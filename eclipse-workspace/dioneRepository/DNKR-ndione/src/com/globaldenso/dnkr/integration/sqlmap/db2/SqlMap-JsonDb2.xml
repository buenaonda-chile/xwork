<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.globaldenso.dnkr.integration.dao.JsonDao">

	<select id="searchQR" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT
		COMPS, DEVID, TRNDT, '${PRSTMFR}' AS PRSTM, SUM(PRTQY) AS PRTQY
	FROM
		PSCDBLIB.FGP530PF
	WHERE
		COMPS=#{COMPS} AND TRNDT= #{TRNDT}
		<if test="DEVID != null and DEVID != ''">
			AND DEVID=#{DEVID}
		</if>
		<if test="PRSTMFR != null and PRSTMFR != ''">
			 AND PRSTM BETWEEN #{PRSTMFR} AND #{PRSTMTO}
		</if>
		<!-- AND DEVID='21' AND PRSTM BETWEEN 100000 AND 110000 -->
	GROUP BY COMPS, TRNDT, DEVID
	UNION ALL
	SELECT
		COMPS, DEVID, TRNDT, '${PRSTMFR}' AS PRSTM, SUM(PRTQY) AS PRTQY
	FROM
		PSCDBLIB.FGP570PF
	WHERE
		COMPS=#{COMPS} AND TRNDT= #{TRNDT}
		<if test="DEVID != null and DEVID != ''">
			AND DEVID=#{DEVID}
		</if>
		<if test="PRSTMFR != null and PRSTMFR != ''">
			 AND PRSTM BETWEEN #{PRSTMFR} AND #{PRSTMTO}
		</if>
		<!-- AND DEVID='21' AND PRSTM BETWEEN 100000 AND 110000 -->
	GROUP BY COMPS, TRNDT, DEVID
	</select>
</mapper>