<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.globaldenso.dnkr.integration.dao.OrderDaySaleCreateDao">

	<parameterMap id="paramMap" type="hashmap">
		<parameter property="param" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	</parameterMap>
	
	<resultMap id="OrderHostUp" type="OrderHostUpDomain">
		<result property="typcd" column="TYPCD" />
		<result property="psvnd" column="PSVND" />
		<result property="pscom" column="PSCOM" />
		<result property="pyvnd" column="PYVND" />
		<result property="vndcd" column="VNDCD" />
		<result property="faccd" column="FACCD" />
		
		<result property="comps" column="COMPS" />
		<result property="mcrcd" column="MCRCD" />
		<result property="msecd" column="MSECD" />
		<result property="mcrc1" column="MCRC1" />
		<result property="msec1" column="MSEC1" />
		
		<result property="pspno" column="PSPNO" />
		<result property="seqcd" column="SEQCD" />
		<result property="seqno" column="SEQNO" />
		<result property="efffr" column="EFFFR" />
		<result property="effto" column="EFFTO" />

		<result property="dmkcr" column="DMKCR" />
		<result property="dsecd" column="DSECD" />
		<result property="dseno" column="DSENO" />
		<result property="dfacd" column="DFACD" />
		<result property="deffr" column="DEFFR" />
		<result property="defto" column="DEFTO" />
		<result property="dumcb" column="DUMCB" />
		<result property="trimd" column="TRIMD" />
		<result property="pbsqy" column="PBSQY" />
		<result property="patqy" column="PATQY" />
		<result property="wbsqy" column="WBSQY" />

		<result property="d0t01" column="D0T01" />
		<result property="d0t02" column="D0T02" />
		<result property="d0t03" column="D0T03" />
		<result property="d0t04" column="D0T04" />
		<result property="d0t05" column="D0T05" />
		<result property="d0t06" column="D0T06" />
		<result property="d0t07" column="D0T07" />
		<result property="d0t08" column="D0T08" />
		<result property="d0t09" column="D0T09" />
		<result property="d0t10" column="D0T10" />
		<result property="d0tqy" column="D0TQY" />
		
		<result property="d1t01" column="D1T01" />
		<result property="d1t02" column="D1T02" />
		<result property="d1t03" column="D1T03" />
		<result property="d1t04" column="D1T04" />
		<result property="d1t05" column="D1T05" />
		<result property="d1t06" column="D1T06" />
		<result property="d1t07" column="D1T07" />
		<result property="d1t08" column="D1T08" />
		<result property="d1t09" column="D1T09" />
		<result property="d1t10" column="D1T10" />
		<result property="d1tqy" column="D1TQY" />
		
		<result property="d2t01" column="D2T01" />
		<result property="d2t02" column="D2T02" />
		<result property="d2t03" column="D2T03" />
		<result property="d2t04" column="D2T04" />
		<result property="d2t05" column="D2T05" />
		<result property="d2t06" column="D2T06" />
		<result property="d2t07" column="D2T07" />
		<result property="d2t08" column="D2T08" />
		<result property="d2t09" column="D2T09" />
		<result property="d2t10" column="D2T10" />
		<result property="d2tqy" column="D2TQY" />
		
		<result property="d3t01" column="D3T01" />
		<result property="d3t02" column="D3T02" />
		<result property="d3t03" column="D3T03" />
		<result property="d3t04" column="D3T04" />
		<result property="d3t05" column="D3T05" />
		<result property="d3t06" column="D3T06" />
		<result property="d3t07" column="D3T07" />
		<result property="d3t08" column="D3T08" />
		<result property="d3t09" column="D3T09" />
		<result property="d3t10" column="D3T10" />
		<result property="d3tqy" column="D3TQY" />
		
		<result property="d4t01" column="D4T01" />
		<result property="d4t02" column="D4T02" />
		<result property="d4t03" column="D4T03" />
		<result property="d4t04" column="D4T04" />
		<result property="d4t05" column="D4T05" />
		<result property="d4t06" column="D4T06" />
		<result property="d4t07" column="D4T07" />
		<result property="d4t08" column="D4T08" />
		<result property="d4t09" column="D4T09" />
		<result property="d4t10" column="D4T10" />
		<result property="d4tqy" column="D4TQY" />
		
		<result property="dat00" column="DAT00" />
		<result property="dat01" column="DAT01" />
		<result property="dat02" column="DAT02" />
		<result property="dat03" column="DAT03" />
		<result property="dat04" column="DAT04" />
		<result property="dat05" column="DAT05" />
		<result property="dat06" column="DAT06" />
		<result property="dat07" column="DAT07" />
		<result property="dat08" column="DAT08" />
		<result property="dat09" column="DAT09" />
		<result property="dat10" column="DAT10" />
		<result property="dat11" column="DAT11" />
		<result property="dat12" column="DAT12" />		

		<result property="remqy" column="REMQY" />
		<result property="grtot" column="GRTOT" />
		<result property="okqty" column="OKQTY" />
		<result property="mitqy" column="MITQY" />
		<result property="prseq" column="PRSEQ" />
		<result property="miqqy" column="MIQQY" />
		<result property="mioqy" column="MIOQY" />
		<result property="molcd" column="MOLCD" />
						
        <result property="lib1" column="lib1" />
        <result property="lib2" column="lib2" />
        <result property="lib3" column="lib3" />     
    </resultMap>       
    
    <resultMap id="OrderDaySaleCreate" type="OrderDaySaleCreateDomain">
		<result property="pyvnd" column="PYVND" />
		<result property="pspno" column="PSPNO" />
		<result property="mkpno" column="MKPNO" />
		<result property="chldt" column="CHLDT" />
		<result property="faccd" column="FACCD" />
		<result property="seycd" column="SEYCD" />
		
		<result property="seyno" column="SEYNO" />
		<result property="mkcar" column="MKCAR" />
		<result property="carcd" column="CARCD" />
		<result property="trimdd" column="TRIMDD" />
		<result property="pbsqyd" column="PBSQYD" />
		
		<result property="datq0d" column="DATQ0D" />
		<result property="dat11d" column="DAT11D" />
		<result property="dat12d" column="DAT12D" />
		<result property="datq1d" column="DATQ1D" />
		<result property="dat21d" column="DAT21D" />

		<result property="dat22d" column="DAT22D" />
		<result property="datq2d" column="DATQ2D" />
		<result property="dat31d" column="DAT31D" />
		<result property="dat32d" column="DAT32D" />
		<result property="datq3d" column="DATQ3D" />
		<result property="trimdt" column="TRIMDT" />
		<result property="pbsqyt" column="PBSQYT" />
		<result property="datq0t" column="DATQ0T" />
		<result property="dat11t" column="DAT11T" />
		<result property="dat12t" column="DAT12T" />
		<result property="datq1t" column="DATQ1T" />

		<result property="dat21t" column="DAT21T" />
		<result property="dat22t" column="DAT22T" />
		<result property="datq2t" column="DATQ2T" />
		<result property="dat31t" column="DAT31T" />
		<result property="dat32t" column="DAT32T" />
		<result property="datq3t" column="DATQ3T" />
		<result property="dat41t" column="DAT41T" />
		<result property="dat42t" column="DAT42T" />
		<result property="datq4t" column="DATQ4T" />
		<result property="dat51t" column="DAT51T" />
		<result property="dat52t" column="DAT52T" />
		
		<result property="datq5t" column="DATQ5T" />
		<result property="dat61t" column="DAT61T" />
		<result property="dat62t" column="DAT62T" />
		<result property="datq6t" column="DATQ6T" />
		<result property="dat71t" column="DAT71T" />
		<result property="dat72t" column="DAT72T" />
		<result property="datq7t" column="DATQ7T" />
		<result property="dat81t" column="DAT81T" />
		<result property="dat82t" column="DAT82T" />
		<result property="datq8t" column="DATQ8T" />
		<result property="dat91t" column="DAT91T" />
		
		<result property="dat92t" column="DAT92T" />
		<result property="datq9t" column="DATQ9T" />
		<result property="data1t" column="DATA1T" />
		<result property="data2t" column="DATA2T" />
		<result property="datqat" column="DATQAT" />
		<result property="datb1t" column="DATB1T" />
		<result property="datb2t" column="DATB2T" />
		<result property="datqbt" column="DATQBT" />
		<result property="datc1t" column="DATC1T" />
		<result property="datc2t" column="DATC2T" />
		<result property="datqct" column="DATQCT" /> 
		<result property="comps" column="COMPS" />
						
        <result property="lib1" column="lib1" />
        <result property="lib2" column="lib2" />
        <result property="lib3" column="lib3" />     
        
        <result property="dmkcr" column="DMKCR" />
        <result property="dsecd" column="DSECD" />
        <result property="dseno" column="DSENO" />
        <result property="dfacd" column="DFACD" />
        <result property="deffr" column="DEFFR" />
        <result property="defto" column="DEFTO" />
        <result property="dumcb" column="DUMCB" />
        <result property="trimd" column="TRIMD" />
        <result property="pbsqy" column="PBSQY" />
        <result property="patqy" column="PATQY" />
        <result property="wbsqy" column="WBSQY" />
        <result property="dat00" column="DAT00" />
        <result property="dat01" column="DAT01" />
        <result property="dat02" column="DAT02" />
        <result property="dat03" column="DAT03" />
        <result property="dat04" column="DAT04" />
        <result property="dat05" column="DAT05" />
        <result property="dat06" column="DAT06" />
        <result property="dat07" column="DAT07" />
        <result property="dat08" column="DAT08" />
        <result property="dat09" column="DAT09" />
        <result property="dat10" column="DAT10" />
        <result property="dat11" column="DAT11" />
        <result property="dat12" column="DAT12" />
        <result property="remqy" column="REMQY" />
        <result property="okqty" column="OKQTY" />
        <result property="mitqy" column="MITQY" />
        <result property="prseq" column="PRSEQ" />
        <result property="miqqy" column="MIQQY" />
        <result property="mioqy" column="MIOQY" />
        <result property="grtot" column="GRTOT" />
        
    </resultMap>
    
    <resultMap id="OrderDaySaleCreate2" type="OrderDaySaleCreateDomain2">
    	<result property="pyvnd" column="PYVND" /> 
		<result property="pspno" column="PSPNO" /> 
		<result property="mkpno" column="MKPNO" /> 
		<result property="chldt" column="CHLDT" /> 
		<result property="shdpt" column="SHDPT" /> 
		<result property="faccd" column="FACCD" /> 
		<result property="seycd" column="SEYCD" /> 
		<result property="seyno" column="SEYNO" /> 
		<result property="mkcar" column="MKCAR" /> 
		<result property="carcd" column="CARCD" /> 
		<result property="makqy" column="MAKQY" /> 
		<result property="trimd" column="TRIMD" /> 
		<result property="pbsqy" column="PBSQY" /> 
		<result property="imfdt" column="IMFDT" /> 
		<result property="clhct" column="CLHCT" /> 
		<result property="uptdt" column="UPTDT" /> 
		<result property="updat" column="UPDAT" /> 
		<result property="datq0" column="DATQ0" /> 
		<result property="dat11" column="DAT11" /> 
		<result property="dat12" column="DAT12" /> 
		<result property="datq1" column="DATQ1" /> 
		<result property="dat21" column="DAT21" /> 
		<result property="dat22" column="DAT22" /> 
		<result property="datq2" column="DATQ2" /> 
		<result property="dat31" column="DAT31" /> 
		<result property="dat32" column="DAT32" /> 
		<result property="datq3" column="DATQ3" /> 
		<result property="dat41" column="DAT41" /> 
		<result property="dat42" column="DAT42" /> 
		<result property="datq4" column="DATQ4" /> 
		<result property="dat51" column="DAT51" /> 
		<result property="dat52" column="DAT52" /> 
		<result property="datq5" column="DATQ5" /> 
		<result property="dat61" column="DAT61" /> 
		<result property="dat62" column="DAT62" /> 
		<result property="datq6" column="DATQ6" /> 
		<result property="dat71" column="DAT71" /> 
		<result property="dat72" column="DAT72" /> 
		<result property="datq7" column="DATQ7" /> 
		<result property="dat81" column="DAT81" /> 
		<result property="dat82" column="DAT82" /> 
		<result property="datq8" column="DATQ8" /> 
		<result property="dat91" column="DAT91" /> 
		<result property="dat92" column="DAT92" /> 
		<result property="datq9" column="DATQ9" /> 
		<result property="data1" column="DATA1" /> 
		<result property="data2" column="DATA2" /> 
		<result property="datqa" column="DATQA" /> 
		<result property="datb1" column="DATB1" /> 
		<result property="datb2" column="DATB2" /> 
		<result property="datqb" column="DATQB" /> 
		<result property="datc1" column="DATC1" /> 
		<result property="datc2" column="DATC2" /> 
		<result property="datqc" column="DATQC" /> 
		<result property="dapq0" column="DAPQ0" /> 
		<result property="dap11" column="DAP11" /> 
		<result property="dap12" column="DAP12" /> 
		<result property="dap21" column="DAP21" /> 
		<result property="dap22" column="DAP22" /> 
		<result property="dap31" column="DAP31" /> 
		<result property="dap32" column="DAP32" /> 
		<result property="dap41" column="DAP41" /> 
		<result property="dap42" column="DAP42" /> 
		<result property="dap51" column="DAP51" /> 
		<result property="dap52" column="DAP52" /> 
		<result property="dap61" column="DAP61" /> 
		<result property="dap62" column="DAP62" /> 
		<result property="dap71" column="DAP71" /> 
		<result property="dap72" column="DAP72" /> 
		<result property="dap81" column="DAP81" /> 
		<result property="dap82" column="DAP82" /> 
		<result property="dap91" column="DAP91" /> 
		<result property="dap92" column="DAP92" /> 
		<result property="dapa1" column="DAPA1" /> 
		<result property="dapa2" column="DAPA2" /> 
		<result property="dapb1" column="DAPB1" /> 
		<result property="dapb2" column="DAPB2" /> 
		<result property="dapc1" column="DAPC1" /> 
		<result property="dapc2" column="DAPC2" /> 
		<result property="dapd1" column="DAPD1" /> 
		<result property="dapd2" column="DAPD2" /> 
		<result property="sujq0" column="SUJQ0" /> 
		<result property="sujq1" column="SUJQ1" /> 
		<result property="sujq2" column="SUJQ2" /> 
		<result property="sujq3" column="SUJQ3" /> 
		<result property="sujq4" column="SUJQ4" /> 
		<result property="sujq5" column="SUJQ5" /> 
		<result property="sujq6" column="SUJQ6" /> 
		<result property="sujq7" column="SUJQ7" /> 
		<result property="sujq8" column="SUJQ8" /> 
		<result property="sujq9" column="SUJQ9" /> 
		<result property="sujqa" column="SUJQA" /> 
		<result property="sujqb" column="SUJQB" /> 
		<result property="sujqc" column="SUJQC" /> 
		<result property="suyqy" column="SUYQY" /> 
		<result property="cllq1" column="CLLQ1" /> 
		<result property="cllq2" column="CLLQ2" /> 
		<result property="cllq3" column="CLLQ3" /> 
		<result property="cllq4" column="CLLQ4" /> 
		<result property="clpq1" column="CLPQ1" /> 
		<result property="clpq2" column="CLPQ2" /> 
		<result property="clpq3" column="CLPQ3" /> 
		<result property="clpq4" column="CLPQ4" /> 
		<result property="cldq1" column="CLDQ1" /> 
		<result property="cldq2" column="CLDQ2" /> 
		<result property="cldq3" column="CLDQ3" /> 
		<result property="cldq4" column="CLDQ4" /> 
		<result property="cldqt" column="CLDQT" /> 
		<result property="crttm" column="CRTTM" /> 
		<result property="comps" column="COMPS" />

						
        <result property="lib1" column="lib1" />
        <result property="lib2" column="lib2" />
        <result property="lib3" column="lib3" />    
    </resultMap>
    
	<resultMap id="OrderCalendar" type="OrderCalendarDomain">
    	<result property="pyvnd" column="PYVND" /> 
		<result property="pspno" column="PSPNO" /> 
		<result property="makdt" column="MAKDT" /> 
		<result property="makmk" column="MAKMK" />
		<result property="mltcd" column="MLTCD" />
		<result property="clhcd" column="CLHCD" />
						
        <result property="lib1" column="lib1" />
        <result property="lib2" column="lib2" />
        <result property="lib3" column="lib3" />    
    </resultMap>
	
    <select id="procCreate" statementType="CALLABLE" parameterType="hashmap">
		{CALL PSEOBJLIB.SPDE140RC('${param}') }
    </select>

    <select id="procCreate_bak" parameterType="hashmap" statementType="CALLABLE">
        {CALL PSZDBLIB.SPDE140PC
        	(
        		#{param, mode=IN, jdbcType=VARCHAR, javaType=string}<!--,
                #{rtnCd, mode=OUT, jdbcType=INTEGER, javaType=int},
                #{rtnMsg, mode=OUT, jdbcType=VARCHAR, javaType=string}-->
            )
        }
    </select>
    
    <delete id="deleteSPD149PFX" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SPD149PFX 
		WHERE 
			  'SqlMap-OrderDaySaleCreate.deleteSPD149PFX' = 'SqlMap-OrderDaySaleCreate.deleteSPD149PFX'
		  AND COMPS = #{comps}
		  AND TYPCD = #{typcd}
		  AND PYVND = #{pyvnd}		  
    </delete>
    
    <delete id="deleteSPD141PF" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SPD141PF 
		WHERE 
			  'SqlMap-OrderDaySaleCreate.deleteSPD141PF' = 'SqlMap-OrderDaySaleCreate.deleteSPD141PF'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}		  
    </delete>
    
    <delete id="deleteSPD142PF" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SPD142PF 
		WHERE 
			  'SqlMap-OrderDaySaleCreate.deleteSPD142PF' = 'SqlMap-OrderDaySaleCreate.deleteSPD142PF'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}		  
    </delete>
    
    <delete id="deleteSPD148PF" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SPD148PF 
		WHERE 
			  'SqlMap-OrderDaySaleCreate.deleteSPD148PF' = 'SqlMap-OrderDaySaleCreate.deleteSPD148PF'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}		  
    </delete> 
    
    <delete id="deleteSHK200PF" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SHK200PF 
		WHERE 
			  'SqlMap-OrderDaySaleCreate.deleteSHK200PF' = 'SqlMap-OrderDaySaleCreate.deleteSHK200PF'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}		  
    </delete> 
    
    <delete id="deleteSHK210PF" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SHK210PF 
		WHERE 
			  'SqlMap-OrderDaySaleCreate.deleteSHK210PF' = 'SqlMap-OrderDaySaleCreate.deleteSHK210PF'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}		  
    </delete>         

	<insert id="insertSHK200PF" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderDaySaleCreate.insertSHK200PF */
		INSERT INTO PSZDBLIB.SHK200PF 
		(
			PYVND,PSPNO,DMKCR,DSECD,DSENO,
			DFACD,DEFFR,DEFTO,DUMCB,TRIMD,
			PBSQY,PATQY,WBSQY,DATD0,DATD1,
			DATD2,DATD3,DATD4,DATD5,DATD6,
			DATD7,DATD8,DATD9,DATQY,DATN1,
			DATN2,DATN3,DATN4,DATN5,DATN6,
			DT2AF,DT2EV,DT3AF,DT3EV,REMQY,
			GRTOT,COMPS
		)
		SELECT PYVND,PSPNO,DMKCR,DSECD,DSENO,
			DFACD,DEFFR,DEFTO,DUMCB,TRIMD,PBSQY,PATQY,WBSQY,
			D0T01,D0T02,D0T03,D0T04,D0T05,
			D0T06,D0T07,D0T08,D0T09,D0T10,D0TQY,
			D1T01,D1T02,D1T03+D1T04,D1T05+D1T06,
			D1T07+D1T08,D1T09+D1T10,
			D2T01+D2T02+D2T03+D2T04+D2T05,
			D2T06+D2T07+D2T08+D2T09+D2T10,
			D3T01+D3T02+D3T03+D3T04+D3T05,
			D3T06+D3T07+D3T08+D3T09+D3T10,
			REMQY,GRTOT,COMPS 
			FROM PSZDBLIB.SVH310PF
			WHERE COMPS = #{comps}
			AND PYVND = #{pyvnd}
    </insert>

	<insert id="insertSHK210PF" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderDaySaleCreate.insertSHK210PF */
		 INSERT INTO PSZDBLIB.SHK210PF
		 (
			PYVND,PSPNO,DMKCR,DSECD,DSENO,
			DFACD,DEFFR,DEFTO,DUMCB,TRIMD,
			PBSQY,PATQY,WBSQY,DAT00,DAT01,
			DAT02,DAT03,DAT04,DAT05,DAT06,
			DAT07,DAT08,DAT09,DAT10,DAT11,
			DAT12,REMQY,OKQTY,MITQY,PRSEQ,
			MIQQY,MIOQY,GRTOT,COMPS
		  )
		   SELECT PYVND,PSPNO,DMKCR,DSECD,DSENO,DFACD,DEFFR,DEFTO,
		        DUMCB,TRIMD,PBSQY,PATQY,WBSQY,DAT00,DAT01,DAT02,
		        DAT03,DAT04,DAT05,DAT06,DAT07,DAT08,DAT09,DAT10,
		        DAT11,DAT12,REMQY,OKQTY,MITQY,PRSEQ,MIQQY,MIOQY,
		        GRTOT,COMPS
		   FROM PSZDBLIB.SVH320PF
		   WHERE COMPS = #{comps}
		   AND PYVND = #{pyvnd} 
    </insert>

	<insert id="insertSPD141PF" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderDaySaleCreate.insertSPD141PF */
		insert into PSZDBLIB.SPD141PF
		(
		PYVND,PSPNO,MKPNO,CHLDT,FACCD,
		SEYCD,SEYNO,MKCAR,CARCD,TRIMDD,
		PBSQYD,DATQ0D,DAT11D,DAT12D,DATQ1D,
		DAT21D,DAT22D,DATQ2D,DAT31D,DAT32D,
		DATQ3D,COMPS
		)
		select * from		 
		(select pyvnd,pspno,
		(select cprtn from 
${lib1}.EM000LR0 a , 
(select CUSNO, PRTNO, max(edatm) as edatm from ${lib1}.EM000LR0 group by CUSNO, PRTNO) b
where
a.cusno = pyvnd and a.prtno = pspno and 
a.cusno = b.cusno and a.prtno = b.prtno and a.edatm = b.edatm ) mkpno,
		dumcb as chldt,
		dfacd as faccd,
		dsecd as seycd,
		dseno as seyno,
		dmkcr as mkcar,
		(select carcd FROM ${lib2}.mst100pf where prtno = pspno and ${lib2}.mst100pf.comps = PSZDBLIB.SHK200PF.COMPS) as carcd,
		trimd as trimdd,
		pbsqy+patqy+wbsqy as pbsqyd,
		datqy as datq0d,
		datn1+datn2+datn3 as dat11d,
		datn4+datn5+datn6 as dat12d,
		datn1+datn2+datn3+datn4+datn5+datn6  as  datq1d,
		dt2af as dat21d,
		dt2ev as dat22d,
		dt2af +  dt2ev as datq2d,
		dt3af as dat31d,
		dt3ev as dat32d,
		dt3af + dt3ev as datq3d,	
		PSZDBLIB.SHK200PF.COMPS 
		from ${lib2}.mst100pf,
		PSZDBLIB.SHK200PF
		WHERE PSPNO = PRTNO
		AND pyvnd = #{pyvnd}
		AND PSZDBLIB.SHK200PF.COMPS = #{comps}
		)
		 A
		where
		mkpno is not null
    </insert>
    
    <insert id="insertSPD141PF_2" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderDaySaleCreate.insertSPD141PF_2 */		
		INSERT INTO PSZDBLIB.SPD141PF
		(
		PYVND,PSPNO,MKPNO,CHLDT,FACCD,
		SEYCD,SEYNO,MKCAR,CARCD,TRIMDD,
		PBSQYD,DAT11T,DAT12T,DATQ1T,DAT21T,
		DAT22T,DATQ2T,DAT31T,DAT32T,DATQ3T,
		DAT41T,DAT42T,DATQ4T,DAT51T,DAT52T,
		DATQ5T,DAT61T,DAT62T,DATQ6T,DAT71T,
		DAT72T,DATQ7T,DAT81T,DAT82T,DATQ8T,
		DAT91T,DAT92T,DATQ9T,DATA1T,DATA2T,
		DATQAT,DATB1T,DATB2T,DATQBT,DATC1T,
		DATC2T,DATQCT,COMPS
		)
		select * from		 
		(
		select 
		pyvnd,
		pspno,
		(select cprtn from 
${lib1}.EM000LR0 a , 
(select CUSNO, PRTNO, max(edatm) as edatm from ${lib1}.EM000LR0 group by CUSNO, PRTNO) b
where
a.cusno = pyvnd and a.prtno = pspno and 
a.cusno = b.cusno and a.prtno = b.prtno and a.edatm = b.edatm ) mkpno,
		dumcb as chldt,
		dfacd as faccd,
		dsecd as seycd,
		dseno as seyno,
		dmkcr as mkcar,
		(select carcd from ${lib2}.mst100pf where prtno =  pspno and ${lib2}.mst100pf.comps = PSZDBLIB.SHK210PF.COMPS) as carcd,
		trimd as trimdd,
		pbsqy+patqy+wbsqy as pbsqyd,
		INTEGER(DAT01 / 2 + MOD(DAT01, 2)) AS DAT11T,
		INTEGER(DAT01 / 2) AS DAT12T,
		DAT01 AS DATQ1T,
		INTEGER(DAT02 / 2 + MOD(DAT02, 2)) AS DAT21T,
		INTEGER(DAT02 / 2) AS DAT22T,
		DAT02 AS DATQ2T,
		INTEGER(DAT03 / 2 + MOD(DAT03, 2)) AS DAT31T,
		INTEGER(DAT03 / 2) AS DAT32T,
		DAT03 AS DATQ3T,
		INTEGER(DAT04 / 2 + MOD(DAT04, 2)) AS DAT41T,
		INTEGER(DAT04 / 2) AS DAT42T,
		DAT04 AS DATQ4T,
		INTEGER(DAT05 / 2 + MOD(DAT05, 2)) AS DAT51T,
		INTEGER(DAT05 / 2) AS DAT52T,
		DAT05 AS DATQ5T,
		INTEGER(DAT06 / 2 + MOD(DAT06, 2)) AS DAT61T,
		INTEGER(DAT06 / 2) AS DAT62T,
		DAT06 AS DATQ6T,
		INTEGER(DAT07 / 2 + MOD(DAT07, 2)) AS DAT71T,
		INTEGER(DAT07 / 2) AS DAT72T,
		DAT07 AS DATQ7T,
		INTEGER(DAT08 / 2 + MOD(DAT08, 2)) AS DAT81T,
		INTEGER(DAT08 / 2) AS DAT82T,
		DAT08 AS DATQ8T,
		INTEGER(DAT09 / 2 + MOD(DAT09, 2)) AS DAT91T,
		INTEGER(DAT09 / 2) AS DAT92T,
		DAT09 AS DATQ9T,
		INTEGER(DAT10 / 2 + MOD(DAT10, 2)) AS DATA1T,
		INTEGER(DAT10 / 2) AS DATA2T,
		DAT10 AS DATQAT,
		INTEGER(DAT11 / 2 + MOD(DAT11, 2)) AS DATB1T,
		INTEGER(DAT11 / 2) AS DATB2T,
		DAT11 AS DATQBT,
		INTEGER(DAT12 / 2 + MOD(DAT12, 2)) AS DATC1T,
		INTEGER(DAT12 / 2) AS DATC2T,
		DAT12 AS DATQCT,
		PSZDBLIB.SHK210PF.COMPS
		from ${lib2}.mst100pf,
		PSZDBLIB.SHK210PF
		WHERE PSPNO = PRTNO
		AND pyvnd = #{pyvnd}
		AND PSZDBLIB.SHK210PF.COMPS = #{comps}
		)
		 A
		where
		mkpno is not null
    </insert>
    
    <insert id="insertSPD141PF_3" parameterType ="OrderDaySaleCreateDomain">
    	/* SqlMap-OrderDaySaleCreate.insertSPD141PF_3 */		
		INSERT INTO PSZDBLIB.SPD141PF 
		(
		PYVND,PSPNO,MKPNO,CHLDT,FACCD, 
		SEYCD,SEYNO,MKCAR,CARCD,TRIMDD, 
		PBSQYD,DAT11T,DAT12T,DATQ1T,DAT21T,
		DAT22T,DATQ2T,DAT31T,DAT32T,DATQ3T,
		DAT41T,DAT42T,DATQ4T,DAT51T,DAT52T,
		DATQ5T,DAT61T,DAT62T,DATQ6T,DAT71T,
		DAT72T,DATQ7T,DAT81T,DAT82T,DATQ8T,
		DAT91T,DAT92T,DATQ9T,DATA1T,DATA2T,
		DATQAT,DATB1T,DATB2T,DATQBT,DATC1T,
		DATC2T,DATQCT,COMPS
		) values 
		(
		#{pyvnd},
		#{pspno},
		COALESCE((select cprtn from 
${lib1}.EM000LR0 a , 
(select CUSNO, PRTNO, max(edatm) as edatm from ${lib1}.EM000LR0 group by CUSNO, PRTNO) b
where
a.cusno = pyvnd and a.prtno = pspno and 
a.cusno = b.cusno and a.prtno = b.prtno and a.edatm = b.edatm), '-'),
		#{dumcb},
		#{dfacd},
		#{dsecd},
		#{dseno},
		#{dmkcr},
		(select carcd from ${lib2}.mst100pf where prtno = #{pspno} and ${lib2}.mst100pf.comps = #{comps}),
		#{trimd},
		CAST(#{pbsqy} AS INTEGER)+CAST(#{patqy} AS INTEGER)+CAST(#{wbsqy} AS INTEGER),
		CAST(#{dat01} AS INTEGER) / 2 + MOD(CAST(#{dat01} AS INTEGER), 2),
		CAST(#{dat01} AS INTEGER) / 2, 
		#{dat01}, 
		CAST(#{dat02} AS INTEGER) / 2 + MOD(CAST(#{dat02} AS INTEGER), 2),
		CAST(#{dat02} AS INTEGER) / 2,
		#{dat02},
		CAST(#{dat03} AS INTEGER) / 2 + MOD(CAST(#{dat03} AS INTEGER), 2),
		CAST(#{dat03} AS INTEGER) / 2,
		#{dat03},
		CAST(#{dat04} AS INTEGER) / 2 + MOD(CAST(#{dat04} AS INTEGER), 2),
		CAST(#{dat04} AS INTEGER) / 2,
		#{dat04},
		CAST(#{dat05} AS INTEGER) / 2 + MOD(CAST(#{dat05} AS INTEGER), 2),
		CAST(#{dat05} AS INTEGER) / 2,
		#{dat05},
		CAST(#{dat06} AS INTEGER) / 2 + MOD(CAST(#{dat06} AS INTEGER), 2),
		CAST(#{dat06} AS INTEGER) / 2,
		#{dat06},
		CAST(#{dat07} AS INTEGER) / 2 + MOD(CAST(#{dat07} AS INTEGER), 2),
		CAST(#{dat07} AS INTEGER) / 2,
		#{dat07},
		CAST(#{dat08} AS INTEGER) / 2 + MOD(CAST(#{dat08} AS INTEGER), 2),
		CAST(#{dat08} AS INTEGER) / 2,
		#{dat08},
		CAST(#{dat09} AS INTEGER) / 2 + MOD(CAST(#{dat09} AS INTEGER), 2),
		CAST(#{dat09} AS INTEGER) / 2,
		#{dat09},
		CAST(#{dat10} AS INTEGER) / 2 + MOD(CAST(#{dat10} AS INTEGER), 2),
		CAST(#{dat10} AS INTEGER) / 2,
		#{dat10},
		CAST(#{dat11} AS INTEGER) / 2 + MOD(CAST(#{dat11} AS INTEGER), 2),
		CAST(#{dat11} AS INTEGER) / 2,
		#{dat11},
		CAST(#{dat12} AS INTEGER) / 2 + MOD(CAST(#{dat12} AS INTEGER), 2),
		CAST(#{dat12} AS INTEGER) / 2,
		#{dat12},		
		#{comps}
		)
    </insert>
    
    <update id="updateSPD141PF" parameterType ="OrderDaySaleCreateDomain">
    	/* SqlMap-OrderDaySaleCreate.updateSPD141PF */		

		update PSZDBLIB.SPD141PF set  		
		TRIMDT = #{trimd},
		PBSQYD = (CAST(#{pbsqy} AS INTEGER) + CAST(#{patqy} AS INTEGER) + CAST(#{wbsqy} AS INTEGER)),
		DATQ0T = #{dat00},
		DAT11T = (CAST(#{dat01} AS INTEGER) / 2 + MOD(CAST(#{dat01} AS INTEGER), 2)),
		DAT12T = (CAST(#{dat01} AS INTEGER) / 2),
		DATQ1T = #{dat01},
		DAT21T = (CAST(#{dat02} AS INTEGER) / 2 + MOD(CAST(#{dat02} AS INTEGER), 2)),
		DAT22T = (CAST(#{dat02} AS INTEGER) / 2),
		DATQ2T = #{dat02},
		DAT31T = (CAST(#{dat03} AS INTEGER) / 2 + MOD(CAST(#{dat03} AS INTEGER), 2)),
		DAT32T = (CAST(#{dat03} AS INTEGER) / 2),
		DATQ3T = #{dat03},
		DAT41T = (CAST(#{dat04} AS INTEGER) / 2 + MOD(CAST(#{dat04} AS INTEGER), 2)),
		DAT42T = (CAST(#{dat04} AS INTEGER) / 2),
		DATQ4T = #{dat04},
		DAT51T = (CAST(#{dat05} AS INTEGER) / 2 + MOD(CAST(#{dat05} AS INTEGER), 2)),
		DAT52T = (CAST(#{dat05} AS INTEGER) / 2),
		DATQ5T = #{dat05},
		DAT61T = (CAST(#{dat06} AS INTEGER) / 2 + MOD(CAST(#{dat06} AS INTEGER), 2)),
		DAT62T = (CAST(#{dat06} AS INTEGER) / 2),
		DATQ6T = #{dat06},
		DAT71T = (CAST(#{dat07} AS INTEGER) / 2 + MOD(CAST(#{dat07} AS INTEGER), 2)),
		DAT72T = (CAST(#{dat07} AS INTEGER) / 2),
		DATQ7T = #{dat07},
		DAT81T = (CAST(#{dat08} AS INTEGER) / 2 + MOD(CAST(#{dat08} AS INTEGER), 2)),
		DAT82T = (CAST(#{dat08} AS INTEGER) / 2),
		DATQ8T = #{dat08},
		DAT91T = (CAST(#{dat09} AS INTEGER) / 2 + MOD(CAST(#{dat09} AS INTEGER), 2)),
		DAT92T = (CAST(#{dat09} AS INTEGER) / 2),
		DATQ9T = #{dat09},
		DATA1T = (CAST(#{dat10} AS INTEGER) / 2 + MOD(CAST(#{dat10} AS INTEGER), 2)),
		DATA2T = (CAST(#{dat10} AS INTEGER) / 2),
		DATQAT = #{dat10},
		DATB1T = (CAST(#{dat11} AS INTEGER) / 2 + MOD(CAST(#{dat11} AS INTEGER), 2)),
		DATB2T = (CAST(#{dat11} AS INTEGER) / 2),
		DATQBT = #{dat11},
		DATC1T = (CAST(#{dat12} AS INTEGER) / 2 + MOD(CAST(#{dat12} AS INTEGER), 2)),
		DATC2T = (CAST(#{dat12} AS INTEGER) / 2),
		DATQCT = #{dat12} 				
		where 
		COMPS = #{comps} 
		and PYVND = #{pyvnd} 
		and PSPNO = #{pspno} 	
		and SEYCD = #{dsecd} 
		and SEYNO = #{dseno}
		and FACCD = #{dfacd}
		and MKCAR = #{dmkcr}
    </update>
    
    <select id="selectSPD141PF" resultMap="OrderDaySaleCreate" parameterType="OrderHostUpDomain">
		SELECT PYVND,PSPNO,MKPNO,CHLDT,FACCD,	
			SEYCD,SEYNO,MKCAR,CARCD,TRIMDD,
			PBSQYD,DATQ0D,DAT11D,DAT12D,DATQ1D,	
			DAT21D,DAT22D,DATQ2D,DAT31D,DAT32D,	
			DATQ3D,TRIMDT,PBSQYT,DATQ0T,DAT11T,
			DAT12T,DATQ1T,DAT21T,DAT22T,DATQ2T,
			DAT31T,DAT32T,DATQ3T,DAT41T,DAT42T,	
			DATQ4T,DAT51T,DAT52T,DATQ5T,DAT61T,	
			DAT62T,DATQ6T,DAT71T,DAT72T,DATQ7T,	
			DAT81T,DAT82T,DATQ8T,DAT91T,DAT92T,	
			DATQ9T,DATA1T,DATA2T,DATQAT,DATB1T,	
			DATB2T,DATQBT,DATC1T,DATC2T,DATQCT,COMPS	
		FROM 
			PSZDBLIB.SPD141PF  
		WHERE 
		      'SqlMap-OrderDaySaleCreate.selectSPD141PF' = 'SqlMap-OrderDaySaleCreate.selectSPD141PF'
		
		AND COMPS = #{comps}
		<if test="pyvnd != null and pyvnd !='' ">
		  AND PYVND = #{pyvnd}
		</if>
		<if test="pspno != null and pspno !='' ">
		  AND PSPNO = #{pspno}
		</if>										

    </select>
    
    <insert id="insertSPD142PF" parameterType ="OrderDaySaleCreateDomain">
    	/* SqlMap-OrderDaySaleCreate.createSPD142PF */
		INSERT INTO 
			PSZDBLIB.SPD142PF  
			( PYVND,PSPNO,MKCAR,TRIMD,PBSQY,	
				DATQ0,DAT11,DAT12,DATQ1,DAT21,
				DAT22,DATQ2,DAT31,DAT32,DATQ3,
				DAT41,DAT42,DATQ4,DAT51,DAT52,
				DATQ5,DAT61,DAT62,DATQ6,DAT71,
				DAT72,DATQ7,DAT81,DAT82,DATQ8,
				DAT91,DAT92,DATQ9,DATA1,DATA2,
				DATQA,DATB1,DATB2,DATQB,DATC1,
				DATC2,DATQC,COMPS,MKPNO,CHLDT,
				FACCD,SEYCD,SEYNO,CARCD
			 )
		VALUES
			(
			#{pyvnd},#{pspno},#{mkcar},#{trimdd},#{pbsqyd},			
			#{datq0d},#{dat11d},#{dat12d},#{datq1d},#{dat21d},
			#{dat22d},#{datq2d},#{dat31d},#{dat32d},#{datq3d},			
			#{dat41t},#{dat42t},#{datq4t},#{dat51t},#{dat52t},
			#{datq5t},#{dat61t},#{dat62t},#{datq6t},#{dat71t},
			#{dat72t},#{datq7t},#{dat81t},#{dat82t},#{datq8t},
			#{dat91t},#{dat92t},#{datq9t},#{data1t},#{data2t},
			#{datqat},#{datb1t},#{datb2t},#{datqbt},#{datc1t},
			#{datc2t},#{datqct},#{comps},#{mkpno},#{chldt},
			#{faccd},#{seycd},#{seyno},#{carcd}
			)
    </insert> 
    
    <insert id="insertSPD148PF" parameterType ="OrderDaySaleCreateDomain">
    	/* SqlMap-OrderDaySaleCreate.createSPD148PF */
		INSERT INTO 
			PSZDBLIB.SPD148PF  
			( PYVND,PSPNO,MKPNO,CHLDT,FACCD,	
			SEYCD,SEYNO,MKCAR,CARCD,ERRCD,TRIMDD,
			PBSQYD,DATQ0D,DAT11D,DAT12D,DATQ1D,	
			DAT21D,DAT22D,DATQ2D,DAT31D,DAT32D,	
			DATQ3D,TRIMDT,PBSQYT,DATQ0T,DAT11T,
			DAT12T,DATQ1T,DAT21T,DAT22T,DATQ2T,
			DAT31T,DAT32T,DATQ3T,DAT41T,DAT42T,	
			DATQ4T,DAT51T,DAT52T,DATQ5T,DAT61T,	
			DAT62T,DATQ6T,DAT71T,DAT72T,DATQ7T,	
			DAT81T,DAT82T,DATQ8T,DAT91T,DAT92T,	
			DATQ9T,DATA1T,DATA2T,DATQAT,DATB1T,	
			DATB2T,DATQBT,DATC1T,DATC2T,DATQCT,COMPS 
			 )
		VALUES
			(
			#{pyvnd},#{pspno},#{mkpno},#{chldt},#{faccd},
			#{seycd},#{seyno},#{mkcar},#{carcd},#{errcd},#{trimdd},
			#{pbsqyd},#{datq0d},#{dat11d},#{dat12d},#{datq1d},
			#{dat21d},#{dat22d},#{datq2d},#{dat31d},#{dat32d},	
			#{datq3d},#{trimdt},#{pbsqyt},#{datq0t},#{dat11t},
			#{dat12t},#{datq1t},#{dat21t},#{dat22t},#{datq2t},
			#{dat31t},#{dat32t},#{datq3t},#{dat41t},#{dat42t},	
			#{datq4t},#{dat51t},#{dat52t},#{datq5t},#{dat61t},	
			#{dat62t},#{datq6t},#{dat71t},#{dat72t},#{datq7t},	
			#{dat81t},#{dat82t},#{datq8t},#{dat91t},#{dat92t},	
			#{datq9t},#{data1t},#{data2t},#{datqat},#{datb1t},	
			#{datb2t},#{datqbt},#{datc1t},#{datc2t},#{datqct},#{comps}	
			)
    </insert> 
    
    <select id="countSAL160PF" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT
		FROM
			${lib2}.SAL160PF
		WHERE
		      'SqlMap-OrderDaySaleCreate.countSAL160PF' = 'SqlMap-OrderDaySaleCreate.countSAL160PF'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}
		  AND MAKCR = #{mkcar}
    </select>
    
    <select id="countSVZ040PF" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT
		FROM
			PSZDBLIB.SVZ040PF
		WHERE
		      'SqlMap-OrderDaySaleCreate.countSVZ040PF' = 'SqlMap-OrderDaySaleCreate.countSVZ040PF'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}
		  AND PSPNO = #{pspno}
    </select>
    
    <select id="countBM009PR" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT
		FROM
			${lib2}.BM009PR
		WHERE
		      'SqlMap-OrderDaySaleCreate.countBM009PR' = 'SqlMap-OrderDaySaleCreate.countBM009PR'
		  AND PYVND = #{pyvnd}
		  AND PSPNO = #{pspno}
    </select>
   
    <select id="selectSPD142PF" resultMap="OrderDaySaleCreate2" parameterType="OrderHostUpDomain">
		SELECT PYVND,PSPNO,MKPNO,CHLDT,SHDPT,	
			FACCD,SEYCD,SEYNO,MKCAR,CARCD,	
			COALESCE((select MKHAD+GIVQY from ${lib2}.SAL200PF
where comps = A.comps and pyvnd = A.pyvnd and pspno = A.pspno),0) AS MAKQY,
			TRIMD,PBSQY,
			COALESCE((select IMFDT from ${lib2}.SAL160PF
where comps = A.comps and pyvnd = A.pyvnd and makcr = A.MKCAR),0) as IMFDT,
			COALESCE((select CLHCT from ${lib2}.SAL160PF
where comps = A.comps and pyvnd = A.pyvnd and makcr = A.MKCAR),0) as CLHCT,	
			UPTDT,UPDAT,DATQ0,DAT11,DAT12,	
			DATQ1,DAT21,DAT22,DATQ2,DAT31,	
			DAT32,DATQ3,DAT41,DAT42,DATQ4,	
			DAT51,DAT52,DATQ5,DAT61,DAT62,	
			DATQ6,DAT71,DAT72,DATQ7,DAT81,	
			DAT82,DATQ8,DAT91,DAT92,DATQ9,	
			DATA1,DATA2,DATQA,DATB1,DATB2,	
			DATQB,DATC1,DATC2,DATQC,DAPQ0,	
			DAP11,DAP12,DAP21,DAP22,DAP31,	
			DAP32,DAP41,DAP42,DAP51,DAP52,	
			DAP61,DAP62,DAP71,DAP72,DAP81,	
			DAP82,DAP91,DAP92,DAPA1,DAPA2,	
			DAPB1,DAPB2,DAPC1,DAPC2,DAPD1,	
			DAPD2,SUJQ0,SUJQ1,SUJQ2,SUJQ3,	
			SUJQ4,SUJQ5,SUJQ6,SUJQ7,SUJQ8,	
			SUJQ9,SUJQA,SUJQB,SUJQC,SUYQY,	
			CLLQ1,CLLQ2,CLLQ3,CLLQ4,CLPQ1,	
			CLPQ2,CLPQ3,CLPQ4,CLDQ1,CLDQ2,	
			CLDQ3,CLDQ4,CLDQT,CRTTM,COMPS
		FROM 
			PSZDBLIB.SPD142PF A 
		WHERE 
		      'SqlMap-OrderDaySaleCreate.selectSPD142PF' = 'SqlMap-OrderDaySaleCreate.selectSPD142PF'
		  AND COMPS = #{comps}
		<if test="pyvnd != null and pyvnd !='' ">
		  AND PYVND = #{pyvnd}
		</if>
		<if test="pspno != null and pspno !='' ">
		  AND PSPNO = #{pspno}
		</if>		
    </select>
    
    <update id="updateSPD142PF" parameterType="OrderDaySaleCreateDomain2">
        update 
                PSZDBLIB.SPD142PF 
        set
            DAPQ0 = #{dapq0},
			DAP11 = #{dap11},
			DAP12 = #{dap12},
			DAP21 = #{dap21},
			DAP22 = #{dap22},
			DAP31 = #{dap31},
			DAP32 = #{dap32},
			DAP41 = #{dap41},
			DAP42 = #{dap42},
			DAP51 = #{dap51},
			DAP52 = #{dap52},
			DAP61 = #{dap61},
			DAP62 = #{dap62},
			DAP71 = #{dap71},
			DAP72 = #{dap72},
			DAP81 = #{dap81},
			DAP82 = #{dap82},
			DAP91 = #{dap91},
			DAP92 = #{dap92},
			DAPA1 = #{dapa1},
			DAPA2 = #{dapa2},
			DAPB1 = #{dapb1},
			DAPB2 = #{dapb2},
			DAPC1 = #{dapc1},
			DAPC2 = #{dapc2}, 
			
			MAKQY = #{makqy},
			IMFDT = #{imfdt},
			CLHCT = #{clhct},
			UPTDT = #{uptdt},
			UPDAT = #{updat},
			CLPQ1 = #{clpq1},
			CLDQ1 = #{cldq1},
			CLLQ1 = #{cllq1}
			
        where 
                'SqlMap-OrderDaySaleCreate.updateSPD142PF' = 'SqlMap-OrderDaySaleCreate.updateSPD142PF'
            AND COMPS = #{comps}
            and PYVND = #{pyvnd}
            and PSPNO = #{pspno}
            and MKPNO = #{mkpno}
    </update>
    
    <update id="updateSPD142PF_2" parameterType="OrderDaySaleCreateDomain2">
        update 
                PSZDBLIB.SPD142PF 
        set
            SUJQ0 = #{sujq0},
			SUJQ1 = #{sujq1},
			SUJQ2 = #{sujq2},
			SUJQ3 = #{sujq3},
			SUJQ4 = #{sujq4},
			SUJQ5 = #{sujq5},
			SUJQ6 = #{sujq6},
			SUJQ7 = #{sujq7},
			SUJQ8 = #{sujq8},
			SUJQ9 = #{sujq9},
			SUJQA = #{sujqa},
			SUJQB = #{sujqb},
			SUJQC = #{sujqc}
 
        where 
                'SqlMap-OrderDaySaleCreate.updateSPD142PF_2' = 'SqlMap-OrderDaySaleCreate.updateSPD142PF_2'
			AND COMPS = #{comps}
            and PYVND = #{pyvnd}
            and PSPNO = #{pspno}
            and MKPNO = #{mkpno}
    </update>
    
    <select id="selectSAL100PF" resultMap="OrderCalendar" parameterType="NonOrderHostUpDomain">
		select
	    	COMPS,PYVND,MAKDT,MAKMK,MLTCD,
	    	CLHCD 
		from ${lib2}.SAL100PF 
		where 
			'SqlMap-OrderDaySaleCreate.selectSAL100PF' = 'SqlMap-OrderDaySaleCreate.selectSAL100PF'
		and comps = #{comps} 
		and pyvnd = #{pyvnd}  
		and MAKDT >= #{plndt} 
		and makmk not in ('H','S') 
		order by makdt asc  
		FETCH FIRST ${rows} ROWS ONLY 
    </select>
    
    <insert id="insertSVZ600PF_2" parameterType ="NonOrderHostUpDomain">
    	/* SqlMap-OrderDaySaleCreate.insertSVZ600PF_2 */
		INSERT INTO 
			PSZDBLIB.SVZ600PF
			(COMPS,TYPCD,PYVND,SHPTO,PSPNO,	
			PLNDT,BASQY,CHGDT,INPID,INPDT,	
			INPTM,CHPID,CHPDT,CHGTM,PLNCD
			)
		VALUES
			(
			#{comps},#{typcd},#{pyvnd},#{shpto},#{pspno},
			#{plndt},CAST(#{basqy} AS INTEGER),
			substr(trim(char(date(current date), ISO)),1,4) || substr(trim(char(date(current date), ISO)),6,2) || substr(trim(char(date(current date), ISO)),9,2)
			,#{inpid},substr(trim(char(date(current date), ISO)),1,4) || substr(trim(char(date(current date), ISO)),6,2) || substr(trim(char(date(current date), ISO)),9,2),
			substr(trim(char(time(current time), ISO)),1,2) || substr(trim(char(time(current time), ISO)),4,2) || substr(trim(char(time(current time), ISO)),7,2)
			,#{chpid},0,0,#{plncd}
			)
    </insert>

    <select id="selectSHK210PF" resultMap="OrderDaySaleCreate" parameterType="OrderHostUpDomain">
		select
			PYVND,PSPNO,DMKCR,DSECD,DSENO,
			DFACD,DEFFR,DEFTO,DUMCB,TRIMD,
			PBSQY,PATQY,WBSQY,DAT00,DAT01,
			DAT02,DAT03,DAT04,DAT05,DAT06,
			DAT07,DAT08,DAT09,DAT10,DAT11,
			DAT12,REMQY,OKQTY,MITQY,PRSEQ,
			MIQQY,MIOQY,GRTOT,COMPS
		from PSZDBLIB.SHK210PF
		where 
			'SqlMap-OrderDaySaleCreate.selectSHK210PF' = 'SqlMap-OrderDaySaleCreate.selectSHK210PF'
		and comps = #{comps} 
		and pyvnd = #{pyvnd} 
    </select>
    
    <select id="getPlnM" resultMap="OrderDaySaleCreate" parameterType="OrderDaySaleCreateDomain">
		
		SELECT
		A.COMPS AS COMPS,  A.PYVND AS PYVND, A.PRDCD,  A.PSPNO,  
		SUM(CASE WHEN 1=1 THEN A.SM0QY ELSE A.SL0QY END) AS PQTYM,
		SUM(CASE WHEN 1=1 THEN A.SM0QY*A.PCOST ELSE A.SL0QY*A.PCOST END) AS PCOSTM
		FROM ${lib2}.SPM110PF A
		WHERE
		A.PLNYM = #{baseym} --계획년월
		AND A.COMPS IN (#{comps}) --C1:창원, S1:화성, H1:홍성
		AND A.PSPNO = #{pspno}
		--AND A.PLTCD IN ('C1') --C1:창원, S1:화성, H1:홍성, A1:마산 
		GROUP BY A.COMPS, A.PYVND, A.PRDCD, A.PSPNO
    </select>

    <select id="getWorkDays" resultMap="OrderDaySaleCreate" parameterType="OrderDaySaleCreateDomain">
		select
			COMPS,PYVND,MAKDT,MAKMK,MLTCD,CLHCD 
		from ${lib2}.SAL100PF 
		where 
			'SqlMap-OrderDaySaleCreate.selectSAL100PF' = 'SqlMap-OrderDaySaleCreate.selectSAL100PF'
			and comps = #{comps}
			and pyvnd = #{pyvnd} 
			and MAKDT > #{daseymd} --마지막 날짜(년월일)
			and SUBSTR(MAKDT,1,6) = #{daseym} --마지막 날짜(년월)
			and makmk not in ('H','S') 
		order by makdt asc  
    </select>
</mapper>