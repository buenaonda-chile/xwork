package com.denso.pssallib;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.HashMap;
import java.sql.SQLException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.ui.ModelMap;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.multiaction.MultiActionController;

import com.denso.common.converter.DataConverter;
import com.denso.common.converter.MiPlatformView;
import com.denso.common.dao.CommonDAO;
import com.tobesoft.platform.PlatformRequest;
import com.tobesoft.platform.data.Dataset;
import com.tobesoft.platform.data.DatasetList;

public class PssallibController extends MultiActionController {
	
	CommonDAO dao = CommonDAO.getInstance(1);	

	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @exception 
	 * 	- request로 입력받은 데이터셋명을 파리미터에 따라 변경하여 데이터셋명을 리턴한다.
	 * @see
	 * 	- 2010-11-26	:	황규철
	***********************************************************************/ 	
	public void selectSPME114Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME114Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME114Q", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME114QD1(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME114QD1", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME114QD1", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME114QD2(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME114QD2", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME114QD2", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME114QD3(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME114QD3", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME114QD3", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME116Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME116Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME116Q", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME116QD1(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME116QD1", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME116QD1", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME116QD2(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME116QD2", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME116QD2", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME116QD3(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME116QD3", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME116QD3", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void selectSPME118Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME118Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME118Q", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME118QD1(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME118QD1", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME118QD1", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME118QD2(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME118QD2", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME118QD2", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPME118QD3(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME118QD3", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME118QD3", list);
		new MiPlatformView().render(map, request, response);
	}	
	public void selectSPMC117Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMC117Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMC117Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMC117QD_1(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMC117QD_1", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMC117QD_1", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMC117QD_2(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMC117QD_2", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMC117QD_2", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMC117QD_3(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMC117QD_3", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMC117QD_3", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYC900Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC900Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC900Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYC900QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC900QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC900QD", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPYC902Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC902Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC902Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYC902QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC902QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC902QD", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPYC904Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC904Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC904Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYC904QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC904QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC904QD", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void selectSPYC906Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC906Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC906Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYC906QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC906QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC906QD", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void selectSPYC908Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC908Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC908Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYC908QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC908QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC908QD", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void selectSPYC910Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC910Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC910Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYC910QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC910QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC910QD", list);
		new MiPlatformView().render(map, request, response);
	}	
	public void ProcCVTSPY200C(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);

		dao.updateData("pssallib.ProcCVTSPY200C", pData);
			
		System.out.println(pData);
		new MiPlatformView().render(null, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/중복차종서열코드 마스터
	 * @exception 
	 * @see 
	 * 	- 2012-05-14	:	제환복
	***********************************************************************/

	public void selectSPrtno_pop(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPrtno_pop", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_sPrt_pop", list);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/중복차종서열코드 마스터
	 * @exception 
	 * @see 
	 * 	- 2012-05-14	:	제환복
	***********************************************************************/
	
	public void selectSvze080(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSvze080", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE080", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/중복차종서열코드 마스터 저장
	 * @exception 
	 * @see
	 * 	- 2012-05-16	:	제환복
	***********************************************************************/ 		
	@SuppressWarnings("unchecked")
	public void svze080Save(HttpServletRequest request, HttpServletResponse response) throws Exception {				
		PlatformRequest pReq = new PlatformRequest(request);			
		pReq.receiveData();			
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVZE080");			
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyMCRC="";
		String emptyMSEC="";
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVZE080");
		//////////////////////////////////////////////////////////////			
		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyMCRC = (String) pData.get("MCRC1");
			emptyMSEC = (String) pData.get("MSEC1");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyMCRC != "" && emptyMSEC !="") {				
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSvze080_chk",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MCRC1", pData.get("MCRC1"));
							errMap.put("MSEC1", pData.get("MSEC1"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSvze080", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyMCRC = (String) pData.get("MCRC1");
			emptyMSEC = (String) pData.get("MSEC1");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyMCRC != "" && emptyMSEC !="") {
				if ("insert".equals(rowType)) {					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSvze080_chk",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("MCRC1", pData.get("MCRC1"));
							errMap.put("MSEC1", pData.get("MSEC1"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt3 = (Map)dao.getReadData("pssallib.selectSVZE080_SVM100CHK",pData);
							if(CheckCnt3!=null && CheckCnt3.get("CNT")!=null && !CheckCnt3.get("CNT").equals("")){
								if(CheckCnt3.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("MCRC1", pData.get("MCRC1"));
									errMap.put("MSEC1", pData.get("MSEC1"));
									errMap.put("RTMSG", "추가불가(업체서열차종마스터에 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.insertData("pssallib.insertSvze080", pData);
								}
							}
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_MCRC1", ds.getOrgBuffColumn(0, "MCRC1").getString());
					pData.put("OLD_MSEC1", ds.getOrgBuffColumn(0, "MSEC1").getString());
					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSvze080_chk2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MCRC1", pData.get("OLD_MCRC1"));
							errMap.put("MSEC1", pData.get("OLD_MSEC1"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSvze080_chk",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("MCRC1", pData.get("MCRC1"));
									errMap.put("MSEC1", pData.get("MSEC1"));
									errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									Map CheckCnt3 = (Map)dao.getReadData("pssallib.selectSVZE080_SVM100CHK",pData);
									if(CheckCnt3!=null && CheckCnt3.get("CNT")!=null && !CheckCnt3.get("CNT").equals("")){
										if(CheckCnt3.get("CNT").equals(1)){
											//update 불가(대상이 없음)
											HashMap errMap = new HashMap();
											errMap.put("MCRC1", pData.get("MCRC1"));
											errMap.put("MSEC1", pData.get("MSEC1"));
											errMap.put("RTMSG", "추가불가(업체서열차종마스터에 등록된 자료입니다.)");
											errList.add(errMap);
										}else{
											dao.updateData("pssallib.updateSvze080", pData);
										}
									}									
								}
							}
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SVZE080_CHK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}		
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/업체서열차종 마스타 조회
	 * @exception 
	 * @see 
	 * 	- 2012-05-14	:	제환복
	***********************************************************************/
	
	public void selectSvme100(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSvme100", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_svme100", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSvme100_Check1(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSvme100_chk1", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_svze080", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/업체서열차종 마스터 저장
	 * @exception 
	 * @see
	 * 	- 2012-05-19	:	제환복
	***********************************************************************/ 		
	public void svme100Save(HttpServletRequest request, HttpServletResponse response) throws Exception {
		/*CommonDAO dao = CommonDAO.getInstance(1);*/
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List errList = new ArrayList();// error check list
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_svme100");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		String Scomps = (String)pArg.get("COMPS");
		String Slib2 = (String)pArg.get("LIB2");
		String Susrid = (String)pArg.get("USERID");
		String emptySEQCD="";
		String oldSEQCD="";
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType = "";
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_svme100");
		//////////////////////////////////////////////////////////////		
		int bufCnt=0;
		int bufSize=0;	//orginal dataset buffer size
			bufSize=ds.getRowCount();
			System.out.println("originalIndex 확인=="+bufSize);//syso
			
		dao.startTransaction(); //tr 시작
		while (it_d.hasNext()) {
			Map pData = (Map) it_d.next();
			pData.put("SCOMPS", Scomps);
			pData.put("LIB2", Slib2);
			emptySEQCD = (String) pData.get("SEQCD");
			rowType = (String) pData.get("ROW_TYPE");
			if ("delete".equals(rowType) && emptySEQCD != "") {
				System.out.println(rowType);
				System.out.println("emptySEQCD"+emptySEQCD+"=");
				System.out.println("oldSEQCD"+oldSEQCD+"=");				
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSvme100_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(0)){
						//삭제불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND"));
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
					dao.deleteData("pssallib.deleteSvme100", pData);
					HashMap SVME200Map = new HashMap();
					SVME200Map.put("COMPS_200", pData.get("SCOMPS"));
					SVME200Map.put("PYVND_200", pData.get("PYVND"));
					SVME200Map.put("PSPNO_200", pData.get("PSPNO"));
					SVME200Map.put("GUBCD_200", "D");
					SVME200Map.put("SEQNO1_200", pData.get("SEQNO"));
					SVME200Map.put("SEQCD1_200", pData.get("SEQCD"));
					SVME200Map.put("MCRCD1_200", pData.get("MCRCD"));
					SVME200Map.put("EFFFR1_200", pData.get("EFFFR"));
					SVME200Map.put("EFFTO1_200", pData.get("EFFTO"));
					SVME200Map.put("SEQNO2_200", "");
					SVME200Map.put("SEQCD2_200", "");
					SVME200Map.put("MCRCD2_200", "");
					SVME200Map.put("EFFFR2_200", "0");
					SVME200Map.put("EFFTO2_200", "0");
					SVME200Map.put("USRID2_200", Susrid);
					dao.insertData("pssallib.insertSvme100_200", SVME200Map);
					}
				}
			}
		}
		bufCnt=0;
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("SCOMPS", Scomps);
			pData.put("LIB2", Slib2);
			pData.put("USRID", Susrid);
			emptySEQCD = (String) pData.get("SEQCD");
			oldSEQCD =ds.getOrgBuffColumn(bufCnt, "SEQCD").getString();
		
			if(bufCnt < bufSize){

			if ("update".equals(rowType) && emptySEQCD != "" && oldSEQCD!= null ) {

				System.out.println(rowType);
				System.out.println("emptySEQCD"+emptySEQCD+"=");
				System.out.println("oldSEQCD"+oldSEQCD+"=");
				
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSvme100_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(0)){
						//update불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND"));
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.(품번)");
						errList.add(errMap);
					}else{
						System.out.println("수정");
						Map CheckCnt3 = (Map)dao.getReadData("pssallib.selectSvme100_Check2",pData);
						if(CheckCnt3!=null && CheckCnt3.get("CNT")!=null && !CheckCnt3.get("CNT").equals("")){
							if(CheckCnt3.get("CNT").equals(0)){
								//update 불가(대상이 없음)
								HashMap errMap = new HashMap();
								errMap.put("PYVND", pData.get("PYVND"));
								errMap.put("PSPNO", pData.get("PSPNO"));
								errMap.put("RTMSG", "수정불가(차종/서열코드/번호가 미 등록된 자료입니다.)");
								errList.add(errMap);
							}else{
								dao.updateData("pssallib.updateSvme100", pData);
								HashMap SVME200Map = new HashMap();
								SVME200Map.put("COMPS_200", pData.get("SCOMPS"));
								SVME200Map.put("PYVND_200", pData.get("PYVND"));
								SVME200Map.put("PSPNO_200", pData.get("PSPNO"));
								SVME200Map.put("GUBCD_200", "C");
								SVME200Map.put("SEQNO1_200", ds.getOrgBuffColumn(bufCnt, "SEQNO").getString());
								SVME200Map.put("SEQCD1_200", ds.getOrgBuffColumn(bufCnt, "SEQCD").getString());
								SVME200Map.put("MCRCD1_200", ds.getOrgBuffColumn(bufCnt, "MCRCD").getString());
								SVME200Map.put("EFFFR1_200", ds.getOrgBuffColumn(bufCnt, "EFFFR").getString());
								SVME200Map.put("EFFTO1_200", ds.getOrgBuffColumn(bufCnt, "EFFTO").getString());
								SVME200Map.put("SEQNO2_200", pData.get("SEQNO"));
								SVME200Map.put("SEQCD2_200", pData.get("SEQCD"));
								SVME200Map.put("MCRCD2_200", pData.get("MCRCD"));
								SVME200Map.put("EFFFR2_200", pData.get("EFFFR"));
								SVME200Map.put("EFFTO2_200", pData.get("EFFTO"));
								SVME200Map.put("USRID2_200", Susrid);
								SVME200Map.put("LIB2", pData.get("LIB2"));
								dao.insertData("pssallib.insertSvme100_200", SVME200Map);
							}
						}
					}
				}
			}else if ("update".equals(rowType) && emptySEQCD != "" && oldSEQCD== null) {
				System.out.println("등록");
				System.out.println(rowType);
				System.out.println("emptySEQCD"+emptySEQCD+"=");
				System.out.println("oldSEQCD"+oldSEQCD+"=");

				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSvme100_Check",pData);
				System.out.println("1 insert");
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					System.out.println("2 insert");
					if(!(CheckCnt.get("CNT").equals(0))){
						System.out.println("3 insert");
						//insert불가(이미등록된 자료)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND"));
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("RTMSG", "등록불가(이미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						Map CheckCnt3 = (Map)dao.getReadData("pssallib.selectSvme100_Check2",pData);
						if(CheckCnt3!=null && CheckCnt3.get("CNT")!=null && !CheckCnt3.get("CNT").equals("")){
							if(CheckCnt3.get("CNT").equals(1)){
								//update 불가(대상이 없음)
								HashMap errMap = new HashMap();
								errMap.put("PYVND", pData.get("PYVND"));
								errMap.put("PSPNO", pData.get("PSPNO"));
								errMap.put("RTMSG", "등록불가(차종/서열코드/번호가 동일한 항목이 존재합니다.)");
								errList.add(errMap);
							}else{
								dao.insertData("pssallib.insertSvme100", pData);
								HashMap SVME200Map = new HashMap();
								SVME200Map.put("COMPS_200", pData.get("SCOMPS"));
								SVME200Map.put("PYVND_200", pData.get("PYVND"));
								SVME200Map.put("PSPNO_200", pData.get("PSPNO"));
								SVME200Map.put("GUBCD_200", "A");
								SVME200Map.put("SEQNO1_200", "");
								SVME200Map.put("SEQCD1_200", "");
								SVME200Map.put("MCRCD1_200", "");
								SVME200Map.put("EFFFR1_200", "0");
								SVME200Map.put("EFFTO1_200", "0");
								SVME200Map.put("SEQNO2_200", pData.get("SEQNO"));
								SVME200Map.put("SEQCD2_200", pData.get("SEQCD"));
								SVME200Map.put("MCRCD2_200", pData.get("MCRCD"));
								SVME200Map.put("EFFFR2_200", pData.get("EFFFR"));
								SVME200Map.put("EFFTO2_200", pData.get("EFFTO"));
								SVME200Map.put("USRID2_200", Susrid);
								SVME200Map.put("LIB2", pData.get("LIB2"));
							dao.insertData("pssallib.insertSvme100_200", SVME200Map);
							}
						}
					}
				}
			}
			}
			bufCnt++;
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_svme100_check", errList);//추가
		new MiPlatformView().render(map, request, response);
	}	
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/업체서열차종마스타차종별조회
	 * @exception 
	 * @see 
	 * 	- 2012-05-14	:	제환복
	***********************************************************************/
	
	public void selectSVME101Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVME101Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVME101", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/업체서열차종이력마스타 조회
	 * @exception 
	 * @see 
	 * 	- 2012-05-14	:	제환복
	***********************************************************************/
	
	public void selectSVME200Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVME200Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVME200", list);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/TRANSFER TICKET 인쇄       
	 * @exception 
	 * @see 
	 * 	- 2012-06-04	:	제환복
	***********************************************************************/
	
	public void selectSZZE101P(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE101P", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE101", list);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- MRP영업관리_마스터관리_제품 단가등록 확인서
	 * @exception 
	 * @see 
	 * 	- 2012-06-29	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSALE154R(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALE154R", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALE154", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- MRP영업관리_마스터관리_제품가단가 관리 현황 
	 * @exception 
	 * @see 
	 * 	- 2012-07-09	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSALE156Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALE156Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALE156", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/월업체별차종별개발비상각 현황
	 * @exception 
	 * @see 
	 * 	- 2012-04-26	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSVZE511Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE511Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE511", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/득의선 품목관리 마스타 현황
	 * @exception 
	 * @see 
	 * 	- 2012-04-26	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSOMC012Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSOMC012Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SOMC012", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 마스타관리/ 차종_규격코드 조회
	 * @exception 
	 * @see 
	 * 	- 2012-06-04	:	제환복
	***********************************************************************/
	
	public void selectSALZ051Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALZ051Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALZ051", list);
		new MiPlatformView().render(map, request, response);
	}

	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/업체품번별제품조회－구MRP
	 * @exception 
	 * @see 
	 * 	- 2012-04-26	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSzae101(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSzae101", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZAE101", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/품번별제품마스타조회－구MRP
	 * @exception 
	 * @see 
	 * 	- 2012-04-26	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSzae103(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSzae103", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZAE103", list);
		new MiPlatformView().render(map, request, response);
	}
	@SuppressWarnings("unchecked")
	public void selectSZAE102Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZAE102Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZAE102", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/업체차종 상각마스타
	 * @exception 
	 * @see 
	 * 	- 2012-04-26	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSVZE500(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE500", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE500", list);
		new MiPlatformView().render(map, request, response);
	}
	
	@SuppressWarnings("unchecked")
	public void selectMST050_MRP(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectMST050_MRP", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_MST050", list);
		new MiPlatformView().render(map, request, response);
	}
	@SuppressWarnings("unchecked")
	public void selectMST100_MRP(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectMST100_MRP", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_MST100", list);
		new MiPlatformView().render(map, request, response);
	}	
	public void insertSVZE500(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVZE500");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPN="";

		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVZE500");
		//////////////////////////////////////////////////////////////	
		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPN = (String) pData.get("CARCD");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE500_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("CARCD", pData.get("CARCD"));
							errMap.put("BDYCD", pData.get("BDYCD"));
							errMap.put("SGGUB", pData.get("SGGUB"));
							errMap.put("MPDAT", pData.get("MPDAT"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							System.out.println("없음");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSVZE500", pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPN = (String) pData.get("CARCD");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE500_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("CARCD", pData.get("CARCD"));
							errMap.put("BDYCD", pData.get("BDYCD"));
							errMap.put("SGGUB", pData.get("SGGUB"));
							errMap.put("MPDAT", pData.get("MPDAT"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSVZE500", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_CARCD", ds.getOrgBuffColumn(0, "CARCD").getString());
					pData.put("OLD_BDYCD", ds.getOrgBuffColumn(0, "BDYCD").getString());
					pData.put("OLD_SGGUB", ds.getOrgBuffColumn(0, "SGGUB").getString());
					pData.put("OLD_MPDAT", ds.getOrgBuffColumn(0, "MPDAT").getString());
					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE500_Check2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("CARCD", pData.get("OLD_CARCD"));
							errMap.put("BDYCD", pData.get("OLD_BDYCD"));
							errMap.put("SGGUB", pData.get("OLD_SGGUB"));
							errMap.put("MPDAT", pData.get("OLD_MPDAT"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSVZE500_Check",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("CARCD", pData.get("CARCD"));
									errMap.put("BDYCD", pData.get("BDYCD"));
									errMap.put("SGGUB", pData.get("SGGUB"));
									errMap.put("MPDAT", pData.get("MPDAT"));
									errMap.put("RTMSG", "수정불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.updateData("pssallib.updateSVZE500", pData);			
								}
							}							
						}
					}
				}
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SVZE500_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/대표업체차종코드 마스타
	 * @exception 
	 * @see 
	 * 	- 2012-07-27	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSVZE505(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE505", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE505", list);
		new MiPlatformView().render(map, request, response);
	}

	public void insertSVZE505(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVZE505");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPN="";
		String SCOMPS="";
		String SPYVND="";

		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVZE505");
		//////////////////////////////////////////////////////////////	
		
		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("SCOMPS", (String)pArg.get("SCOMPS"));
			pData.put("SPYVND", (String)pArg.get("SPYVND"));
			pData.put("SCARCD", (String)pArg.get("SCARCD"));
			pData.put("SBDYCD", (String)pArg.get("SBDYCD"));
			emptyPN = (String) pData.get("COMPS2");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE505_Check1",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("COMPS2", pData.get("COMPS2"));
							errMap.put("PYVND", pData.get("PYVND2"));
							errMap.put("CARCD", pData.get("CARCD2"));
							errMap.put("BDYCD", pData.get("BDYCD2"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							System.out.println("없음");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSVZE505", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPN = (String) pData.get("COMPS2");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE505_Check1",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("COMPS2", pData.get("COMPS2"));
							errMap.put("PYVND", pData.get("PYVND2"));
							errMap.put("CARCD", pData.get("CARCD2"));
							errMap.put("BDYCD", pData.get("BDYCD2"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSVZE505", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_COMPS2", ds.getOrgBuffColumn(0, "COMPS2").getString());
					pData.put("OLD_PYVND2", ds.getOrgBuffColumn(0, "PYVND2").getString());
					pData.put("OLD_CARCD2", ds.getOrgBuffColumn(0, "CARCD2").getString());
					pData.put("OLD_BDYCD2", ds.getOrgBuffColumn(0, "BDYCD2").getString());
					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE505_Check2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("COMPS2", pData.get("OLD_COMPS2"));
							errMap.put("PYVND", pData.get("OLD_PYVND2"));
							errMap.put("CARCD", pData.get("OLD_CARCD2"));
							errMap.put("BDYCD", pData.get("OLD_BDYCD2"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSVZE505_Check1",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("COMPS2", pData.get("COMPS2"));
									errMap.put("PYVND", pData.get("PYVND2"));
									errMap.put("CARCD", pData.get("SCARCD"));
									errMap.put("BDYCD", pData.get("SBDYCD"));
									errMap.put("RTMSG", "수정불가(이미등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.updateData("pssallib.updateSVZE505", pData);
								}
							}
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SVZE505_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/득의선달력마스타수정
	 * @exception 
	 * @see 
	 * 	- 2012-08-07	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSALZ100(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALZ100", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALZ100", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSAL100_MST(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSAL100_MST", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SAL100MST", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void insertSALZ100(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SALZ100_INPUT");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPN="";
		String SCOMPS="";
		String SPYVND="";

		dao.startTransaction(); //tr 시작		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("SCOMPS", (String)pArg.get("SCOMPS"));
			pData.put("SPYVND", (String)pArg.get("SPYVND"));
			rowType = (String) pData.get("ROW_TYPE");
			if ("insert".equals(rowType)) {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALZ100_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(0)){
						//update 불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND2"));
						errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.updateData("pssallib.updateSALZ100", pData);
					}
				}			
			}     
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SALZ100_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/득의선 출하구분 등록
	 * @exception 
	 * @see 
	 * 	- 2012-08-09	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSALZ101(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALZ101", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALZ101", list);
		new MiPlatformView().render(map, request, response);
	}

	public void saveSALZ101(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SALZ101");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPN="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPN = (String) pData.get("MAKDT");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALZ101_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MAKDT", pData.get("MAKDT"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSALZ101", pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPN = (String) pData.get("MAKDT");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALZ101_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 없음)
							HashMap errMap = new HashMap();							
							errMap.put("MAKDT", pData.get("MAKDT"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSALZ101", pData);
						}
					}

				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALZ101_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MAKDT", pData.get("MAKDT"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSALZ101", pData);
						}
					}
				}
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SALZ101_CHECK", errList);//추가
		new MiPlatformView().render(map, request, response);
	}

	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/제품차종코드등록
	 * @exception 
	 * @see 
	 * 	- 2012-08-09	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSOMC011(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq = new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSOMC011", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SOMC011", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSOMC010(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq = new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSOMC010", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SOMC010", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSOMC010(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SOMC010");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPN="";
		String SCOMPS="";
		String SPYVND="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2")); 
			pData.put("SUSER", (String)pArg.get("SUSER"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSOMC010_Check",pData);			
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("IORDT", pData.get("IORDT"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							System.out.println("없음");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSOMC010", pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("SUSER", (String)pArg.get("SUSER"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSOMC010_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 없음)
							HashMap errMap = new HashMap();							
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("IORDT", pData.get("IORDT"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSOMC010", pData);
							//pData.put("COMPS", (String)pArg.get("SCOMPS"));
							//pData.put("PRTNO", (String) pData.get("PSPNO"));
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectMST100PF",pData);
							Map CheckCnt3 = (Map)dao.getReadData("pssallib.selectBM008PR",pData);
							String mcarcd = (String) CheckCnt2.get("MCARCD");
							String itn = (String) CheckCnt2.get("ITN");
							String itc = (String) CheckCnt3.get("ITC");
							String sitc = "";
							if(itc.equals("D")||itc.equals("M")||itc.equals("N")||itc.equals("P")||itc.equals("W")){
								sitc="A";
							}
							else{
								sitc="D";
							}
							pData.put("ITN", itn);
							pData.put("ITC", sitc);							
//System.out.print("mcarcd===="+mcarcd);								
//System.out.print("ITN===="+itn);								
//System.out.print("ITC===="+itc);								
//System.out.print("ITS===="+sitc);								
							if(mcarcd == null || mcarcd.length()==0){	
//System.out.print("ok");
								dao.updateData("pssallib.updateMST100PF", pData);//INSERT인경우 MST100PF에서 PRTNO의 MSTCD를 추가함.
							}
							
							else{
//System.out.print("null");								
							}
							dao.updateData("pssallib.updateMST100PF_IT", pData);//ITN ='0'이면 QYEXT=Y아니면, N //(ITC='D' OR ITC='M' OR ITC='N' OR  ITC='P' OR ITC='W') 이면  MGMCD=A아니면 D 												
						}
					}
				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSOMC010_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("IORDT", pData.get("IORDT"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{					
							dao.updateData("pssallib.updateSOMC010", pData);

							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectMST100PF",pData);
							Map CheckCnt3 = (Map)dao.getReadData("pssallib.selectBM008PR",pData);
							String mcarcd = (String) CheckCnt2.get("MCARCD");
							String itn = (String) CheckCnt2.get("ITN");
							String itc = (String) CheckCnt3.get("ITC");
							String sitc = "";
							if(itc.equals("D")||itc.equals("M")||itc.equals("N")||itc.equals("P")||itc.equals("W")){
								sitc="A";
							}
							else{
								sitc="D";
							}
							pData.put("ITN", itn);
							pData.put("ITC", sitc);	
	
							dao.updateData("pssallib.updateMST100PF_IT", pData);//ITN ='0'이면 QYEXT=Y아니면, N //(ITC='D' OR ITC='M' OR ITC='N' OR  ITC='P' OR ITC='W') 이면  MGMCD=A아니면 D 												
						}
					}
				}
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SOMC010_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  마스터관리/제품단가마스타등록  풍성모터스
	 * @exception 
	 * @see 
	 * 	- 2012-08-17	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSALZ500(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq = new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALZ500", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALZ500", list);
		new MiPlatformView().render(map, request, response);
	}	

	public void selectSPYC201Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC201Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC201Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYE201Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYE201Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYE201Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYZ201(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYZ201", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYZ201", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSPYZ201(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SPYZ201insert");
		Map pMap = DataConverter.getMiPlatformData(pReq);
		dao.startTransaction(); //tr 시작		
		dao.deleteData("pssallib.deleteSPYZ201", pMap);
		Iterator it = pList.iterator();
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			dao.insertData("pssallib.insertSPYZ201", pData);
		}
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);	
	}
	public void selectSOMC300(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSOMC300", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SOMC300", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSOMC300(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SOMC300");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		dao.startTransaction(); //tr 시작		
		Iterator it = pList.iterator();
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMYM", (String)pArg.get("COMYM"));
			dao.deleteData("pssallib.deleteSOMC300", pData);
			dao.insertData("pssallib.insertSOMC300", pData);
		}
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);	
	}
	public void selectSPMC100C(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SEND");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it = pList.iterator();
		List errList = new ArrayList();
		String PN="";
		String PV="";
		while (it.hasNext()) {  
			Map pData = (Map) it.next();
			PN = (String) pData.get("PSPNO_1");
			PV = (String) pData.get("PYVND_1");
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("CUSNO", PV);
			pData.put("ITNBR", PN);
			/*
			HashMap errMap = new HashMap();
			errMap.put("PSPNO_R",PN);
			errMap.put("UPERR_R","0");  //정상
			*/
			
			Map CheckPspno = (Map)dao.getReadData("pscomlib.selectSAL001",pData);
			
			if(CheckPspno==null || CheckPspno.get("ITDSC")==null || CheckPspno.get("ITDSC").equals("")){
				HashMap errMap = new HashMap();
				errMap.put("COMPS_R",(String)pArg.get("COMPS"));
				errMap.put("PLNYM_R",(String)pArg.get("COMYM"));
				errMap.put("PYVND_R",PV);
				//SHPTO
				errMap.put("PLTCD_R","");
				errMap.put("PSPNO_R",PN);
				//PYSEQ
				errMap.put("PRDCD_R","");
				//SPTEX
				errMap.put("PFOTE_R","");
				errMap.put("PCOST_R","");
				errMap.put("SM0QY_R",(String) pData.get("M0QTY_1"));
				errMap.put("SM1QY_R",(String) pData.get("M1QTY_1"));
				errMap.put("SM2QY_R",(String) pData.get("M2QTY_1"));
				errMap.put("SM3QY_R",(String) pData.get("M3QTY_1"));
				errMap.put("SM4QY_R",(String) pData.get("M4QTY_1"));
				errMap.put("SM5QY_R",(String) pData.get("M5QTY_1"));
				errMap.put("SM6QY_R",(String) pData.get("M6QTY_1"));
				errMap.put("UPERR_R","1");  //품번미등록
				errList.add(errMap);
			}else{
				if(CheckPspno.get("CUSNM")==null || CheckPspno.get("CUSNM").equals("")){
					HashMap errMap = new HashMap();
					errMap.put("COMPS_R",(String)pArg.get("COMPS"));
					errMap.put("PLNYM_R",(String)pArg.get("COMYM"));
					errMap.put("PYVND_R",PV);
					//SHPTO
					errMap.put("PLTCD_R","");
					errMap.put("PSPNO_R",PN);
					//PYSEQ
					errMap.put("PRDCD_R","");
					//SPTEX
					errMap.put("PFOTE_R","");
					errMap.put("PCOST_R","");
					errMap.put("SM0QY_R",(String) pData.get("M0QTY_1"));
					errMap.put("SM1QY_R",(String) pData.get("M1QTY_1"));
					errMap.put("SM2QY_R",(String) pData.get("M2QTY_1"));
					errMap.put("SM3QY_R",(String) pData.get("M3QTY_1"));
					errMap.put("SM4QY_R",(String) pData.get("M4QTY_1"));
					errMap.put("SM5QY_R",(String) pData.get("M5QTY_1"));
					errMap.put("SM6QY_R",(String) pData.get("M6QTY_1"));
					errMap.put("UPERR_R","2");  //거래처미등록
					errList.add(errMap);
				}else if(CheckPspno.get("CPRTN")==null || CheckPspno.get("CPRTN").equals("")){
					HashMap errMap = new HashMap();
					errMap.put("COMPS_R",(String)pArg.get("COMPS"));
					errMap.put("PLNYM_R",(String)pArg.get("COMYM"));
					errMap.put("PYVND_R",PV);
					//SHPTO
					errMap.put("PLTCD_R","");
					errMap.put("PSPNO_R",PN);
					//PYSEQ
					errMap.put("PRDCD_R","");
					//SPTEX
					errMap.put("PFOTE_R","");
					errMap.put("PCOST_R","");
					errMap.put("SM0QY_R",(String) pData.get("M0QTY_1"));
					errMap.put("SM1QY_R",(String) pData.get("M1QTY_1"));
					errMap.put("SM2QY_R",(String) pData.get("M2QTY_1"));
					errMap.put("SM3QY_R",(String) pData.get("M3QTY_1"));
					errMap.put("SM4QY_R",(String) pData.get("M4QTY_1"));
					errMap.put("SM5QY_R",(String) pData.get("M5QTY_1"));
					errMap.put("SM6QY_R",(String) pData.get("M6QTY_1"));
					errMap.put("UPERR_R","3");  //oem품번미등록
					errList.add(errMap);
				}else if(CheckPspno.get("PRICE")==null || CheckPspno.get("PRICE").equals("")){
					HashMap errMap = new HashMap();
					errMap.put("COMPS_R",(String)pArg.get("COMPS"));
					errMap.put("PLNYM_R",(String)pArg.get("COMYM"));
					errMap.put("PYVND_R",PV);
					//SHPTO
					errMap.put("PLTCD_R","");
					errMap.put("PSPNO_R",PN);
					//PYSEQ
					errMap.put("PRDCD_R","");
					//SPTEX
					errMap.put("PFOTE_R","");
					errMap.put("PCOST_R","");
					errMap.put("SM0QY_R",(String) pData.get("M0QTY_1"));
					errMap.put("SM1QY_R",(String) pData.get("M1QTY_1"));
					errMap.put("SM2QY_R",(String) pData.get("M2QTY_1"));
					errMap.put("SM3QY_R",(String) pData.get("M3QTY_1"));
					errMap.put("SM4QY_R",(String) pData.get("M4QTY_1"));
					errMap.put("SM5QY_R",(String) pData.get("M5QTY_1"));
					errMap.put("SM6QY_R",(String) pData.get("M6QTY_1"));
					errMap.put("UPERR_R","4");  //단가 미등록
					errList.add(errMap);
				}else{
					String PCD = (String) CheckPspno.get("ITCLS");
					String PRDCD = PCD.substring(0,1);
					HashMap errMap = new HashMap();
					errMap.put("COMPS_R",(String)pArg.get("COMPS"));
					errMap.put("PLNYM_R",(String)pArg.get("COMYM"));
					errMap.put("PYVND_R",PV);
					//SHPTO
					errMap.put("PLTCD_R",CheckPspno.get("PACKC"));
					errMap.put("PSPNO_R",PN);
					//PYSEQ
					//errMap.put("PRDCD_R",CheckPspno.get("ITCLS"));
					errMap.put("PRDCD_R",PRDCD);
					//SPTEX
					errMap.put("PFOTE_R",CheckPspno.get("REASN"));
					errMap.put("PCOST_R",CheckPspno.get("PRICE"));
					errMap.put("SM0QY_R",(String) pData.get("M0QTY_1"));
					errMap.put("SM1QY_R",(String) pData.get("M1QTY_1"));
					errMap.put("SM2QY_R",(String) pData.get("M2QTY_1"));
					errMap.put("SM3QY_R",(String) pData.get("M3QTY_1"));
					errMap.put("SM4QY_R",(String) pData.get("M4QTY_1"));
					errMap.put("SM5QY_R",(String) pData.get("M5QTY_1"));
					errMap.put("SM6QY_R",(String) pData.get("M6QTY_1"));
					errMap.put("UPERR_R","0");  //정상
					errList.add(errMap);
				}
			}
			/*
			Map CheckPspno = (Map)dao.getReadData("pscomlib.selectBM008PR",pData);
			if(CheckPspno==null || CheckPspno.get("ITNBR")==null || CheckPspno.get("ITNBR").equals("")){
				HashMap errMap = new HashMap();
				errMap.put("PSPNO_R",PN);
				errMap.put("UPERR_R","1");  //품번미등록
				errList.add(errMap);
			}
			Map CheckMPspno = (Map)dao.getReadData("pscomlib.selectEM000PR",pData);
			if(CheckMPspno==null || CheckMPspno.get("PRTNO")==null || CheckMPspno.get("PRTNO").equals("")){
				HashMap errMap = new HashMap();
				errMap.put("PSPNO_R",PN);
				errMap.put("UPERR_R","2");  //oem품번미등록
				errList.add(errMap);
			}
			Map CheckPrice = (Map)dao.getReadData("pscomlib.selectEM001PR",pData);
			if(CheckPrice==null || CheckPrice.get("PRTNO")==null || CheckPrice.get("PRTNO").equals("")){
				HashMap errMap = new HashMap();
				errMap.put("PSPNO_R",PN);
				errMap.put("UPERR_R","3");  //단가 미등록
				errList.add(errMap);
			}
			*/
		}
		ModelMap map = new ModelMap();
		map.addAttribute("ds_RECEIVE", errList);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSPMC100C(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		Map pArg = DataConverter.getMiPlatformData(pReq);
		dao.startTransaction(); //tr 시작
		dao.deleteData("pssallib.deleteSPMC100C", pArg);
		dao.insertData("pssallib.insertSPMC100C", pArg);
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);	
	}
	public void insertSPMC100C1(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_RECEIVE");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it = pList.iterator();
		String ERR="";
		dao.startTransaction(); //tr 시작
		dao.deleteData("pssallib.deleteSPMC100C", pArg);
		Integer Seq = 0;
		while (it.hasNext()) {  
			Map pData = (Map) it.next();
			ERR = (String) pData.get("UPERR_R");
			if (ERR.equals("0")){
				Seq = Seq+1;
				pData.put("SEQ", Seq);
				pData.put("LIB2", (String)pArg.get("LIB2"));
				dao.insertData("pssallib.insertSPMC100C1", pData);
			}
		}
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);	
	}
	public void selectSPMZ100(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		//CommonDAO dao = CommonDAO.getInstance(1);
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		//dao.insertData("pssallib.tablelock", pData);
		List list = dao.getListData("pssallib.selectSPMZ100", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMZ100", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMZ100_SPTEX(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMZ100_SPTEX", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMZ100_SPTEX", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMZ100_BEFOR(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMZ100_BEFOR", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMZ100_BEFOR", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSPMZ100(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SPMZ100");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPN="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSPMZ100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							System.out.println("없음");
							errList.add(errMap);
						}else{
							try{
								dao.deleteData("pssallib.deleteSPMZ100", pData);
							}catch(SQLException  e ){
								ModelMap map = new ModelMap();
								map.addAttribute("SQLState", e.getSQLState());
								new MiPlatformView().render(map, request, response);
							}
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSPMZ100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							try{
								dao.insertData("pssallib.insertSPMZ100", pData);
							}catch(SQLException  e ){
								ModelMap map = new ModelMap();
								map.addAttribute("SQLState", e.getSQLState());
								new MiPlatformView().render(map, request, response);
							}
							
						}
					}
				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSPMZ100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							try{
								dao.updateData("pssallib.updateSPMZ100", pData);
							}catch(SQLException  e ){
								ModelMap map = new ModelMap();
								map.addAttribute("SQLState", e.getSQLState());
								new MiPlatformView().render(map, request, response);
							}
							
						}
					}
				}
			}
		}
		System.out.println("1endTransaction------------");
		dao.endTransaction(); //commit

		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SPMZ100_CHECK", errList);//추가
		System.out.println("eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee");
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPMC101Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMC101Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMC101Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPME101Q_1(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME101Q_1", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME101Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPME101Q_2(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME101Q_2", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME101Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMC111Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMC111Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMC111Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPME111Q_1(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME111Q_1", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME111Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPME111Q_2(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME111Q_2", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME111Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void procSPMZ109C(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pArg = DataConverter.getMiPlatformData(pReq);
		System.out.println(pArg);
		dao.updateData("pssallib.procSPMZ109C", pArg);
		System.out.println(pArg);
		String rtncd = (String) pArg.get("ERRCD");
		ModelMap map = new ModelMap();
		map.addAttribute("rtnCode", ""+rtncd);
		System.out.println(map);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMZ030(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMZ030", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMZ030", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSPMZ030(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SPMZ030");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPV="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPV = (String) pData.get("PYVND");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPV != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSPMZ030_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PYVND", pData.get("PYVND"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSPMZ030", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPV = (String) pData.get("PYVND");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPV != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSPMZ030_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(이미등록된 자료)
							HashMap errMap = new HashMap();
							errMap.put("PYVND", pData.get("PYVND"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSPMZ030", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSPMZ030_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PYVND", pData.get("PYVND"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSPMZ030", pData);
						}
					}
				}
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SPMZ030_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMZ149Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMZ149Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMZ149Q", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSPMZ158Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMZ158Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMZ158Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPYC912Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPYC912Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPYC912Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMC128Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMC128Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMC128Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPMC128QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPMC128QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPMC128QD", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPME128Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		//List list = dao.getListData("pssallib.selectSPME128Q", pData);				
		String SEL ="";
		SEL =(String) pData.get("SQL_GUB");
		List list = null;
		if(SEL.equals("D")){
			list = dao.getListData("pssallib.selectSPME128Q_A", pData);
		}else if(SEL.equals("P")){	//제품인경우
			list = dao.getListData("pssallib.selectSPME128Q_B", pData);		
		}
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME128Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSPME131Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPME131Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPME131Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ010(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSLTZ010", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ010", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSLTZ010(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SLTZ010");
		Map pArg = DataConverter.getMiPlatformData(pReq);

		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String empty="";

		dao.startTransaction(); //tr 시작	

		if (pList.isEmpty()) {			//저장할 내역이 없음
			HashMap errMap = new HashMap();
			errMap.put("MKLOC", "");
			errMap.put("RTMSG", " [경고] 저장할 내역이 없습니다.");
			errList.add(errMap);
		}
		int scount=0;
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty = (String) pData.get("MKLOC");
			rowType = (String) pData.get("ROW_TYPE");
			if (empty != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ010_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKLOC", pData.get("MKLOC"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSLTZ010", pData);
							scount= scount+1;
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty = (String) pData.get("MKLOC");
			rowType = (String) pData.get("ROW_TYPE");
			if (empty != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ010_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(이미등록된 자료)
							HashMap errMap = new HashMap();
							errMap.put("MKLOC", pData.get("MKLOC"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSLTZ010", pData);
							scount= scount+1;
						}
					}
				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ010_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKLOC", pData.get("MKLOC"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSLTZ010", pData);
							scount= scount+1;
						}
					}
				}
			}
		}
		dao.endTransaction(); //commit
		if(scount == 0){
			HashMap errMap = new HashMap();
			errMap.put("MKLOC", "");
			errMap.put("RTMSG", " [경고] 저장할 내역이 없습니다.");
			errList.add(errMap);
		}
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SLTZ010_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ020(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSLTZ020", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ020", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSLTZ020(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SLTZ020");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String empty1="";
		String empty2="";
		String empty3="";
		String empty4="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("MKLOC");
			empty2 = (String) pData.get("CARTN");
			empty3 = (String) pData.get("USEGB");
			empty4 = (String) pData.get("TRNCD");
			rowType = (String) pData.get("ROW_TYPE");
			if (empty1 != "" || empty2 != "" || empty3 != "" || empty4 != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ020_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKLOC", pData.get("MKLOC"));
							errMap.put("CARTN", pData.get("CARTN"));
							errMap.put("USEGB", pData.get("USEGB"));
							errMap.put("TRNCD", pData.get("TRNCD"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSLTZ020", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("MKLOC");
			empty2 = (String) pData.get("CARTN");
			empty3 = (String) pData.get("USEGB");
			empty4 = (String) pData.get("TRNCD");
			rowType = (String) pData.get("ROW_TYPE");
			if (empty1 != "" || empty2 != "" || empty3 != "" || empty4 != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ020_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(이미등록된 자료)
							HashMap errMap = new HashMap();
							errMap.put("MKLOC", pData.get("MKLOC"));
							errMap.put("CARTN", pData.get("CARTN"));
							errMap.put("USEGB", pData.get("USEGB"));
							errMap.put("TRNCD", pData.get("TRNCD"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSLTZ020", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ020_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKLOC", pData.get("MKLOC"));
							errMap.put("CARTN", pData.get("CARTN"));
							errMap.put("USEGB", pData.get("USEGB"));
							errMap.put("TRNCD", pData.get("TRNCD"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSLTZ020", pData);
						}
					}
				}
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SLTZ020_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSALZ150Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALZ150Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALZ150Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ100(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list1 = dao.getListData("pssallib.selectSLTZ100", pData);
		List list2 = dao.getListData("pssallib.selectSLTZ100_A", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ100", list1);
		map.addAttribute("ds_SLTZ100_A", list2);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSLTZ100(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SLTZ100");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();// error check list
		List lntnoList = new ArrayList();// insert시 lntno번호 넘겨주기
		Iterator it = pList.iterator();
		//Iterator it_iu = pList.iterator();
		String p_lntno="";
		String rowType="";
		String empty1="";
		String empty2="";
		String empty3="";
		int maxLNTNO;

		dao.startTransaction(); //tr 시작		
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			p_lntno = (String)pArg.get("LNTNO");
			rowType = (String) pData.get("ROW_TYPE");
			if ("insert".equals(rowType)) {
				pData.put("MAJCD", "LNTNO");
				Map MaxMapLNTNO = (Map)dao.getReadData("pscomlib.selectMST040PF",pData);
				//System.out.println(MaxMapLNTNO.get("MJINT")+" 11111");
				maxLNTNO = Integer.parseInt(MaxMapLNTNO.get("MJINT").toString()) + 1;
				
				System.out.println(maxLNTNO);
				
				pData.put("LNTNO", maxLNTNO);
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ100_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(1)){
						//insert 불가(이미등록된 자료)
						HashMap errMap = new HashMap();
						errMap.put("LNTNO", maxLNTNO);
						errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.insertData("pssallib.insertSLTZ100", pData);
						HashMap lntnoMap = new HashMap();
						lntnoMap.put("LNTNO", maxLNTNO);
						lntnoList.add(lntnoMap);
					}
				}
			} 
			if (p_lntno != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("LNTNO", p_lntno);
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSLTZ100", pData);
						}
					}
				}else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("LNTNO", p_lntno);
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSLTZ100", pData);
						}
					}
				}
			}
		}
		
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SLTZ100_CHECK", errList);//추가
		map.addAttribute("ds_SLTZ100_LNTNO", lntnoList);//
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSLTZ100_110(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		Map pArg = DataConverter.getMiPlatformData(pReq);
		dao.startTransaction(); //tr 시작	
		dao.deleteData("pssallib.deleteSLTZ100_110", pArg);
		String p_jpsno="";
		p_jpsno = (String)pArg.get("JPSNO1");
		System.out.println(p_jpsno);
		//if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
		if (p_jpsno != null && pArg.get("JPSNO1") != null && !pArg.get("JPSNO1").equals("")) {
			dao.insertData("pssallib.insertSLTZ100_110", pArg);
		}
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);
	}
	public void selectSLTZ100_BOX1(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSLTZ100_BOX1", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ100D_BOX", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ113R(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSLTZ113R", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ113R", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ101(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list1 = dao.getListData("pssallib.selectSLTZ101", pData);
		//List list2 = dao.getListData("pssallib.selectSLTZ101_A", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ101", list1);
		//map.addAttribute("ds_SLTZ101_A", list2);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ101_A(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		//List list1 = dao.getListData("pssallib.selectSLTZ101", pData);
		List list2 = dao.getListData("pssallib.selectSLTZ101_A", pData);
		ModelMap map = new ModelMap();
		//map.addAttribute("ds_SLTZ101", list1);
		map.addAttribute("ds_SLTZ101_A", list2);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSLTZ101(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		//List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SLTZ101");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();// error check list
		//Iterator it = pList.iterator();
		String p_lntno="";
		String p_jpsnob1="";
		String p_jpsnob2="";
		String p_jpsnob3="";
		String p_jpsnob4="";
		String p_jpsnob5="";
		String p_jpsnob6="";
		String p_jpsnob7="";
		String rowType="";

		p_lntno = (String) pArg.get("LNTNO");
		p_jpsnob1 = (String) pArg.get("JPSNOB1");
		p_jpsnob2 = (String) pArg.get("JPSNOB2");
		p_jpsnob3 = (String) pArg.get("JPSNOB3");
		p_jpsnob4 = (String) pArg.get("JPSNOB4");
		p_jpsnob5 = (String) pArg.get("JPSNOB5");
		p_jpsnob6 = (String) pArg.get("JPSNOB6");
		p_jpsnob7 = (String) pArg.get("JPSNOB7");
		System.out.println(p_jpsnob1.length());
		System.out.println(p_jpsnob2.length());
		System.out.println(p_jpsnob3.length());
		System.out.println(p_jpsnob4.length());
		System.out.println(p_jpsnob5.length());
		System.out.println(p_jpsnob6.length());
		System.out.println(p_jpsnob7.length());
		dao.startTransaction(); //tr 시작
		Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ100_Check",pArg);
		if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
			if(CheckCnt.get("CNT").equals(0)){
				//update 불가(대상이 없음)
				HashMap errMap = new HashMap();
				errMap.put("LNTNO", p_lntno);
				errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
				errList.add(errMap);
			}else{
				dao.updateData("pssallib.updateSLTZ101", pArg);
				dao.deleteData("pssallib.deleteSLTZ101_110", pArg);
				if(p_jpsnob1.length() != 0){
					pArg.put("JPSNO", p_jpsnob1);
					pArg.put("BOXQY", (String) pArg.get("BOXQYB1"));
					pArg.put("INOUTB",(String) pArg.get("INOUTB1"));
					dao.insertData("pssallib.insertSLTZ101_110", pArg);
				}
				if(p_jpsnob2.length() != 0){
					pArg.put("JPSNO", p_jpsnob2);
					pArg.put("BOXQY", (String) pArg.get("BOXQYB2"));
					pArg.put("INOUTB",(String) pArg.get("INOUTB2"));
					dao.insertData("pssallib.insertSLTZ101_110", pArg);
				}
				if(p_jpsnob3.length() != 0){
					pArg.put("JPSNO", p_jpsnob3);
					pArg.put("BOXQY", (String) pArg.get("BOXQYB3"));
					pArg.put("INOUTB",(String) pArg.get("INOUTB3"));
					dao.insertData("pssallib.insertSLTZ101_110", pArg);
				}
				if(p_jpsnob4.length() != 0){
					pArg.put("JPSNO", p_jpsnob4);
					pArg.put("BOXQY", (String) pArg.get("BOXQYB4"));
					pArg.put("INOUTB",(String) pArg.get("INOUTB4"));
					dao.insertData("pssallib.insertSLTZ101_110", pArg);
				}
				if(p_jpsnob5.length() != 0){
					pArg.put("JPSNO", p_jpsnob5);
					pArg.put("BOXQY", (String) pArg.get("BOXQYB5"));
					pArg.put("INOUTB",(String) pArg.get("INOUTB5"));
					dao.insertData("pssallib.insertSLTZ101_110", pArg);
				}
				if(p_jpsnob6.length() != 0){
					pArg.put("JPSNO", p_jpsnob6);
					pArg.put("BOXQY", (String) pArg.get("BOXQYB6"));
					pArg.put("INOUTB",(String) pArg.get("INOUTB6"));
					dao.insertData("pssallib.insertSLTZ101_110", pArg);
				}
				if(p_jpsnob7.length() != 0){
					pArg.put("JPSNO", p_jpsnob7);
					pArg.put("BOXQY", (String) pArg.get("BOXQYB7"));
					pArg.put("INOUTB",(String) pArg.get("INOUTB7"));
					dao.insertData("pssallib.insertSLTZ101_110", pArg);
				}
			}
		}
		
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SLTZ101_CHECK", errList);//추가
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ104Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSLTZ104Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ104Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ106Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSLTZ106Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ106Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ107Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSLTZ107Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SLTZ107Q", list);
		new MiPlatformView().render(map, request, response);
	}

	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/일별제품출고전표현황
	 * @exception 
	 * @see 
	 * 	- 2012-09-27	:	제환복
	***********************************************************************/ 
	public void selectSMDZ120P(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDZ120P", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDZ120P", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/품번별제품출고 현황
	 * @exception 
	 * @see 
	 * 	- 2012-10-08	:	제환복
	***********************************************************************/ 	
	public void selectSMDZ121P(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDZ121P", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDZ121P", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/품번별제품출고집계 현황
	 * @exception 
	 * @see 
	 * 	- 2012-10-08	:	제환복
	***********************************************************************/ 	
	public void selectSMDZ122P(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDZ122P", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDZ122P", list);
		new MiPlatformView().render(map, request, response);
	}	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/제품출고전표
	 * @exception 
	 * @see 
	 * 	- 2012-10-10	:	제환복
	***********************************************************************/ 	
	public void selectSMDZ123P_CHK(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDZ123P_CHK", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDZ123P_CHK", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/제품출고전표
	 * @exception 
	 * @see 
	 * 	- 2012-10-10	:	제환복
	***********************************************************************/ 	
	public void selectSMDZ123P(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDZ123P", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDZ123P", list);
		new MiPlatformView().render(map, request, response);
	}			
	public void selectSJZZ101Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJZZ101Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJZZ101Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSJSZ106Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ106Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ106Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSZZE100(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE100", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE100", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSZZE100_SZZ050PF(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE100_SZZ050PF", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZ050PF", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSZZE100(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SZZE100");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String empty1="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("PRTNOS");
			rowType = (String) pData.get("ROW_TYPE");
			if (empty1 != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSZZE100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("SLPNOS", pData.get("SLPNOS"));
							errMap.put("PRTNOS", pData.get("PRTNOS"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSZZE100", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("PRTNOS");
			rowType = (String) pData.get("ROW_TYPE");
			if (empty1 != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSZZE100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(이미등록된 자료)
							HashMap errMap = new HashMap();
							errMap.put("SLPNOS", pData.get("SLPNOS"));
							errMap.put("PRTNOS", pData.get("PRTNOS"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSZZE100", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSZZE100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("SLPNOS", pData.get("SLPNOS"));
							errMap.put("PRTNOS", pData.get("PRTNOS"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSZZE100", pData);
						}
					}
				}
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SZZE100_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void saveSZZE110C(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SZZE110");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it = pList.iterator();
		String rowType="";

		dao.startTransaction(); //tr 시작		
		while (it.hasNext()) {  
			Map pData = (Map) it.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			dao.insertData("pssallib.insertSZZE110", pData);
			dao.updateData("pssallib.updateSZZE110_100", pData);
		}
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);	
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/월일별제품출고전표현황
	 * @exception 
	 * @see 
	 * 	- 2012-10-24	:	제환복
	***********************************************************************/
	
	public void selectSMDZ135Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDZ135Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDZ135Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/INTER-WAREHOUSE TRANSFER인쇄
	 * @exception 
	 * @see 
	 * 	- 2012-10-24	:	제환복
	***********************************************************************/
	
	public void selectSZZE301P(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE301P", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE301P", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/업체별차종별 월납입 현황  
	 * @exception 
	 * @see 
	 * 	- 2012-10-25	:	제환복
	***********************************************************************/
	
	public void selectSMDE121Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDE121Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDE121Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/년업체차종별제품출고집계 현황
	 * @exception 
	 * @see 
	 * 	- 2012-10-26	:	제환복
	***********************************************************************/
	
	public void selectSMDE122Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDE122Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDE122Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/출고관리MENU/년업체차종별제품출고집계 현황
	 * @exception 
	 * @see 
	 * 	- 2012-10-26	:	제환복
	***********************************************************************/
	
	public void selectSJSZ110Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ110Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ110Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/세금계산서마스타 조회
	 * @exception 
	 * @see 
	 * 	- 2012-11-01	:	제환복
	***********************************************************************/
	
	public void selectSJTZ111Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ111Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ111Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/세금계산서마스타 현황
	 * @exception 
	 * @see 
	 * 	- 2012-11-01	:	제환복
	***********************************************************************/
	
	public void selectSJTZ112Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ112Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ112Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/세금계산서마스타 현황
	 * @exception 
	 * @see 
	 * 	- 2012-11-01	:	제환복
	***********************************************************************/
	//동일한세금계산서번호의 계산서는 년월이 같아야함.
	public void selectSJTZ210_TAXDTCHK(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ210_TAXDTCHK", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ210_TAXDTCHK", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSJTZ210(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ210", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ210", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSJTZ210_DETAIL(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ210_DETAIL", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ210_DETAIL", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSJTZ210_CHK2(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ210_CHK2", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ210_CHK2", list);
		new MiPlatformView().render(map, request, response);
	}		
	public void insertSJTZ210(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SJTZ210");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SJTZ210");
		//////////////////////////////////////////////////////////////			
		String rowType="";
		String emptyPN="";
		String STLWH="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("STLWH", (String)pArg.get("STLWH"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSJTZ210_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("MKPNO", pData.get("MKPNO"));
							errMap.put("PSSEQ", pData.get("PSSEQ"));
							errMap.put("TAXDT", pData.get("TAXDT"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							System.out.println("없음");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSJTZ210", pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("STLWH", (String)pArg.get("STLWH"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSJTZ210_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("MKPNO", pData.get("MKPNO"));
							errMap.put("PSSEQ", pData.get("PSSEQ"));
							errMap.put("TAXDT", pData.get("TAXDT"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSJTZ210", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_TAXDT", ds.getOrgBuffColumn(0, "TAXDT").getString());
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSJTZ210_Check2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("MKPNO", pData.get("MKPNO"));
							errMap.put("PSSEQ", pData.get("PSSEQ"));
							errMap.put("TAXDT", pData.get("OLD_TAXDT"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSJTZ210", pData);
						}
/*			
					pData.put("OLD_TAXDT", ds.getOrgBuffColumn(0, "TAXDT").getString());
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSJTZ210_Check2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("MKPNO", pData.get("MKPNO"));
							errMap.put("PSSEQ", pData.get("PSSEQ"));
							errMap.put("TAXDT", pData.get("OLD_TAXDT"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSJTZ210_Check",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 등록됨.)
									HashMap errMap = new HashMap();
									errMap.put("PSPNO", pData.get("PSPNO"));
									errMap.put("MKPNO", pData.get("MKPNO"));
									errMap.put("PSSEQ", pData.get("PSSEQ"));
									errMap.put("TAXDT", pData.get("TAXDT"));
									errMap.put("RTMSG", "수정불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.updateData("pssallib.updateSJTZ210", pData);			
								}
							}
						}
*/								
					}			
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SJTZ210_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}	

	public void selectSJTZ210_SUB(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ210_SUB", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ210_SUB", list);
		new MiPlatformView().render(map, request, response);
	}

	public void insertSJTZ210UC(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SEND");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		Iterator it = pList.iterator();
		
		String rowType="";
		String emptyPN="";
		String STLWH="";

		dao.startTransaction(); //tr 시작	
		dao.deleteData("pssallib.deleteSJTZ210UC", pArg);  //기존DATA삭제
		while (it.hasNext()) { 
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMPS", (String)pArg.get("COMPS"));
			pData.put("PYVND", (String)pArg.get("PYVND"));
			pData.put("SHPTO", (String)pArg.get("SHPTO"));
			pData.put("TAXNO", (String)pArg.get("TAXNO"));
			pData.put("TAXDT", (String)pArg.get("TAXDT"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				dao.insertData("pssallib.insertSJTZ210UC", pData);
				/*
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSJTZ210_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(1)){
						//INSERT 불가(중복DATA)
						HashMap errMap = new HashMap();
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("MKPNO", pData.get("MKPNO"));
						errMap.put("PSSEQ", pData.get("PSSEQ"));
						errMap.put("TAXDT", pData.get("TAXDT"));
						errMap.put("RTMSG", "추가불가(기 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.insertData("pssallib.insertSJTZ210UC", pData);
					}
				}*/
			}
		}
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/업체이월재고 등록
	 * @exception 
	 * @see 
	 * 	- 2012-11-15	:	제환복
	***********************************************************************/
	
	public void selectSJTZ230(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ230", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ230", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSJTZ230(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SJTZ230");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPN="";
		String STLWH="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("STLWH", (String)pArg.get("STLWH"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSJTZ230_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKPNO", pData.get("MKPNO"));
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							System.out.println("없음");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSJTZ230", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("STLWH", (String)pArg.get("STLWH"));
			emptyPN = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPN != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSJTZ230_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKPNO", pData.get("MKPNO"));
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSJTZ230", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSJTZ230_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKPNO", pData.get("MKPNO"));
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSJTZ230", pData);
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SJTZ230_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/판매정산단가 차이 가마감 LIST
	 * @exception 
	 * @see 
	 * 	- 2012-11-01	:	제환복
	***********************************************************************/
	
	public void selectSJTZ120Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ120Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ120Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/판매정산단가 차이  LIST
	 * @exception 
	 * @see 
	 * 	- 2012-11-01	:	제환복
	***********************************************************************/
	
	public void selectSJTZ115Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ115Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ115Q", list);
		new MiPlatformView().render(map, request, response);
	}		
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/세금계산서TX업체별집계 조회   
	 * @exception 
	 * @see 
	 * 	- 2012-12-04	:	제환복
	***********************************************************************/
	
	public void selectSJTZ216Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ216Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ216Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSJTZ216QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ216QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ216QD", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/세금계산서CIGMA 이관전 현황
	 * @exception 
	 * @see 
	 * 	- 2012-11-21	:	제환복
	***********************************************************************/
	
	public void selectSJTZ215R(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ215R", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ215R", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/세금계산서CIGMA이관전ERRLIST
	 * @exception 
	 * @see 
	 * 	- 2012-11-22	:	제환복
	***********************************************************************/
	
	public void selectSJTZ214Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ214Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ214Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/세금계산서CIGMA이관후ERRLIST
	 * @exception 
	 * @see 
	 * 	- 2012-11-22	:	제환복
	***********************************************************************/
	
	public void selectSJTZ295Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ295Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ295Q", list);
		new MiPlatformView().render(map, request, response);
	}	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/세금계산서관리MENU/월 가매출 CHECK LIST
	 * @exception 
	 * @see 
	 * 	- 2012-12-05	:	제환복
	***********************************************************************/
	
	public void selectSJTZ219Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ219Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ219Q", list);
		new MiPlatformView().render(map, request, response);
	}		
	public void selectSJSZ115Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list1 = dao.getListData("pssallib.selectSJSZ115Q", pData);
		//List list2 = dao.getListData("pssallib.selectSJSZ115Q_2", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ115Q", list1);
		//map.addAttribute("ds_SJSZ115Q_2", list2);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSJSZ900Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ900Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ900Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ011Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ011Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ011Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ012Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ012Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ012Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ012QD(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ012QD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ012QD", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ101R(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ101R", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ101R", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ102Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ102Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ102Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ121Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ121Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ121Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ010(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ010", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ010", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ010_DCHK(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ010", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ010_DCHK", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSMBZ010(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SMBZ010");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String empty1="";

		dao.startTransaction(); //tr 시작		
		while (it.hasNext()) { 
			Map pData = (Map) it.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("RVBNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (empty1 != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSMBZ010_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(이미등록된 자료)
							HashMap errMap = new HashMap();
							errMap.put("RVBNO", pData.get("RVBNO"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSMBZ010", pData);
						}
					}
				}else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSMBZ010_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("RVBNO", pData.get("RVBNO"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSMBZ010", pData);
						}
					}
				}else if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSMBZ010_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("RVBNO", pData.get("RVBNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSMBZ010", pData);
						}
					}
				}
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SMBZ010_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void selectSMBZ100(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ100", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ100", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ100_DCHK(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ100_Check", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ100_DCHK", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ100_010(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ100_010", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMB010PF", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void insertSMBZ100(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SMBZ100");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String empty1="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("SIPCD");
			
			rowType = (String) pData.get("ROW_TYPE");
			
			System.out.println(rowType + "--->" + (String) pData.get("SIPNO") + "-----" + empty1);
			if (empty1 != "") {
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSMBZ100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("SIPNO", pData.get("SIPNO"));
							errMap.put("SEQNO", pData.get("SEQNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSMBZ100", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("SIPCD");
			rowType = (String) pData.get("ROW_TYPE");
			if (empty1 != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSMBZ100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(이미등록된 자료)
							HashMap errMap = new HashMap();
							errMap.put("SIPNO", pData.get("SIPNO"));
							errMap.put("SEQNO", pData.get("SEQNO"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							//전표저장
							dao.insertData("pssallib.insertSMBZ100", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSMBZ100_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("SIPNO", pData.get("SIPNO"));
							errMap.put("SEQNO", pData.get("SEQNO"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSMBZ100", pData);
						}
					}
				}
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SMBZ100_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}

	public void selectSMBZ120C(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ120C", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ120C", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void insertSMBZ120C(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SMBZ120C");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_iu = pList.iterator();
		String rowType="";
		String yearAFT="";

		dao.startTransaction(); //tr 시작
		dao.updateData("pssallib.updateSMBZ120C_all", pArg);
		while (it_iu.hasNext()) { 
			Map pData = (Map) it_iu.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("YYYY", (String)pArg.get("YYYY"));
			pData.put("DEBMM",(String)pArg.get("DEBMM"));
			pData.put("CREMM",(String)pArg.get("CREMM"));
			pData.put("MISMM",(String)pArg.get("MISMM"));
			//rowType = (String) pData.get("ROW_TYPE");
			
			System.out.println("--->" + (String) pData.get("PYVND") + "-----" + (String) pData.get("COMPS"));
			Map CheckCnt = (Map)dao.getReadData("pssallib.selectSMBZ120C_Check",pData);
			if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
				if(CheckCnt.get("CNT").equals(0)){
					dao.insertData("pssallib.insertSMBZ120C", pData);
				}else{
					dao.updateData("pssallib.updateSMBZ120C", pData);
				}
			}else{
				//System 오류
				HashMap errMap = new HashMap();
				errMap.put("COMPS", pData.get("COMPS"));
				errMap.put("PYVND", pData.get("PYVND"));
				errMap.put("RTMSG", "System오류가 발생하여 마감 작업에 오류가 발생하였습니다.");
				errList.add(errMap);
			}
		}
		yearAFT = (String)pArg.get("MM");
		if(yearAFT.equals("03")){ //3월이면 년이월작업
			dao.insertData("pssallib.insertSMBZ120C_YEARAFT", pArg);
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SMBZ120C_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ122R(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list1 = dao.getListData("pssallib.selectSMBZ122R", pData);
		List list2 = dao.getListData("pssallib.selectSMBZ122R_TOT", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ122R", list1);
		map.addAttribute("ds_SMBZ122R_TOT", list2);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSMBZ116C(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ116C", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ116C", list);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSMBZ116C(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		//List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SMBZ120C");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		List errList = new ArrayList();//추가
		
		dao.startTransaction(); //tr 시작
		dao.insertData("pssallib.insertSMBZ116C", pArg);
		dao.updateData("pssallib.updateSMBZ116C_1", pArg);
		dao.updateData("pssallib.updateSMBZ116C_2", pArg);
		dao.updateData("pssallib.updateSMBZ116C_3", pArg);
		dao.updateData("pssallib.updateSMBZ116C_4", pArg);
		dao.updateData("pssallib.updateSMBZ116C_5", pArg);
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);
	}
	public void selectSMBZ116(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMBZ116", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMBZ116", list);
		new MiPlatformView().render(map, request, response);
	}

	public void insertSMBZ116(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SMBZ116");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		
		Iterator it_u = pList.iterator();
		String rowType="";
		String empty1="";

		dao.startTransaction(); //tr 시작		
		while (it_u.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_u.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMPS", (String)pArg.get("COMPS"));
			pData.put("TAXYM", (String)pArg.get("TAXYM"));
			pData.put("PYVND", (String)pArg.get("PYVND"));
			pData.put("ADUSR", (String)pArg.get("ADUSR"));
			empty1 = (String) pData.get("TAXNO");
			
			rowType = (String) pData.get("ROW_TYPE");
			
			if (empty1 != "") {
				if ("update".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSMBZ116_Check",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("TAXNO", pData.get("TAXNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSMBZ116", pData);
						}
					}
				}
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SMBZ116_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	
	public void insertSVHE334UC_1(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE334UC_0");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List UC1List = new ArrayList(); //정상 dataset return
		List UC2List = new ArrayList(); //error dataset return
		Iterator it = pList.iterator();
		
		String vplngb="";
		String pyvnd="";
		String comps="";
		String pspno="";
		String efffr ="";
		String effto ="";
		String vDocument="";
		String daypyo_DMKCR = "";
		String daypyo_DSECD = "";
		String errCHK ="";
		
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMPS", (String)pArg.get("COMPS"));
			vplngb = (String) pData.get("Col03");

			if (vplngb.equals("T")) {
				//String vCol04 = iif((String) pData.get("Col04").equals("")," ",(String) pData.get("Col04")); //VAN ID 4자리
				String vCol04 = (String) pData.get("Col04"); //VAN ID 4자리
				String vCol05 = (String) pData.get("Col05"); //계획구분 1자리
				String vCol06 = (String) pData.get("Col06"); //서열번호 (CODE SERAIL) 3자리

				String vCol08t = (String) pData.get("Col08"); //CODE VALUE 15자리
				String vCol08="";
				if(vCol08t == ""){
					vCol08 = "    "; //CODE VALUE 4자리변경
				}else{
					vCol08 = vCol08t.substring(0,4); //CODE VALUE 4자리변경
				}
				String vCol09 = (String) pData.get("Col09"); //oem공장코드 4자리
				
				String vCol37t = (String) pData.get("Col37"); //차종코드 4자리	
				String vCol37="";
				if(vCol37t == ""){
					vCol37 = "    "; 
				}else{
					vCol37 = vCol37t.substring(0,2); //차종코드 2자리변경
				}
				vDocument = (String) pData.get("Col01");
				HashMap pKey1 = new HashMap();
				pKey1.put("LIB2", (String)pArg.get("LIB2"));
				pKey1.put("P_VNDCD", vCol04);
				pKey1.put("P_FACCD", vCol09);
				Map getSVM020PF = (Map)dao.getReadData("pscomlib.selectSVM020PF",pKey1);
				if(getSVM020PF!=null && getSVM020PF.get("PSVND")!=null && !getSVM020PF.get("PSVND").equals("")){
					comps = (String) getSVM020PF.get("PSCOM");
					pyvnd = (String) getSVM020PF.get("PSVND").toString();
					
					//대표서열산출(중복서열코드마스타)
					//Map pKey2;
					HashMap pKey2 = new HashMap();
					pKey2.put("LIB2", (String)pArg.get("LIB2"));
					pKey2.put("P_COMPS", comps);
					pKey2.put("P_PYVND", pyvnd);
					pKey2.put("P_MCRC1", vCol37); //모델코드
					pKey2.put("P_MSEC1", vCol08); //CODE VALUE
					
					Map getSVZ080PF = (Map)dao.getReadData("pscomlib.selectSVZ080PF",pKey2);
					if(getSVZ080PF!=null && getSVZ080PF.get("MCRCD")!=null && !getSVZ080PF.get("MCRCD").equals("")){
						daypyo_DMKCR = (String)  getSVZ080PF.get("MCRCD");
						daypyo_DSECD = (String)  getSVZ080PF.get("MSECD");
					}else{
						daypyo_DMKCR = vCol37;
						daypyo_DSECD = vCol08;
					}
					
					//업체서열차종마스타
					//Map pKey3;
					HashMap pKey3 = new HashMap();
					pKey3.put("LIB2", (String)pArg.get("LIB2"));
					pKey3.put("P_COMPS", comps);
					pKey3.put("P_PYVND", pyvnd);
					pKey3.put("P_MCRCD", daypyo_DMKCR.substring(0,2));
					pKey3.put("P_SEQCD", daypyo_DSECD.substring(0,4));
					pKey3.put("P_SEQNO", vCol06);
					
					List list = dao.getListData("pscomlib.selectSVM100PF", pKey3);
					if(!list.isEmpty()){
						for(Iterator it_SVM100PF = list.iterator(); it_SVM100PF.hasNext(); ){
							Map map_SVM100PF = (Map)it_SVM100PF.next();
							effto = (String) map_SVM100PF.get("EFFTO").toString();
							if (effto.equals("99999999")){
								pspno = (String) map_SVM100PF.get("PSPNO");
								efffr = (String) map_SVM100PF.get("EFFFR").toString();
								effto = (String) map_SVM100PF.get("EFFTO").toString();
								errCHK ="T";
								HashMap UC1 = new HashMap();
								UC1.put("PYVND", pyvnd); //denso 거래처코드
								UC1.put("PSPNO", pspno); //denso 풍성품번
								UC1.put("DMKCR", (String) daypyo_DMKCR.substring(0,2)); 
								UC1.put("DSECD", (String) daypyo_DSECD.substring(0,4));
								UC1.put("DSENO", vCol06); //대표서열번호 (CODE SERAIL))
								UC1.put("DFACD", vCol09); //대표공장(공장구분)
								UC1.put("DEFFR", efffr);
								UC1.put("DEFTO", effto);
								UC1.put("DUMCA", vDocument.substring(0,2)); //문서자료
								UC1.put("DUMCB", vDocument.substring(2,10)); //문서일자
								UC1.put("DUMCC", vDocument.substring(10,14)); //문서코드 = 공장구분
								UC1.put("VENDR", vCol04); //VAN ID
								UC1.put("JBGB1", vCol05); //지시구분
								UC1.put("ITMNO", vCol06); //서열번호 (CODE SERAIL)
								UC1.put("PNONM", (String) pData.get("Col07")); //업체품명 (CODE NAME)
								UC1.put("ITMCD", vCol08); //CODE VALUE
								UC1.put("FACGU", vCol09); //공장구분
								UC1.put("TRIMD",(String) pData.get("Col10")); //TRIM (D-1실적)
								UC1.put("PBSQY",(String) pData.get("Col11")); //대기댓수
								UC1.put("PATQY",(String) pData.get("Col12")); //도장갯수
								UC1.put("WBSQY",(String) pData.get("Col13")); //비축댓수
								UC1.put("DAT00",(String) pData.get("Col14")); //D DAY 2시간수량
								UC1.put("DAT01",(String) pData.get("Col15")); //D DAY 2시간수량	
								UC1.put("DAT02",(String) pData.get("Col16")); //D DAY 2시간수량
								UC1.put("DAT03",(String) pData.get("Col17")); //D DAY 2시간수량
								UC1.put("DAT04",(String) pData.get("Col18")); //D DAY 2시간수량
								UC1.put("DAT05",(String) pData.get("Col19")); //D DAY 2시간수량
								UC1.put("DAT06",(String) pData.get("Col20")); //D DAY 2시간수량
								UC1.put("DAT07",(String) pData.get("Col21")); //D DAY 2시간수량		
								UC1.put("DAT08",(String) pData.get("Col22")); //D DAY 2시간수량
								UC1.put("DAT09",(String) pData.get("Col23")); //D DAY 2시간수량
								UC1.put("DATQY",(String) pData.get("Col24")); //D DAY TOTAL수량
								UC1.put("DAT10",(String) pData.get("Col25")); //D+1 DAY 2시간수량
								UC1.put("DAT11",(String) pData.get("Col26")); //D+1 DAY 2시간수량		
								UC1.put("DAT12",(String) pData.get("Col27")); //D+1 DAY 4시간수량	
								UC1.put("DAT13",(String) pData.get("Col28")); //D+1 DAY 4시간수량
								UC1.put("DAT14",(String) pData.get("Col29")); //D+1 DAY 4시간수량	
								UC1.put("DAT15",(String) pData.get("Col30")); //D+1 DAY 4시간수량
								UC1.put("DAT20",(String) pData.get("Col31")); //D+2 DAY 주간수량
								UC1.put("DAT21",(String) pData.get("Col32")); //D+2 DAY 야간수량
								UC1.put("DAT30",(String) pData.get("Col33")); //D+3 DAY 주간수량	
								UC1.put("DAT31",(String) pData.get("Col34")); //D+3 DAY 야간수량
								UC1.put("REMQY",(String) pData.get("Col35")); //이후투입수량
								UC1.put("GRTOT",(String) pData.get("Col36")); //합계수량
								UC1.put("MOLCD",vCol37); //차종코드	
								UC1.put("SPACE",errCHK); //ERROR여부	
								UC1List.add(UC1);
							}
						}
					}else{
						//차종서열제외마스타
						Map getSVM300PF = (Map)dao.getReadData("pscomlib.selectSVM300PF",pKey3);
						if(getSVM300PF!=null && getSVM300PF.get("COMPS")!=null && !getSVM300PF.get("COMPS").equals("")){
							errCHK ="2"; //차종서열제외 list.
						}else{
							errCHK ="1"; //차종서열 존재하지 않음.
						}
					}
				}else{
					errCHK ="3"; //HKMC공장코드error
				}
				if(errCHK!="T"){
					HashMap UC2 = new HashMap();
					UC2.put("PYVND", pyvnd); //denso 거래처코드
					UC2.put("PSPNO", pspno); //denso 풍성품번
					if(daypyo_DMKCR == ""){
						UC2.put("DMKCR","");
					}else {
						UC2.put("DMKCR", (String) daypyo_DMKCR.substring(0,2)); 
					}
					if(daypyo_DSECD == ""){
						UC2.put("DSECD","");
					}else {
						UC2.put("DSECD", (String) daypyo_DSECD.substring(0,4)); 
					}
					UC2.put("DSENO", vCol06); //대표번호 (서열번호 (CODE SERAIL))
					UC2.put("DFACD", vCol09); //대표공장(공장구분)
					UC2.put("DEFFR", efffr);
					UC2.put("DEFTO", effto);
					UC2.put("DUMCA", vDocument.substring(0,2)); //문서자료
					UC2.put("DUMCB", vDocument.substring(2,10)); //문서일자
					UC2.put("DUMCC", vDocument.substring(12,14)); //문서코드 = 공장구분
					UC2.put("VENDR", vCol04); //VAN ID
					UC2.put("JBGB1", vCol05); //지시구분
					UC2.put("ITMNO", vCol06); //서열번호 (CODE SERAIL)
					UC2.put("PNONM", (String) pData.get("Col07")); //업체품명 (CODE NAME)
					UC2.put("ITMCD", vCol08); //CODE VALUE
					UC2.put("FACGU", vCol09); //공장구분
					UC2.put("TRIMD",(String) pData.get("Col10")); //TRIM (D-1실적)
					UC2.put("PBSQY",(String) pData.get("Col11")); //대기댓수
					UC2.put("PATQY",(String) pData.get("Col12")); //도장갯수
					UC2.put("WBSQY",(String) pData.get("Col13")); //비축댓수
					UC2.put("DAT00",(String) pData.get("Col14")); //D DAY 2시간수량
					UC2.put("DAT01",(String) pData.get("Col15")); //D DAY 2시간수량	
					UC2.put("DAT02",(String) pData.get("Col16")); //D DAY 2시간수량
					UC2.put("DAT03",(String) pData.get("Col17")); //D DAY 2시간수량
					UC2.put("DAT04",(String) pData.get("Col18")); //D DAY 2시간수량
					UC2.put("DAT05",(String) pData.get("Col19")); //D DAY 2시간수량
					UC2.put("DAT06",(String) pData.get("Col20")); //D DAY 2시간수량
					UC2.put("DAT07",(String) pData.get("Col21")); //D DAY 2시간수량		
					UC2.put("DAT08",(String) pData.get("Col22")); //D DAY 2시간수량
					UC2.put("DAT09",(String) pData.get("Col23")); //D DAY 2시간수량
					UC2.put("DATQY",(String) pData.get("Col24")); //D DAY TOTAL수량
					UC2.put("DAT10",(String) pData.get("Col25")); //D+1 DAY 2시간수량
					UC2.put("DAT11",(String) pData.get("Col26")); //D+1 DAY 2시간수량		
					UC2.put("DAT12",(String) pData.get("Col27")); //D+1 DAY 4시간수량	
					UC2.put("DAT13",(String) pData.get("Col28")); //D+1 DAY 4시간수량
					UC2.put("DAT14",(String) pData.get("Col29")); //D+1 DAY 4시간수량	
					UC2.put("DAT15",(String) pData.get("Col30")); //D+1 DAY 4시간수량
					UC2.put("DAT20",(String) pData.get("Col31")); //D+2 DAY 주간수량
					UC2.put("DAT21",(String) pData.get("Col32")); //D+2 DAY 야간수량
					UC2.put("DAT30",(String) pData.get("Col33")); //D+3 DAY 주간수량	
					UC2.put("DAT31",(String) pData.get("Col34")); //D+3 DAY 야간수량
					UC2.put("REMQY",(String) pData.get("Col35")); //이후투입수량
					UC2.put("GRTOT",(String) pData.get("Col36")); //합계수량
					UC2.put("MOLCD",vCol37); //차종코드	
					UC2.put("SPACE",errCHK); //ERROR여부	
					UC2List.add(UC2);
				}
				pyvnd="";
				pspno="";
			}
		}
		//dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE334UC_1", UC1List);
		map.addAttribute("ds_SVHE334UC_2", UC2List);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void insertSVHE334UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE334UC");
		List pList_CD = DataConverter.getMiPlatformMultiData(pReq, "ds_DFACD");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		
		Iterator it_i = pList.iterator();
		Iterator it_d = pList_CD.iterator();
		
		String rowType="";
		String empty1="";
		String empty2="";
		dao.startTransaction(); //tr 시작
		//공장코드별 삭제
		while (it_d.hasNext()) { 
			Map pData_CD = (Map) it_d.next();
			pData_CD.put("LIB2", (String)pArg.get("LIB2"));
			dao.deleteData("pssallib.deleteSVHE334UC", pData_CD);
		}
		//data생성
		while (it_i.hasNext()) { 
			Map pData = (Map) it_i.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("PYVND");
			empty2 = (String) pData.get("PSPNO");
			if (empty1 != "" && empty2 != "") {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVHE334UC_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(1)){
						//update 불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND"));
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("DMKCR", pData.get("DMKCR"));
						errMap.put("DSECD", pData.get("DSECD"));
						errMap.put("DSENO", pData.get("DSENO"));
						errMap.put("DFACD", pData.get("DFACD"));
						errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.insertData("pssallib.insertSVHE334UC", pData);
					}
				}
			}
		}
		// SW003 Start 업체부품구성마스터에의한 구성품번 추가-------------
		HashMap pKey = new HashMap();
		pKey.put("LIB2", (String)pArg.get("LIB2"));
		dao.insertData("pssallib.insertSVHE334UC_ADD", pKey);
		// SW003 End ---------------------------------------------
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE334UC_CHECK", errList);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void insertSVHE344UC_1(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE344UC_0");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List UC1List = new ArrayList(); //정상 dataset return
		List UC2List = new ArrayList(); //error dataset return
		Iterator it = pList.iterator();
		
		String vplngb="";
		String pyvnd="";
		String comps="";
		String pspno="";
		String efffr ="";
		String effto ="";
		String vDocument="";
		String daypyo_DMKCR = "";
		String daypyo_DSECD = "";
		String errCHK ="";
		
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMPS", (String)pArg.get("COMPS"));
			vplngb = (String) pData.get("Col03");

			if (vplngb.equals("T")) {
				//String vCol04 = iif((String) pData.get("Col04").equals("")," ",(String) pData.get("Col04")); //VAN ID 4자리
				String vCol04 = (String) pData.get("Col04"); //VAN ID 4자리
				String vCol05 = (String) pData.get("Col05"); //지시구분 1자리
				String vCol06 = (String) pData.get("Col06"); //서열번호 (CODE SERAIL) 3자리

				String vCol08t = (String) pData.get("Col08"); //CODE VALUE 15자리
				String vCol08="";
				if(vCol08t == ""){
					vCol08 = "    "; //CODE VALUE 4자리변경
				}else{
					vCol08 = vCol08t.substring(0,4); //CODE VALUE 4자리변경
				}
				String vCol09 = (String) pData.get("Col09"); //oem공장코드 4자리
				
				String vCol34t = (String) pData.get("Col34"); //차종코드 4자리	
				String vCol34="";
				if(vCol34t == ""){
					vCol34 = "    "; 
				}else{
					vCol34 = vCol34t.substring(0,2); //차종코드 2자리변경
				}
				vDocument = (String) pData.get("Col01");
				HashMap pKey1 = new HashMap();
				pKey1.put("LIB2", (String)pArg.get("LIB2"));
				pKey1.put("P_VNDCD", vCol04);
				pKey1.put("P_FACCD", vCol09);
				Map getSVM020PF = (Map)dao.getReadData("pscomlib.selectSVM020PF",pKey1);
				if(getSVM020PF!=null && getSVM020PF.get("PSVND")!=null && !getSVM020PF.get("PSVND").equals("")){
					comps = (String) getSVM020PF.get("PSCOM");
					pyvnd = (String) getSVM020PF.get("PSVND").toString();
					
					//대표서열산출(중복서열코드마스타)
					//Map pKey2;
					HashMap pKey2 = new HashMap();
					pKey2.put("LIB2", (String)pArg.get("LIB2"));
					pKey2.put("P_COMPS", comps);
					pKey2.put("P_PYVND", pyvnd);
					pKey2.put("P_MCRC1", vCol34); //모델코드
					pKey2.put("P_MSEC1", vCol08); //CODE VALUE
					
					Map getSVZ080PF = (Map)dao.getReadData("pscomlib.selectSVZ080PF",pKey2);
					if(getSVZ080PF!=null && getSVZ080PF.get("MCRCD")!=null && !getSVZ080PF.get("MCRCD").equals("")){
						daypyo_DMKCR = (String)  getSVZ080PF.get("MCRCD");
						daypyo_DSECD = (String)  getSVZ080PF.get("MSECD");
					}else{
						daypyo_DMKCR = vCol34;
						daypyo_DSECD = vCol08;
					}
					
					//업체서열차종마스타
					//Map pKey3;
					HashMap pKey3 = new HashMap();
					pKey3.put("LIB2", (String)pArg.get("LIB2"));
					pKey3.put("P_COMPS", comps);
					pKey3.put("P_PYVND", pyvnd);
					pKey3.put("P_MCRCD", daypyo_DMKCR.substring(0,2));
					pKey3.put("P_SEQCD", daypyo_DSECD.substring(0,4));
					pKey3.put("P_SEQNO", vCol06);
					
					List list = dao.getListData("pscomlib.selectSVM100PF", pKey3);
					if(!list.isEmpty()){
						for(Iterator it_SVM100PF = list.iterator(); it_SVM100PF.hasNext(); ){
							Map map_SVM100PF = (Map)it_SVM100PF.next();
							effto = (String) map_SVM100PF.get("EFFTO").toString();
							if (effto.equals("99999999")){
								pspno = (String) map_SVM100PF.get("PSPNO");
								efffr = (String) map_SVM100PF.get("EFFFR").toString();
								effto = (String) map_SVM100PF.get("EFFTO").toString();
								errCHK ="T";
								HashMap UC1 = new HashMap();
								UC1.put("PYVND", pyvnd); //denso 거래처코드
								UC1.put("PSPNO", pspno); //denso 풍성품번
								UC1.put("DMKCR", (String) daypyo_DMKCR.substring(0,2)); 
								UC1.put("DSECD", (String) daypyo_DSECD.substring(0,4));
								UC1.put("DSENO", vCol06); //대표서열번호 (CODE SERAIL))
								UC1.put("DFACD", vCol09); //대표공장(공장구분)
								UC1.put("DEFFR", efffr);
								UC1.put("DEFTO", effto);
								UC1.put("DUMCA", vDocument.substring(0,2)); //문서자료
								UC1.put("DUMCB", vDocument.substring(2,10)); //문서일자
								UC1.put("DUMCC", vDocument.substring(10,14)); //문서코드 = 공장구분
								UC1.put("VENDR", vCol04); //VAN ID
								UC1.put("JBGB1", vCol05); //지시구분
								UC1.put("ITMNO", vCol06); //서열번호 (CODE SERAIL)
								UC1.put("PNONM", (String) pData.get("Col07")); //업체품명 (CODE NAME)
								UC1.put("ITMCD", vCol08); //CODE VALUE
								UC1.put("FACGU", vCol09); //공장구분
								UC1.put("TRIMD",(String) pData.get("Col10")); //TRIM (D-1실적)
								UC1.put("PBSQY",(String) pData.get("Col11")); //대기댓수
								UC1.put("PATQY",(String) pData.get("Col12")); //도장갯수
								UC1.put("WBSQY",(String) pData.get("Col13")); //비축댓수
								UC1.put("DAT00",(String) pData.get("Col14")); //D DAY 수량
								UC1.put("DAT01",(String) pData.get("Col15")); //D+1 DAY 수량	
								UC1.put("DAT02",(String) pData.get("Col16")); //D+2 DAY 수량
								UC1.put("DAT03",(String) pData.get("Col17")); //D+3 DAY 수량
								UC1.put("DAT04",(String) pData.get("Col18")); //D+4 DAY 수량
								UC1.put("DAT05",(String) pData.get("Col19")); //D+5 DAY 수량
								UC1.put("DAT06",(String) pData.get("Col20")); //D+6 DAY 수량
								UC1.put("DAT07",(String) pData.get("Col21")); //D+7 DAY 수량		
								UC1.put("DAT08",(String) pData.get("Col22")); //D+8 DAY 수량
								UC1.put("DAT09",(String) pData.get("Col23")); //D+9 DAY 수량
								UC1.put("DAT10",(String) pData.get("Col24")); //D+10 DAY 수량
								UC1.put("DAT11",(String) pData.get("Col25")); //D+11 DAY 수량
								UC1.put("DAT12",(String) pData.get("Col26")); //D+12 DAY 수량		
								
								UC1.put("REMQY",(String) pData.get("Col27")); //이후투입수량
								UC1.put("OKQTY",(String) pData.get("Col28")); //확정수량
								UC1.put("MITQY",(String) pData.get("Col29")); //MITU
								UC1.put("PRSEQ",(String) pData.get("Col30")); //PR-SEQ
								UC1.put("MIQQY",(String) pData.get("Col31")); //당월미반영잔량
								UC1.put("MIOQY",(String) pData.get("Col32")); //차월생산 ORDER량
								UC1.put("GRTOT",(String) pData.get("Col33")); //합계수량
								UC1.put("MOLCD",vCol34); //차종코드	
								UC1.put("SPACE",errCHK); //ERROR여부	
								UC1List.add(UC1);
							}
						}
					}else{
						//차종서열제외마스타
						Map getSVM300PF = (Map)dao.getReadData("pscomlib.selectSVM300PF",pKey3);
						if(getSVM300PF!=null && getSVM300PF.get("COMPS")!=null && !getSVM300PF.get("COMPS").equals("")){
							errCHK ="2"; //차종서열제외 list.
						}else{
							errCHK ="1"; //차종서열 존재하지 않음.
						}
					}
				}else{
					errCHK ="3"; //HKMC공장코드error
				}
				if(errCHK!="T"){
					HashMap UC2 = new HashMap();
					UC2.put("PYVND", pyvnd); //denso 거래처코드
					UC2.put("PSPNO", pspno); //denso 풍성품번
					if(daypyo_DMKCR == ""){
						UC2.put("DMKCR","");
					}else {
						UC2.put("DMKCR", (String) daypyo_DMKCR.substring(0,2)); 
					}
					if(daypyo_DSECD == ""){
						UC2.put("DSECD","");
					}else {
						UC2.put("DSECD", (String) daypyo_DSECD.substring(0,4)); 
					}
					
					UC2.put("DSENO", vCol06); //대표번호 (서열번호 (CODE SERAIL))
					UC2.put("DFACD", vCol09); //대표공장(공장구분)
					UC2.put("DEFFR", efffr);
					UC2.put("DEFTO", effto);
					UC2.put("DUMCA", vDocument.substring(0,2)); //문서자료
					UC2.put("DUMCB", vDocument.substring(2,10)); //문서일자
					UC2.put("DUMCC", vDocument.substring(12,14)); //문서코드 = 공장구분
					UC2.put("VENDR", vCol04); //VAN ID
					UC2.put("JBGB1", vCol05); //지시구분
					UC2.put("ITMNO", vCol06); //서열번호 (CODE SERAIL)
					UC2.put("PNONM", (String) pData.get("Col07")); //업체품명 (CODE NAME)
					UC2.put("ITMCD", vCol08); //CODE VALUE
					UC2.put("FACGU", vCol09); //공장구분
					UC2.put("TRIMD",(String) pData.get("Col10")); //TRIM (D-1실적)
					UC2.put("PBSQY",(String) pData.get("Col11")); //대기댓수
					UC2.put("PATQY",(String) pData.get("Col12")); //도장갯수
					UC2.put("WBSQY",(String) pData.get("Col13")); //비축댓수
					UC2.put("DAT00",(String) pData.get("Col14")); //D DAY 수량
					UC2.put("DAT01",(String) pData.get("Col15")); //D+1 DAY 수량	
					UC2.put("DAT02",(String) pData.get("Col16")); //D+2 DAY 수량
					UC2.put("DAT03",(String) pData.get("Col17")); //D+3 DAY 수량
					UC2.put("DAT04",(String) pData.get("Col18")); //D+4 DAY 수량
					UC2.put("DAT05",(String) pData.get("Col19")); //D+5 DAY 수량
					UC2.put("DAT06",(String) pData.get("Col20")); //D+6 DAY 수량
					UC2.put("DAT07",(String) pData.get("Col21")); //D+7 DAY 수량		
					UC2.put("DAT08",(String) pData.get("Col22")); //D+8 DAY 수량
					UC2.put("DAT09",(String) pData.get("Col23")); //D+9 DAY 수량
					UC2.put("DAT10",(String) pData.get("Col24")); //D+10 DAY 수량
					UC2.put("DAT11",(String) pData.get("Col25")); //D+11 DAY 수량
					UC2.put("DAT12",(String) pData.get("Col26")); //D+12 DAY 수량		
					UC2.put("REMQY",(String) pData.get("Col27")); //이후투입수량
					UC2.put("OKQTY",(String) pData.get("Col28")); //확정수량
					UC2.put("MITQY",(String) pData.get("Col29")); //MITU
					UC2.put("PRSEQ",(String) pData.get("Col30")); //PR-SEQ
					UC2.put("MIQQY",(String) pData.get("Col31")); //당월미반영잔량
					UC2.put("MIOQY",(String) pData.get("Col32")); //차월생산 ORDER량
					UC2.put("GRTOT",(String) pData.get("Col33")); //합계수량
					UC2.put("MOLCD",vCol34); //차종코드	
					UC2.put("SPACE",errCHK); //ERROR여부	
					UC2List.add(UC2);
				}
				pyvnd="";
				pspno="";
			}
		}
		//dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE344UC_1", UC1List);
		map.addAttribute("ds_SVHE344UC_2", UC2List);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void insertSVHE344UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE344UC");
		List pList_CD = DataConverter.getMiPlatformMultiData(pReq, "ds_DFACD");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		
		Iterator it_i = pList.iterator();
		Iterator it_d = pList_CD.iterator();
		
		String rowType="";
		String empty1="";
		String empty2="";
		dao.startTransaction(); //tr 시작
		//공장코드별 삭제
		while (it_d.hasNext()) { 
			Map pData_CD = (Map) it_d.next();
			pData_CD.put("LIB2", (String)pArg.get("LIB2"));
			dao.deleteData("pssallib.deleteSVHE344UC", pData_CD);
		}
		//data생성
		while (it_i.hasNext()) { 
			Map pData = (Map) it_i.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("PYVND");
			empty2 = (String) pData.get("PSPNO");
			if (empty1 != "" && empty2 != "") {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVHE344UC_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(1)){
						//update 불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND"));
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("DMKCR", pData.get("DMKCR"));
						errMap.put("DSECD", pData.get("DSECD"));
						errMap.put("DSENO", pData.get("DSENO"));
						errMap.put("DFACD", pData.get("DFACD"));
						errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.insertData("pssallib.insertSVHE344UC", pData);
					}
				}
			}
		}
		// SW003 Start 업체부품구성마스터에의한 구성품번 추가-------------
		HashMap pKey = new HashMap();
		pKey.put("LIB2", (String)pArg.get("LIB2"));
		dao.insertData("pssallib.insertSVHE344UC_ADD", pKey);
		// SW003 End ---------------------------------------------
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE344UC_CHECK", errList);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void insertSVHE314UC_1(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE314UC_0");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List UC1List = new ArrayList(); //정상 dataset return
		List UC2List = new ArrayList(); //error dataset return
		Iterator it = pList.iterator();
		
		String vplngb="";
		String pyvnd="";
		String comps="";
		String pspno="";
		String efffr ="";
		String effto ="";
		String vDocument="";
		String daypyo_DMKCR = "";
		String daypyo_DSECD = "";
		String errCHK ="";
		
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMPS", (String)pArg.get("COMPS"));
			vplngb = (String) pData.get("Col03");

			if (vplngb.equals("T")) {
				String vCol02 = (String) pData.get("Col02"); //처리구분
				String vCol04 = (String) pData.get("Col04"); //VAN ID 4자리
				String vCol05 = (String) pData.get("Col05"); //FILE  ID
				String vCol06 = (String) pData.get("Col06"); //관리구분
				String vCol07 = (String) pData.get("Col07"); //DATA구분
				String vCol08 = (String) pData.get("Col08"); //서열번호 3자리
				String vCol09 = (String) pData.get("Col09"); //업체품명
				String vCol10 = (String) pData.get("Col10"); //작업지시구분
				String vCol11t = (String) pData.get("Col11"); //서열코드 15자리
				String vCol11="";
				if(vCol11t == ""){
					vCol11 = "    "; //서열코드 4자리변경
				}else{
					vCol11 = vCol11t.substring(0,4); //서열코드 4자리변경
				}
				String vCol12 = (String) pData.get("Col12"); //oem공장코드 4자리
				
				String vCol74t = (String) pData.get("Col74"); //차종코드 4자리	
				String vCol74="";
				if(vCol74t == ""){
					vCol74 = "    "; 
				}else{
					vCol74 = vCol74t.substring(0,2); //차종코드 2자리변경
				}
				
				vDocument = (String) pData.get("Col01");
				HashMap pKey1 = new HashMap();
				pKey1.put("LIB2", (String)pArg.get("LIB2"));
				pKey1.put("P_VNDCD", vCol04);
				pKey1.put("P_FACCD", vCol12);
				Map getSVM020PF = (Map)dao.getReadData("pscomlib.selectSVM020PF",pKey1);
				if(getSVM020PF!=null && getSVM020PF.get("PSVND")!=null && !getSVM020PF.get("PSVND").equals("")){
					comps = (String) getSVM020PF.get("PSCOM");
					pyvnd = (String) getSVM020PF.get("PSVND").toString();
					//대표서열산출(중복서열코드마스타)
					HashMap pKey2 = new HashMap();
					pKey2.put("LIB2", (String)pArg.get("LIB2"));
					pKey2.put("P_COMPS", comps);
					pKey2.put("P_PYVND", pyvnd);
					pKey2.put("P_MCRC1", vCol74); //차종코드
					pKey2.put("P_MSEC1", vCol11); //서열코드
					
					Map getSVZ080PF = (Map)dao.getReadData("pscomlib.selectSVZ080PF",pKey2);
					if(getSVZ080PF!=null && getSVZ080PF.get("MCRCD")!=null && !getSVZ080PF.get("MCRCD").equals("")){
						daypyo_DMKCR = (String)  getSVZ080PF.get("MCRCD");
						daypyo_DSECD = (String)  getSVZ080PF.get("MSECD");
					}else{
						daypyo_DMKCR = vCol74;
						daypyo_DSECD = vCol11;
					}
					
					//업체서열차종마스타
					//Map pKey3;
					HashMap pKey3 = new HashMap();
					pKey3.put("LIB2", (String)pArg.get("LIB2"));
					pKey3.put("P_COMPS", comps);
					pKey3.put("P_PYVND", pyvnd);
					pKey3.put("P_MCRCD", daypyo_DMKCR.substring(0,2)); //차종코드
					pKey3.put("P_SEQCD", daypyo_DSECD.substring(0,4)); //서열코드
					pKey3.put("P_SEQNO", vCol08);                      //서열번호
					
					List list = dao.getListData("pscomlib.selectSVM100PF", pKey3);
					if(!list.isEmpty()){
						for(Iterator it_SVM100PF = list.iterator(); it_SVM100PF.hasNext(); ){
							Map map_SVM100PF = (Map)it_SVM100PF.next();
							effto = (String) map_SVM100PF.get("EFFTO").toString();
							if (effto.equals("99999999")){
								pspno = (String) map_SVM100PF.get("PSPNO");
								efffr = (String) map_SVM100PF.get("EFFFR").toString();
								effto = (String) map_SVM100PF.get("EFFTO").toString();
								errCHK ="T";
								HashMap UC1 = new HashMap();
								UC1.put("COMPS", comps); //사업부
								UC1.put("PYVND", pyvnd); //denso 거래처코드
								UC1.put("PSPNO", pspno); //denso 풍성품번
								UC1.put("DMKCR", (String) daypyo_DMKCR.substring(0,2)); 
								UC1.put("DSECD", (String) daypyo_DSECD.substring(0,4));
								UC1.put("DSENO", vCol08); //대표서열번호 (CODE SERAIL))
								UC1.put("DFACD", vCol12); //대표공장(공장구분)
								UC1.put("DEFFR", efffr);
								UC1.put("DEFTO", effto);
								UC1.put("DUMCA", vDocument.substring(0,2)); //문서자료
								UC1.put("DUMCB", vDocument.substring(2,10)); //문서일자
								UC1.put("DUMCC", vDocument.substring(10,14)); //문서코드 = 공장구분
								UC1.put("PROGB", vCol02); //처리구분
								UC1.put("PLNGB", vplngb); //계획구분
								UC1.put("VENDR", vCol04); //VAN ID
								UC1.put("FILID", vCol05); //FILE  ID
								UC1.put("MAGGB", vCol06); //관리구분
								UC1.put("DTAGB", vCol07); //DATA 구분
								UC1.put("ITMNO", vCol08); //서열번호 (CODE SERAIL)
								UC1.put("PNONM", vCol09); //업체품명 (CODE NAME)
								UC1.put("JOBGB", vCol10); //작업구분
								UC1.put("ITMCD", vCol11); //서열코드
								UC1.put("FACGU", vCol12); //공장구분
								UC1.put("TRIMD",(String) pData.get("Col13")); //TRIM (D-1실적)
								UC1.put("PBSQY",(String) pData.get("Col14")); //대기댓수
								UC1.put("PATQY",(String) pData.get("Col15")); //도장갯수
								UC1.put("WBSQY",(String) pData.get("Col16")); //비축댓수
								UC1.put("D0T01",(String) pData.get("Col17")); //D DAY 2HR수량	
								UC1.put("D0T02",(String) pData.get("Col18")); //D DAY 2HR수량
								UC1.put("D0T03",(String) pData.get("Col19")); //D DAY 2HR수량
								UC1.put("D0T04",(String) pData.get("Col20")); //D DAY 2HR수량
								UC1.put("D0T05",(String) pData.get("Col21")); //D DAY 2HR수량
								UC1.put("D0T06",(String) pData.get("Col22")); //D DAY 2HR수량
								UC1.put("D0T07",(String) pData.get("Col23")); //D DAY 2HR수량	
								UC1.put("D0T08",(String) pData.get("Col24")); //D DAY 2HR수량
								UC1.put("D0T09",(String) pData.get("Col25")); //D DAY 2HR수량
								UC1.put("D0T10",(String) pData.get("Col26")); //D DAY 2HR수량
								UC1.put("D0TQY",(String) pData.get("Col27")); //D DAY 수량		
								UC1.put("D1T01",(String) pData.get("Col28")); //D+1 DAY 2HR수량	
								UC1.put("D1T02",(String) pData.get("Col29")); //D+1 DAY 2HR수량
								UC1.put("D1T03",(String) pData.get("Col30")); //D+1 DAY 2HR수량
								UC1.put("D1T04",(String) pData.get("Col31")); //D+1 DAY 2HR수량
								UC1.put("D1T05",(String) pData.get("Col32")); //D+1 DAY 2HR수량
								UC1.put("D1T06",(String) pData.get("Col33")); //D+1 DAY 2HR수량
								UC1.put("D1T07",(String) pData.get("Col34")); //D+1 DAY 2HR수량	
								UC1.put("D1T08",(String) pData.get("Col35")); //D+1 DAY 2HR수량
								UC1.put("D1T09",(String) pData.get("Col36")); //D+1 DAY 2HR수량
								UC1.put("D1T10",(String) pData.get("Col37")); //D+1 DAY 2HR수량
								UC1.put("D1TQY",(String) pData.get("Col38")); //D+1 DAY 수량
								UC1.put("D2T01",(String) pData.get("Col39")); //D+2 DAY 2HR수량	
								UC1.put("D2T02",(String) pData.get("Col40")); //D+2 DAY 2HR수량
								UC1.put("D2T03",(String) pData.get("Col41")); //D+2 DAY 2HR수량
								UC1.put("D2T04",(String) pData.get("Col42")); //D+2 DAY 2HR수량
								UC1.put("D2T05",(String) pData.get("Col43")); //D+2 DAY 2HR수량
								UC1.put("D2T06",(String) pData.get("Col44")); //D+2 DAY 2HR수량
								UC1.put("D2T07",(String) pData.get("Col45")); //D+2 DAY 2HR수량	
								UC1.put("D2T08",(String) pData.get("Col46")); //D+2 DAY 2HR수량
								UC1.put("D2T09",(String) pData.get("Col47")); //D+2 DAY 2HR수량
								UC1.put("D2T10",(String) pData.get("Col48")); //D+2 DAY 2HR수량
								UC1.put("D2TQY",(String) pData.get("Col49")); //D+2 DAY 수량	
								UC1.put("D3T01",(String) pData.get("Col50")); //D+3 DAY 2HR수량	
								UC1.put("D3T02",(String) pData.get("Col51")); //D+3 DAY 2HR수량
								UC1.put("D3T03",(String) pData.get("Col52")); //D+3 DAY 2HR수량
								UC1.put("D3T04",(String) pData.get("Col53")); //D+3 DAY 2HR수량
								UC1.put("D3T05",(String) pData.get("Col54")); //D+3 DAY 2HR수량
								UC1.put("D3T06",(String) pData.get("Col55")); //D+3 DAY 2HR수량
								UC1.put("D3T07",(String) pData.get("Col56")); //D+3 DAY 2HR수량	
								UC1.put("D3T08",(String) pData.get("Col57")); //D+3 DAY 2HR수량
								UC1.put("D3T09",(String) pData.get("Col58")); //D+3 DAY 2HR수량
								UC1.put("D3T10",(String) pData.get("Col59")); //D+3 DAY 2HR수량
								UC1.put("D3TQY",(String) pData.get("Col60")); //D+3 DAY 수량
								UC1.put("D4T01",(String) pData.get("Col61")); //D+4 DAY 2HR수량	
								UC1.put("D4T02",(String) pData.get("Col62")); //D+4 DAY 2HR수량
								UC1.put("D4T03",(String) pData.get("Col63")); //D+4 DAY 2HR수량
								UC1.put("D4T04",(String) pData.get("Col64")); //D+4 DAY 2HR수량
								UC1.put("D4T05",(String) pData.get("Col65")); //D+4 DAY 2HR수량
								UC1.put("D4T06",(String) pData.get("Col66")); //D+4 DAY 2HR수량
								UC1.put("D4T07",(String) pData.get("Col67")); //D+4 DAY 2HR수량	
								UC1.put("D4T08",(String) pData.get("Col68")); //D+4 DAY 2HR수량
								UC1.put("D4T09",(String) pData.get("Col69")); //D+4 DAY 2HR수량
								UC1.put("D4T10",(String) pData.get("Col70")); //D+4 DAY 2HR수량
								UC1.put("D4TQY",(String) pData.get("Col71")); //D+4 DAY 수량	
								UC1.put("REMQY",(String) pData.get("Col72")); //이후투입수량
								UC1.put("GRTOT",(String) pData.get("Col73")); //합계수량
								UC1.put("MOLCD",vCol74); //차종코드	
								UC1.put("SPACE",errCHK); //ERROR여부	
								UC1List.add(UC1);
							}
						}
					}else{
						//차종서열제외마스타
						Map getSVM300PF = (Map)dao.getReadData("pscomlib.selectSVM300PF",pKey3);
						if(getSVM300PF!=null && getSVM300PF.get("COMPS")!=null && !getSVM300PF.get("COMPS").equals("")){
							errCHK ="2"; //차종서열제외 list.
						}else{
							errCHK ="1"; //차종서열 존재하지 않음.
						}
					}
				}else{
					errCHK ="3"; //HKMC공장코드error
				}
				if(errCHK!="T"){
					HashMap UC2 = new HashMap();
					UC2.put("COMPS", comps); //사업부
					UC2.put("PYVND", pyvnd); //denso 거래처코드
					UC2.put("PSPNO", pspno); //denso 풍성품번
					if(daypyo_DMKCR == ""){
						UC2.put("DMKCR","");
					}else {
						UC2.put("DMKCR", (String) daypyo_DMKCR.substring(0,2)); 
					}
					if(daypyo_DSECD == ""){
						UC2.put("DSECD","");
					}else {
						UC2.put("DSECD", (String) daypyo_DSECD.substring(0,4)); 
					}
					UC2.put("DSENO", vCol08); //대표서열번호 (CODE SERAIL))
					UC2.put("DFACD", vCol12); //대표공장(공장구분)
					UC2.put("DEFFR", efffr);
					UC2.put("DEFTO", effto);
					UC2.put("DUMCA", vDocument.substring(0,2)); //문서자료
					UC2.put("DUMCB", vDocument.substring(2,10)); //문서일자
					UC2.put("DUMCC", vDocument.substring(10,14)); //문서코드 = 공장구분
					UC2.put("PROGB", vCol02); //처리구분
					UC2.put("PLNGB", vplngb); //계획구분
					UC2.put("VENDR", vCol04); //VAN ID
					UC2.put("FILID", vCol05); //FILE  ID
					UC2.put("MAGGB", vCol06); //관리구분
					UC2.put("DTAGB", vCol07); //DATA 구분
					UC2.put("ITMNO", vCol08); //서열번호 (CODE SERAIL)
					UC2.put("PNONM", vCol09); //업체품명 (CODE NAME)
					UC2.put("JOBGB", vCol10); //작업구분
					UC2.put("ITMCD", vCol11); //서열코드
					UC2.put("FACGU", vCol12); //공장구분
					UC2.put("TRIMD",(String) pData.get("Col13")); //TRIM (D-1실적)
					UC2.put("PBSQY",(String) pData.get("Col14")); //대기댓수
					UC2.put("PATQY",(String) pData.get("Col15")); //도장갯수
					UC2.put("WBSQY",(String) pData.get("Col16")); //비축댓수
					UC2.put("D0T01",(String) pData.get("Col17")); //D DAY 2HR수량	
					UC2.put("D0T02",(String) pData.get("Col18")); //D DAY 2HR수량
					UC2.put("D0T03",(String) pData.get("Col19")); //D DAY 2HR수량
					UC2.put("D0T04",(String) pData.get("Col20")); //D DAY 2HR수량
					UC2.put("D0T05",(String) pData.get("Col21")); //D DAY 2HR수량
					UC2.put("D0T06",(String) pData.get("Col22")); //D DAY 2HR수량
					UC2.put("D0T07",(String) pData.get("Col23")); //D DAY 2HR수량	
					UC2.put("D0T08",(String) pData.get("Col24")); //D DAY 2HR수량
					UC2.put("D0T09",(String) pData.get("Col25")); //D DAY 2HR수량
					UC2.put("D0T10",(String) pData.get("Col26")); //D DAY 2HR수량
					UC2.put("D0TQY",(String) pData.get("Col27")); //D DAY 수량		
					UC2.put("D1T01",(String) pData.get("Col28")); //D+1 DAY 2HR수량	
					UC2.put("D1T02",(String) pData.get("Col29")); //D+1 DAY 2HR수량
					UC2.put("D1T03",(String) pData.get("Col30")); //D+1 DAY 2HR수량
					UC2.put("D1T04",(String) pData.get("Col31")); //D+1 DAY 2HR수량
					UC2.put("D1T05",(String) pData.get("Col32")); //D+1 DAY 2HR수량
					UC2.put("D1T06",(String) pData.get("Col33")); //D+1 DAY 2HR수량
					UC2.put("D1T07",(String) pData.get("Col34")); //D+1 DAY 2HR수량	
					UC2.put("D1T08",(String) pData.get("Col35")); //D+1 DAY 2HR수량
					UC2.put("D1T09",(String) pData.get("Col36")); //D+1 DAY 2HR수량
					UC2.put("D1T10",(String) pData.get("Col37")); //D+1 DAY 2HR수량
					UC2.put("D1TQY",(String) pData.get("Col38")); //D+1 DAY 수량
					UC2.put("D2T01",(String) pData.get("Col39")); //D+2 DAY 2HR수량	
					UC2.put("D2T02",(String) pData.get("Col40")); //D+2 DAY 2HR수량
					UC2.put("D2T03",(String) pData.get("Col41")); //D+2 DAY 2HR수량
					UC2.put("D2T04",(String) pData.get("Col42")); //D+2 DAY 2HR수량
					UC2.put("D2T05",(String) pData.get("Col43")); //D+2 DAY 2HR수량
					UC2.put("D2T06",(String) pData.get("Col44")); //D+2 DAY 2HR수량
					UC2.put("D2T07",(String) pData.get("Col45")); //D+2 DAY 2HR수량	
					UC2.put("D2T08",(String) pData.get("Col46")); //D+2 DAY 2HR수량
					UC2.put("D2T09",(String) pData.get("Col47")); //D+2 DAY 2HR수량
					UC2.put("D2T10",(String) pData.get("Col48")); //D+2 DAY 2HR수량
					UC2.put("D2TQY",(String) pData.get("Col49")); //D+2 DAY 수량	
					UC2.put("D3T01",(String) pData.get("Col50")); //D+3 DAY 2HR수량	
					UC2.put("D3T02",(String) pData.get("Col51")); //D+3 DAY 2HR수량
					UC2.put("D3T03",(String) pData.get("Col52")); //D+3 DAY 2HR수량
					UC2.put("D3T04",(String) pData.get("Col53")); //D+3 DAY 2HR수량
					UC2.put("D3T05",(String) pData.get("Col54")); //D+3 DAY 2HR수량
					UC2.put("D3T06",(String) pData.get("Col55")); //D+3 DAY 2HR수량
					UC2.put("D3T07",(String) pData.get("Col56")); //D+3 DAY 2HR수량	
					UC2.put("D3T08",(String) pData.get("Col57")); //D+3 DAY 2HR수량
					UC2.put("D3T09",(String) pData.get("Col58")); //D+3 DAY 2HR수량
					UC2.put("D3T10",(String) pData.get("Col59")); //D+3 DAY 2HR수량
					UC2.put("D3TQY",(String) pData.get("Col60")); //D+3 DAY 수량
					UC2.put("D4T01",(String) pData.get("Col61")); //D+4 DAY 2HR수량	
					UC2.put("D4T02",(String) pData.get("Col62")); //D+4 DAY 2HR수량
					UC2.put("D4T03",(String) pData.get("Col63")); //D+4 DAY 2HR수량
					UC2.put("D4T04",(String) pData.get("Col64")); //D+4 DAY 2HR수량
					UC2.put("D4T05",(String) pData.get("Col65")); //D+4 DAY 2HR수량
					UC2.put("D4T06",(String) pData.get("Col66")); //D+4 DAY 2HR수량
					UC2.put("D4T07",(String) pData.get("Col67")); //D+4 DAY 2HR수량	
					UC2.put("D4T08",(String) pData.get("Col68")); //D+4 DAY 2HR수량
					UC2.put("D4T09",(String) pData.get("Col69")); //D+4 DAY 2HR수량
					UC2.put("D4T10",(String) pData.get("Col70")); //D+4 DAY 2HR수량
					UC2.put("D4TQY",(String) pData.get("Col71")); //D+4 DAY 수량	
					UC2.put("REMQY",(String) pData.get("Col72")); //이후투입수량
					UC2.put("GRTOT",(String) pData.get("Col73")); //합계수량
					UC2.put("MOLCD",vCol74); //차종코드	
					UC2.put("SPACE",errCHK); //ERROR여부	
					UC2List.add(UC2);
				}
				comps="";
				pyvnd="";
				pspno="";
			}
		}
		//dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE314UC_1", UC1List);
		map.addAttribute("ds_SVHE314UC_2", UC2List);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void insertSVHE314UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE314UC");
		List pList_CD = DataConverter.getMiPlatformMultiData(pReq, "ds_DFACD");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		
		Iterator it_i = pList.iterator();
		Iterator it_d = pList_CD.iterator();
		
		String rowType="";
		String empty1="";
		String empty2="";
		dao.startTransaction(); //tr 시작
		//공장코드별 삭제
		while (it_d.hasNext()) { 
			Map pData_CD = (Map) it_d.next();
			pData_CD.put("LIB2", (String)pArg.get("LIB2"));
			dao.deleteData("pssallib.deleteSVHE314UC", pData_CD);
		}
		//data생성
		while (it_i.hasNext()) { 
			Map pData = (Map) it_i.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("PYVND");
			empty2 = (String) pData.get("PSPNO");
			if (empty1 != "" && empty2 != "") {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVHE314UC_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(1)){
						//update 불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND"));
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("DMKCR", pData.get("DMKCR"));
						errMap.put("DSECD", pData.get("DSECD"));
						errMap.put("DSENO", pData.get("DSENO"));
						errMap.put("DFACD", pData.get("DFACD"));
						errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.insertData("pssallib.insertSVHE314UC", pData);
					}
				}
			}
		}
		// SW003 Start 업체부품구성마스터에의한 구성품번 추가-------------
		HashMap pKey = new HashMap();
		pKey.put("LIB2", (String)pArg.get("LIB2"));
		dao.insertData("pssallib.insertSVHE314UC_ADD", pKey);
		// SW003 End ---------------------------------------------
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE314UC_CHECK", errList);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	
	public void insertSVHE324UC_1(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE324UC_0");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List UC1List = new ArrayList(); //정상 dataset return
		List UC2List = new ArrayList(); //error dataset return
		Iterator it = pList.iterator();
		
		String vplngb="";
		String pyvnd="";
		String comps="";
		String pspno="";
		String efffr ="";
		String effto ="";
		String vDocument="";
		String daypyo_DMKCR = "";
		String daypyo_DSECD = "";
		String errCHK ="";
		
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMPS", (String)pArg.get("COMPS"));
			vplngb = (String) pData.get("Col03");

			if (vplngb.equals("T")) {
				String vCol02 = (String) pData.get("Col02"); //처리구분
				String vCol04 = (String) pData.get("Col04"); //VAN ID 4자리
				String vCol05 = (String) pData.get("Col05"); //FILE  ID
				String vCol06 = (String) pData.get("Col06"); //관리구분
				String vCol07 = (String) pData.get("Col07"); //DATA구분
				String vCol08 = (String) pData.get("Col08"); //서열번호 3자리
				String vCol09 = (String) pData.get("Col09"); //업체품명
				String vCol10 = (String) pData.get("Col10"); //작업지시구분
				String vCol11t = (String) pData.get("Col11"); //서열코드 15자리
				String vCol11="";
				if(vCol11t == ""){
					vCol11 = "    "; //서열코드 4자리변경
				}else{
					vCol11 = vCol11t.substring(0,4); //서열코드 4자리변경
				}
				String vCol12 = (String) pData.get("Col12"); //oem공장코드 4자리
				
				String vCol37t = (String) pData.get("Col37"); //차종코드 4자리	
				String vCol37="";
				if(vCol37t == ""){
					vCol37 = "  "; 
				}else{
					vCol37 = vCol37t.substring(0,2); //차종코드 2자리변경
				}
				
				vDocument = (String) pData.get("Col01");
				HashMap pKey1 = new HashMap();
				pKey1.put("LIB2", (String)pArg.get("LIB2"));
				pKey1.put("P_VNDCD", vCol04);
				pKey1.put("P_FACCD", vCol12);
				Map getSVM020PF = (Map)dao.getReadData("pscomlib.selectSVM020PF",pKey1);
				if(getSVM020PF!=null && getSVM020PF.get("PSVND")!=null && !getSVM020PF.get("PSVND").equals("")){
					comps = (String) getSVM020PF.get("PSCOM");
					pyvnd = (String) getSVM020PF.get("PSVND").toString();
					//대표서열산출(중복서열코드마스타)
					HashMap pKey2 = new HashMap();
					pKey2.put("LIB2", (String)pArg.get("LIB2"));
					pKey2.put("P_COMPS", comps);
					pKey2.put("P_PYVND", pyvnd);
					pKey2.put("P_MCRC1", vCol37); //차종코드
					pKey2.put("P_MSEC1", vCol11); //서열코드
					
					Map getSVZ080PF = (Map)dao.getReadData("pscomlib.selectSVZ080PF",pKey2);
					if(getSVZ080PF!=null && getSVZ080PF.get("MCRCD")!=null && !getSVZ080PF.get("MCRCD").equals("")){
						daypyo_DMKCR = (String)  getSVZ080PF.get("MCRCD");
						daypyo_DSECD = (String)  getSVZ080PF.get("MSECD");
					}else{
						daypyo_DMKCR = vCol37;
						daypyo_DSECD = vCol11;
					}
					
					//업체서열차종마스타
					//Map pKey3;
					HashMap pKey3 = new HashMap();
					pKey3.put("LIB2", (String)pArg.get("LIB2"));
					pKey3.put("P_COMPS", comps);
					pKey3.put("P_PYVND", pyvnd);
					pKey3.put("P_MCRCD", daypyo_DMKCR.substring(0,2)); //차종코드
					pKey3.put("P_SEQCD", daypyo_DSECD.substring(0,4)); //서열코드
					pKey3.put("P_SEQNO", vCol08);                      //서열번호
					
					List list = dao.getListData("pscomlib.selectSVM100PF", pKey3);
					if(!list.isEmpty()){
						for(Iterator it_SVM100PF = list.iterator(); it_SVM100PF.hasNext(); ){
							Map map_SVM100PF = (Map)it_SVM100PF.next();
							effto = (String) map_SVM100PF.get("EFFTO").toString();
							if (effto.equals("99999999")){
								pspno = (String) map_SVM100PF.get("PSPNO");
								efffr = (String) map_SVM100PF.get("EFFFR").toString();
								effto = (String) map_SVM100PF.get("EFFTO").toString();
								errCHK ="T";
								HashMap UC1 = new HashMap();
								UC1.put("COMPS", comps); //사업부
								UC1.put("PYVND", pyvnd); //denso 거래처코드
								UC1.put("PSPNO", pspno); //denso 풍성품번
								UC1.put("DMKCR", (String) daypyo_DMKCR.substring(0,2)); 
								UC1.put("DSECD", (String) daypyo_DSECD.substring(0,4));
								UC1.put("DSENO", vCol08); //대표서열번호 (CODE SERAIL))
								UC1.put("DFACD", vCol12); //대표공장(공장구분)
								UC1.put("DEFFR", efffr);
								UC1.put("DEFTO", effto);
								UC1.put("DUMCA", vDocument.substring(0,2)); //문서자료
								UC1.put("DUMCB", vDocument.substring(2,10)); //문서일자
								UC1.put("DUMCC", vDocument.substring(10,14)); //문서코드 = 공장구분
								UC1.put("PROGB", vCol02); //처리구분
								UC1.put("PLNGB", vplngb); //계획구분
								UC1.put("VENDR", vCol04); //VAN ID
								UC1.put("FILID", vCol05); //FILE  ID
								UC1.put("MAGGB", vCol06); //관리구분
								UC1.put("DTAGB", vCol07); //DATA 구분
								UC1.put("ITMNO", vCol08); //서열번호 (CODE SERAIL)
								UC1.put("PNONM", vCol09); //업체품명 (CODE NAME)
								UC1.put("JOBGB", vCol10); //작업구분
								UC1.put("ITMCD", vCol11); //서열코드
								UC1.put("FACGU", vCol12); //공장구분
								UC1.put("TRIMD",(String) pData.get("Col13")); //TRIM (D-1실적)
								UC1.put("PBSQY",(String) pData.get("Col14")); //대기댓수
								UC1.put("PATQY",(String) pData.get("Col15")); //도장갯수
								UC1.put("WBSQY",(String) pData.get("Col16")); //비축댓수
								UC1.put("DAT00",(String) pData.get("Col17")); //D DAY 수량	
								UC1.put("DAT01",(String) pData.get("Col18")); //D+1 DAY 수량
								UC1.put("DAT02",(String) pData.get("Col19")); //D+2 DAY 수량
								UC1.put("DAT03",(String) pData.get("Col20")); //D+3 DAY 수량
								UC1.put("DAT04",(String) pData.get("Col21")); //D+4 DAY 수량
								UC1.put("DAT05",(String) pData.get("Col22")); //D+5 DAY 수량
								UC1.put("DAT06",(String) pData.get("Col23")); //D+6 DAY 수량	
								UC1.put("DAT07",(String) pData.get("Col24")); //D+7 DAY 수량
								UC1.put("DAT08",(String) pData.get("Col25")); //D+8 DAY 수량
								UC1.put("DAT09",(String) pData.get("Col26")); //D+9 DAY 수량
								UC1.put("DAT10",(String) pData.get("Col27")); //D+10 DAY 수량		
								UC1.put("DAT11",(String) pData.get("Col28")); //D+11 DAY 수량	
								UC1.put("DAT12",(String) pData.get("Col29")); //D+12 DAY 수량
								UC1.put("REMQY",(String) pData.get("Col30")); //이후투입수량
								UC1.put("OKQTY",(String) pData.get("Col31")); //확정수량
								UC1.put("MITQY",(String) pData.get("Col32")); //MITU
								UC1.put("PRSEQ",(String) pData.get("Col33")); //PR-SEQ
								UC1.put("MIQQY",(String) pData.get("Col34")); //당월미반영잔량
								UC1.put("MIOQY",(String) pData.get("Col35")); //차월생산 ORDER량
								UC1.put("GRTOT",(String) pData.get("Col36")); //합계수량
								UC1.put("MOLCD",vCol37); //차종코드	
								UC1.put("SPACE",errCHK); //ERROR여부	
								UC1List.add(UC1);
							}
						}
					}else{
						//차종서열제외마스타
						Map getSVM300PF = (Map)dao.getReadData("pscomlib.selectSVM300PF",pKey3);
						if(getSVM300PF!=null && getSVM300PF.get("COMPS")!=null && !getSVM300PF.get("COMPS").equals("")){
							errCHK ="2"; //차종서열제외 list.
						}else{
							errCHK ="1"; //차종서열 존재하지 않음.
						}
					}
				}else{
					errCHK ="3"; //HKMC공장코드error
				}
				if(errCHK!="T"){
					HashMap UC2 = new HashMap();
					UC2.put("COMPS", comps); //사업부
					UC2.put("PYVND", pyvnd); //denso 거래처코드
					UC2.put("PSPNO", pspno); //denso 풍성품번
					if(daypyo_DMKCR == ""){
						UC2.put("DMKCR","");
					}else {
						UC2.put("DMKCR", (String) daypyo_DMKCR.substring(0,2)); 
					}
					if(daypyo_DSECD == ""){
						UC2.put("DSECD","");
					}else {
						UC2.put("DSECD", (String) daypyo_DSECD.substring(0,4)); 
					}
					UC2.put("DSENO", vCol08); //대표서열번호 (CODE SERAIL))
					UC2.put("DFACD", vCol12); //대표공장(공장구분)
					UC2.put("DEFFR", efffr);
					UC2.put("DEFTO", effto);
					UC2.put("DUMCA", vDocument.substring(0,2)); //문서자료
					UC2.put("DUMCB", vDocument.substring(2,10)); //문서일자
					UC2.put("DUMCC", vDocument.substring(10,14)); //문서코드 = 공장구분
					UC2.put("PROGB", vCol02); //처리구분
					UC2.put("PLNGB", vplngb); //계획구분
					UC2.put("VENDR", vCol04); //VAN ID
					UC2.put("FILID", vCol05); //FILE  ID
					UC2.put("MAGGB", vCol06); //관리구분
					UC2.put("DTAGB", vCol07); //DATA 구분
					UC2.put("ITMNO", vCol08); //서열번호 (CODE SERAIL)
					UC2.put("PNONM", vCol09); //업체품명 (CODE NAME)
					UC2.put("JOBGB", vCol10); //작업구분
					UC2.put("ITMCD", vCol11); //서열코드
					UC2.put("FACGU", vCol12); //공장구분
					UC2.put("TRIMD",(String) pData.get("Col13")); //TRIM (D-1실적)
					UC2.put("PBSQY",(String) pData.get("Col14")); //대기댓수
					UC2.put("PATQY",(String) pData.get("Col15")); //도장갯수
					UC2.put("WBSQY",(String) pData.get("Col16")); //비축댓수
					UC2.put("DAT00",(String) pData.get("Col17")); //D DAY 수량	
					UC2.put("DAT01",(String) pData.get("Col18")); //D+1 DAY 수량
					UC2.put("DAT02",(String) pData.get("Col19")); //D+2 DAY 수량
					UC2.put("DAT03",(String) pData.get("Col20")); //D+3 DAY 수량
					UC2.put("DAT04",(String) pData.get("Col21")); //D+4 DAY 수량
					UC2.put("DAT05",(String) pData.get("Col22")); //D+5 DAY 수량
					UC2.put("DAT06",(String) pData.get("Col23")); //D+6 DAY 수량	
					UC2.put("DAT07",(String) pData.get("Col24")); //D+7 DAY 수량
					UC2.put("DAT08",(String) pData.get("Col25")); //D+8 DAY 수량
					UC2.put("DAT09",(String) pData.get("Col26")); //D+9 DAY 수량
					UC2.put("DAT10",(String) pData.get("Col27")); //D+10 DAY 수량		
					UC2.put("DAT11",(String) pData.get("Col28")); //D+11 DAY 수량	
					UC2.put("DAT12",(String) pData.get("Col29")); //D+12 DAY 수량
					UC2.put("REMQY",(String) pData.get("Col30")); //이후투입수량
					UC2.put("OKQTY",(String) pData.get("Col31")); //확정수량
					UC2.put("MITQY",(String) pData.get("Col32")); //MITU
					UC2.put("PRSEQ",(String) pData.get("Col33")); //PR-SEQ
					UC2.put("MIQQY",(String) pData.get("Col34")); //당월미반영잔량
					UC2.put("MIOQY",(String) pData.get("Col35")); //차월생산 ORDER량
					UC2.put("GRTOT",(String) pData.get("Col36")); //합계수량
					UC2.put("MOLCD",vCol37); //차종코드	
					UC2.put("SPACE",errCHK); //ERROR여부	
					UC2List.add(UC2);
				}
				comps="";
				pyvnd="";
				pspno="";
			}
		}
		//dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE324UC_1", UC1List);
		map.addAttribute("ds_SVHE324UC_2", UC2List);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void insertSVHE324UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE324UC");
		List pList_CD = DataConverter.getMiPlatformMultiData(pReq, "ds_DFACD");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		
		Iterator it_i = pList.iterator();
		Iterator it_d = pList_CD.iterator();
		
		String rowType="";
		String empty1="";
		String empty2="";
		dao.startTransaction(); //tr 시작
		//공장코드별 삭제
		while (it_d.hasNext()) { 
			Map pData_CD = (Map) it_d.next();
			pData_CD.put("LIB2", (String)pArg.get("LIB2"));
			dao.deleteData("pssallib.deleteSVHE324UC", pData_CD);
		}
		//data생성
		while (it_i.hasNext()) { 
			Map pData = (Map) it_i.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("PYVND");
			empty2 = (String) pData.get("PSPNO");
			if (empty1 != "" && empty2 != "") {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVHE324UC_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(1)){
						//update 불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND"));
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("DMKCR", pData.get("DMKCR"));
						errMap.put("DSECD", pData.get("DSECD"));
						errMap.put("DSENO", pData.get("DSENO"));
						errMap.put("DFACD", pData.get("DFACD"));
						errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.insertData("pssallib.insertSVHE324UC", pData);
					}
				}
			}
		}
		// SW003 Start 업체부품구성마스터에의한 구성품번 추가-------------
		HashMap pKey = new HashMap();
		pKey.put("LIB2", (String)pArg.get("LIB2"));
		dao.insertData("pssallib.insertSVHE324UC_ADD", pKey);
		// SW003 End ---------------------------------------------
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE324UC_CHECK", errList);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	
	public void insertSVHE304UC_1(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE304UC_0");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List UC1List = new ArrayList(); //정상 dataset return
		List UC2List = new ArrayList(); //error dataset return
		Iterator it = pList.iterator();
		
		String pyvnd="";
		String comps="";
		String pspno="";
		String carcd="";
		String bdycd="";
		String errCHK ="";
		
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMPS", (String)pArg.get("COMPS"));
			String vdumcd=(String)pData.get("VDUMCD");
			String vdumym=vdumcd.substring(2,10);
			//String vdumfc=(String)pArg.get("VDUMFC");
			String vvndno=(String)pData.get("VVNDNO");
			String vfacgu=(String)pData.get("VFACGU");
			String vpatnot=(String)pData.get("VPATNO");
			String vpatno1= vpatnot.substring(0,5);
			String vpatno2= vpatnot.substring(5,18);
			String vpatno= vpatno1+"-"+vpatno2;
			String vcurjg=(String)pData.get("VCURJG");
			String vsiljg=(String)pData.get("VSILJG");
			String vbefsl=(String)pData.get("VBEFSL");
			String napcd="AA";
			String vnabcd=(String)pData.get("VNABCD");
			
			HashMap pKey1 = new HashMap();
			pKey1.put("LIB2", (String)pArg.get("LIB2"));
			pKey1.put("P_VNDCD", vvndno);
			pKey1.put("P_FACCD", vfacgu);
			Map getSVM020PF = (Map)dao.getReadData("pscomlib.selectSVM020PF",pKey1);
			if(getSVM020PF!=null && getSVM020PF.get("PSVND")!=null && !getSVM020PF.get("PSVND").equals("")){
				comps = (String) getSVM020PF.get("PSCOM");
				pyvnd = (String) getSVM020PF.get("PSVND").toString();
				
				HashMap pKey2 = new HashMap();
				pKey2.put("LIB1", (String)pArg.get("LIB1"));
				pKey2.put("P_CUSNO", pyvnd);
				pKey2.put("P_CPRTN", vpatno);
				pKey2.put("P_EDATM", (String)pArg.get("EDATM"));
				List list = dao.getListData("pscomlib.selectCGMPARMBB", pKey2);
				Map getCGMPARMBB = (Map)dao.getReadData("pscomlib.selectCGMPARMBB",pKey2);
				if(getCGMPARMBB!=null && getCGMPARMBB.get("PRTNO")!=null && !getCGMPARMBB.get("PRTNO").equals("")){
					pspno = (String) getCGMPARMBB.get("PRTNO");
					HashMap pKey3 = new HashMap();
					pKey3.put("LIB2", (String)pArg.get("LIB2"));
					pKey3.put("COMPS", comps);
					pKey3.put("PRTNO", pspno);
					Map getMST100PF = (Map)dao.getReadData("pscomlib.selectMST100PF",pKey3);
					if(getMST100PF!=null && getMST100PF.get("CARCD")!=null && !getMST100PF.get("CARCD").equals("")){
						carcd = (String) getMST100PF.get("CARCD");
						bdycd = (String) getMST100PF.get("BDYCD");
					}else{
						carcd ="";
						bdycd ="";
					}
					errCHK ="T"; // 정상
				}else{
					comps="";
					pyvnd="";
					pspno="";
					errCHK ="1"; //OEM품번 미매칭
				}
			}else{
				comps="";
				pyvnd="";
				pspno="";
				errCHK ="3"; //HKMC공장코드error
			}
			if(errCHK=="T"){
				HashMap UC1 = new HashMap();
				UC1.put("COMPS", comps);    //사업부
				UC1.put("PYVND", pyvnd);    //업체코드
				UC1.put("PSPNO", pspno);    //풍성품번
				UC1.put("NAPCD", napcd);    //납품장소
				UC1.put("CARCD", carcd);    //풍성차종
				UC1.put("BDYCD", bdycd);    //풍성규격
				UC1.put("MKPNO", vpatno);    //업체품번
				UC1.put("DOCCD", vdumcd);    //문서번호
				UC1.put("STDDT", vdumym);    //문서일자
				UC1.put("PLNCD", vfacgu);    //공장구분
				UC1.put("PATNO", vpatnot);    //PART NUMBER
				UC1.put("CURJGR", (String) pData.get("VCURJG"));    //현　재　고
				UC1.put("BEFSLR", (String) pData.get("VBEFSL"));    //전일　실적
				UC1.put("D00QYR", (String) pData.get("V0TOTA"));    //Ｄ００계획
				UC1.put("D01QYR", (String) pData.get("V1TOTA"));    //Ｄ０１계획
				UC1.put("D02QYR", (String) pData.get("V2TOTA"));    //Ｄ０２계획
				UC1.put("D03QYR", (String) pData.get("V3TOTA"));    //Ｄ０３계획
				UC1.put("D04QYR", (String) pData.get("V4TOTA"));    //Ｄ０４계획
				UC1.put("D05QYR", (String) pData.get("V5TOTA"));    //Ｄ０５계획
				UC1.put("D06QYR", (String) pData.get("V6TOTA"));    //Ｄ０６계획
				UC1.put("D07QYR", (String) pData.get("V7TOTA"));    //Ｄ０７계획
				UC1.put("D08QYR", (String) pData.get("V8TOTA"));    //Ｄ０８계획
				UC1.put("D09QYR", (String) pData.get("V9TOTA"));    //Ｄ０９계획
				UC1.put("D10QYR", (String) pData.get("VATOTA"));    //Ｄ１０계획
				UC1.put("D11QYR", (String) pData.get("VBTOTA"));    //Ｄ１１계획
				UC1.put("D12QYR", (String) pData.get("VCTOTA"));    //Ｄ１２계획
				UC1.put("D13QYR", (String) pData.get("VDTOTA"));    //Ｄ１３계획
				UC1.put("D14QYR", (String) pData.get("VETOTA"));    //Ｄ１４계획
				UC1.put("D15QYR", (String) pData.get("VFTOTA"));    //Ｄ１５계획
				UC1.put("D16QYR", (String) pData.get("VGTOTA"));    //Ｄ１６계획
				UC1.put("D17QYR", (String) pData.get("VHTOTA"));    //Ｄ１７계획
				UC1.put("D18QYR", (String) pData.get("VITOTA"));    //Ｄ１８계획
				UC1.put("D19QYR", (String) pData.get("VJTOTA"));    //Ｄ１９계획
				UC1.put("D20QYR", (String) pData.get("VKTOTA"));    //Ｄ２０계획
				UC1.put("D21QYR", (String) pData.get("VLTOTA"));    //Ｄ２１계획
				UC1.put("D22QYR", (String) pData.get("VMTOTA"));    //Ｄ２２계획
				UC1.put("D23QYR", (String) pData.get("VNTOTA"));    //Ｄ２３계획
				UC1.put("D24QYR", (String) pData.get("VOTOTA"));    //Ｄ２４계획
				UC1.put("D25QYR", (String) pData.get("VPTOTA"));    //Ｄ２５계획
				UC1.put("D26QYR", (String) pData.get("VQTOTA"));    //Ｄ２６계획
				UC1.put("D27QYR", (String) pData.get("VRTOTA"));    //Ｄ２７계획
				UC1.put("D28QYR", (String) pData.get("VSTOTA"));    //Ｄ２８계획
				UC1.put("D29QYR", (String) pData.get("VTTOTA"));    //Ｄ２９계획
				UC1.put("D30QYR", (String) pData.get("VUTOTA"));    //Ｄ３０계획
				UC1.put("D31QYR", (String) pData.get("VVTOTA"));    //D31-45계획
				UC1.put("DUEINR", (String) pData.get("VUEINR"));    //발주　잔량
				UC1.put("NABCD", vnabcd);    //납입　유형
				UC1List.add(UC1);
			}else{
				HashMap UC2 = new HashMap();
				UC2.put("COMPS", comps);    //사업부
				UC2.put("PYVND", pyvnd);    //업체코드
				UC2.put("PSPNO", pspno);    //풍성품번
				UC2.put("NAPCD", napcd);    //납품장소
				UC2.put("CARCD", carcd);    //풍성차종
				UC2.put("BDYCD", bdycd);    //풍성규격
				UC2.put("MKPNO", vpatno);    //업체품번
				UC2.put("DOCCD", vdumcd);    //문서번호
				UC2.put("STDDT", vdumym);    //문서일자
				UC2.put("PLNCD", vfacgu);    //공장구분
				UC2.put("PATNO", vpatnot);    //PART NUMBER
				UC2.put("CURJGR", (String) pData.get("VCURJG"));    //현　재　고
				UC2.put("BEFSLR", (String) pData.get("VBEFSL"));    //전일　실적
				UC2.put("D00QYR", (String) pData.get("V0TOTA"));    //Ｄ００계획
				UC2.put("D01QYR", (String) pData.get("V1TOTA"));    //Ｄ０１계획
				UC2.put("D02QYR", (String) pData.get("V2TOTA"));    //Ｄ０２계획
				UC2.put("D03QYR", (String) pData.get("V3TOTA"));    //Ｄ０３계획
				UC2.put("D04QYR", (String) pData.get("V4TOTA"));    //Ｄ０４계획
				UC2.put("D05QYR", (String) pData.get("V5TOTA"));    //Ｄ０５계획
				UC2.put("D06QYR", (String) pData.get("V6TOTA"));    //Ｄ０６계획
				UC2.put("D07QYR", (String) pData.get("V7TOTA"));    //Ｄ０７계획
				UC2.put("D08QYR", (String) pData.get("V8TOTA"));    //Ｄ０８계획
				UC2.put("D09QYR", (String) pData.get("V9TOTA"));    //Ｄ０９계획
				UC2.put("D10QYR", (String) pData.get("VATOTA"));    //Ｄ１０계획
				UC2.put("D11QYR", (String) pData.get("VBTOTA"));    //Ｄ１１계획
				UC2.put("D12QYR", (String) pData.get("VCTOTA"));    //Ｄ１２계획
				UC2.put("D13QYR", (String) pData.get("VDTOTA"));    //Ｄ１３계획
				UC2.put("D14QYR", (String) pData.get("VETOTA"));    //Ｄ１４계획
				UC2.put("D15QYR", (String) pData.get("VFTOTA"));    //Ｄ１５계획
				UC2.put("D16QYR", (String) pData.get("VGTOTA"));    //Ｄ１６계획
				UC2.put("D17QYR", (String) pData.get("VHTOTA"));    //Ｄ１７계획
				UC2.put("D18QYR", (String) pData.get("VITOTA"));    //Ｄ１８계획
				UC2.put("D19QYR", (String) pData.get("VJTOTA"));    //Ｄ１９계획
				UC2.put("D20QYR", (String) pData.get("VKTOTA"));    //Ｄ２０계획
				UC2.put("D21QYR", (String) pData.get("VLTOTA"));    //Ｄ２１계획
				UC2.put("D22QYR", (String) pData.get("VMTOTA"));    //Ｄ２２계획
				UC2.put("D23QYR", (String) pData.get("VNTOTA"));    //Ｄ２３계획
				UC2.put("D24QYR", (String) pData.get("VOTOTA"));    //Ｄ２４계획
				UC2.put("D25QYR", (String) pData.get("VPTOTA"));    //Ｄ２５계획
				UC2.put("D26QYR", (String) pData.get("VQTOTA"));    //Ｄ２６계획
				UC2.put("D27QYR", (String) pData.get("VRTOTA"));    //Ｄ２７계획
				UC2.put("D28QYR", (String) pData.get("VSTOTA"));    //Ｄ２８계획
				UC2.put("D29QYR", (String) pData.get("VTTOTA"));    //Ｄ２９계획
				UC2.put("D30QYR", (String) pData.get("VUTOTA"));    //Ｄ３０계획
				UC2.put("D31QYR", (String) pData.get("VVTOTA"));    //D31-45계획
				UC2.put("DUEINR", (String) pData.get("VUEINR"));    //발주　잔량
				UC2.put("NABCD", vnabcd);    //납입　유형	
				UC2List.add(UC2);
				UC2.put("SPACE",errCHK); //ERROR여부	
			}
			comps="";
			pyvnd="";
			
		}
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE304UC_1", UC1List);
		map.addAttribute("ds_SVHE304UC_2", UC2List);
		new MiPlatformView().render(map, request, response);	
	}
	public void insertSVHE304UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE304UC");
		List pList_CD = DataConverter.getMiPlatformMultiData(pReq, "ds_DFACD");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		
		Iterator it_i = pList.iterator();
		Iterator it_d = pList_CD.iterator();
		
		String rowType="";
		String empty1="";
		String empty2="";
		dao.startTransaction(); //tr 시작
		//공장코드별 삭제
		while (it_d.hasNext()) { 
			Map pData_CD = (Map) it_d.next();
			pData_CD.put("LIB2", (String)pArg.get("LIB2"));
			dao.deleteData("pssallib.deleteSVHE304UC", pData_CD);
		}
		//data생성
		while (it_i.hasNext()) { 
			Map pData = (Map) it_i.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("PYVND");
			empty2 = (String) pData.get("PSPNO");
			if (empty1 != "" && empty2 != "") {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVHE304UC_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(1)){
						//INSERT 불가(KEY중복)
						HashMap errMap = new HashMap();
						errMap.put("PYVND", pData.get("PYVND"));
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("MKPNO", pData.get("MKPNO"));
						errMap.put("DOCCD", pData.get("DOCCD"));
						errMap.put("STDDT", pData.get("STDDT"));
						errMap.put("PLNCD", pData.get("PLNCD"));
						errMap.put("PATNO", pData.get("PATNO"));
						errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.insertData("pssallib.insertSVHE304UC", pData);
					}
				}
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE304UC_CHECK", errList);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	public void selectSVHE330Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHE330Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE330Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSVHE340Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHE340Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE340Q", list);
		new MiPlatformView().render(map, request, response);
	}

	public void selectSVHE310Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHE310Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE310Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSVHE320Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHE320Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE320Q", list);
		new MiPlatformView().render(map, request, response);
	}	
	public void selectSVHE300Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHE300Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE300Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSVHE600Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHE600Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE600Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ100UC(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		String grpcode="";
		grpcode="LOC";
		HashMap pKey1 = new HashMap();
		pKey1.put("LIB2", (String)pData.get("LIB2"));
		pKey1.put("COMPS", (String)pData.get("COMPS"));
		pKey1.put("GRPCD", grpcode);
		List list1 = dao.getListData("pscomlib.selectMST050PF", pKey1);
		grpcode="SLC";
		HashMap pKey2 = new HashMap();
		pKey2.put("LIB2", (String)pData.get("LIB2"));
		pKey2.put("COMPS", (String)pData.get("COMPS"));
		pKey2.put("GRPCD", grpcode);
		List list2 = dao.getListData("pscomlib.selectMST050PF", pKey2);
		grpcode="USE";
		HashMap pKey3 = new HashMap();
		pKey3.put("LIB2", (String)pData.get("LIB2"));
		pKey3.put("COMPS", (String)pData.get("COMPS"));
		pKey3.put("GRPCD", grpcode);
		List list3 = dao.getListData("pscomlib.selectMST050PF", pKey3);
		grpcode="TRN";
		HashMap pKey5 = new HashMap();
		pKey5.put("LIB2", (String)pData.get("LIB2"));
		pKey5.put("COMPS", (String)pData.get("COMPS"));
		pKey5.put("GRPCD", grpcode);
		List list5 = dao.getListData("pscomlib.selectMST050PF", pKey5);
		HashMap pKey4 = new HashMap();
		pKey4.put("LIB2", (String)pData.get("LIB2"));
		pKey4.put("VNDOR_5LIKE", "5");
		List list4 = dao.getListData("pscomlib.selectMST600PF", pKey4);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_MST050_MKLOC", list1);
		map.addAttribute("ds_MST050_CARSQ", list2);
		map.addAttribute("ds_MST050_USEGB", list3);
		map.addAttribute("ds_MST600_DRVPN", list4);
		map.addAttribute("ds_MST050_TRNCD", list5);
		new MiPlatformView().render(map, request, response);
	}
	public void insertSLTZ100UC(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SEND");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();// error check list
		List lntnoList = new ArrayList();// insert시 lntno번호 넘겨주기
		Iterator it = pList.iterator();
		//Iterator it_iu = pList.iterator();
		String p_lntno="";
		String rowType="";
		String empty1="";
		String empty2="";
		String empty3="";
		int maxLNTNO;

		dao.startTransaction(); //tr 시작		
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("COMPS",(String)pArg.get("COMPS"));
			//p_lntno = (String)pArg.get("LNTNO");
			pData.put("MAJCD", "LNTNO");
			Map MaxMapLNTNO = (Map)dao.getReadData("pscomlib.selectMST040PF",pData);
			//System.out.println(MaxMapLNTNO.get("MJINT")+" 11111");
			maxLNTNO = Integer.parseInt(MaxMapLNTNO.get("MJINT").toString()) + 1;
			//System.out.println(maxLNTNO);
			pData.put("LNTNO", maxLNTNO);
			pData.put("INOUT",(String)pArg.get("INOUT"));
			pData.put("EXPCD",(String)pArg.get("EXPCD"));
			pData.put("CFMCD",(String)pArg.get("CFMCD"));
			pData.put("SHPTO","0");
			Map CheckCnt = (Map)dao.getReadData("pssallib.selectSLTZ100_Check",pData);
			if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
				if(CheckCnt.get("CNT").equals(1)){
					//insert 불가(이미등록된 자료)
					HashMap errMap = new HashMap();
					errMap.put("LNTNO", maxLNTNO);
					errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
					errList.add(errMap);
				}else{
					//TX저장
					dao.insertData("pssallib.insertSLTZ100UC", pData);
					//발행번호 저장(MST040PF)
					HashMap pKey1 = new HashMap();
					pKey1.put("LIB2", (String)pData.get("LIB2"));
					pKey1.put("COMPS", (String)pData.get("COMPS"));
					pKey1.put("MAJCD", "LNTNO");
					pKey1.put("MJINT", maxLNTNO);
					dao.updateData("pscomlib.updateMST040", pKey1);
					//전표번호저장(SLT110PF)
					String p_jpsno1="";
					String p_EXPCD="";
					p_jpsno1 = (String)pData.get("JPSNO1");
					p_EXPCD = (String)pData.get("EXPCD");
					//System.out.println(p_jpsno1);
					HashMap pKey = new HashMap();
					pKey.put("LIB2", (String)pData.get("LIB2"));
					pKey.put("COMPS", (String)pData.get("COMPS"));
					pKey.put("LNTNO", maxLNTNO);
					pKey.put("INOUT", (String)pData.get("INOUT"));
					pKey.put("EXPCD", (String)pData.get("EXPCD"));
					pKey.put("JPSNO1", (String)pData.get("JPSNO1"));
					pKey.put("JPSNO2", (String)pData.get("JPSNO2"));
					pKey.put("JPSNO3", (String)pData.get("JPSNO3"));
					pKey.put("JPSNO4", (String)pData.get("JPSNO4"));
					pKey.put("JPSNO5", (String)pData.get("JPSNO5"));
					pKey.put("JPSNO6", (String)pData.get("JPSNO6"));
					pKey.put("BOXQY1", "0");
					pKey.put("BOXQY2", "0");
					pKey.put("BOXQY3", "0");
					pKey.put("BOXQY4", "0");
					pKey.put("BOXQY5", "0");
					pKey.put("BOXQY6", "0");
					HashMap pKeyL = new HashMap();
					pKeyL.put("LIB2", (String)pData.get("LIB2"));
					pKeyL.put("COMPS", (String)pData.get("COMPS"));
					pKeyL.put("LNTNO", maxLNTNO);
					pKeyL.put("INOUT", "1");
					pKeyL.put("EXPCD", (String)pData.get("EXPCD"));
					pKeyL.put("JPSNO1", "L000001");
					pKeyL.put("BOXQY1", "0");
					//System.out.println(p_EXPCD);
					if (p_EXPCD.equals("Y")) {
						dao.insertData("pssallib.insertSLTZ100_110", pKey);
						dao.insertData("pssallib.insertSLTZ100_110", pKeyL);
					}
					
					//HashMap lntnoMap = new HashMap();
					//lntnoMap.put("LNTNO", maxLNTNO);
					//lntnoList.add(lntnoMap);
					
				}
			}
		}
		
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SLTZ100UC_CHECK", errList);//추가
		//map.addAttribute("ds_SLTZ100_LNTNO", lntnoList);//
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSLTZ100UCxxx(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SEND");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it = pList.iterator();
		List errList = new ArrayList();
		String MKLOC="";
		String CARSQ="";
		String USEGB="";
		//String TRNCD="";
		//String DRVPN="";
		String grpcode="";
		String errcode="";
		int errRow=0;
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			MKLOC = (String) pData.get("MKLOC");
			CARSQ = (String) pData.get("CARSQ");
			USEGB = (String) pData.get("USEGB");
			//TRNCD = (String) pData.get("TRNCD");
			//DRVPN = (String) pData.get("DRVPN");
			grpcode="LOC";
			HashMap pKey1 = new HashMap();
			pKey1.put("LIB2", (String)pArg.get("LIB2"));
			pKey1.put("COMPS", (String)pArg.get("COMPS"));
			pKey1.put("GRPCD", grpcode);
			pKey1.put("MSTCD", MKLOC);
			Map CheckMKLOC = (Map)dao.getReadData("pscomlib.selectMST050PF",pKey1);
			if(CheckMKLOC==null || CheckMKLOC.get("GRPCD")==null || CheckMKLOC.get("GRPCD").equals("")){
				errcode = "1"; //납품장소err
			}else{
				errcode = "T"; //정상
			}
			
			grpcode="SLC";
			HashMap pKey2 = new HashMap();
			pKey2.put("LIB2", (String)pArg.get("LIB2"));
			pKey2.put("COMPS", (String)pArg.get("COMPS"));
			pKey2.put("GRPCD", grpcode);
			pKey2.put("MSTCD", CARSQ);
			Map CheckCARSQ = (Map)dao.getReadData("pscomlib.selectMST050PF",pKey2);
			if(CheckCARSQ==null || CheckCARSQ.get("GRPCD")==null || CheckCARSQ.get("GRPCD").equals("")){
				errcode = "2"; //출발장소err
			}else{
				errcode = "T"; //정상
			}
			
			grpcode="USE";
			HashMap pKey3 = new HashMap();
			pKey3.put("LIB2", (String)pArg.get("LIB2"));
			pKey3.put("COMPS", (String)pArg.get("COMPS"));
			pKey3.put("GRPCD", grpcode);
			pKey3.put("MSTCD", USEGB);
			Map CheckUSEGB = (Map)dao.getReadData("pscomlib.selectMST050PF",pKey3);
			if(CheckUSEGB==null || CheckUSEGB.get("GRPCD")==null || CheckUSEGB.get("GRPCD").equals("")){
				errcode = "3"; //운행구분err
			}else{
				errcode = "T"; //정상
			}
			errRow = errRow+1;
			if(errcode != "T"){
				HashMap errMap = new HashMap();
				errMap.put("MKLOC", MKLOC); 
				errMap.put("CARSQ", CARSQ);
				errMap.put("USEGB", USEGB);
				errMap.put("UPERR", errcode);
				errMap.put("ROWER", errRow);
				errList.add(errMap);
			}
		}
		ModelMap map = new ModelMap();
		map.addAttribute("ds_RECEIVE", errList);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 출하정보 TABLE 마스타 
	 * @exception 
	 * @see 
	 * 	- 2012-11-26	:	김정현
	***********************************************************************/ 
	public void selectSALE160(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALE160", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALE160", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void saveSALE160(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq 	= new PlatformRequest(request);
		pReq.receiveData();	
		
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SALE160");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyMAKCR="";
		String emptyIMFDT="";
		List errList = new ArrayList();// error check list
		
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SALE160");
		//////////////////////////////////////////////////////////////
		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyMAKCR = (String) pData.get("MAKCR");
			emptyIMFDT = (String) pData.get("IMFDT");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyMAKCR != "" || emptyIMFDT != "") {				
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE160_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MAKCR", pData.get("MAKCR"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSALE160", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyMAKCR = (String) pData.get("MAKCR");
			emptyIMFDT = (String) pData.get("IMFDT");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyMAKCR != "" && emptyIMFDT != "") {				
				if ("insert".equals(rowType)) {					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE160_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("MAKCR", pData.get("MAKCR"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSALE160", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_MAKCR", ds.getOrgBuffColumn(0, "MAKCR").getString());					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE160_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MAKCR", pData.get("MAKCR"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSALE160", pData);
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SALE160_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);		
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  업체부품구성 마스타 조회
	 * @exception 
	 * @see 
	 * 	- 2012-11-26	:	김정현
	***********************************************************************/ 
	public void selectSVZE051Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE051Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE051Q", list);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  업체재고마스타 조회
	 * @exception 
	 * @see 
	 * 	- 2012-11-26	:	김정현
	***********************************************************************/ 
	public void selectSALE200(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALE200", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALE200", list);
		new MiPlatformView().render(map, request, response);
	}	
/*	
	public void selectSALE200_IUD(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALE200_IUD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALE200_IUD", list);
		new MiPlatformView().render(map, request, response);
	}
*/	
	public void saveSALE200(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request);
		pReq.receiveData();	
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SALE200");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPSPNO="";
		String chkFLAG="";
		
		List errList = new ArrayList();// error check list
		
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SALE200");
		//////////////////////////////////////////////////////////////
		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPSPNO = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPSPNO != "" ) {				
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE200_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSALE200", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next(); 
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("TFLAG", (String)pArg.get("TFLAG"));
			emptyPSPNO = (String) pData.get("PSPNO");
			chkFLAG = (String) pData.get("TFLAG");
//System.out.print("=="+chkFLAG+"==");		
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPSPNO != "" ) {				
				if ("update".equals(rowType) && "add".equals(chkFLAG)) {
//System.out.print("==insert==");		
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE200_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSALE200", pData);
						}
					}
				} else if ("update".equals(rowType) && "sel".equals(chkFLAG)) {
//System.out.print("==update==");		
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE200_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSALE200", pData);
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SALE200_CHECK", errList);//추가
		new MiPlatformView().render(map, request, response);		
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 업체재고마스타（차종별）　등록
	 * @exception 
	 * @see 
	 * 	- 2012-11-26	:	김정현
	***********************************************************************/ 
	public void selectSALE201(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALE201", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALE201", list);
		new MiPlatformView().render(map, request, response);
	}
	//수정만 가능함.
	public void saveSALE201(HttpServletRequest request, HttpServletResponse response) throws Exception {
	PlatformRequest pReq 	= new PlatformRequest(request);
	pReq.receiveData();	
	List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SALE201");
	Map pArg = DataConverter.getMiPlatformData(pReq);
	Iterator it_d = pList.iterator();
	Iterator it_iu = pList.iterator();
	String rowType="";
	String emptyPSPNO="";
	List errList = new ArrayList();// error check list

	dao.startTransaction(); //tr 시작		
/*
	while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
		Map pData = (Map) it_d.next();
		pData.put("LIB1", (String)pArg.get("LIB1"));
		pData.put("LIB2", (String)pArg.get("LIB2"));
		emptyPSPNO = (String) pData.get("PSPNO");
		rowType = (String) pData.get("ROW_TYPE");
		if (emptyPSPNO != "") {				
			if ("delete".equals(rowType)) {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE201_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(0)){
						//삭제불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.deleteData("pssallib.deleteSALE201" , pData);
					}
				}
			}
		}
	}
*/	
	while (it_iu.hasNext()) {
		Map pData = (Map) it_iu.next();
		pData.put("LIB1", (String)pArg.get("LIB1"));
		pData.put("LIB2", (String)pArg.get("LIB2"));
		emptyPSPNO = (String) pData.get("PSPNO");
		rowType = (String) pData.get("ROW_TYPE");
		if (emptyPSPNO != "") {
			/*
			if ("insert".equals(rowType)) {					
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE201_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(1)){
						//insert 불가(대상이 있음)
						HashMap errMap = new HashMap();
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.insertData("pssallib.insertSALE201" , pData);
					}
				}
			} else
			*/ if ("update".equals(rowType)) {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSALE201_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					if(CheckCnt.get("CNT").equals(0)){
						//update 불가(대상이 없음)
						HashMap errMap = new HashMap();
						errMap.put("PSPNO", pData.get("PSPNO"));
						errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
						errList.add(errMap);
					}else{
						dao.updateData("pssallib.updateSALE201" , pData);
					}
				}
			}				
		}       
	}      
	dao.endTransaction(); //commit
	ModelMap map = new ModelMap();//추가
	map.addAttribute("ds_SALE201_CHECK", errList);//추가
	//new MiPlatformView().render(null, request, response);
	new MiPlatformView().render(map, request, response);		
	}	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 업체재고마스타（차종별）　등록
	 * @exception 
	 * @see 
	 * 	- 2012-11-26	:	김정현
	***********************************************************************/ 
	public void selectSVME010(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVME010", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVME010", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void saveSVME010(HttpServletRequest request, HttpServletResponse response) throws Exception {

		PlatformRequest pReq 	= new PlatformRequest(request);
		pReq.receiveData();	
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVME010");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyNAPCD="";
		List errList = new ArrayList();// error check list
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVME010");
		//////////////////////////////////////////////////////////////
		dao.startTransaction(); //tr 시작
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyNAPCD = (String) pData.get("NAPCD");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyNAPCD != "") {				
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVME010_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("NAPCD", pData.get("NAPCD"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSVME010" , pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyNAPCD = (String) pData.get("NAPCD");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyNAPCD != "") {
				if ("insert".equals(rowType)) {					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVME010_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("NAPCD", pData.get("NAPCD"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSVME010" , pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_NAPCD", ds.getOrgBuffColumn(0, "NAPCD").getString());
					pData.put("OLD_NAPDS", ds.getOrgBuffColumn(0, "NAPDS").getString());
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVME010_CHK2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("NAPCD", pData.get("OLD_NAPCD"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSVME010_CHK",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("NAPCD", pData.get("NAPCD"));
									errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.updateData("pssallib.updateSVME010" , pData);
								}
							}
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SVME010_CHECK", errList);//추가
		new MiPlatformView().render(map, request, response);		
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 업체재고마스타（차종별）　등록
	 * @exception 
	 * @see 
	 * 	- 2012-11-26	:	김정현
	***********************************************************************/ 
	public void selectSVZE050(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE050", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE050", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSVZE050_DETAIL(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE050_DETAIL", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE050_DETAIL", list);
		new MiPlatformView().render(map, request, response);
	}
	public void saveSVZE050(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq 	= new PlatformRequest(request);
		pReq.receiveData();	
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVZE050_DETAIL");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyCINBR="";
		List errList = new ArrayList();// error check list
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVZE050_DETAIL");
		//////////////////////////////////////////////////////////////
		dao.startTransaction(); //tr 시작
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyCINBR = (String) pData.get("CINBR");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyCINBR != "") {				
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE050_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("CINBR", pData.get("CINBR"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSVZE050" , pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyCINBR = (String) pData.get("CINBR");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyCINBR != "") {	
				if ("insert".equals(rowType)) {					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE050_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("CINBR", pData.get("CINBR"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSVZE050" , pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_CINBR", ds.getOrgBuffColumn(0, "CINBR").getString());
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE050_CHK2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("CINBR", pData.get("OLD_CINBR"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSVZE050_CHK",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("CINBR", pData.get("CINBR"));
									errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.updateData("pssallib.updateSVZE050" , pData);
								}
							}
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SVZE050_CHECK", errList);//추가
		new MiPlatformView().render(map, request, response);		
	}
/*	김정현s
	public void selectSVZE050_MST(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE050_MST", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE050_MST", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSVZE050_IUD(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE050_IUD", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE050_IUD", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void saveSVZE050_IUD(HttpServletRequest request, HttpServletResponse response) throws Exception {
		
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		
		//추가, 삭제, 업데이트 중 하나가 발생한 데이터만 해당 Dataset에서 취득
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVZE050_IUD");
		
		//변수 저장 MAP 취득
		Map pMap = DataConverter.getMiPlatformData(pReq);
		
		//변수취득		
		String pyvnd = (String)pMap.get("PYVND");	
		String pspno = (String)pMap.get("PSPNO");
		String comps = (String)pMap.get("COMPS");
		
		//취득한 변경발생된 데이터를 루프
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType = "";
		
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVZE050_IUD");
		//////////////////////////////////////////////////////////////		
		
		dao.startTransaction();
		while (it_d.hasNext()) {			
			Map pData = (Map) it_d.next();
	        //공장코드는 DB에 들어가지만 DATASET에 없기에 변수로 받아서 ROW의 테이터들과 같은 곳에 해당키값으로 저장						

			pData.put("PYVND", pyvnd);
			pData.put("COMPS", comps);
			pData.put("PSPNO", pspno);			
			
	        //DATASET의 숨겨진 칼럼인 ROW타입을 판단 
			rowType = (String) pData.get("ROW_TYPE");			
			if ("delete".equals(rowType)) {
				dao.deleteData("pssallib.deleteSVZE050" , pData);
			}
		}
		while (it_iu.hasNext()) {			
			Map pData = (Map) it_iu.next();
	        //공장코드는 DB에 들어가지만 DATASET에 없기에 변수로 받아서 ROW의 테이터들과 같은 곳에 해당키값으로 저장						
			
			pData.put("PYVND", pyvnd);
			pData.put("COMPS", comps);
			pData.put("PSPNO", pspno);			
			
	        //DATASET의 숨겨진 칼럼인 ROW타입을 판단 
			rowType = (String) pData.get("ROW_TYPE");			
			if ("insert".equals(rowType)) {
				dao.insertData("pssallib.insertSVZE050" , pData);
			} else if ("update".equals(rowType)) {				
				dao.updateData("pssallib.updateSVZE050" , pData);
			}
		}		
		dao.endTransaction();
		new MiPlatformView().render(null, request, response);			
	}
*/	
	public void selectSVZE030(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE030", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE030", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void saveSVZE030(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq 	= new PlatformRequest(request);
		pReq.receiveData();	
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVZE030");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPYVNO="";
		List errList = new ArrayList();// error check list
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVZE030");
		//////////////////////////////////////////////////////////////
		dao.startTransaction(); //tr 시작
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPYVNO = (String) pData.get("PYVNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPYVNO != "") {				
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE030_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PYVNO", pData.get("PYVNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSVZE030" , pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPYVNO = (String) pData.get("PYVNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPYVNO != "") {	
				if ("insert".equals(rowType)) {					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE030_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("PYVNO", pData.get("PYVNO"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSVZE030" , pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_PYVNO", ds.getOrgBuffColumn(0, "PYVNO").getString());
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE030_CHK2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PYVNO", pData.get("OLD_PYVNO"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSVZE030_CHK",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("PYVNO", pData.get("PYVNO"));
									errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.updateData("pssallib.updateSVZE030" , pData);
								}
							}
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SVZE030_CHECK", errList);//추가
		new MiPlatformView().render(map, request, response);		
	}
	public void selectSVME300(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVME300", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVME300", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void saveSVME300(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List errList = new ArrayList();// error check list
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVME300");
		Map pArg = DataConverter.getMiPlatformData(pReq);
	
		String emptyMKCAR="";
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType = "";

		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVME300");
		//////////////////////////////////////////////////////////////
		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyMKCAR = (String) pData.get("MKCAR");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyMKCAR != ""){	
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVME300_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKCAR", pData.get("MKCAR"));
							errMap.put("SEYNO", pData.get("SEYNO"));
							errMap.put("SEYCD", pData.get("SEYCD"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSVME300", pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyMKCAR = (String) pData.get("MKCAR");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyMKCAR != "") {
				if ("insert".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVME300_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("MKCAR", pData.get("MKCAR"));
							errMap.put("SEYNO", pData.get("SEYNO"));
							errMap.put("SEYCD", pData.get("SEYCD"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt3 = (Map)dao.getReadData("pssallib.selectSVME300_SVM100CHK",pData);
							if(CheckCnt3!=null && CheckCnt3.get("CNT")!=null && !CheckCnt3.get("CNT").equals("")){
								if(CheckCnt3.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("MKCAR", pData.get("MKCAR"));
									errMap.put("SEYNO", pData.get("SEYNO"));
									errMap.put("SEYCD", pData.get("SEYCD"));
									errMap.put("RTMSG", "추가불가(업체서열차종마스터에 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.insertData("pssallib.insertSVME300", pData);
								}
							}
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_MKCAR", ds.getOrgBuffColumn(0, "MKCAR").getString());					
					pData.put("OLD_SEYNO", ds.getOrgBuffColumn(0, "SEYNO").getString());
					pData.put("OLD_SEYCD", ds.getOrgBuffColumn(0, "SEYCD").getString());
					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVME300_CHK2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("MKCAR", pData.get("OLD_MKCAR"));
							errMap.put("SEYNO", pData.get("OLD_SEYNO"));
							errMap.put("SEYCD", pData.get("OLD_SEYCD"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSVME300_CHK",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("MKCAR", pData.get("MKCAR"));
									errMap.put("SEYNO", pData.get("SEYNO"));
									errMap.put("SEYCD", pData.get("SEYCD"));
									errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									Map CheckCnt3 = (Map)dao.getReadData("pssallib.selectSVME300_SVM100CHK",pData);
									if(CheckCnt3!=null && CheckCnt3.get("CNT")!=null && !CheckCnt3.get("CNT").equals("")){
										if(CheckCnt3.get("CNT").equals(1)){
											//update 불가(대상이 없음)
											HashMap errMap = new HashMap();
											errMap.put("MKCAR", pData.get("MKCAR"));
											errMap.put("SEYNO", pData.get("SEYNO"));
											errMap.put("SEYCD", pData.get("SEYCD"));
											errMap.put("RTMSG", "추가불가(업체서열차종마스터에 등록된 자료입니다.)");
											errList.add(errMap);
										}else{
											dao.updateData("pssallib.updateSVME300", pData);
										}
									}									
								}
							}
						}
					}
				}					
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SVME300_CHECK", errList);//추가
		new MiPlatformView().render(map, request, response);		
}
	
	public void selectSVZE040(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZE040", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZE040", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	public void saveSVZE040(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq 	= new PlatformRequest(request);
		pReq.receiveData();	
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVZE040");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPSPNO="";
		List errList = new ArrayList();// error check list
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SVZE040");
		//////////////////////////////////////////////////////////////
		dao.startTransaction(); //tr 시작
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPSPNO = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPSPNO != "") {				
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE040_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSVZE040" , pData);
						}
					}
				}
			}
		}
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPSPNO = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPSPNO != "") {	
				if ("insert".equals(rowType)) {					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE040_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.insertData("pssallib.insertSVZE040" , pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_PSPNO", ds.getOrgBuffColumn(0, "PSPNO").getString());
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVZE040_CHK2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("OLD_PSPNO"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSVZE040_CHK",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("PSPNO", pData.get("PSPNO"));
									errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.updateData("pssallib.updateSVZE040" , pData);
								}
							}
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SVZE040_CHECK", errList);//추가
		new MiPlatformView().render(map, request, response);		
	}
	
	public void selectSVDE301CP(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVDE301CP", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVDE301CP", list);
		new MiPlatformView().render(map, request, response);
	}		
// 김정현
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  D9월검수합격통보서 CHECK LIST
	 * @exception 
	 * @see 
	 * 	- 2012-12-10	:	제환복
	***********************************************************************/ 
	public void selectSVHZ551Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHZ551Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHZ551Q", list);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  모비스 월검수 세금계산서 error LIST
	 * @exception 
	 * @see 
	 * 	- 2012-12-10	:	LSK
	***********************************************************************/ 
	public void selectSVZZ459C_BE(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZZ459C_BE", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZZ459C_450", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSVZZ459C(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZZ459C", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZZ459C", list);
		new MiPlatformView().render(map, request, response);
	}
	
	public void selectSVHC659C_BE(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHC659C_BE", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHC659C_652", list);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  D9월검수 세금계산서 error LIST
	 * @exception 
	 * @see 
	 * 	- 2012-12-10	:	LSK
	***********************************************************************/ 
	public void selectSVZZ559C(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVZZ559C", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZZ559C", list);
		new MiPlatformView().render(map, request, response);
	}	
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- D9월검수세금계산서생성전 CHECK LIST
	 * @exception 
	 * @see 
	 * 	- 2012-12-11	:	제환복
	***********************************************************************/ 
	public void selectSVZZ551Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list1 = dao.getListData("pssallib.selectSVZZ551Q", pData);
		List list2 = dao.getListData("pssallib.selectSVZZ551Q_8", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVZZ551Q", list1);
		map.addAttribute("ds_SVZZ551Q_8", list2);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/HKMC검수관리MENU/D9월검수합격통보서HOST UP(ERP/CKD)
	 * @exception 
	 * @see 
	 * 	- 2013-01-08	:	제환복
	***********************************************************************/ 	
/*
	public void saveSVHZHKMCU(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHZHKMCU_CHK");
		List pListMain = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHZHKMCU");

		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		Iterator it_d = pList.iterator();
		Iterator it_iu = pListMain.iterator();
		String rowType="";

		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			//System.out.println(pData);		
System.out.println("삭제"+"|"+(String)pData.get("FACGU"));

			dao.deleteData("pssallib.deleteSVHZ554U_CHK", pData);
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			String pgmChk = (String)pArg.get("PGMCHK");
			
			Map chkSVM020= (Map)dao.getReadData("pssallib.selectSVHZ554U_CHK1",pData);//svm020pf 업체확인
			String pscom = (String) chkSVM020.get("PSCOM");
			String psvnd = String.valueOf(chkSVM020.get("PSVND")); //java.math.BigDecimal오류
			if (psvnd != "") {//업체코드가  null이 아닌것만 처리함.rpg
				pData.put("COMPS", pscom);
				pData.put("PYVND", psvnd);
				if(pgmChk.equals("SVHZ553U")){
					pData.put("VINPSR", " ");
				}
				Map chkSVZ550 = (Map)dao.getReadData("pssallib.selectSVHZ554U_CHK2",pData);
				String pspno="";
				String pcode="";
				String insInpqy="";
				String insInpam="";
				String insBoxam="";
				String sInpqy="";
				String sInpam="";
				String sBoxam="";
				
				if(chkSVZ550 == null){ //history에 data가없으면 insert 있으면 update
					Map chkEM000PR = (Map)dao.getReadData("pssallib.selectSVHZ554U_CHK3",pData);
					if(chkEM000PR != null){ //ps품번이 null이면 null표시
						pspno = (String) chkEM000PR.get("PRTNO");
						pcode = (String) pData.get("PCODE");
						if(pspno.indexOf(pcode)!=-1){	//POS=%SCAN(PCODE: PRTNO
							pData.put("PSPNO", pspno);	
System.out.println("CASE1 = 정상 :풍성품번존재"+"|"+(String)pData.get("VPATNO"));
							dao.insertData("pssallib.insertSVHZ554U", pData);		
						}else{
							pData.put("PSPNO", "");	
System.out.println("CASE2 = 정상 :품번은있으나 PCODE에러"+"|"+(String)pData.get("VPATNO"));
							dao.insertData("pssallib.insertSVHZ554U", pData);		
						}
					}else{
						pData.put("PSPNO", "");	
System.out.println("CASE3 = 비정상 :풍성품번없음"+"|"+(String)pData.get("VPATNO"));
							dao.insertData("pssallib.insertSVHZ554U", pData);
					}		
				}else{
System.out.println("CASE4 = 업데이트"+"|"+(String)pData.get("VPATNO"));
					insInpqy = String.valueOf(chkSVZ550.get("INPQY"));
					insInpam = String.valueOf(chkSVZ550.get("INPAM"));
					insBoxam = String.valueOf(chkSVZ550.get("BOXAM"));
					sInpqy = String.valueOf(pData.get("VINPQY"));
					sInpam = String.valueOf(pData.get("VINPAM"));
					sBoxam = String.valueOf(pData.get("VBOXAM"));
					long a=  Long.parseLong(insInpqy)+Long.parseLong((sInpqy));
					long b=  Long.parseLong(insInpam)+Long.parseLong((sInpam));
					long c=  Long.parseLong(insBoxam)+Long.parseLong((sBoxam));
					pData.put("VINPQY", a);
					pData.put("VINPAM", b);
					pData.put("VBOXAM", c);
					dao.updateData("pssallib.updateSVHZ554U", pData);
				}
			}else{
System.out.println("CASE5 = 미등록 업체코드X"+"|"+(String)pData.get("VPATNO"));	
			} 
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		new MiPlatformView().render(null, request, response);
	}
*/
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/HKMC검수관리MENU/D9월검수세금계산서생성전 CHECK LIST
	 * @exception 
	 * @see 
	 * 	- 2013-01-08	:	제환복
	***********************************************************************/ 		
	public void saveSVZZ551Q_CHK(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		Map pArg = DataConverter.getMiPlatformData(pReq);

		dao.startTransaction(); //tr 시작
System.out.print("삭제====>"+(String)pArg.get("PYVND")+"=="+(String)pArg.get("SJTYM"));
		dao.deleteData("pssallib.deleteSVZZ551_SVZ110PF", pArg);
System.out.print("등록====>"+(String)pArg.get("PYVND")+"=="+(String)pArg.get("SJTYM"));
		dao.insertData("pssallib.insertSVZZ551_SVZ110PF", pArg);
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		new MiPlatformView().render(null, request, response);
	}	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 월검수세금계산서 TX현황
	 * @exception 
	 * @see 
	 * 	- 2013-01-11	:	제환복
	***********************************************************************/ 
	public void selectSJTZ221Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJTZ221Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJTZ221Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 모비스 월검수현황
	 * @exception 
	 * @see 
	 * 	- 2013-01-11	:	제환복
	***********************************************************************/ 
	public void selectSVHC650Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVHC650Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHC650Q", list);
		new MiPlatformView().render(map, request, response);
	}	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/단가정리전표TX CHECK LIST 
	 * @exception 
	 * @see 
	 * 	- 2013-01-14	:	제환복
	***********************************************************************/ 
	public void selectSCDZ104Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSCDZ104Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SCDZ104Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/월 품번별 적송조회
	 * @exception 
	 * @see 
	 * 	- 2013-01-15	:	제환복
	***********************************************************************/ 
	public void selectSJSZ100Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ100Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ100Q", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSJSZ100Q_SUB(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ100Q_SUB", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ100Q_SUB", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/품번별 적송상세현황
	 * @exception 
	 * @see 
	 * 	- 2013-01-16	:	제환복
	***********************************************************************/ 
	public void selectSJSZ102Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ102Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ102Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/품번별 적송현황
	 * @exception 
	 * @see 
	 * 	- 2013-01-17	:	제환복
	***********************************************************************/ 
	public void selectSJSC103Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSC103Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSC103Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/품번별 적송현황
	 * @exception 
	 * @see 
	 * 	- 2013-01-17	:	제환복
	***********************************************************************/ 
	public void selectSJSZ103Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ103Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ103Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/차종별 적송현황
	 * @exception 
	 * @see 
	 * 	- 2013-01-17	:	제환복
	***********************************************************************/ 
	public void selectSJSZ105Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ105Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ105Q", list);
		new MiPlatformView().render(map, request, response);
	}		
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/품번별 적송 미청산 현황
	 * @exception 
	 * @see 
	 * 	- 2013-01-18	:	제환복
	***********************************************************************/ 
	public void selectSJSZ104Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ104Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ104Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/품벌별 적송 미청산현황 마감전
	 * @exception 
	 * @see 
	 * 	- 2013-01-18	:	제환복
	***********************************************************************/ 

	public void selectSJSZ119Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJSZ119Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJSZ119Q", list);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/업체별 적송 미청산 가마감   
	 * @exception 
	 * @see 
	 * 	- 2013-01-18	:	제환복
	***********************************************************************/ 
	public void selectSJZZ102Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJZZ102Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJZZ102Q", list);
		new MiPlatformView().render(map, request, response);
	}	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/정산관리/단가정리MENU/판매단가와 정산단가 비교 현황
	 * @exception 
	 * @see 
	 * 	- 2013-01-18	:	제환복
	***********************************************************************/ 
	public void selectSJZZ100Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSJZZ100Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SJZZ100Q", list);
		new MiPlatformView().render(map, request, response);
	}		
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/단가정리/단가정리전표 인쇄
	 * @exception 
	 * @see 
	 * 	- 2013-02-25	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
	public void selectSCDZ106R(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSCDZ106R", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SCDZ106R", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  정산관리/단가정리/단가정리전표 조회
	 * @exception 
	 * @see 
	 * 	- 2013-02-25	:	제환복
	***********************************************************************/ 
	@SuppressWarnings("unchecked")
/*
	public void selectSCDZ107Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list=dao.getListData("pssallib.selectSCDZ107Q_SMD116LF", pData);

if(list.isEmpty()){
	System.out.println("null임.");	
	list=dao.getListData("pssallib.selectSCDZ107Q_SCD100PF", pData);
}
else{
	System.out.println("null아님.");	
}
		
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SCDZ107Q", list);
		new MiPlatformView().render(map, request, response);
	}
*/
	public void selectSCDZ107Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list=dao.getListData("pssallib.selectSCDZ107Q", pData);	
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SCDZ107Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 정산관리/단가정리/단가정리전표 TX등록
	 * @exception 
	 * @see
	 * 	- 2012-05-16	:	제환복
	***********************************************************************/ 
	public void selectSCDZ105(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list=dao.getListData("pssallib.selectSCDZ105", pData);	
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SCDZ105", list);
		new MiPlatformView().render(map, request, response);
	}
		
	public void saveSCDZ105(HttpServletRequest request, HttpServletResponse response) throws Exception {				
		PlatformRequest pReq = new PlatformRequest(request);			
		pReq.receiveData();			
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SCDZ105");			
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String emptyPSPNO="";
		//////////////////////////////////////////////////////////////
		// OLD값 처리
		DatasetList in_dl = new DatasetList();
		in_dl = pReq.getDatasetList();
		Dataset ds = in_dl.getDataset("ds_SCDZ105");
		//////////////////////////////////////////////////////////////			
		dao.startTransaction(); //tr 시작		
		while (it_d.hasNext()) {  //tr발생이 insert발생 후 delete가 발생되므로 삭제먼저 진행 (중복오류발생)
			Map pData = (Map) it_d.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			emptyPSPNO = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPSPNO != "") {				
				if ("delete".equals(rowType)) {
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSCDZ105_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//삭제불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "삭제불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.deleteData("pssallib.deleteSCDZ105", pData);
						}
					}
				}
			}
		}
		
		while (it_iu.hasNext()) {
			Map pData = (Map) it_iu.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("MAJCD", (String)pArg.get("MAJCD"));
			pData.put("MJINT", (String)pArg.get("MJINT"));
			emptyPSPNO = (String) pData.get("PSPNO");
			rowType = (String) pData.get("ROW_TYPE");
			if (emptyPSPNO != "") {				
				if ("insert".equals(rowType)) {					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSCDZ105_CHK",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(1)){
							//insert 불가(대상이 있음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("PSPNO"));
							errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pscomlib.updateMST040", pData);
							dao.insertData("pssallib.insertSCDZ105", pData);
						}
					}
				} else if ("update".equals(rowType)) {
					pData.put("OLD_PSPNO", ds.getOrgBuffColumn(0, "PSPNO").getString());
					
					Map CheckCnt = (Map)dao.getReadData("pssallib.selectSCDZ105_CHK2",pData);
					if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
						if(CheckCnt.get("CNT").equals(0)){
							//update 불가(대상이 없음)
							HashMap errMap = new HashMap();
							errMap.put("PSPNO", pData.get("OLD_PSPNO"));
							errMap.put("RTMSG", "수정불가(미 등록된 자료입니다.)");
							errList.add(errMap);
						}else{
							dao.updateData("pssallib.updateSCDZ105", pData);
							/*
							Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSCDZ105_CHK",pData);
							if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
								if(CheckCnt2.get("CNT").equals(1)){
									//update 불가(대상이 없음)
									HashMap errMap = new HashMap();
									errMap.put("PSPNO", pData.get("PSPNO"));
									errMap.put("RTMSG", "추가불가(이미 등록된 자료입니다.)");
									errList.add(errMap);
								}else{
									dao.updateData("pssallib.updateSCDZ105", pData);
								}
							}
							*/
						}
					}
				}				
			}       
		}      
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SCDZ105_CHK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/대우 VAN관리 MENU/대우일일부품소요계획현황     
	 * @exception 
	 * @see 
	 * 	- 2013-03-12	:	제환복
	***********************************************************************/ 
	public void selectSVDE350Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVDE350Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVDE350Q", list);
		new MiPlatformView().render(map, request, response);
	}	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/대우 VAN관리 MENU/대우 발주정보현황 ERROR LIST
	 * @exception 
	 * @see 
	 * 	- 2013-03-12	:	제환복
	***********************************************************************/ 
	public void selectSVDE359Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVDE359Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVDE359Q", list);
		new MiPlatformView().render(map, request, response);
	}		
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/대우 VAN관리 MENU/대우 AS 발주현황
	 * @exception 
	 * @see 
	 * 	- 2013-03-13	:	제환복
	***********************************************************************/ 
	public void selectSVDE140Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVDE140Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVDE140Q", list);
		new MiPlatformView().render(map, request, response);
	}		
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/대우 VAN관리 MENU/대우일일부품소요계획 현황
	 * @exception 
	 * @see 
	 * 	- 2013-03-13	:	제환복
	***********************************************************************/ 
	public void selectSVDE301Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVDE301Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVDE301Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/대우 VAN관리 MENU/대우일일부품소요계획 HOSTUP
	 * @exception 
	 * @see 
	 * 	- 2013-03-13	:	제환복
	***********************************************************************/ 	
	public void insertSVDE304UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVDE304UC");
		List pList_CD = DataConverter.getMiPlatformMultiData(pReq, "ds_DFACD");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();
		
		Iterator it_i = pList.iterator();
		Iterator it_d = pList_CD.iterator();
		
		String rowType="";
		String empty1="";
		dao.startTransaction(); //tr 시작
		//공장코드별 삭제
		while (it_d.hasNext()) {
			Map pData_CD = (Map) it_d.next();
			empty1 = (String) pData_CD.get("FACGU");
			if (empty1 != "") {
			pData_CD.put("LIB2", (String)pArg.get("LIB2"));
			dao.deleteData("pssallib.deleteSVDE304UC_SVD300PF", pData_CD);
			dao.deleteData("pssallib.deleteSVDE304UC_SVD309PF", pData_CD);
			}
		}
		//data생성
		while (it_i.hasNext()) { 
			Map pData = (Map) it_i.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("PYVND", (String)pArg.get("PYVND"));
			empty1 = (String) pData.get("FACGU");
			if (empty1 != "") {
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVDE304UC_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					int chkCnt= Integer.parseInt(CheckCnt.get("CNT").toString());
					if(chkCnt >0){
						okList.add(pData);			
						dao.insertData("pssallib.insertSVDE304UC_SVD300PF", pData);	
/*중복체크는 품번(미사용)										
						Map CheckCnt2 = (Map)dao.getReadData("pssallib.selectSVDE304UC_Check2",pData);
						if(CheckCnt2!=null && CheckCnt2.get("CNT")!=null && !CheckCnt2.get("CNT").equals("")){
							if(CheckCnt2.get("CNT").equals(1)){
								pData.put("RTMSG", "중복DATA");
								errList.add(pData);
								dao.insertData("pssallib.insertSVDE304UC_SVD309PF", pData);
							}else{
								okList.add(pData);			
								dao.insertData("pssallib.insertSVDE304UC_SVD300PF", pData);	
							}
						}
*/						
					}else{
						pData.put("RTMSG", "품번미등록");
						errList.add(pData);
						dao.insertData("pssallib.insertSVDE304UC_SVD309PF", pData);
					}
				}	
			}
		}
	
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVDE304UC_1", okList);
		map.addAttribute("ds_SVDE304UC_2", errList);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/대우 VAN관리 MENU/대우AS발주현황 HOSTUP
	 * @exception 
	 * @see 
	 * 	- 2013-03-13	:	제환복
	***********************************************************************/
	public void insertSVDE144UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVDE144UC");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();
		
		Iterator it_i = pList.iterator();
		Iterator it_d = pList.iterator();
		
		String rowType="";
		String empty1="";
		dao.startTransaction(); //tr 시작
		//공장코드별 삭제

		dao.deleteData("pssallib.deleteSVDE114UC", pArg);

		//data생성
		while (it_i.hasNext()) { 
			Map pData = (Map) it_i.next();
			//pData.put("LIB2", (String)pArg.get("LIB2"));
			empty1 = (String) pData.get("PATNO");
			if (empty1 != "") {
				okList.add(pData);			
				dao.insertData("pssallib.insertSVDE114UC", pData);					
/*중복체크는 품번과 발주번호(미사용)				
				Map CheckCnt = (Map)dao.getReadData("pssallib.selectSVDE114UC_Check",pData);
				if(CheckCnt!=null && CheckCnt.get("CNT")!=null && !CheckCnt.get("CNT").equals("")){
					int chkCnt= Integer.parseInt(CheckCnt.get("CNT").toString());
					if(chkCnt >0){
						pData.put("RTMSG", "중복DATA");
						errList.add(pData);
					}else{
						okList.add(pData);			
						dao.insertData("pssallib.insertSVDE114UC", pData);	
					}
				}
*/				
			}
			else{
				pData.put("RTMSG", "품번미등록");				
				errList.add(pData);
			}
		}
	
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVDE144UC_1", okList);
		map.addAttribute("ds_SVDE144UC_2", errList);
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/대우 VAN관리 MENU/대우일소요자료(발주정보) UP
	 * @exception 
	 * @see 
	 * 	- 2013-03-15	:	제환복
	***********************************************************************/
	public void insertSVDE354UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVDE354UC");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();
		Iterator it = pList.iterator();
		String empty1="";
		String PSPNO="";
		String PSCAR="";
		String SEQCD="";

		dao.startTransaction(); //tr 시작
		dao.deleteData("pssallib.deleteSVDE354UC_SVD350PF", pArg);
		dao.deleteData("pssallib.deleteSVDE354UC_SVD359PF", pArg);
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			//1.em000prf로 풍성품번 가져옴.
			empty1 = (String) pData.get("CPRTN");
			if (empty1 != "") {
				Map ChkGET1 = (Map)dao.getReadData("pssallib.selectSVDE354UC_GET1",pData);
				if(ChkGET1!=null && ChkGET1.get("PRTNO")!=null && !ChkGET1.get("PRTNO").equals("")){
					PSPNO= ChkGET1.get("PRTNO").toString();
					pData.put("PSPNO", PSPNO);
					//품번이 존재하면, 차종을 가져옴.
					Map ChkGET2 = (Map)dao.getReadData("pssallib.selectSVDE354UC_GET2",pData);				
					if(ChkGET2!=null && ChkGET2.get("PRTNO")!=null && !ChkGET2.get("PRTNO").equals("")){
						PSCAR= ChkGET2.get("CARCD").toString();
						SEQCD= ChkGET2.get("SEQCD").toString();
						pData.put("PSCAR", PSCAR);				
						pData.put("SEQCD", SEQCD);				
					}else{
						pData.put("PSCAR", "");				
						pData.put("SEQCD", "");				
					}
					okList.add(pData);	
					dao.insertData("pssallib.insertSVDE354UC_SVD350PF", pData);	
				}else{//풍성품번이 없으면
					//pData.put("PSPNO", "");
					//pData.put("PSCAR", "");				
					//pData.put("SEQCD", "");					
					pData.put("RTMSG", "품번미등록");				
					errList.add(pData);			
					dao.insertData("pssallib.insertSVDE354UC_SVD359PF", pData);	
				}
			}//신규추가함.2013.03.20
/*
			else{//HOST파일에 업체품번이 없으면
				//pData.put("PSPNO", "");
				//pData.put("PSCAR", "");				
				//pData.put("SEQCD", "");	
				pData.put("RTMSG", "업체품번미등록");				
				errList.add(pData);
				dao.insertData("pssallib.insertSVDE354UC_SVD359PF", pData);	
			}
*/
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVDE354UC_1", okList);
		map.addAttribute("ds_SVDE354UC_2", errList);
		new MiPlatformView().render(map, request, response);	
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/정산관리/HKMC검수관리MENU//D9 ERP월검수합격통보서HOST UP
	 * @exception 
	 * @see 
	 * 	- 2013-03-14	:	제환복
	***********************************************************************/	
	//풍성품번이 없어도 INSERT함.
	public void insertSVHZ554UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHZ554UC");
		List pList_CD = DataConverter.getMiPlatformMultiData(pReq, "ds_DFACD");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();
		
		Iterator it = pList.iterator();
		Iterator it_d = pList_CD.iterator();

		String empty1="";
		String COMPS="";
		String PYVND="";
		String PCODE="";
		String VFACGU="";
		String PSPNO="";
		dao.startTransaction(); //tr 시작
		while (it_d.hasNext()) {
			Map pData_CD = (Map) it_d.next();
			empty1 = (String) pData_CD.get("FACGU");
			if (empty1 != "") {
				pData_CD.put("LIB2", (String)pArg.get("LIB2"));
				dao.deleteData("pssallib.deleteSVHZ554UC_FACGU", pData_CD);
			}
		}
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			//1.em000prf로 풍성품번 가져옴.
			//empty1 = (String) pData.get("CPRTN");
			Map ChkGET1 = (Map)dao.getReadData("pssallib.selectSVHZ554UC_1_GET1",pData);
			if(ChkGET1!=null && ChkGET1.get("PSVND")!=null && !ChkGET1.get("PSVND").equals("")){
				COMPS= ChkGET1.get("PSCOM").toString();
				PYVND= ChkGET1.get("PSVND").toString();
				pData.put("COMPS", COMPS);
				pData.put("PYVND", PYVND);
				
				Map ChkGET3 = (Map)dao.getReadData("pssallib.selectSVHZ554UC_1_GET3",pData);
				int chkCnt= Integer.parseInt(ChkGET3.get("CNT").toString());
				//UPDATE의 경우 풍성품번,PCODE계산안함
				if(chkCnt >0){	
					dao.updateData("pssallib.updateSVHZ554UC", pData);	
					pData.put("RTMSG", "수정");				
				}
				else{
					VFACGU=(String)pData.get("VFACGU");
					if(VFACGU.equals("HV11") || VFACGU.equals("HV12") || VFACGU.equals("HV13") || VFACGU.equals("HV14") || VFACGU.equals("HV15") || VFACGU.equals("HE11")){
						pData.put("PCODE", "0H");				
					}
					if(VFACGU.equals("HV31") || VFACGU.equals("HE31")){
						pData.put("PCODE", "0C");				
					}
					if(VFACGU.equals("HK31")){
						pData.put("PCODE", "1C");				
					}
					if(VFACGU.equals("HK11")){
						pData.put("PCODE", "1H");				
					}
					if(VFACGU.equals("HK21")){
						pData.put("PCODE", "1M");				
					}
					if(VFACGU.equals("HE21") || VFACGU.equals("HV21")){
						pData.put("PCODE", "0M");				
					}	
					Map ChkGET2 = (Map)dao.getReadData("pssallib.selectSVHZ554UC_1_GET2",pData);
					if(ChkGET2!=null && ChkGET2.get("PRTNO")!=null && !ChkGET2.get("PRTNO").equals("")){
						PSPNO= ChkGET2.get("PRTNO").toString();
						pData.put("PSPNO", PSPNO);
					}
					else{
						pData.put("PSPNO", "");
					}
					dao.insertData("pssallib.insertSVHZ554UC", pData);
					pData.put("RTMSG", "등록");				
				}
				okList.add(pData);
			}else{//업체가 없으면 등록안함.
				pData.put("RTMSG", "업체코드미등록");				
				pData.put("COMPS", "");
				pData.put("PYVND", "");				
				//pData.put("PCODE", "");				
				//pData.put("PSPNO", "");
				errList.add(pData);
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHZ554UC_1", okList);
		map.addAttribute("ds_SVHZ554UC_2", errList);
		new MiPlatformView().render(map, request, response);	
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/정산관리/HKMC검수관리MENU/D9 CKD 월검수합격통보서HOST UP
	 * @exception 
	 * @see 
	 * 	- 2013-03-14	:	제환복
	***********************************************************************/	
	//풍성품번이 없어도 INSERT함.
	public void insertSVHZ553UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHZ553UC");
		List pList_CD = DataConverter.getMiPlatformMultiData(pReq, "ds_DFACD");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();
		
		Iterator it = pList.iterator();
		Iterator it_d = pList_CD.iterator();

		String empty1="";
		String COMPS="";
		String PYVND="";
		String PCODE="";
		String VFACGU="";
		String PSPNO="";

		dao.startTransaction(); //tr 시작

		while (it_d.hasNext()) {
			Map pData_CD = (Map) it_d.next();
			empty1 = (String) pData_CD.get("FACGU");
			if (empty1 != "") {
				pData_CD.put("LIB2", (String)pArg.get("LIB2"));
				dao.deleteData("pssallib.deleteSVHZ554UC_FACGU", pData_CD);
			}
		}

		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			//1.em000prf로 풍성품번 가져옴.
			//empty1 = (String) pData.get("CPRTN");
			Map ChkGET1 = (Map)dao.getReadData("pssallib.selectSVHZ554UC_1_GET1",pData);
			if(ChkGET1!=null && ChkGET1.get("PSVND")!=null && !ChkGET1.get("PSVND").equals("")){
				COMPS= ChkGET1.get("PSCOM").toString();
				PYVND= ChkGET1.get("PSVND").toString();
				pData.put("COMPS", COMPS);
				pData.put("PYVND", PYVND);
				pData.put("VINPSR", " ");
				
				Map ChkGET3 = (Map)dao.getReadData("pssallib.selectSVHZ554UC_1_GET3",pData);
				int chkCnt= Integer.parseInt(ChkGET3.get("CNT").toString());
				//UPDATE의 경우 풍성품번,PCODE계산안함
				if(chkCnt >0){	
					dao.updateData("pssallib.updateSVHZ554UC", pData);	
					pData.put("RTMSG", "수정");				
				}
				else{
					VFACGU=(String)pData.get("VFACGU");
					if(VFACGU.equals("HV11") || VFACGU.equals("HV12") || VFACGU.equals("HV13") || VFACGU.equals("HV14") || VFACGU.equals("HV15") || VFACGU.equals("HE11")){
						pData.put("PCODE", "0H");				
					}
					if(VFACGU.equals("HV31") || VFACGU.equals("HE31")){
						pData.put("PCODE", "0C");				
					}
					if(VFACGU.equals("HK31")){
						pData.put("PCODE", "1C");				
					}
					if(VFACGU.equals("HK11")){
						pData.put("PCODE", "1H");				
					}
					if(VFACGU.equals("HK21")){
						pData.put("PCODE", "1M");				
					}
					if(VFACGU.equals("HE21") || VFACGU.equals("HV21")){
						pData.put("PCODE", "0M");				
					}	
					Map ChkGET2 = (Map)dao.getReadData("pssallib.selectSVHZ554UC_1_GET2",pData);
					if(ChkGET2!=null && ChkGET2.get("PRTNO")!=null && !ChkGET2.get("PRTNO").equals("")){
						PSPNO= ChkGET2.get("PRTNO").toString();
						pData.put("PSPNO", PSPNO);
					}
					else{
						pData.put("PSPNO", "");
					}
					dao.insertData("pssallib.insertSVHZ554UC", pData);
					pData.put("RTMSG", "등록");				
				}
				okList.add(pData);
			}else{//업체가 없으면 등록안함.
				pData.put("RTMSG", "업체코드미등록");				
				pData.put("COMPS", "");
				pData.put("PYVND", "");				
				//pData.put("PCODE", "");				
				//pData.put("PSPNO", "");
				errList.add(pData);
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHZ553UC_1", okList);
		map.addAttribute("ds_SVHZ553UC_2", errList);
		new MiPlatformView().render(map, request, response);	
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/정산관리/검수관리MENU/모비스월검수현황 HOST UP
	 * @exception 
	 * @see 
	 * 	- 2013-03-14	:	제환복
	***********************************************************************/	
/*
	public void insertSVHC654UC_1_OLD(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHC654UC");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();
		
		Iterator it = pList.iterator();

		String empty1="";
		String DEGUB="";
		String CPRTN="";
		String PSPNO="";
		String COMPS="";
		String CARCD="";
		String BDYCD="";
		String PRDCD="";
		String ERRCD="";
		
		dao.startTransaction(); //tr 시작

		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			DEGUB = (String) pData.get("DEGUB");
			CPRTN = (String) pData.get("MPRTN");
			PSPNO="";
			CARCD="";
			BDYCD="";
			PRDCD="";
			ERRCD="";
			if(DEGUB.equals("D")){//국내
				if(!CPRTN.isEmpty()){
					ERRCD="D=OK";
					HashMap pKey2 = new HashMap();
					pKey2.put("LIB1", (String)pArg.get("LIB1"));
					pKey2.put("P_CUSNO", pData.get("PYVND"));
					pKey2.put("P_CPRTN", CPRTN);
					pKey2.put("P_PCKCD", "3X");
					Map getCGMPARMBB = (Map)dao.getReadData("pscomlib.selectCGMPARMBB",pKey2);
					if(getCGMPARMBB!=null && getCGMPARMBB.get("PRTNO")!=null && !getCGMPARMBB.get("PRTNO").equals("")){
						PSPNO = (String) getCGMPARMBB.get("PRTNO");
						ERRCD="D=PSPNO=OK";
					}else{
						ERRCD="D=PSPNO=NG";
					}
				}
				else{
					ERRCD="D=NG";					
				}
			}
			if(DEGUB.equals("E")){//수출
				if(!CPRTN.isEmpty()){
					ERRCD="E=OK";
					HashMap pKey2 = new HashMap();
					pKey2.put("LIB1", (String)pArg.get("LIB1"));
					pKey2.put("P_CUSNO", pData.get("PYVND"));
					pKey2.put("P_CPRTN", CPRTN);
					pKey2.put("P_PCKCD", "4X");
					Map getCGMPARMBB = (Map)dao.getReadData("pscomlib.selectCGMPARMBB",pKey2);
					if(getCGMPARMBB!=null && getCGMPARMBB.get("PRTNO")!=null && !getCGMPARMBB.get("PRTNO").equals("")){
						PSPNO = (String) getCGMPARMBB.get("PRTNO");
						ERRCD="E=PSPNO=OK";
					}else{
						ERRCD="E=PSPNO=NG";
					}
				}
				else{
					ERRCD="E=NG";					
				}
			}
			if(!PSPNO.isEmpty()){
				ERRCD="OK";
				HashMap pKey3 = new HashMap();
				pKey3.put("LIB2", (String)pArg.get("LIB2"));
				pKey3.put("COMPS", pData.get("COMPS"));
				pKey3.put("PRTNO", PSPNO);
				Map getMST100PF = (Map)dao.getReadData("pscomlib.selectMST100PF",pKey3);
				if(getMST100PF!=null && getMST100PF.get("CARCD")!=null && !getMST100PF.get("CARCD").equals("")){
					CARCD = (String) getMST100PF.get("CARCD");
					BDYCD = (String) getMST100PF.get("BDYCD");
					PRDCD = (String) getMST100PF.get("PRDCD");
				}else{
					CARCD ="";
					BDYCD ="";
					PRDCD ="";
				}
				pData.put("ERRCD", ERRCD);
				pData.put("CARCD", CARCD);
				pData.put("BDYCD", BDYCD);
				pData.put("PRDCD", PRDCD);
				pData.put("PSPNO", PSPNO);
				okList.add(pData);
				//dao.insertData("pssallib.insertSVHC654UC_SVH650PF", pData);	
			}else{
				pData.put("ERRCD", ERRCD);
				pData.put("PSPNO", PSPNO);				
				okList.add(pData);
				//dao.insertData("pssallib.insertSVHC654UC_SVH659PF", pData);					
			}			
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHC654UC_1", okList);
		//map.addAttribute("ds_SVHZ553UC_2", errList);
		new MiPlatformView().render(map, request, response);	
	}	
*/
	public void insertSVHC654UC_1(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHC654UC_0");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();
		
		Iterator it = pList.iterator();

		String empty1="";
		String DEGUB="";
		String CPRTN="";
		String PSPNO="";
		String COMPS="";
		String CARCD="";
		String BDYCD="";
		String PRDCD="";
		String ERRCD="";
		
		//dao.startTransaction(); //tr 시작
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			DEGUB = (String) pData.get("DEGUB");
			CPRTN = (String) pData.get("MPRTN");
			PSPNO="";
			CARCD="";
			BDYCD="";
			PRDCD="";
			ERRCD="";
//if(DEGUB.equals("D") || DEGUB.equals("E")){ //rpg에서는 D/E가 아닌것에 대한 error가 없지만 추가함.
			if(DEGUB.equals("D")){//국내
				if(!CPRTN.isEmpty()){
					//ERRCD="D=OK";
					HashMap pKey2 = new HashMap();
					pKey2.put("LIB1", (String)pArg.get("LIB1"));
					pKey2.put("P_CUSNO", pData.get("PYVND"));
					pKey2.put("P_CPRTN", CPRTN);
					pKey2.put("P_PCKCD", "3X");
					Map getCGMPARMBB = (Map)dao.getReadData("pscomlib.selectCGMPARMBB",pKey2);
					if(getCGMPARMBB!=null && getCGMPARMBB.get("PRTNO")!=null && !getCGMPARMBB.get("PRTNO").equals("")){
						PSPNO = (String) getCGMPARMBB.get("PRTNO");
						//ERRCD="D=PSPNO=OK";
					}else{//errcd 추가사항(풍성-품번미스)
						//ERRCD="E2";	
					}
				}
/*				
				else{//errcd 추가사항(업체미스)
					ERRCD="E1";					
				}
*/
			}
			if(DEGUB.equals("E")){//수출
				if(!CPRTN.isEmpty()){
					//ERRCD="E=OK";
					HashMap pKey2 = new HashMap();
					pKey2.put("LIB1", (String)pArg.get("LIB1"));
					pKey2.put("P_CUSNO", pData.get("PYVND"));
					pKey2.put("P_CPRTN", CPRTN);
					pKey2.put("P_PCKCD", "4X");
					Map getCGMPARMBB = (Map)dao.getReadData("pscomlib.selectCGMPARMBB",pKey2);
					if(getCGMPARMBB!=null && getCGMPARMBB.get("PRTNO")!=null && !getCGMPARMBB.get("PRTNO").equals("")){
						PSPNO = (String) getCGMPARMBB.get("PRTNO");
						//ERRCD="E=PSPNO=OK";
					}else{//errcd 추가사항(풍성-품번미스)
						//ERRCD="E2";	
					}
				}
/*				
				else{//errcd 추가사항(업체미스)
					ERRCD="E1";					
				}
*/
			}
			if(!PSPNO.isEmpty()){
				//ERRCD="OK";
				HashMap pKey3 = new HashMap();
				pKey3.put("LIB2", (String)pArg.get("LIB2"));
				pKey3.put("COMPS", pData.get("COMPS"));
				pKey3.put("PRTNO", PSPNO);
				Map getMST100PF = (Map)dao.getReadData("pscomlib.selectMST100PF",pKey3);
				if(getMST100PF!=null && getMST100PF.get("CARCD")!=null && !getMST100PF.get("CARCD").equals("")){
					CARCD = (String) getMST100PF.get("CARCD");
					BDYCD = (String) getMST100PF.get("BDYCD");
					PRDCD = (String) getMST100PF.get("PRDCD");
				}else{
					CARCD ="";
					BDYCD ="";
					PRDCD ="";
				}
				pData.put("ERRCD", ERRCD);
				pData.put("CARCD", CARCD);
				pData.put("BDYCD", BDYCD);
				pData.put("PRDCD", PRDCD);
				pData.put("PSPNO", PSPNO);
				okList.add(pData);
				//dao.insertData("pssallib.insertSVHC654UC_SVH650PF", pData);	
			}else{
				pData.put("ERRCD", ERRCD);
				pData.put("CARCD", CARCD);
				pData.put("BDYCD", BDYCD);
				pData.put("PRDCD", PRDCD);
				pData.put("PSPNO", PSPNO);				
				okList.add(pData);
				//dao.insertData("pssallib.insertSVHC654UC_SVH659PF", pData);					
			}
//}
		}
		//dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHC654UC", okList);
		new MiPlatformView().render(map, request, response);	
	}
	//insertSVHC654UC_1로 한번에 처리가능하나 삭제 후 가공 후 등록시 TERM이 발생하여
	//insertSVHC654UC_1에서 1차가공후insertSVHC654UC에서 삭제 및 등록 처리함.
	//RPG에서 MEBER속성을 MCOMPS컬럼을 추가하여 구분함.
	//SVH650PF => SVH652PF로 변경함.
	public void insertSVHC654UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHC654UC");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		List errList = new ArrayList();
		List okList = new ArrayList();		

		Iterator it = pList.iterator();
		String PSPNO="";			
		String INPTY="";			
		int INPQY=0;			
		int CLSQY=0;			
		int DANAM=0;			
		int INPAM=0;			
		dao.startTransaction(); //tr 시작
		dao.deleteData("pssallib.deleteSVHC654UC_SVH652PF", pArg);
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("MCOMPS", (String)pArg.get("MCOMPS"));
			PSPNO=(String) pData.get("PSPNO");
			INPTY="";			
			INPQY=0;			
			CLSQY=0;			
			DANAM=0;
			INPAM=0;	
			if(!PSPNO.isEmpty()){
				dao.insertData("pssallib.insertSVHC654UC_SVH652PF", pData);	
				okList.add(pData);
			}else{
				dao.insertData("pssallib.insertSVHC654UC_SVH659PF", pData);	
				INPTY=(String) pData.get("INPTY");
				INPQY=Integer.parseInt((String) pData.get("INPQY"));
				CLSQY=Integer.parseInt((String) pData.get("CLSQY"));
				DANAM=Integer.parseInt((String) pData.get("DANAM"));
				if(INPTY.equals("CN")||INPTY.equals("CA")){
					INPAM=(INPQY+CLSQY)*DANAM;
				}else{
					INPAM=(INPQY-CLSQY)*DANAM;						
				}
				pData.put("INPAM", INPAM);
				errList.add(pData);
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHC654UC_1", okList);
		map.addAttribute("ds_SVHC654UC_2", errList);
		new MiPlatformView().render(map, request, response);	
	}

	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/쌍용 VAN관리 MENU/쌍용일일부품소요계획 현황
	 * @exception 
	 * @see 
	 * 	- 2013-03-19	:	제환복
	***********************************************************************/ 
	public void selectSVSE102Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVSE102Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVSE102Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/쌍용 VAN관리 MENU/쌍용일일부품소요계획 현황 ERROR
	 * @exception 
	 * @see 
	 * 	- 2013-03-19	:	제환복
	***********************************************************************/ 
	public void selectSVSE109Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVSE109Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVSE109Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/쌍용 VAN관리 MENU/쌍용일일부품소요계획현황 HOSTUP
	 * @exception 
	 * @see 
	 * 	- 2013-03-14	:	제환복
	***********************************************************************/	
	public void insertSVSE101UC_1(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVSE101UC");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();		
		List makdtList = new ArrayList();		
		Iterator it = pList.iterator();

		String empty1="";
		String COMPS="";
		String MKCOD="";
		String ALCCD="";
		String PSPNO="";
		
		//dao.startTransaction(); //tr 시작
		//dao.deleteData("pssallib.deleteSVSE101UC_SVS100PF", pArg);
		//dao.deleteData("pssallib.deleteSVSE101UC_SVS109PF", pArg);
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			Map ChkGET1 = (Map)dao.getReadData("pssallib.selectSVSE101UC_1_GET1",pData);
			if(ChkGET1!=null && ChkGET1.get("PYVND")!=null && !ChkGET1.get("PYVND").equals("")){
				//pData.put("ALCCD1", (String)pData.get("ALCCD"));//TEST용원본
				MKCOD= ChkGET1.get("MCRCD").toString();
				ALCCD= ChkGET1.get("MSECD").toString();
				pData.put("MKCOD", MKCOD);
				pData.put("ALCCD", ALCCD.trim());
				//pData.put("ERRCD","081");
			}
/*
			else{//ALCD 및 MKCODPARAM값임.
				//pData.put("ALCCD1", (String)pData.get("ALCCD"));	//TEST용원본			
				pData.put("MKCOD", (String)pData.get("MKCOD"));	
				pData.put("ALCCD", (String)pData.get("ALCCD"));				
			}
*/	
			ALCCD= pData.get("ALCCD").toString().trim();//
			if(!(ALCCD.equals("LBO")|| ALCCD.equals("LBX")|| 
				ALCCD.equals("LEO")|| ALCCD.equals("LEX")|| ALCCD.equals("RBX")|| ALCCD.equals("KT1")||
				ALCCD.equals("KT3")|| ALCCD.equals("KX1")|| ALCCD.equals("KX3")|| ALCCD.equals("TK1")||
				ALCCD.equals("TK2")|| ALCCD.equals("TK4")|| ALCCD.equals("LLD")|| ALCCD.equals("LLX")||
				ALCCD.equals("SK1")|| ALCCD.equals("SK2")|| ALCCD.equals("VK1")|| ALCCD.equals("VK2")||
				ALCCD.equals("ZK1")|| ALCCD.equals("ZK2")|| ALCCD.equals("RLD")|| ALCCD.equals("LED")||
				ALCCD.equals("RLX")|| ALCCD.equals("BBX")|| ALCCD.equals("GT1")|| ALCCD.equals("GT3")||
				ALCCD.equals("SM1") || ALCCD.equals("SM2")|| ALCCD.equals("ZG2"))){

				Map ChkGET2 = (Map)dao.getReadData("pssallib.selectSVSE101UC_1_GET2",pData);
				if(ChkGET2!=null && ChkGET2.get("PYVND")!=null && !ChkGET2.get("PYVND").equals("")){
					makdtList = dao.getListData("pssallib.selectSVSE101UC_1_GET3",pData);//문서일자4일확인
					PSPNO= ChkGET2.get("PSPNO").toString();
					int EFFFR= Integer.parseInt(ChkGET2.get("EFFFR").toString());
					int EFFTO= Integer.parseInt(ChkGET2.get("EFFTO").toString());

					int msize=makdtList.size();
					int mdt[]= new int[msize];
					String mdtcnt[]= new String[msize];
					int mdtChk=0;
					for(int i=0; i<msize; i++){
						mdt[i] = Integer.parseInt(makdtList.get(i).toString().substring(7,15));
						if(mdt[i] >= EFFFR && mdt[i]<=EFFTO){
//System.out.print("ok크기 ="+EFFFR+" "+mdt[i]+" "+EFFTO);
							mdtcnt[i]="OK";//적용일자 범위에 대상여부 확인
							mdtChk++;//적용일자에 존재여부CHK
						}
						else{
							mdtcnt[i]="NG";
//System.out.print("ng크기 ="+EFFFR+" "+mdt[i]+" "+EFFTO);							
						}	
					}
					if(mdtChk >0){//적용일자에 존재하는데이터가 있으면,
						pData.put("PSPNO",PSPNO);
						pData.put("DEFFR",EFFFR);
						pData.put("DEFTO",EFFTO);
						for(int i=0; i<msize; i++){
							if(mdtcnt[i]=="NG"){
								if(i==0){
									pData.put("D"+i+"0QY",0);
									pData.put("D"+i+"1QY",0);
									pData.put("D"+i+"TQY",0);
									pData.put("TRIMD",0);
									pData.put("PSBSQY",0);
								}
								else if(i==1){
									pData.put("D"+i+"0QY",0);
									pData.put("D"+i+"1QY",0);
									pData.put("D"+i+"TQY",0);
								}
								else{
									pData.put("D"+i+"TQY",0);
								}
							}
						}
					//pData.put("ERRCD","OK");	
					okList.add(pData);
					//dao.insertData("pssallib.insertSVSE101UC_SVS100PF", pData);	
					}else{//적용일자 범위밖  SVS109PF에 ERR코드와 함께 INSERT SVS109
//System.out.print("NG");
						pData.put("D00QY",0);
						pData.put("D01QY",0);
						pData.put("D0TQY",0);
						pData.put("D10QY",0);
						pData.put("D11QY",0);
						pData.put("D1TQY",0);
						pData.put("D2TQY",0);
						pData.put("D3TQY",0);
						pData.put("D4TQY",0);
						pData.put("D5TQY",0);
						pData.put("D6TQY",0);
						pData.put("TRIMD",0);
						pData.put("PBSQY",0);
						pData.put("ERRCD","2");
						//TEST용
						//String CUSNO=(String)pData.get("PYVND");
						//pData.put("CUSNO",CUSNO);					
						//Map ChkGET99 = (Map)dao.getReadData("pscomlib.selectCustomerMaster",pData);
						//String CUSNM = ChkGET99.get("A2").toString();
						//pData.put("CUSNM",CUSNM);
						//
						errList.add(pData);
						//dao.insertData("pssallib.insertSVSE101UC_SVS109PF", pData);	
					}
//System.out.print("cnt크기 ="+j+" "+mdtcnt[0]+" "+mdtcnt[1]+" "+mdtcnt[2]+" "+mdtcnt[3]+" "+mdtcnt[4]+" "+mdtcnt[5]);				
				}else{//ALCD 및 MKCODPARAM값임.//insert 109
					pData.put("ERRCD","1");	
					//TEST용
					//String CUSNO=(String)pData.get("PYVND");
					//pData.put("CUSNO",CUSNO);					
					//Map ChkGET99 = (Map)dao.getReadData("pscomlib.selectCustomerMaster",pData);
					//String CUSNM = ChkGET99.get("A2").toString();
					//pData.put("CUSNM",CUSNM);
					//
					errList.add(pData);
					//dao.insertData("pssallib.insertSVSE101UC_SVS109PF", pData);	
				}
			}
/*
			else{//미처리됨 SVS100/109둘다 등록안됨.
				//pData.put("ERRCD","9");	//TEST용으로  삭제
				//errList.add(pData);
			}
*/
		}
		//dao.endTransaction(); //commit
		//errList  = dao.getListData("pssallib.selectSVSE109Q", pArg);//RPG는 에러등록 후 조회하여 가져감.
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVSE101UC_1", okList);
		map.addAttribute("ds_SVSE101UC_2", errList);
		new MiPlatformView().render(map, request, response);	
	}
//insertSVSE101UC_1로 한번에 처리가능하나 삭제 후 가공 후 등록시 TERM이 발생하여
//insertSVSE101UC_1에서 1차가공후 insertSVSE101UC에서 삭제 및 등록 처리함.
//SVS100PF->SVS103PF SVS109PF->SVS110PF로 변경 MKPNM컬럼 타입 A->O로 변경함.
	public void insertSVSE101UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List okList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVSE101UC_1");
		List errList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVSE101UC_2");
		Map pArg = DataConverter.getMiPlatformData(pReq);
	
		Iterator it = okList.iterator();
		Iterator it_e = errList.iterator();
		
		dao.startTransaction(); //tr 시작
		dao.deleteData("pssallib.deleteSVSE101UC_SVS103PF", pArg);
		dao.deleteData("pssallib.deleteSVSE101UC_SVS110PF", pArg);
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			dao.insertData("pssallib.insertSVSE101UC_SVS103PF", pData);	
		}
		while (it_e.hasNext()) {
			Map pData = (Map) it_e.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			dao.insertData("pssallib.insertSVSE101UC_SVS110PF", pData);	
		}
		errList.clear();
		errList  = dao.getListData("pssallib.selectSVSE109Q", pArg);//RPG는 에러등록 후 조회하여 가져감.
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVSE101UC_2", errList);
		new MiPlatformView().render(map, request, response);	
	}
	public void insertSVSE201UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVSE201UC");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it = pList.iterator();
		String mkno="";
		dao.startTransaction(); //tr 시작
		dao.deleteData("pssallib.deleteSVSE201UC", pArg);
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			// System.out.println((String) pData.get("ROW_TYPE"));
			mkno = (String)pData.get("MKPNO");
			if(!(mkno.equals(null) || mkno.equals("") || mkno.equals("-"))){
				pData.put("LIB1", (String)pArg.get("LIB1"));
				pData.put("LIB2", (String)pArg.get("LIB2"));
				pData.put("P_CUSNO", (String)pArg.get("PYVND"));
				pData.put("P_CPRTN", (String)pData.get("MKPNO"));
				pData.put("P_PCKCD", "");
				pData.put("P_EDATM", (String)pArg.get("CURDT"));
				pData.put("PLNDT", (String)pArg.get("PLNDT"));
				pData.put("USRID", (String)pArg.get("USRID"));
				Map ChkGET1 = (Map)dao.getReadData("pscomlib.selectCGMPARMBB",pData);
				if(ChkGET1!=null && ChkGET1.get("PRTNO")!=null && !ChkGET1.get("PRTNO").equals("")){
					//PSPNO = ChkGET1.get("PRTNO").toString();
					pData.put("getPSPNO", ChkGET1.get("PRTNO").toString());	
				}else{
					pData.put("getPSPNO", "");
				}
				dao.insertData("pssallib.insertSVSE201UC", pData);
			}
		}
		dao.endTransaction(); //commit

		List list = dao.getListData("pssallib.selectSVSE201UC", pArg);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVSE201UC_0", list);
		new MiPlatformView().render(map, request, response);

	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/모비스 VAN관리 MENU/모비스발주현황HOSTUP
	 * @exception 
	 * @see 
	 * 	- 2013-03-22	:	제환복
	***********************************************************************/	
	public void insertSVHE604UC_1(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE604UC_0");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List okList = new ArrayList();		
		Iterator it = pList.iterator();

		String empty1="";
		String BALGB="";
		String PYVND="";
		String CPRTN="";//CPRTN
		String MPRTN="";//CPRTN
		String PSPNO="";
		String CARCD="";
		String BDYCD="";
		
		//dao.startTransaction(); //tr 시작
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			BALGB =(String) pData.get("BALGB");
			PYVND ="0";
			CPRTN = "";
		if(BALGB.equals("DH") || BALGB.equals("DK")){
			Map ChkGET1 = (Map)dao.getReadData("pssallib.selectSVHE604UC_1_GET1",pData);
			//Map ChkGET1 = (Map)dao.getReadData2("pssallib.selectSVHE604UC_1_GET1",pData);
				if(ChkGET1!=null && ChkGET1.get("PYVND")!=null && !ChkGET1.get("PYVND").equals("")){
					PYVND = ChkGET1.get("PYVND").toString();
					//pData.put("PYVND", PYVND);
				}
				else{
					PYVND="0";
					//pData.put("PYVND", 0);
				}
			}
			else{
				if(BALGB.equals("EH")){
					PYVND="1900";
					//pData.put("PYVND", 1900);
				}
				if(BALGB.equals("EK")){
					PYVND="2000";
					//pData.put("PYVND", 2000);
				}				
			}
			//PYVND =(String) pData.get("PYVND");
			if(PYVND.equals("1900")){
				CPRTN = (String)pData.get("MPRTNB")+"-"+(String)pData.get("MPRTNC");	
			}
			if(PYVND.equals("2000")){
				CPRTN = (String)pData.get("MPRTN");
			}
			MPRTN =CPRTN;
			if(PYVND.equals("0")){
				MPRTN = (String)pData.get("MPRTN");
			}
			pData.put("PYVND", PYVND);
			pData.put("MPRTN", MPRTN);
			pData.put("CPRTN", CPRTN);
			okList.add(pData);
		}
		//dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE604UC", okList);
		new MiPlatformView().render(map, request, response);	
	}	

	public void insertSVHE604UC_2(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE604UC");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();
		List okList = new ArrayList();		
		Iterator it = pList.iterator();

		String empty1="";
		String BALGB="";
		String PYVND="";
		String CPRTN="";//CPRTN
		String MPRTN="";//CPRTN
		String PSPNO="";
		String CARCD="";
		String BDYCD="";
		
		//dao.startTransaction(); //tr 시작
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			PYVND = (String)pData.get("PYVND");
			CPRTN = (String)pData.get("CPRTN");
			HashMap pKey2 = new HashMap();
			pKey2.put("LIB1", (String)pArg.get("LIB1"));
			pKey2.put("P_CUSNO", PYVND);
			pKey2.put("P_CPRTN", CPRTN);
			pKey2.put("P_EDATM", "SUBSTR(trim(char(date(current date), ISO)),1,4) || SUBSTR(trim(char(date(current date), ISO)),6,2) || SUBSTR(trim(char(date(current date), ISO)),9,2)");
			Map getCGMPARMBB = (Map)dao.getReadData("pscomlib.selectCGMPARMBB",pKey2);
			if(getCGMPARMBB!=null && getCGMPARMBB.get("PRTNO")!=null && !getCGMPARMBB.get("PRTNO").equals("")){
				PSPNO = (String) getCGMPARMBB.get("PRTNO");
				HashMap pKey3 = new HashMap();
				pKey3.put("LIB2", (String)pArg.get("LIB2"));
				pKey3.put("COMPS", "E1");
				pKey3.put("PRTNO", PSPNO);
				Map getMST100PF = (Map)dao.getReadData("pscomlib.selectMST100PF",pKey3);
				if(getMST100PF!=null && getMST100PF.get("CARCD")!=null && !getMST100PF.get("CARCD").equals("")){
					CARCD = (String) getMST100PF.get("CARCD");
					BDYCD = (String) getMST100PF.get("BDYCD");
				}else{
					CARCD ="";
					BDYCD ="";
				}
			}
			else{
				PSPNO ="";			
				CARCD ="";
				BDYCD ="";				
			}
			pData.put("PSPNO", PSPNO);
			pData.put("CARCD", CARCD);
			pData.put("BDYCD", BDYCD);
			okList.add(pData);
			/*
			if(PYVND.equals("1900")||PYVND.equals("2000")){
				okList.add(pData);
			}else{
				errList.add(pData);	
			}
			*/
		}
		//dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE604UC_3", okList);
		//map.addAttribute("ds_SVHE604UC_1", okList);
		//map.addAttribute("ds_SVHE604UC_2", errList);
		new MiPlatformView().render(map, request, response);	
	}	
	public void insertSVHE604UC_3(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList_B = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE604UC_3");
		List pList_E = DataConverter.getMiPlatformMultiData(pReq, "ds_SVHE604UC_MOBISE");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		List okList = new ArrayList();		
		List errList = new ArrayList();

		Iterator it = pList_B.iterator();
		Iterator it_e = pList_E.iterator();
		String PYVND="";			
		String YOCDT="";			
		int VANDTASC=0;
		int VANDTB=0;
		String VANDTC="";
		dao.startTransaction(); //tr 시작
		//MOBISEB TR
		dao.deleteData("pssallib.deleteSVHE604UC_SVH600PF", pArg);
		dao.deleteData("pssallib.deleteSVHE604UC_SVH609PF", pArg);
		while (it.hasNext()) {
			Map pData = (Map) it.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			PYVND=(String) pData.get("PYVND");
			YOCDT=(String) pData.get("YOCDT");
			if(YOCDT.isEmpty()){
				YOCDT="0";
				pData.put("YOCDT", YOCDT);
			}
			if(PYVND.equals("1900")||PYVND.equals("2000")){
				dao.insertData("pssallib.insertSVHE604UC_SVH600PF", pData);
				okList.add(pData);
			}
			else{
				dao.insertData("pssallib.insertSVHE604UC_SVH609PF", pData);
				errList.add(pData);	
			}
		}
		//MOBISEE TR
		dao.updateData("pssallib.updateSVHE604UC_SVH601PF", pArg);	
		dao.insertData("pssallib.insertSVHE604UC_SVH601PF", pArg);
		dao.deleteData("pssallib.deleteSVHE604UC_SVH610PF", pArg);
		while (it_e.hasNext()) {
			Map pData = (Map) it_e.next();
			pData.put("LIB1", (String)pArg.get("LIB1"));
			pData.put("LIB2", (String)pArg.get("LIB2"));
			VANDTASC=Integer.parseInt((String) pData.get("VANDTASC"));
			if(VANDTASC==32){
				VANDTC="0";
			}
			else{
				VANDTB=Integer.parseInt(Long.toOctalString(VANDTASC).substring(1,3));
				VANDTC=Integer.toString(VANDTB);
				int len = VANDTC.length();
				int tmp = 7 - len;
				for (int i=0; i < tmp ; i++){
					VANDTC += "0";
				}
			}
			pData.put("VANDT", VANDTC);
						
			System.out.println(pData.get("COMGB") + "/"+
					pData.get("PSTNO") + "/"+
					pData.get("VORQY") + "/"+
					pData.get("AIRQY") + "/"+
					pData.get("SEAQY") + "/"+
					pData.get("VANDT") + "/"
					);
			
			dao.insertData("pssallib.insertSVHE604UC_SVH610PF", pData);	
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE604UC_1", okList);
		map.addAttribute("ds_SVHE604UC_2", errList);
		new MiPlatformView().render(map, request, response);
	}

	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/모비스 VAN관리 MENU/모비스 발주현황(협력업체별) 
	 * @exception 
	 * @see 
	 * 	- 2013-03-28	:	제환복
	***********************************************************************/ 
	public void selectSVHE606Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();
		Map pArg = DataConverter.getMiPlatformData(pReq);
		dao.startTransaction(); //tr 시작
		dao.deleteData("pssallib.deleteSVHE606Q_SVH605PF", pArg);
		dao.insertData("pssallib.insertSVHE606Q_SVH605PF", pArg);
		List list = dao.getListData("pssallib.selectSVHE606Q", pArg);
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVHE606Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업관리/VAN관리/일일출하수주이관관리 MENU/대우일일출하및수주량 CHECK LIST
	 * @exception 
	 * @see 
	 * 	- 2013-03-28	:	제환복
	***********************************************************************/ 
	public void selectSPDE123Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();
		Map pArg = DataConverter.getMiPlatformData(pReq);

		List list1 = dao.getListData("pssallib.selectSPDE123Q_122PF", pArg);
		List list2 = dao.getListData("pssallib.selectSPDE123Q_128PF", pArg);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPDE123Q_122PF", list1);
		map.addAttribute("ds_SPDE123Q_128PF", list2);
		new MiPlatformView().render(map, request, response);
	}		
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/일일출하수주이관관리 MENU/쌍용일일출하및수주량 CHECK LIST
	 * @exception 
	 * @see 
	 * 	- 2013-03-28	:	제환복
	***********************************************************************/ 
	public void selectSPDE131Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();
		Map pArg = DataConverter.getMiPlatformData(pReq);

		List list1 = dao.getListData("pssallib.selectSPDE131Q_131PF", pArg);
		List list2 = dao.getListData("pssallib.selectSPDE131Q_139PF", pArg);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPDE131Q_131PF", list1);
		map.addAttribute("ds_SPDE131Q_139PF", list2);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/일일출하수주이관관리 MENU/HKMC일일출하및수주량 CHECK LIST
	 * @exception 
	 * @see 
	 * 	- 2013-03-28	:	제환복
	***********************************************************************/ 
	public void selectSPDE141Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();
		Map pArg = DataConverter.getMiPlatformData(pReq);

		List list1 = dao.getListData("pssallib.selectSPDE141Q_142PF", pArg);
		List list2 = dao.getListData("pssallib.selectSPDE141Q_148PF", pArg);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPDE141Q_142PF", list1);
		map.addAttribute("ds_SPDE141Q_148PF", list2);
		new MiPlatformView().render(map, request, response);
	}
	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/일일출하수주이관관리 MENU/일일 수주이관전 ERROR LIST
	 * @exception 
	 * @see 
	 * 	- 2013-03-19	:	제환복
	***********************************************************************/ 
	public void selectSPDE125Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPDE125Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPDE125Q", list);
		new MiPlatformView().render(map, request, response);
	}	
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/일일출하수주이관관리 MENU/일일 수주이관전ERR(HKMC)
	 * @exception 
	 * @see 
	 * 	- 2013-03-19	:	제환복
	***********************************************************************/ 
	public void selectSPDE145Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPDE145Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPDE145Q", list);
		new MiPlatformView().render(map, request, response);
	}		
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/VAN관리/일일출하수주이관관리 MENU/일일 수주이관후 ERROR LIST
	 * @exception 
	 * @see 
	 * 	- 2013-03-19	:	제환복
	***********************************************************************/ 
	public void selectSPDE158Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSPDE158Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SPDE158Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  생산관리/마스터관리/품목정보 ALC CHECK LIST
	 * @exception 
	 * @see 
	 * 	- 2013-05-10	:	제환복
	***********************************************************************/ 
	public void selectSVME111Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSVME111Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVME111Q", list);
		new MiPlatformView().render(map, request, response);
	}

	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  자재관리/사입관리/ scrap ticket 등록
	 * @exception 
	 * @see 
	 * 	- 2013-05-10	:	lsk
	***********************************************************************/ 
	public void selectSZZE205_205PF(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE205_205PF", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE205_205PF", list);
		new MiPlatformView().render(map, request, response);
	}
	public void selectSZZE205_200PF(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE205_200PF", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE205_200PF", list);
		new MiPlatformView().render(map, request, response);
	}
	public void saveSZZE205(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SZZE205");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		
		List errList = new ArrayList();//추가
		Iterator it_d = pList.iterator();
		Iterator it_iu = pList.iterator();
		String rowType="";
		String pspnoCheck="";
		String update205="";
		String movcd="";

		dao.startTransaction(); //tr 시작
		dao.deleteData("pssallib.deleteSZZE205_200", pArg);
		while (it_d.hasNext()) { 
			Map pData = (Map) it_d.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			pData.put("DSLPNO", (String)pArg.get("DSLPNO"));
			update205 = (String)pArg.get("GUBUN");
			pspnoCheck = (String) pData.get("PRTNO");
			movcd = (String) pData.get("MOVCD");
			if (pspnoCheck != "") {
				if("Y".equals(update205)){
					if("Y".equals(movcd)){
						dao.updateData("pssallib.updateSZZE205_205", pData);
						dao.insertData("pssallib.insertSZZE205_200", pData);
					}
				}else{
					dao.insertData("pssallib.insertSZZE205_200", pData);
				}
			}
		}
		dao.endTransaction(); //commit
		ModelMap map = new ModelMap();//추가
		map.addAttribute("ds_SZZE205_CHECK", errList);//추가
		//new MiPlatformView().render(null, request, response);
		new MiPlatformView().render(map, request, response);	
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  scrap ticket cigma갱신
	 * @exception 
	 * @see 
	 * 	- 2013-05-10	:	lsk
	***********************************************************************/ 
	public void selectSZZE210C(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE210C", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE210C_200", list);
		new MiPlatformView().render(map, request, response);
	}
	public void saveSZZE210C(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SZZE210C");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it = pList.iterator();
		String rowType="";
		String stock_YN="";
		dao.startTransaction(); //tr 시작		
		while (it.hasNext()) {  
			Map pData = (Map) it.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			stock_YN = (String) pData.get("STK_GUB");
			//System.out.print("stock_YN ="+stock_YN+";");	
			if("Y".equals(stock_YN)){  
				dao.insertData("pssallib.insertSZZE210C_210", pData);
			}else{
				dao.insertData("pssallib.insertSZZE210C_220", pData);
			}
			dao.updateData("pssallib.updateSZZE210C_200", pData);
			dao.updateData("pssallib.updateSZZE210C_205", pData);
		}
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);	
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  업체재고마스타생성
	 * @exception 
	 * @see 
	 * 	- 2013-05-10	:	lsk
	 * @Revision History
	 *  - SW002
	***********************************************************************/ 
	public void selectSALE202UC(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSALE202UC", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SALE202UC", list);
		new MiPlatformView().render(map, request, response);
	}
	public void saveSALE202UC(HttpServletRequest request, HttpServletResponse response) throws Exception {
		PlatformRequest pReq = new PlatformRequest(request);
		pReq.receiveData();
		List pList = DataConverter.getMiPlatformMultiData(pReq, "ds_SEND");
		Map pArg = DataConverter.getMiPlatformData(pReq);
		Iterator it = pList.iterator();
		dao.startTransaction(); //tr 시작		
		while (it.hasNext()) {  
			Map pData = (Map) it.next();
			pData.put("LIB2", (String)pArg.get("LIB2"));
			dao.updateData("pssallib.updateSALE200", pData);  //sale200.xml와 같이사용
		}
		dao.endTransaction(); //commit
		new MiPlatformView().render(null, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  생산관리/CIGMA자료관리/SCRAP TICKET인쇄
	 * @exception 
	 * @see 
	 * 	- 2013-06-18	:	제환복
	***********************************************************************/ 
	public void selectSZZE201R(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE201R", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE201R", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  생산관리/CIGMA자료관리/SCRAP TICKET처리현황
	 * @exception 
	 * @see 
	 * 	- 2013-06-18	:	제환복
	***********************************************************************/ 
	public void selectSZZE203Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE203Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE203Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  생산관리/MAKER일일투입량관리/기아 일일부품 소요계획 현황
	 * @exception 
	 * @see 
	 * 	- 2013-12-24	:	제환복
	***********************************************************************/ 
	public void selectSVKE110Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		String SEL ="";
		SEL =(String) pData.get("SEL");
		List list1;
		if(SEL.equals("")){
			//System.out.print("전체");
			list1 = dao.getListData("pssallib.selectSVKE110Q_all", pData);
		}else if(SEL.equals("1")){
			//System.out.print("MAKER 일일투입량");
			list1 = dao.getListData("pssallib.selectSVKE110Q_1", pData);		
		}else{
			//System.out.print("MAKER 일일투입량 및 실시간 생산실적 반영");
			list1 = dao.getListData("pssallib.selectSVKE110Q_2", pData);
		}
		List list2 = dao.getListData("pssallib.selectSVKE110Q_SVK119PF", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SVKE110Q", list1);
		map.addAttribute("ds_SVKE110Q_SVK119PF", list2);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/관리/
	 * @exception 
	 * @see 
	 * 	- 2013-06-18	:	lsk
	***********************************************************************/ 
	public void selectSMDC454Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDC454Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDC454Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/관리/
	 * @exception 
	 * @see 
	 * 	- 2013-06-18	:	lsk
	***********************************************************************/ 
	public void selectSMDE454Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSMDE454Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SMDE454Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  영업관리/관리/
	 * @exception 
	 * @see 
	 * 	- 2013-06-18	:	lsk
	***********************************************************************/ 
	public void selectSZZE100Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE100Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE100Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  [DIKR] 영업관리/관리/
	 * @exception 
	 * @see 
	 * 	- 2016-01-29	:	lsk
	***********************************************************************/ 
	public void selectR_SALE155Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectR_SALE155Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_R_SALE155Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  [DIKR] 영업관리/판매계획/월판매계획 조회
	 * @exception 
	 * @see 
	 * 	- 2016-01-29	:	lsk
	***********************************************************************/ 
	public void selectR_SPMZ111Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectR_SPMZ111Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_R_SPMZ111Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  [DIKR] 영업관리/판매계획/월판매계획대실적 조회
	 * @exception 
	 * @see 
	 * 	- 2016-01-29	:	lsk
	***********************************************************************/ 
	public void selectR_SPMZ128Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectR_SPMZ128Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_R_SPMZ128Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  [DIKR] 영업관리/판매계획/년판매계획 조회
	 * @exception 
	 * @see 
	 * 	- 2016-01-29	:	lsk
	***********************************************************************/ 
	public void selectR_SPYZ201Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectR_SPYZ201Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_R_SPYZ201Q", list);
		new MiPlatformView().render(map, request, response);
	}
	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	-  [DIKR] 영업관리/판매계획/년판매계획대실적 조회
	 * @exception 
	 * @see 
	 * 	- 2016-01-29	:	lsk
	***********************************************************************/ 
	public void selectR_SPYZ906Q(HttpServletRequest request, HttpServletResponse response) throws Exception {			
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8");
		pReq.receiveData();	
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectR_SPYZ906Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_R_SPYZ906Q", list);
		new MiPlatformView().render(map, request, response);
	}

	/********************************************************************** 
	 * @param 
	 * 	- HttpServletRequest request			:   데이터셋, 파라미터
	 * @return 
	 * 	- HttpServletResponse response		:	데이터셋
	 * @hint
	 * 	- 영업기초자료관리/TRANSFER TICKET 조회       
	 * @exception 
	 * @see 
	 * 	- 2018-07-10	:	제환복
	***********************************************************************/
	
	public void selectSZZE103Q(HttpServletRequest request, HttpServletResponse response) throws Exception {	
		PlatformRequest pReq 	= new PlatformRequest(request, "UTF-8"); 
		pReq.receiveData();
		Map pData = DataConverter.getMiPlatformData(pReq);
		List list = dao.getListData("pssallib.selectSZZE103Q", pData);
		ModelMap map = new ModelMap();
		map.addAttribute("ds_SZZE103Q", list);
		new MiPlatformView().render(map, request, response);
	}
}    