<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
    
<sqlMap namespace="pscstlib">
	<select id="selectCZZZ100" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	SELECT 
		A.PRTNO, A.PROCS, A.PPPRI, A.MXASM, A.PRPRI, A.GROUP, TRIM(A.MANHR) AS MANHR, TRIM(A.MACHR) AS MACHR,
		TRIM(A.DICST) AS DICST, TRIM(B.ITDSC) AS ITDSC, B.ITTYP
	FROM
		$LIB1$.BM002PR A
		LEFT OUTER JOIN $LIB1$.BM008PR B ON A.PRTNO=B.ITNBR
	WHERE
		<isEqual property="SEL" compareValue="1">
		A.PROCS = #INPUT#
		</isEqual>
		<isEqual property="SEL" compareValue="2">
		A.PRTNO <![CDATA[>=]]> #INPUT#
		</isEqual>
	ORDER BY A.PRTNO
	</select>
	<select id="selectCZZZ100_Check" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	SELECT 
		COUNT(*) CNT 
	FROM
		$LIB1$.BM002PR
	WHERE 
		PRTNO = #PRTNO#
		AND PROCS = #PROCS#		
	</select>
	<update id="updateCZZZ100" parameterClass="java.util.HashMap">
	UPDATE 
		$LIB1$.BM002PR
	SET
		MANHR= #MANHR#,
		MACHR= #MACHR#,
		DICST= #DICST#
	WHERE 
		PRTNO = #PRTNO#
		AND PROCS = #PROCS#
	</update>
<select id="selectCYJC101Q_XX" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT
	A.PRDCD, A.PSPNO, A.ITDSC, E.CMPRICE, E.CMCRCY, J.MNFCS, 
	A.IQY04,A.IQY05,A.IQY06,A.IQY07,A.IQY08,A.IQY09,
	A.IQY10,A.IQY11,A.IQY12,A.IQY01,A.IQY02,A.IQY03,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY04*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY04*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY04*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY04*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY04*E.CMPRICE*$DMRATE$
	ELSE A.IQY04*E.CMPRICE END IAM04,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY05*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY05*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY05*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY05*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY05*E.CMPRICE*$DMRATE$
	ELSE A.IQY05*E.CMPRICE END IAM05,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY06*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY06*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY06*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY06*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY06*E.CMPRICE*$DMRATE$
	ELSE A.IQY06*E.CMPRICE END IAM06,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY07*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY07*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY07*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY07*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY07*E.CMPRICE*$DMRATE$
	ELSE A.IQY07*E.CMPRICE END IAM07,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY08*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY08*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY08*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY08*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY08*E.CMPRICE*$DMRATE$
	ELSE A.IQY08*E.CMPRICE END IAM08,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY09*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY09*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY09*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY09*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY09*E.CMPRICE*$DMRATE$
	ELSE A.IQY09*E.CMPRICE END IAM09,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY10*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY10*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY10*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY10*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY10*E.CMPRICE*$DMRATE$
	ELSE A.IQY10*E.CMPRICE END IAM10,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY11*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY11*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY11*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY11*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY11*E.CMPRICE*$DMRATE$
	ELSE A.IQY11*E.CMPRICE END IAM11,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY12*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY12*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY12*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY12*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY12*E.CMPRICE*$DMRATE$
	ELSE A.IQY12*E.CMPRICE END IAM12,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY01*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY01*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY01*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY01*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY01*E.CMPRICE*$DMRATE$
	ELSE A.IQY01*E.CMPRICE END IAM01,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY02*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY02*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY02*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY02*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY02*E.CMPRICE*$DMRATE$
	ELSE A.IQY02*E.CMPRICE END IAM02,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY03*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY03*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY03*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY03*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY03*E.CMPRICE*$DMRATE$
	ELSE A.IQY03*E.CMPRICE END IAM03
FROM
	(
	SELECT
		PRDCD,PSPNO,ITDSC,
		SUM(CASE WHEN PLNYM=$PLNYM04$ THEN REQQY ELSE 0 END) IQY04,
		SUM(CASE WHEN PLNYM=$PLNYM05$ THEN REQQY ELSE 0 END) IQY05,
		SUM(CASE WHEN PLNYM=$PLNYM06$ THEN REQQY ELSE 0 END) IQY06,
		SUM(CASE WHEN PLNYM=$PLNYM07$ THEN REQQY ELSE 0 END) IQY07,
		SUM(CASE WHEN PLNYM=$PLNYM08$ THEN REQQY ELSE 0 END) IQY08,
		SUM(CASE WHEN PLNYM=$PLNYM09$ THEN REQQY ELSE 0 END) IQY09,
		SUM(CASE WHEN PLNYM=$PLNYM10$ THEN REQQY ELSE 0 END) IQY10,
		SUM(CASE WHEN PLNYM=$PLNYM11$ THEN REQQY ELSE 0 END) IQY11,
		SUM(CASE WHEN PLNYM=$PLNYM12$ THEN REQQY ELSE 0 END) IQY12,
		SUM(CASE WHEN PLNYM=$PLNYM01$ THEN REQQY ELSE 0 END) IQY01,
		SUM(CASE WHEN PLNYM=$PLNYM02$ THEN REQQY ELSE 0 END) IQY02,
		SUM(CASE WHEN PLNYM=$PLNYM04$ THEN REQQY ELSE 0 END) IQY03
	FROM
		$LIB2$.FRY100PF
	WHERE
		COMPS=#COMPS#
		AND PRDGU NOT IN ('0','1','2')
		AND PLNYM BETWEEN $PLNYM04$ AND $PLNYM03$
		AND PLNGB = '$PLNGB$'
		AND PRDCD BETWEEN #PRDCD1# AND #PRDCD2#
	GROUP BY
		PRDCD,PSPNO,ITDSC
	)A
	LEFT OUTER JOIN (SELECT PRTNO,MNFCS FROM $LIB1$.$D30PR$) J ON A.PSPNO=J.PRTNO
	LEFT OUTER JOIN 
	(
	SELECT
		Z.*
	FROM
		(
		SELECT
			X.PRTNO, X.SPCOD, X.CMEDAT, X.CMPRICE, X.CMCRCY, X.CMTEMP, ROWNUMBER() OVER (PARTITION BY X.PRTNO) AS ROWNUM
		FROM
			(
			SELECT 
				PRTNO,SPCOD,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE2 
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE1 ELSE 0 END CMPRICE,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP2 
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP1 ELSE '' END CMTEMP,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY2
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY1 ELSE '' END CMCRCY,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT2
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT1 ELSE 0 END CMEDAT
			FROM 
				$LIB1$.CM001PR 
			WHERE
				PRCLS='1'
			) X,
			(SELECT 
				PRTNO,
				MAX(CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT3 
					WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT2
					WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT1 ELSE 0 END) MAXEDAT
			FROM 
				$LIB1$.CM001PR 
			WHERE
				PRCLS='1'
			GROUP BY 
				PRTNO
			) Y
		WHERE
			X.PRTNO=Y.PRTNO AND X.CMEDAT=Y.MAXEDAT
		) Z 
	WHERE 
		Z.ROWNUM=1 
	)E ON A.PSPNO=E.PRTNO
ORDER BY
	A.PRDCD,A.PSPNO
</select>
<select id="selectCYJC101Q" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT
	TRIM(A.PRDCD) AS PRDCD, TRIM(A.PSPNO) AS PSPNO, TRIM(A.ITDSC) AS ITDSC, <!-- E.CMPRICE, E.CMCRCY,  --> 0 AS CMPRICE, '' AS CMCRCY, J.MNFCS, 
	A.IQY04,A.IQY05,A.IQY06,A.IQY07,A.IQY08,A.IQY09,
	A.IQY10,A.IQY11,A.IQY12,A.IQY01,A.IQY02,A.IQY03,
	0 AS IAM04, 0 AS IAM05, 0 AS IAM06, 0 AS IAM07, 0 AS IAM08, 0 AS IAM09, 0 AS IAM10, 0 AS IAM11, 0 AS IAM12, 0 AS IAM01, 0 AS IAM02, 0 AS IAM03
	<!--
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY04*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY04*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY04*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY04*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY04*E.CMPRICE*$DMRATE$
	ELSE A.IQY04*E.CMPRICE END IAM04,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY05*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY05*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY05*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY05*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY05*E.CMPRICE*$DMRATE$
	ELSE A.IQY05*E.CMPRICE END IAM05,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY06*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY06*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY06*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY06*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY06*E.CMPRICE*$DMRATE$
	ELSE A.IQY06*E.CMPRICE END IAM06,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY07*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY07*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY07*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY07*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY07*E.CMPRICE*$DMRATE$
	ELSE A.IQY07*E.CMPRICE END IAM07,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY08*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY08*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY08*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY08*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY08*E.CMPRICE*$DMRATE$
	ELSE A.IQY08*E.CMPRICE END IAM08,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY09*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY09*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY09*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY09*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY09*E.CMPRICE*$DMRATE$
	ELSE A.IQY09*E.CMPRICE END IAM09,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY10*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY10*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY10*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY10*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY10*E.CMPRICE*$DMRATE$
	ELSE A.IQY10*E.CMPRICE END IAM10,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY11*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY11*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY11*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY11*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY11*E.CMPRICE*$DMRATE$
	ELSE A.IQY11*E.CMPRICE END IAM11,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY12*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY12*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY12*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY12*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY12*E.CMPRICE*$DMRATE$
	ELSE A.IQY12*E.CMPRICE END IAM12,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY01*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY01*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY01*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY01*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY01*E.CMPRICE*$DMRATE$
	ELSE A.IQY01*E.CMPRICE END IAM01,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY02*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY02*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY02*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY02*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY02*E.CMPRICE*$DMRATE$
	ELSE A.IQY02*E.CMPRICE END IAM02,
	CASE WHEN E.CMCRCY = 'UD' THEN A.IQY03*E.CMPRICE*$UDRATE$
 	     WHEN E.CMCRCY = 'JY' THEN A.IQY03*E.CMPRICE*$JYRATE$
	     WHEN E.CMCRCY = 'EU' THEN A.IQY03*E.CMPRICE*$EURATE$
	     WHEN E.CMCRCY = 'PD' THEN A.IQY03*E.CMPRICE*$PDRATE$
         WHEN E.CMCRCY = 'DM' THEN A.IQY03*E.CMPRICE*$DMRATE$
	ELSE A.IQY03*E.CMPRICE END IAM03 -->
FROM
	(
	SELECT
		PRDCD,PSPNO,ITDSC,
		SUM(CASE WHEN PLNYM=$PLNYM04$ THEN REQQY ELSE 0 END) IQY04,
		SUM(CASE WHEN PLNYM=$PLNYM05$ THEN REQQY ELSE 0 END) IQY05,
		SUM(CASE WHEN PLNYM=$PLNYM06$ THEN REQQY ELSE 0 END) IQY06,
		SUM(CASE WHEN PLNYM=$PLNYM07$ THEN REQQY ELSE 0 END) IQY07,
		SUM(CASE WHEN PLNYM=$PLNYM08$ THEN REQQY ELSE 0 END) IQY08,
		SUM(CASE WHEN PLNYM=$PLNYM09$ THEN REQQY ELSE 0 END) IQY09,
		SUM(CASE WHEN PLNYM=$PLNYM10$ THEN REQQY ELSE 0 END) IQY10,
		SUM(CASE WHEN PLNYM=$PLNYM11$ THEN REQQY ELSE 0 END) IQY11,
		SUM(CASE WHEN PLNYM=$PLNYM12$ THEN REQQY ELSE 0 END) IQY12,
		SUM(CASE WHEN PLNYM=$PLNYM01$ THEN REQQY ELSE 0 END) IQY01,
		SUM(CASE WHEN PLNYM=$PLNYM02$ THEN REQQY ELSE 0 END) IQY02,
		SUM(CASE WHEN PLNYM=$PLNYM03$ THEN REQQY ELSE 0 END) IQY03
	FROM
		$LIB2$.FRY100PF
	WHERE
		COMPS=#COMPS#
		AND PRDGU NOT IN ('0','1','2')
		AND PLNYM BETWEEN $PLNYM04$ AND $PLNYM03$
		AND PLNGB = '$PLNGB$'
		AND PRDCD BETWEEN #PRDCD1# AND #PRDCD2#
	GROUP BY
		PRDCD,PSPNO,ITDSC
	)A
	LEFT OUTER JOIN (SELECT PRTNO,MNFCS FROM $LIB1$.$D30PR$) J ON A.PSPNO=J.PRTNO
<!--
 	LEFT OUTER JOIN 
	(
	SELECT
		Z.*
	FROM
		(
		SELECT
			X.PRTNO, X.SPCOD, X.CMEDAT, X.CMPRICE, X.CMCRCY, X.CMTEMP, ROWNUMBER() OVER (PARTITION BY X.PRTNO) AS ROWNUM
		FROM
			(
			SELECT 
				PRTNO,SPCOD,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE2 
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE1 ELSE 0 END CMPRICE,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP2 
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP1 ELSE '' END CMTEMP,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY2
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY1 ELSE '' END CMCRCY,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT2
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT1 ELSE 0 END CMEDAT
			FROM 
				$LIB1$.CM001PR 
			WHERE
				PRCLS='1'
			) X,
			(SELECT 
				PRTNO,
				MAX(CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT3 
					WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT2
					WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT1 ELSE 0 END) MAXEDAT
			FROM 
				$LIB1$.CM001PR 
			WHERE
				PRCLS='1'
			GROUP BY 
				PRTNO
			) Y
		WHERE
			X.PRTNO=Y.PRTNO AND X.CMEDAT=Y.MAXEDAT
		) Z 
	WHERE 
		Z.ROWNUM=1 
	)E ON A.PSPNO=E.PRTNO -->
ORDER BY
	A.PRDCD,A.PSPNO
</select>
<select id="selectCYJC101Q_PRICE" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	SELECT
		Z.*
	FROM
		(
		SELECT
			TRIM(X.PRTNO) AS PRTNO, X.SPCOD, X.CMEDAT, X.CMPRICE, X.CMCRCY, X.CMTEMP, ROWNUMBER() OVER (PARTITION BY X.PRTNO) AS ROWNUM
		FROM
			(
			SELECT 
				PRTNO,SPCOD,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE2 
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN PRCE1 ELSE 0 END CMPRICE,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP2 
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN TEMP1 ELSE '' END CMTEMP,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY2
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN CRCY1 ELSE '' END CMCRCY,
				CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT3 
					 WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT2
					 WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT1 ELSE 0 END CMEDAT
			FROM 
				$LIB1$.CM001PR 
			WHERE
				PRCLS='1'
				AND PRTNO IN(
					SELECT
						PSPNO
					FROM
						$LIB2$.FRY100PF
					WHERE
						COMPS=#COMPS#
						AND PRDGU NOT IN ('0','1','2')
						AND PLNYM BETWEEN $PLNYM04$ AND $PLNYM03$
						AND PLNGB = '$PLNGB$'
						AND PRDCD BETWEEN #PRDCD1# AND #PRDCD2#
					GROUP BY
						PRDCD,PSPNO
				)
			) X,
			(SELECT 
				PRTNO,
				MAX(CASE WHEN EDAT3 != 99999999 AND EDAT3 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT3 
					WHEN EDAT2 != 99999999 AND EDAT2 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT2
					WHEN EDAT1 != 99999999 AND EDAT1 <![CDATA[<=]]> $YMDPRICE$ THEN EDAT1 ELSE 0 END) MAXEDAT
			FROM 
				$LIB1$.CM001PR 
			WHERE
				PRCLS='1'
				AND PRTNO IN(
					SELECT
						PSPNO
					FROM
						$LIB2$.FRY100PF
					WHERE
						COMPS=#COMPS#
						AND PRDGU NOT IN ('0','1','2')
						AND PLNYM BETWEEN $PLNYM04$ AND $PLNYM03$
						AND PLNGB = '$PLNGB$'
						AND PRDCD BETWEEN #PRDCD1# AND #PRDCD2#
					GROUP BY
						PRDCD,PSPNO
				)
			GROUP BY 
				PRTNO
			) Y
		WHERE
			X.PRTNO=Y.PRTNO AND X.CMEDAT=Y.MAXEDAT
		) Z 
	ORDER BY Z.PRTNO
</select>
<select id="selectCJJZ530Q" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT
	A.*,B.EDATM,B.PRICE,C.CUSNM,
	D.RMATC,D.RMATL,D.RMATI,D.RMIMC,D.PURCS,D.PURCL,D.PURCI,D.PPIMC,D.PRCST,D.LABCS,D.DEPCS,D.MFEXP,D.DIECS,D.MOHCS

FROM
	(
	SELECT 
		SUBSTR(B.ITCLS,1,1) AA, A.PSPNO, B.ITDSC,	A.PYVND, SUM(A.MONQY) MONQY01
	FROM
		$LIB2$.SPY200PF A
		LEFT OUTER JOIN (SELECT ITNBR,ITDSC,ITCLS FROM $LIB1$.BM008PR) B ON A.PSPNO=B.ITNBR
	WHERE
		PLNYM BETWEEN $PLNYM_F$ AND $PLNYM_T$
		AND MONQY != 0
		AND PLNGB = #PLNGB#
	GROUP BY
		SUBSTR(B.ITCLS,1,1), A.PSPNO, B.ITDSC,	A.PYVND
	) A LEFT OUTER JOIN 
		(SELECT	* FROM $LIB1$.EM001PR A WHERE EDATM = (SELECT MAX(EDATM) FROM $LIB1$.EM001PR B WHERE A.CUSNO=B.CUSNO AND A.PRTNO=B.PRTNO)) B ON A.PYVND=B.CUSNO AND A.PSPNO=B.PRTNO	
	LEFT OUTER JOIN (SELECT CUSNO,CUSNM FROM $LIB1$.CUSMAS) C ON A.PYVND=C.CUSNO
	LEFT OUTER JOIN (SELECT * FROM $LIB1$.$D30PR$) D ON A.PSPNO=D.PRTNO
ORDER BY
	A.PYVND,A.PSPNO
</select>
<select id="selectCJJZ501Q" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT
	A.PYVND, A.PSPNO, 
	E.ITDSC, F.MSTSM, A.YESCS, B.EDATM, B.PRICE, 
	C.KRSUR, C.SURKR, C.SURUS, C.SURJP, C.SURUR, C.KRPUR, C.KRCKD, C.CKDUS, C.CKDJP, C.CKDUR, C.CKDKR, 
	SUM(CASE PLNYM WHEN $YM04$ THEN A.MONQY ELSE 0 END) YM04QY,	SUM(CASE PLNYM WHEN $YM05$ THEN A.MONQY ELSE 0 END) YM05QY,
	SUM(CASE PLNYM WHEN $YM06$ THEN A.MONQY ELSE 0 END) YM06QY,	SUM(CASE PLNYM WHEN $YM07$ THEN A.MONQY ELSE 0 END) YM07QY,
	SUM(CASE PLNYM WHEN $YM08$ THEN A.MONQY ELSE 0 END) YM08QY,	SUM(CASE PLNYM WHEN $YM09$ THEN A.MONQY ELSE 0 END) YM09QY,
	SUM(CASE PLNYM WHEN $YM10$ THEN A.MONQY ELSE 0 END) YM10QY,	SUM(CASE PLNYM WHEN $YM11$ THEN A.MONQY ELSE 0 END) YM11QY,
	SUM(CASE PLNYM WHEN $YM12$ THEN A.MONQY ELSE 0 END) YM12QY,	SUM(CASE PLNYM WHEN $YM01$ THEN A.MONQY ELSE 0 END) YM01QY,
	SUM(CASE PLNYM WHEN $YM02$ THEN A.MONQY ELSE 0 END) YM02QY,	SUM(CASE PLNYM WHEN $YM03$ THEN A.MONQY ELSE 0 END) YM03QY
FROM
	(
	SELECT 
		PLNYM,PYVND,PLNGB,PSPNO,CARCD,MONQY,YESCS
	FROM
		$LIB2$.SPY200PF
	WHERE
		PLNYM BETWEEN $PLNYM_F$ AND $PLNYM_T$
		AND MONQY != 0
		AND PLNGB = #PLNGB#
	) A 
		LEFT OUTER JOIN (SELECT ITNBR,ITDSC,ITCLS FROM $LIB1$.BM008PR) E ON A.PSPNO=E.ITNBR
		LEFT OUTER JOIN (SELECT MSTCD,MSTSM FROM $LIB2$.MST051LF where COMPS=#COMPS#) F ON A.CARCD = F.MSTCD 
		LEFT OUTER JOIN (SELECT	* FROM $LIB1$.EM001PR A WHERE EDATM = (SELECT MAX(EDATM) FROM pereslib.EM001PR B WHERE A.CUSNO=B.CUSNO AND A.PRTNO=B.PRTNO)) B ON A.PYVND=B.CUSNO AND A.PSPNO=B.PRTNO	
		LEFT OUTER JOIN $LIB2$.CJJ500PF C ON A.PSPNO=C.STPNO
GROUP BY
	A.PYVND, A.PSPNO, 
	E.ITDSC, F.MSTSM, A.YESCS, B.EDATM, B.PRICE,  
	C.KRSUR, C.SURKR, C.SURUS, C.SURJP, C.SURUR, C.KRPUR, C.KRCKD, C.CKDUS, C.CKDJP, C.CKDUR, C.CKDKR
ORDER BY
	A.PYVND,A.PSPNO
</select>

<select id="selectCJJZ741Q_1" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT	
	A.PYVND, A.PROCS, A.PSPNO, D.EDATM,D.PRICE, B.UNMSR,B.ITTYP, B.ITDSC, C.KRSUR,C.SURKR,C.SURUS,C.SURJP,
	C.SURUR,C.KRPUR,C.KRCKD,C.CKDUS,C.CKDJP,C.CKDUR,C.CKDKR,C.KRPAT,C.KRCOT,
	C.MCHMU,C.MAGER,C.HNDTM,C.DRMAN,C.SBMAN,C.DRMCH,C.SBMCH,C.EPCKD,
	C.DANGU,C.DANST,C.DANDT,C.CRTDT,C.CHGDT,
	SUM(A.PRTQY) PRTQY
FROM	
	$LIB2$.FMD100PF A  
	LEFT OUTER JOIN $LIB1$.BM008PR B ON A.PSPNO = B.ITNBR
	LEFT OUTER JOIN $LIB2$.CJJ700PF C ON A.PSPNO=C.STPNO
	LEFT OUTER JOIN (SELECT A.PRTNO,A.CUSNO,A.EDATM,A.PRICE FROM $LIB1$.EM001PR A WHERE EDATM = (SELECT MAX(EDATM) FROM $LIB1$.EM001PR B WHERE A.CUSNO=B.CUSNO AND A.PRTNO=B.PRTNO)) D ON A.PYVND=D.CUSNO AND A.PSPNO=D.PRTNO
WHERE  	
	A.TRNDT BETWEEN $TRNDT1$ AND $TRNDT2$
	AND  A.INPGU IN ('11','41')
GROUP BY	
	A.PYVND, A. PROCS, A.PSPNO, D.EDATM,D.PRICE, B.UNMSR,B.ITTYP, B.ITDSC, C.KRSUR,C.SURKR,C.SURUS,C.SURJP,
	C.SURUR,C.KRPUR,C.KRCKD,C.CKDUS,C.CKDJP,C.CKDUR,C.CKDKR,C.KRPAT,C.KRCOT,
	C.MCHMU,C.MAGER,C.HNDTM,C.DRMAN,C.SBMAN,C.DRMCH,C.SBMCH,C.EPCKD,
	C.DANGU,C.DANST,C.DANDT,C.CRTDT,C.CHGDT
ORDER BY 	
	1,2,3,4
</select>
<select id="selectCJJZ741Q_A" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT	
	A.PYVND, '' PROCS, A.PSPNO, D.EDATM,D.PRICE, B.UNMSR,B.ITTYP, B.ITDSC, C.KRSUR,C.SURKR,C.SURUS,C.SURJP,
	C.SURUR,C.KRPUR,C.KRCKD,C.CKDUS,C.CKDJP,C.CKDUR,C.CKDKR,C.KRPAT,C.KRCOT,
	C.MCHMU,C.MAGER,C.HNDTM,C.DRMAN,C.SBMAN,C.DRMCH,C.SBMCH,C.EPCKD,
	C.DANGU,C.DANST,C.DANDT,C.CRTDT,C.CHGDT,
	SUM(A.JPSQY) PRTQY
FROM	
	$LIB2$.SMD110PF A  
	LEFT OUTER JOIN $LIB1$.BM008PR B ON A.PSPNO = B.ITNBR
	LEFT OUTER JOIN $LIB2$.CJJ700PF C ON A.PSPNO=C.STPNO
	LEFT OUTER JOIN (SELECT A.PRTNO,A.CUSNO,A.EDATM,A.PRICE FROM $LIB1$.EM001PR A WHERE EDATM = (SELECT MAX(EDATM) FROM $LIB1$.EM001PR B WHERE A.CUSNO=B.CUSNO AND A.PRTNO=B.PRTNO)) D ON A.PYVND=D.CUSNO AND A.PSPNO=D.PRTNO
WHERE  	
	A.JPSDT BETWEEN $TRNDT1$ AND $TRNDT2$
	AND  A.SATYP NOT IN ('51','61','71')
GROUP BY	
	A.PYVND, A.PSPNO, D.EDATM,D.PRICE, B.UNMSR,B.ITTYP, B.ITDSC, C.KRSUR,C.SURKR,C.SURUS,C.SURJP,
	C.SURUR,C.KRPUR,C.KRCKD,C.CKDUS,C.CKDJP,C.CKDUR,C.CKDKR,C.KRPAT,C.KRCOT,
	C.MCHMU,C.MAGER,C.HNDTM,C.DRMAN,C.SBMAN,C.DRMCH,C.SBMCH,C.EPCKD,
	C.DANGU,C.DANST,C.DANDT,C.CRTDT,C.CHGDT
ORDER BY 
	1,2,3,4
</select>
<select id="selectCJJZ741Q_2" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT	
	A.PYVND, A. PROCS, A.PSPNO, D.EDATM,D.PRICE, B.UNMSR,B.ITTYP, B.ITDSC, 
	C.MNFCS, C.DIRCS, C.MCOST, C.RMATC, C.RMATL, C.RMATI, C.RMIMC, C.PURCS, C.PURCL, C.PURCI, C.PPIMC, C.PRCST, C.LABCS, C.DEPCS, C.MFEXP, C.DIECS, C.MOHCS, C.FIXDT,
	SUM(A.PRTQY) PRTQY
FROM	
	$LIB2$.FMD100PF A
	LEFT OUTER JOIN $LIB1$.BM008PR B ON A.PSPNO = B.ITNBR
	LEFT OUTER JOIN $LIB1$.$D30PR$ C ON A.PSPNO=C.PRTNO
	LEFT OUTER JOIN (SELECT A.PRTNO,A.CUSNO,A.EDATM,A.PRICE FROM $LIB1$.EM001PR A WHERE EDATM = (SELECT MAX(EDATM) FROM $LIB1$.EM001PR B WHERE A.CUSNO=B.CUSNO AND A.PRTNO=B.PRTNO)) D ON A.PYVND=D.CUSNO AND A.PSPNO=D.PRTNO
WHERE  	
	A.TRNDT BETWEEN $TRNDT1$ AND $TRNDT2$
	AND  A.INPGU IN ('11','41')
GROUP BY 	
	A.PYVND, A.PROCS, A.PSPNO, D.EDATM,D.PRICE, B.UNMSR,B.ITTYP, B.ITDSC, 
	C.MNFCS, C.DIRCS, C.MCOST, C.RMATC, C.RMATL, C.RMATI, C.RMIMC, C.PURCS, C.PURCL, C.PURCI, C.PPIMC, C.PRCST, C.LABCS, C.DEPCS, C.MFEXP, C.DIECS, C.MOHCS, C.FIXDT
ORDER BY	
	1,2,3,4
</select>
<select id="selectCJJZ741Q_B" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT	
	A.PYVND, '' PROCS, A.PSPNO, D.EDATM,D.PRICE, B.UNMSR,B.ITTYP, B.ITDSC, 
	C.MNFCS, C.DIRCS, C.MCOST, C.RMATC, C.RMATL, C.RMATI, C.RMIMC, C.PURCS, C.PURCL, C.PURCI, C.PPIMC, C.PRCST, C.LABCS, C.DEPCS, C.MFEXP, C.DIECS, C.MOHCS, C.FIXDT,
	SUM(A.JPSQY) PRTQY
FROM	
	$LIB2$.SMD110PF A
	LEFT OUTER JOIN $LIB1$.BM008PR B ON A.PSPNO = B.ITNBR
	LEFT OUTER JOIN $LIB1$.$D30PR$ C ON A.PSPNO=C.PRTNO
	LEFT OUTER JOIN (SELECT A.PRTNO,A.CUSNO,A.EDATM,A.PRICE FROM $LIB1$.EM001PR A WHERE EDATM = (SELECT MAX(EDATM) FROM $LIB1$.EM001PR B WHERE A.CUSNO=B.CUSNO AND A.PRTNO=B.PRTNO)) D ON A.PYVND=D.CUSNO AND A.PSPNO=D.PRTNO
WHERE  	
	A.JPSDT BETWEEN $TRNDT1$ AND $TRNDT2$
	AND  A.SATYP NOT IN ('51','61','71')
GROUP BY 	
	A.PYVND, A. PROCS, A.PSPNO, D.EDATM,D.PRICE, B.UNMSR,B.ITTYP, B.ITDSC, 
	C.MNFCS, C.DIRCS, C.MCOST, C.RMATC, C.RMATL, C.RMATI, C.RMIMC, C.PURCS, C.PURCL, C.PURCI, C.PPIMC, C.PRCST, C.LABCS, C.DEPCS, C.MFEXP, C.DIECS, C.MOHCS, C.FIXDT
ORDER BY	
	1,2,3,4
</select>

<select id="selectCJJZ301Q" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT
	A.*,B.ITDSC
FROM
	(
	SELECT
		ROWNUMBER() OVER() AS ROWNUM,
		X.PRTNO,X.PROCD,X.MNFCS,X.DIRCS,X.MCOST,X.RMATC,X.RMATL,X.RMATI,X.RMIMC,X.PURCS,X.PURCL,
		X.PURCI,X.PPIMC,X.PRCST,X.LABCS,X.DEPCS,X.MFEXP,X.DIECS,X.MOHCS,X.FIXDT,X.RCOMP,X.BRMTL,
		X.BRMTI,X.BRMIC,X.BPURL,X.BPURI,X.BPPIC,X.BLABC,X.BDEPC,X.BMEXP,X.BDIEC,X.OCEAN,
		<isEqual property="GUB" compareValue="A">
		0 AS INSDT
		</isEqual>
		<isEqual property="GUB" compareValue="B">
		X.INSDT
		</isEqual>
	FROM
		<isEqual property="GUB" compareValue="A">
		$LIB1$.$D30PF$ X
		</isEqual>
		<isEqual property="GUB" compareValue="B">
		$LIB2$.$D30PF$ X
		</isEqual>
	<isEqual property="GUB" compareValue="A">
	<isNotEmpty property="ITCLS1">
	WHERE PROCD = #ITCLS1#
	</isNotEmpty>
	</isEqual>
	
	<isEqual property="GUB" compareValue="B">
	WHERE
		D30DT = #D30DT#
		<isNotEmpty property="ITCLS1">
		AND PROCD = #ITCLS1#
		</isNotEmpty>
	</isEqual>
	) A LEFT OUTER JOIN (SELECT ITNBR,ITDSC FROM $LIB1$.BM008PR) B ON A.PRTNO=B.ITNBR
WHERE
	A.ROWNUM BETWEEN $F_ROWNUM$ AND $T_ROWNUM$
</select>

<select id="selectCJJE200Q_exchange" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
SELECT
	A.ITNBR, A.ITDSC, A.UNMSR, A.ITTYP, TRIM(A.ENGNO) AS ENGNO,
	B.ECGAV AS RATE_UD, C.ECGAV AS RATE_JY, D.ECGAV AS RATE_EU, 
	SUBSTR(trim(char(date(current date), ISO)),1,4) AS CUR_YY
FROM
	$LIB1$.BM008PR A
	LEFT OUTER JOIN $LIB2$.CST060PF B ON B.ECGCD='제조원가' AND B.ECGCN='UD' AND B.ECGYY=SUBSTR(trim(char(date(current date), ISO)),1,4)  
	LEFT OUTER JOIN $LIB2$.CST060PF C ON C.ECGCD='제조원가' AND C.ECGCN='JY' AND C.ECGYY=SUBSTR(trim(char(date(current date), ISO)),1,4)  
	LEFT OUTER JOIN $LIB2$.CST060PF D ON D.ECGCD='제조원가' AND D.ECGCN='EU' AND D.ECGYY=SUBSTR(trim(char(date(current date), ISO)),1,4)  
WHERE
	A.ITNBR = #ITNBR#
</select>

<select id="selectCJJE200Q" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	SELECT * FROM
		$LIB2$.CJJ204PF
</select>
</sqlMap>
