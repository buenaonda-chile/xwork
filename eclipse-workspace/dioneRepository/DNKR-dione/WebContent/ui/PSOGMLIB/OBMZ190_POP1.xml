<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="584" Id="OBMZ190_POP" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="설비선택" TooltipFont="Default,0" Top="8" Ver="1.0" Width="528" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_MSHNO_POP">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="LINCD" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="0" TabStop="FALSE" Width="530"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="16" Id="title_text" Left="16" TabOrder="0" Top="8" Width="416"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_MSHNO_POP" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="582" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="518" Id="MainGrid_POP" InputPanel="FALSE" LineColor="#888888" MinWidth="100" OnCellDBLClick="MainGrid_POP_OnCellDblClick" Right="524" TabOrder="4" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="#94c1ea" WheelScrollRow="1" Width="524">
			<contents>
				<format id="Default">
					<columns>
						<col width="41"/>
						<col width="150"/>
						<col width="250"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" display="text" text="No."/>
						<cell bkcolor="#dfdfdf" col="1" color="#002043" display="text" text="설비코드"/>
						<cell bkcolor="#dfdfdf" col="2" color="#002043" display="text" text="설비명"/>
					</head>
					<body>
						<cell align="right" checklength="Byte" col="0" display="text" expr="currow+1" SuppressAlign="Middle"/>
						<cell align="left" checklength="Byte" col="1" colid="MSHNO" display="normal" suppress="2" SuppressAlign="Middle"/>
						<cell align="left" autosizing="none" checklength="Byte" col="2" colid="MSHNM" display="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="29" Id="searchBar" Left="1" TabOrder="5" Top="30" Width="523"></Static>
		<Button Height="26" Id="btn_CLOSE" ImageID="closeBtn" Left="448" OnClick="btn_CLOSE_OnClick" TabOrder="0" Text="닫기" Top="32" Width="75"></Button>
		<Button Height="26" Id="btn_SELECT" ImageID="btn2_sele2" Left="368" OnClick="btn_SELECT_OnClick" TabOrder="6" Text="닫기" Top="32" Width="75"></Button>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : Jae hb
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : OBMZ190_POP1.xml
 * ● PROGRAM DESCRIPTION  : 전라인가동현황-라인현황입력(설비선택)
 * ● DATE WRITTEN         : 2017.02.26
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");

var LINCD="";
function on_LoadCompleted(obj){
	getTitle();

	getOBMZ190_POP1(p_LINCD);
	
}
/********************************************************************** 
 * 내용설명 : 라인코드 조회
 **********************************************************************/ 
function getOBMZ190_POP1(p_LINCD){
	
	var sKind		= "getOBMZ190_POP1";						
	var sMethodName = "service::psogmlib/selectOGM_MSHNO_POP.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_MSHNO_POP=ds_MSHNO_POP";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부	
		//sArgument += " LINCD=" + quote(ds_OBMZ190.GetColumn(ds_OBMZ190.currow,"LINCD")); //설비코드
		sArgument += " LINCD=" + quote(p_LINCD); //설비코드
	http.Sync 	= true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync 	= false;
}
function btn_CLOSE_OnClick(obj)
{
	Close();
}

function btn_SELECT_OnClick(obj)
{
	var arrReturn  =  Array();
	arrReturn[0]  = ds_MSHNO_POP.GetColumn(ds_MSHNO_POP.row,"MSHNO");
	close(arrReturn);
}

function MainGrid_POP_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	btn_SELECT_OnClick();
}
]]></Script>
</Window>