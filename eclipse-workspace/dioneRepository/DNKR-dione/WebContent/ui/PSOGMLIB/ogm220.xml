<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="ogm220" Left="8" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="개선상세내역" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Class">
				<Contents>
					<colinfo id="code1" size="256" summ="default" type="STRING"/>
					<colinfo id="code_name" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm220"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm220_rep">
				<Contents>
					<colinfo id="KORNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPDPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEIMA" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="LINNM" size="256" summ="default" type="STRING"/>
					<colinfo id="KYORU" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKAN" size="256" summ="default" type="STRING"/>
					<colinfo id="IMGBF" size="256" summ="default" type="STRING"/>
					<colinfo id="IMGAF" size="256" summ="default" type="STRING"/>
					<colinfo id="WONIN" size="256" summ="default" type="STRING"/>
					<colinfo id="DAECH" size="256" summ="default" type="STRING"/>
					<colinfo id="ASUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CSUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DSUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TSUM" size="256" summ="default" type="STRING"/>
					<colinfo id="JISNO" size="256" summ="default" type="STRING"/>
					<colinfo id="WNDAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="592" Id="Static0" TabOrder="19" Top="32" Width="1060"></Static>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="1" TabStop="FALSE" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="17" Top="8" Width="1032"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="4" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="3" Width="24"></File>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="544" Id="Static14" Left="8" TabOrder="19" Top="72" Width="1040"></Static>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static1" Left="16" TabOrder="20" Text="테&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;마" Top="120" VAlign="Middle" Width="92"></Static>
		<Button Height="25" Id="btnExit" ImageID="closeBtn" Left="975" OnClick="btnExit_OnClick" TabOrder="16" Text="닫기" Top="40" Width="75"></Button>
		<Edit Align="CENTER" DisableBKColor="white" DisableColor="BACKGROUND" Enable="FALSE" Height="21" Id="lblmshno" Left="-256" TabOrder="17" TabStop="FALSE" Top="192" Visible="FALSE" Width="80"></Edit>
		<Static Font="굴림,18,Bold" Height="24" Id="Static8" Left="16" TabOrder="22" Text="개&#32;선&#32;상&#32;세&#32;내&#32;역" Top="40" Width="424"></Static>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static2" Left="16" TabOrder="23" Text="지시&#32;&#32;&#32;&#32;&#32;No" Top="88" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static3" Left="552" TabOrder="24" Text="협&#32;조&#32;부&#32;서" Top="120" VAlign="Middle" Width="92"></Static>
		<TextArea DisableBKColor="white" Enable="FALSE" Height="40" Id="txtteima" Left="112" TabOrder="4" TabStop="FALSE" Top="120" Width="384"></TextArea>
		<TextArea DisableBKColor="white" Enable="FALSE" Height="20" Id="txtkyoru" Left="648" TabOrder="6" TabStop="FALSE" Top="120" Width="384"></TextArea>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static4" Left="16" TabOrder="25" Text="대&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;상" Top="168" VAlign="Middle" Width="92"></Static>
		<TextArea DisableBKColor="white" Enable="FALSE" Height="104" Id="txtdaesn" Left="112" TabOrder="5" TabStop="FALSE" Top="168" Width="384"></TextArea>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static5" Left="552" TabOrder="26" Text="착&#32;&#32;&#32;안&#32;&#32;&#32;점" Top="168" VAlign="Middle" Width="92"></Static>
		<TextArea DisableBKColor="white" Enable="FALSE" Height="104" Id="txtchkan" Left="648" TabOrder="7" TabStop="FALSE" Top="168" Width="384"></TextArea>
		<Static Align="Center" Border="Flat" Height="32" Id="Static17" Left="112" TabOrder="27" Top="312" Width="200"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="24" Id="Static6" Left="112" TabOrder="28" Text="기계보전비의&#32;억제활동" Top="288" VAlign="Middle" Width="200" WordWrap="TRUE"></Static>
		<Edit Align="RIGHT" DisableBKColor="white" DisableColor="black" Enable="FALSE" Height="20" Id="txtasum" Left="120" Number="TRUE" OnKillFocus="calcu_OnKillFocus" TabOrder="8" TabStop="FALSE" Text="0" Top="320" Width="144"></Edit>
		<Image Border="Flat" FillType="STRETCH" Height="232" Id="picbefor" Left="112" TabOrder="13" TabStop="FALSE" Top="376" Width="288"></Image>
		<Image Border="Flat" FillType="STRETCH" Height="232" Id="picafter" Left="656" TabOrder="14" TabStop="FALSE" Top="376" Width="288"></Image>
		<Image Border="Flat" FillType="STRETCH" Height="24" Id="PictureBox1" Left="584" TabOrder="18" TabStop="FALSE" Top="576" Visible="FALSE" Width="32"></Image>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static9" Left="560" TabOrder="30" Text="개&#32;&#32;&#32;선&#32;&#32;&#32;후" Top="376" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static10" Left="16" TabOrder="31" Text="개&#32;&#32;&#32;선&#32;&#32;&#32;전" Top="376" VAlign="Middle" Width="92"></Static>
		<Static Height="16" Id="Static11" Left="927" TabOrder="32" Text="총효과금액" Top="296" Width="81"></Static>
		<Static Height="16" Id="Static12" Left="983" TabOrder="33" Text="천원/Y" Top="344" Width="49"></Static>
		<Static Height="13" Id="Static7" Left="270" TabOrder="34" Text="천원/Y" Top="320" Width="42"></Static>
		<Static Align="Center" Border="Flat" Height="32" Id="Static13" Left="312" TabOrder="35" Top="312" Width="200"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="24" Id="Static15" Left="312" TabOrder="36" Text="생산성&#32;향상활동" Top="288" VAlign="Middle" Width="200" WordWrap="TRUE"></Static>
		<Static Height="13" Id="Static16" Left="470" TabOrder="37" Text="천원/Y" Top="323" Width="42"></Static>
		<Edit Align="RIGHT" DisableBKColor="white" DisableColor="black" Enable="FALSE" Height="20" Id="txtbsum" Left="320" Number="TRUE" OnKillFocus="calcu_OnKillFocus" TabOrder="9" TabStop="FALSE" Text="0" Top="320" Width="144"></Edit>
		<Static Align="Center" Border="Flat" Height="32" Id="Static18" Left="512" TabOrder="38" Top="312" Width="200"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="24" Id="Static19" Left="512" TabOrder="39" Text="설비에&#32;관한&#32;개선활동" Top="288" VAlign="Middle" Width="200" WordWrap="TRUE"></Static>
		<Static Height="13" Id="Static20" Left="670" TabOrder="40" Text="천원/Y" Top="323" Width="42"></Static>
		<Edit Align="RIGHT" DisableBKColor="white" DisableColor="black" Enable="FALSE" Height="20" Id="txtcsum" Left="520" Number="TRUE" OnKillFocus="calcu_OnKillFocus" TabOrder="10" TabStop="FALSE" Text="0" Top="320" Width="144"></Edit>
		<Static Align="Center" Border="Flat" Height="32" Id="Static21" Left="712" TabOrder="41" Top="312" Width="200"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="24" Id="Static22" Left="712" TabOrder="42" Text="경비절감활동" Top="288" VAlign="Middle" Width="200" WordWrap="TRUE"></Static>
		<Static Height="13" Id="Static23" Left="870" TabOrder="43" Text="천원/Y" Top="323" Width="42"></Static>
		<Edit Align="RIGHT" DisableBKColor="white" DisableColor="black" Enable="FALSE" Height="20" Id="txtdsum" Left="720" Number="TRUE" OnKillFocus="calcu_OnKillFocus" TabOrder="11" TabStop="FALSE" Text="0" Top="320" Width="144"></Edit>
		<Edit Align="CENTER" DisableBKColor="white" DisableColor="black" Enable="FALSE" Height="20" Id="lblcallerboard" ImeMode="none" Left="264" TabOrder="3" TabStop="FALSE" Top="88" UseIME="FALSE" Visible="FALSE" Width="96"></Edit>
		<Edit Align="CENTER" Enable="FALSE" Height="20" Id="txtjisno220" Left="112" OnKillFocus="calcu_OnKillFocus" TabOrder="2" TabStop="FALSE" Top="88" Width="144"></Edit>
		<Edit Align="RIGHT" DisableBKColor="white" DisableColor="black" Enable="FALSE" Height="20" Id="txttsum" Left="928" Number="TRUE" OnKillFocus="calcu_OnKillFocus" TabOrder="12" TabStop="FALSE" Text="0" Top="312" Width="104"></Edit>
		<Button Height="25" Id="ReportButton1" ImageID="btn2_publ2" Left="896" OnClick="ReportButton1_OnClick" TabOrder="15" Text="Button1" Top="40" Width="75"></Button>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : Jae hb
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : ogm220.xml
 * ● PROGRAM DESCRIPTION  : 개선상세내역 View
 * ● DATE WRITTEN         : 2011.11.09
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");

var userId = G_ds_user.GetColumn(0,"USER_ID");
var userNm = G_ds_user.GetColumn(0,"USER_NAME");

//var imgVpath="C:/DIONE_UPDOWN_FILE";
//var imgVpath="http://10.72.209.23/DIONE_UPDOWN_FILE";
var imgVpath=G_baseURL+"DIONE_UPDOWN_FILE";
//var imgVpath="http://dione.dnpe.co.kr/DIONE_UPDOWN_FILE";
//var imgUPDOWNpath="C:/DIONE_UPDOWN_FILE/bojen/images/";


function on_LoadCompleted(obj){
	getTitle();	
	getDesign();
	//getComCode(); //공장구분 선택
	getogm220();
	//gFcOnTopButtonColor("0"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	

}

function getComCode(){
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		sArgument   += " CODE1=" + quote(company);		
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	ComboBoxPlant.Value=comps;
//	ComboBoxPlant.Enable = false; 
}

function getDesign(){	
	searchBar.Width = G_ds_design.GetColumn(0,"Width");
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	
}

/********************************************************************** 
 * 내용설명 : 조회
 **********************************************************************/ 
 function getogm220()
{

	var sKind		= "getogm220";						
	var sMethodName = "service::psogmlib/selectOgm220.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm220=ds_ogm220";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(comps1); //사업부
		sArgument += " JISNO=" + quote(jisno1); //
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	
	txtjisno220.Text=jisno1;
	txtteima.Text = trim(ds_ogm220.GetColumn(0,"TEIMA"));
	txtdaesn.Text = trim(ds_ogm220.GetColumn(0,"DAESN"));
	txtchkan.Text = trim(ds_ogm220.GetColumn(0,"CHKAN"));
	txtkyoru.text  = trim(ds_ogm220.GetColumn(0,"KYORU"));
	txtasum.Text = trim(ds_ogm220.GetColumn(0,"A_SUM"));
	txtbsum.Text = trim(ds_ogm220.GetColumn(0,"B_SUM"));
	txtcsum.Text = trim(ds_ogm220.GetColumn(0,"C_SUM"));
	txtdsum.text  = trim(ds_ogm220.GetColumn(0,"D_SUM"));
	txttsum.Text = trim(ds_ogm220.GetColumn(0,"T_SUM"));
	
//alert(ds_ogm220.GetColumn(0,"IMGBF"));	
//alert(substr(trim(ds_ogm220.GetColumn(0,"IMGAF")),14,15));	
	//picbefor.ImageID = trim(ds_ogm220.GetColumn(0,"IMGBF"));
	//picafter.ImageID = substr(trim(ds_ogm220.GetColumn(0,"IMGAF")),14,11);

	if(length(trim(ds_ogm220.GetColumn(0,"IMGBF")))!=0){
		//picbefor.ImageID=AliasToRealPath("%ROOT%" + imgVpath+trim(ds_ogm220.GetColumn(0,"IMGBF")));
		picbefor.ImageID=imgVpath+trim(ds_ogm220.GetColumn(0,"IMGBF"));
	}
	else{
		picbefor.ImageID="";
	}
	if(length(trim(ds_ogm220.GetColumn(0,"IMGAF")))!=0){
		//picafter.ImageID=AliasToRealPath("%ROOT%" + imgVpath+trim(ds_ogm220.GetColumn(0,"IMGAF")));
		picafter.ImageID=imgVpath+trim(ds_ogm220.GetColumn(0,"IMGAF"));
	}
	else{
		picafter.ImageID="";
	}	
}

/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){
		alert(setPopMessage("1002"));
		setMessage("1002");
	// tran 성공	
	}else if(svcId=="getogm220"){
	// 조회건수가 없을경우
		if(ds_ogm220.rowcount <= 0){
			alert(setPopMessage("1003"));
			setMessage("1003");	
		// 정상 조회
		} else {
			alert(setPopMessage("1004"));
			setMessage("1004");				
		}
		// tran 성공	
	}else if(svcId=="setUserList"){
		alert(setPopMessage("1001"));
		setMessage("1001");
	}
}


/********************************************************************** 
 * 내용설명 : 엑셀파일로 저장
 **********************************************************************/ 
function setExcel()
{
	var fName   = "개선상세내역";
	var arrSheets  =  Array();  

	arrSheets[0]  = "Grid_ogm220|개선상세내역";
	createExcelSheetS2(FileDialog0, fName ,arrSheets);

}

/********************************************************************** 
 * 내용설명 : 데이터셋 상태 체크
 **********************************************************************/ 
function ds_ogm220_OnRowPosChanged(obj,nOldRow,nRow){
	//로우타입 insert만 ED박스 enable
	if(ds_ogm220.GetRowType(ds_ogm220.currow)=="insert"){
		ed_maker.Enable=true;
	}else{
		ed_maker.Enable=false;
	}
}


/********************************************************************** 
 * 내용설명 : Sort
 **********************************************************************/ 
function Grid0_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) lib_grid_SetGridSort(obj,nCell);
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	getogm220();
}

function fn_Input()
{
	if(checkInsertCount("ds_ogm200")== false) return;
	ds_ogm220.AddRow();
}

function fn_Delete()
{
	ds_ogm220.DeleteRow(ds_ogm220.currow);
}

function fn_Save()
{
	setogm220();
}

function fn_print()
{
	alert("fn_print");
}

function fn_Excel()
{
	setExcel();
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("0"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}


function btnExit_OnClick(obj)
{
	close();
}
function reportQuery()
{
	http.Sync 	= true;
	var sKind		= "getogm220_rep";						
	var sMethodName = "service::psogmlib/selectOgm220_rep.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm220_rep=ds_ogm220_rep";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(comps1); //사업부
		sArgument += " JISNO=" + quote(jisno1); // 
		sArgument += " IMGPATH=" + quote(imgVpath); //SQL이미지경로
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

function ReportButton1_OnClick(obj)
{
	reportQuery();
	//dialog("psogmlib::ogm220_rep.xml","");
	dialog("psogmlib::ogm220_rep.xml", "",300,300,"TitleBar=false");

}
]]></Script>
</Window>