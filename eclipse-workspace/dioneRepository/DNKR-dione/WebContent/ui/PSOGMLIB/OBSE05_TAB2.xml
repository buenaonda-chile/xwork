<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="528" Id="UserList" Left="8" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="전광판&#32;생산잔업지시" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="850" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="DS_OBSE04_Tab1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_daygu">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd></cd>
						<cdnm>[전체]</cdnm>
					</record>
					<record>
						<cd>D</cd>
						<cdnm>주간</cdnm>
					</record>
					<record>
						<cd>N</cd>
						<cdnm>야간</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_COMP"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_userCompany"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_runcd">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>R</cd>
						<cdnm>가동</cdnm>
					</record>
					<record>
						<cd>P</cd>
						<cdnm>비가동</cdnm>
					</record>
					<record>
						<cd>S</cd>
						<cdnm>정지</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ppmi001mCode"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_daygu2">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>D</cd>
						<cdnm>주간</cdnm>
					</record>
					<record>
						<cd>N</cd>
						<cdnm>야간</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_OBSE04_Tab1Sub"></Dataset>
			<Dataset DataSetType="Dataset" Id="DS_DAYGUBUN">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CD>D</CD>
						<NAME>주간</NAME>
					</record>
					<record>
						<CD>N</CD>
						<NAME>야간</NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_OBSE05_TAB2_MSS">
				<Contents>
					<colinfo id="PRTNO" size="256" summ="default" type="STRING"/>
					<colinfo id="MINUS_QTY" size="256" summ="default" type="INT"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CYCTM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MSTSM" size="256" summ="default" type="STRING"/>
					<colinfo id="LOTSZ" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MULQY" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SPLIT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_OBSE05_TAB2_MSS_COUNT"></Dataset>
		</Datasets>
		<Static Border="Flat" BorderColor="INACTIVECAPTION" Height="109" Id="st_top" Left="1" TabOrder="9" Text="생산&#32;계획&#32;합계" Top="416" Width="845"></Static>
		<Static Border="Flat" BorderColor="INACTIVECAPTION" Height="259" Id="st_bottom" Left="1" TabOrder="10" Text="생산&#32;계획" Top="152" Width="845"></Static>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="DS_OBSE04_Tab1" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="408" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="200" Id="Grid_mid" InputPanel="FALSE" Left="4" LineColor="#888888" MinWidth="100" Right="842" TabOrder="0" TabStop="true" Top="208" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="#94c1ea" WheelScrollRow="1" Width="838">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="60"/>
						<col width="60"/>
						<col width="190"/>
						<col width="100"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="100"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" display="text" text="번호"/>
						<cell bkcolor="#dfdfdf" col="1" color="#002043" display="text" text="주야구분"/>
						<cell bkcolor="#dfdfdf" col="2" color="#002043" display="text" text="작업순서"/>
						<cell bkcolor="#dfdfdf" col="3" color="#002043" display="text" text="품번"/>
						<cell bkcolor="#dfdfdf" col="4" color="#002043" display="text" text="차종명"/>
						<cell bkcolor="#dfdfdf" col="5" color="#002043" display="text" text="지시수량"/>
						<cell bkcolor="#dfdfdf" col="6" color="#002043" display="text" text="텍트타임"/>
						<cell bkcolor="#dfdfdf" col="7" color="#002043" display="text" text="소요공수"/>
						<cell bkcolor="#dfdfdf" col="8" color="#002043" display="text" text="SEQ"/>
					</head>
					<body>
						<cell align="right" col="0" cursor="hand" display="text" expr="row+1"/>
						<cell align="left" col="1" colid="DAYGU" combocol="cd" combodataset="ds_daygu2" combotext="cdnm" display="combo" LimitDec="0"/>
						<cell align="right" col="2" colid="JOBSQ" display="normal"/>
						<cell align="left" col="3" colid="PRTNO" display="normal"/>
						<cell autosizing="none" col="4" colid="mstsm" display="text"/>
						<cell align="right" autosizing="none" col="5" colid="ORQTY" display="normal"/>
						<cell align="right" autosizing="none" col="6" colid="CYCTM" display="normal"/>
						<cell align="right" col="7" colid="ORQTY_CYCTM" color="#333333" display="number"/>
						<cell align="right" bkimagealign="left" col="8" colid="SEQNO" color="#333333" display="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="DS_OBSE04_Tab1Sub" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="520" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="88" Id="Grid_bottom" InputPanel="FALSE" Left="4" LineColor="#888888" MinWidth="100" Right="842" TabOrder="8" TabStop="true" Top="432" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="#94c1ea" WheelScrollRow="1" Width="838">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="87"/>
						<col width="96"/>
						<col width="80"/>
						<col width="80"/>
						<col width="140"/>
						<col width="140"/>
						<col width="140"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" display="text" text="번호"/>
						<cell bkcolor="#dfdfdf" col="1" color="#002043" display="text" text="주야구분"/>
						<cell bkcolor="#dfdfdf" col="2" color="#002043" display="text" text="작업인원"/>
						<cell bkcolor="#dfdfdf" col="3" color="#002043" display="text" text="시작시간"/>
						<cell bkcolor="#dfdfdf" col="4" color="#002043" display="text" text="종료시간"/>
						<cell bkcolor="#dfdfdf" col="5" color="#002043" display="text" text="작업공수"/>
						<cell bkcolor="#dfdfdf" col="6" color="#002043" display="text" text="계획공수"/>
						<cell bkcolor="#dfdfdf" col="7" color="#002043" display="text" text="차이공수"/>
					</head>
					<body>
						<cell align="center" col="0" cursor="hand" display="text" expr="row+1"/>
						<cell align="left" col="1" colid="DAYGU" combocol="cd" combodataset="ds_daygu2" combotext="cdnm" display="combo" LimitDec="0"/>
						<cell align="right" col="2" colid="PRMAN_QCMAN" display="normal"/>
						<cell align="left" col="3" colid="STRTM" display="text" Mask="##:##:##"/>
						<cell align="left" col="4" colid="ENDTM" display="text" Mask="##:##:##"/>
						<cell align="right" col="5" colid="ENDTM_STRTM" color="#333333" display="number"/>
						<cell align="right" col="6" colid="ORQTY_CYCTM" color="#333333" display="number"/>
						<cell align="right" col="7" colid="GAB" color="#333333" display="number"/>
					</body>
					<summary>
						<cell bkcolor="#dfdfdf" col="0" display="text"/>
						<cell align="center" bkcolor="#dfdfdf" col="1" display="text" text="합계"/>
						<cell align="right" bkcolor="#dfdfdf" col="2" display="text" expr='sum(&quot;PRMAN_QCMAN&quot;)'/>
						<cell bkcolor="#dfdfdf" col="3" display="text"/>
						<cell bkcolor="#dfdfdf" col="4" display="text"/>
						<cell align="right" bkcolor="#dfdfdf" col="5" display="text" expr='sum(&quot;ENDTM_STRTM&quot;)'/>
						<cell align="right" bkcolor="#dfdfdf" col="6" display="text" expr='sum(&quot;ORQTY_CYCTM&quot;)'/>
						<cell align="right" bkcolor="#dfdfdf" col="7" display="text" expr='sum(&quot;GAB&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Radio Border="Flat" BorderColor="INACTIVECAPTION" Height="28" Id="Radio0" INDEX="-1" Left="4" TabOrder="1" Top="172" Value="A" Width="263">
			<Contents>
				<Layout code="D" height="15" left="10" text="주간" top="5" width="50"/>
				<Layout code="N" height="15" left="100" text="야간" top="5" width="50"/>
				<Layout code="A" height="15" left="200" text="전체" top="5" width="50"/>
			</Contents>
		</Radio>
		<Combo BindDataset="DS_OBSE04_Tab1" CodeColumn="CD" Column="daygu" DataColumn="NAME" Height="20" Id="cmb_gubun_top" ImeMode="none" InnerDataset="DS_DAYGUBUN" Left="352" TabOrder="2" Top="175" Width="64"></Combo>
		<Static Height="12" Id="Static2" Left="289" TabOrder="11" Text="주야구분&#32;:" Top="180" Width="60"></Static>
		<Static Height="12" Id="Static0" Left="433" TabOrder="12" Text="작업순서&#32;:" Top="180" Width="60"></Static>
		<Static Height="12" Id="Static1" Left="577" TabOrder="13" Text="지시수량&#32;:" Top="180" Width="60"></Static>
		<Edit Align="RIGHT" BindDataset="DS_OBSE04_Tab1" Column="JOBSQ" Height="20" Id="ed_m_jobsq" Left="496" MaxLength="2" TabOrder="3" Top="175" Width="64"></Edit>
		<Edit Align="RIGHT" BindDataset="DS_OBSE04_Tab1" Column="ORQTY" Height="20" Id="ed_m_orqty" Left="640" MaxLength="7" TabOrder="4" Top="175" Width="64"></Edit>
		<Button Height="21" Id="btn_save" ImageID="comBtn_save" Left="725" OnClick="btn_save_OnClick" TabOrder="5" Text="저장" Top="174" Width="52"></Button>
		<Button Height="21" Id="btn_del" ImageID="comBtn_del" Left="785" OnClick="btn_del_OnClick" TabOrder="6" Text="삭제" Top="174" Width="52"></Button>
		<Static Border="Flat" BorderColor="INACTIVECAPTION" Height="144" Id="Static3" Left="1" TabOrder="14" Text="미&#32;생산&#32;계획" Top="4" Width="845"></Static>
		<Grid BindDataset="DS_OBSE05_TAB2_MSS" BkColor2="default" BoldHead="true" Bottom="145" Enable="true" EndLineColor="default" HeadHeight="25" Height="125" Id="Grid_top" InputPanel="FALSE" Left="4" LineColor="default" OnCellClick="Grid_top_OnCellClick" Right="424" TabOrder="15" TabStop="true" Top="20" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="420">
			<contents>
				<format id="Default">
					<columns>
						<col width="103"/>
						<col width="80"/>
						<col width="80"/>
						<col width="58"/>
						<col width="80"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" display="text" text="품번"/>
						<cell bkcolor="#dfdfdf" col="1" display="text" text="차종명"/>
						<cell bkcolor="#dfdfdf" col="2" display="text" text="미생산수량"/>
						<cell bkcolor="#dfdfdf" col="3" display="text" text="택트타임"/>
						<cell bkcolor="#dfdfdf" col="4" display="text" text="SEQ"/>
					</head>
					<body>
						<cell col="0" colid="PRTNO" display="text"/>
						<cell col="1" colid="MSTSM" display="text"/>
						<cell col="2" colid="MINUS_QTY" display="number"/>
						<cell col="3" colid="CYCTM" display="number"/>
						<cell col="4" colid="SEQ" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Height="21" Id="btn_save_misengsan" ImageID="comBtn_save" Left="775" OnClick="btn_save_misengsan_OnClick" TabOrder="16" Text="Button0" Top="20" Width="54"></Button>
		<Edit Align="RIGHT" Height="20" Id="ed_misengsan_jobsq" Left="624" MaxLength="2" TabOrder="17" Top="56" Width="64"></Edit>
		<Edit Align="RIGHT" Height="20" Id="ed_misengsan_orqty" Left="764" TabOrder="18" Top="56" Width="64"></Edit>
		<Static Height="12" Id="Static4" Left="561" TabOrder="19" Text="작업순서&#32;:" Top="60" Width="60"></Static>
		<Static Height="12" Id="Static5" Left="701" TabOrder="20" Text="지시수량&#32;:" Top="59" Width="60"></Static>
	</Form>
	<Script><![CDATA[ /*--------------------------------------------------------------
 * @version               : 1.0 
 * @author                : 김정현
 * @see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : OBSE05_2.xml
 * ● PROGRAM DESCRIPTION  : 전광판 생산현황 조회
 * ● DATE WRITTEN         : 2012.10.18
----------------------------------------------------------------*/

#include "script::lib_script_common.js";

var Lib = G_ds_user.GetColumn(0,"LIB2");
var nowDate = today();
var procs = "" ;
var ordat = "" ;

/********************************************************************** 
 * 개 발 자 : 김정현 
 * 개발일자 : 2012-10-26
 * 내용설명 : 화면로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj){
	getTitle();	
	//getComCode();
	ed_syyyymmdd.Value = nowDate;	
}


/********************************************************************** 
 * 개 발 자 : 김정현 
 * 개발일자 : 2012-10-08
 * 내용설명 : 화면조회
 * 주요변수 : 
 **********************************************************************/ 
function getOBSE05Tab2(){
          
	http.Sync = true;
	var sKind		= "getOBSE04Tab1";						
	var sMethodName = "service::psogmlib/selectOBSE04_Tab1.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "DS_OBSE04_Tab1=DS_OBSE04_Tab1";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	
	
	sArgument += " LIB=" + quote(Lib);
	sArgument += " COMPS=" + quote(G_ds_user.GetColumn(0,"PLANT_CD"));
	sArgument += " PROCS=" + quote(procs);	
	sArgument += " ORDAT=" + quote(ordat);	
	
	if (Radio0.Value = 'D') {
		sArgument += " DAYGU=D";
	} else if(Radio0.Value = 'N') {
		sArgument += " DAYGU=N";
	}
	
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");


	if(DS_OBSE04_Tab1.rowcount <= 0) return ;
	
	http.Sync = true;
	var sKind		= "getOBSE04Tab1Sub";						
	var sMethodName = "service::psogmlib/selectOBSE04_Tab1Sub.do";     			// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             							// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "DS_OBSE04_Tab1Sub=DS_OBSE04_Tab1Sub";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	

	sArgument += " LIB=" + quote(Lib);
	sArgument += " COMPS=" + quote(G_ds_user.GetColumn(0,"PLANT_CD"));
	sArgument += " PROCS=" + quote(procs);	
	sArgument += " ORDAT=" + quote(ordat);
	
	if (Radio0.Value = 'D') {
		sArgument += " DAYGU=D";
	} else if(Radio0.Value = 'N') {
		sArgument += " DAYGU=N";
	} else if(Radio0.Value = 'A') {
		sArgument += " DAYGU=%";
	}		

	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	
	
	////////////////////////////////////////////////////////////////////////////
	// 미생산 조회 추가
	
	var sKind		= "getOBSE04Tab2_mss";						
	var sMethodName = "service::psogmlib/selectOBSE05_Tab2_Misengsan.do";
	var sInDataSet  = "";                             				
	var sOutDataSet = "DS_OBSE05_TAB2_MSS=DS_OBSE05_TAB2_MSS";    			
	var sArgument   = "";
		
	sArgument += " LIB=" + quote(Lib);
	sArgument += " COMPS=" + quote(G_ds_user.GetColumn(0,"PLANT_CD"));
	sArgument += " PROCS=" + quote(procs);	
	sArgument += " ORDAT_YESTERDAY=" + quote(addDate(ordat, -1));	
	
	/*
	if (Radio0.Value = 'D') {
		sArgument += " DAYGU=D";
	} else if(Radio0.Value = 'N') {
		sArgument += " DAYGU=N";
	}
	*/
	
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
}


/********************************************************************** 
 * 개 발 자 : 김정현 
 * 개발일자 : 2012-10-06
 * 내용설명 : 엑셀파일로 저장
 * 주요변수 : 
 **********************************************************************/ 
function setExcel()
{
}


/********************************************************************** 
 * 개 발 자 : 김정현 
 * 개발일자 : 2012-10-26
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){
		alert(setPopMessage("1002"));
		setMessage("1002");		
	} else {
		alert(setPopMessage("1001"));
		setMessage("1001");	
		
		if(svcId=="insertOBSE05_Tab2_Misengsan" or svcId=="updateOBSE05_Tab2_Misengsan"){
			getOBSE05Tab2();
		}
	}
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤 함수들
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	getOBSE04Tab1();
}

function fn_Input()
{
}

function fn_Delete()
{	
}

function fn_Save()
{
	setPpmi006mTab1();
}

function fn_print()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Excel()
{
	setExcel();
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}


function btn_save_OnClick(obj)
{
	if(length(trim(ed_m_jobsq.Text)) <> 0 and length(trim(ed_m_orqty.Text)) <> 0) {

		// update
		var sKind		= "saveOBSE05_Tab2";						
		var sMethodName = "service::psogmlib/saveOBSE05_Tab2.do";     	// 서버에서 호출 될 Method 명
		var sInDataSet  = "DS_OBSE04_Tab1=DS_OBSE04_Tab1:U";  			// 자료 저장 시 보낼 DataSet 명칭
		var sOutDataSet = "";    							     		// 조회 후 돌려 받을 DataSet 명칭
		var sArgument   = "";
	
		sArgument += " PROCS=" + quote(procs);
		sArgument += " ORDAT=" + quote(ordat);		
		
		http.Sync=true;
		Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
		http.Sync=false;
	
	} else {
		alert("작업순서와 지시수량을 바르게 입력해 주세요!");
	}	
}

function btn_del_OnClick(obj)
{
	DS_OBSE04_Tab1.DeleteRow(DS_OBSE04_Tab1.currow);
	
	btn_save_OnClick();
}


function Grid_top_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{	
	ed_misengsan_orqty.Text	= DS_OBSE05_TAB2_MSS.GetColumn(nRow, "MINUS_QTY");
}

function btn_save_misengsan_OnClick(obj)
{
	if(length(trim(ed_misengsan_jobsq.Text)) <> 0 and length(trim(ed_misengsan_orqty.Text)) <> 0) {

		// 품번과SEQ로 카운트 조회해서
	
		var sKind		= "getOBSE04Tab2_mss_count_chk";						
		var sMethodName = "service::psogmlib/selectOBSE05_Tab2_Misengsan_Count_Chk.do";
		var sInDataSet  = "";                             				
		var sOutDataSet = "DS_OBSE05_TAB2_MSS_COUNT=DS_OBSE05_TAB2_MSS_COUNT";    			
		var sArgument   = "";
			
		sArgument += " LIB=" + quote(Lib);
		sArgument += " PROCS=" + quote(procs);	
		sArgument += " PROCS=" + quote(procs);	
		sArgument += " ORDAT=" + quote(ordat);	
		sArgument += " PRTNO=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "PRTNO"));
		sArgument += " SEQ=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "SEQ"));	
		
		http.Sync=true;
		Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");		
		http.Sync=false;
		
		if (DS_OBSE05_TAB2_MSS_COUNT.GetColumn(0, "dupli_cnt") > 0) {
			// 있으면 업데이트 날리고
			//alert("upate");
			var sKind		= "updateOBSE05_Tab2_Misengsan";						
			var sMethodName = "service::psogmlib/updateOBSE05_Tab2_Misengsan.do";     	// 서버에서 호출 될 Method 명
			var sInDataSet  = "";  														// 자료 저장 시 보낼 DataSet 명칭
			var sOutDataSet = "";    							     					// 조회 후 돌려 받을 DataSet 명칭
			var sArgument   = "";
		
			sArgument += " PROCS=" + quote(procs);
			sArgument += " ORDAT=" + quote(ordat);		
			sArgument += " JOBSQ=" + quote(ed_misengsan_jobsq.Text);	
			sArgument += " ORQTY=" + quote(ed_misengsan_orqty.Text);	
			sArgument += " SPLIT=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "SPLIT"));
			sArgument += " SEQNO=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "SEQNO")); 
			sArgument += " SERNO=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "SERNO"));
			sArgument += " PRTNO=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "PRTNO"));
			sArgument += " PRLOT=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "LOTSZ"));
			sArgument += " QTUNT=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "MULQY"));		
			sArgument += " CYCTM=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "CYCTM"));		
							
			http.Sync=true;
			Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
			http.Sync=false;		
			
		} else {
			// 없으면 insert 날려서 처리함.
			//alert("insert");
			var sKind		= "insertOBSE05_Tab2_Misengsan";						
			var sMethodName = "service::psogmlib/insertOBSE05_Tab2_Misengsan.do";     	// 서버에서 호출 될 Method 명
			var sInDataSet  = "";  														// 자료 저장 시 보낼 DataSet 명칭
			var sOutDataSet = "";    							     					// 조회 후 돌려 받을 DataSet 명칭
			var sArgument   = "";
		
			sArgument += " PROCS=" + quote(procs);
			sArgument += " ORDAT=" + quote(ordat);		
			sArgument += " JOBSQ=" + quote(ed_misengsan_jobsq.Text);	
			sArgument += " ORQTY=" + quote(ed_misengsan_orqty.Text);	
			sArgument += " SPLIT=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "SPLIT"));
			sArgument += " SEQNO=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "SEQNO")); 
			sArgument += " SERNO=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "SERNO"));
			sArgument += " PRTNO=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "PRTNO"));
			sArgument += " PRLOT=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "LOTSZ"));
			sArgument += " QTUNT=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "MULQY"));		
			sArgument += " CYCTM=" + quote(DS_OBSE05_TAB2_MSS.GetColumn(DS_OBSE05_TAB2_MSS.currow, "CYCTM"));		
							
			http.Sync=true;
			Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
			http.Sync=false;				
		}		
	} else {
		alert("작업순서와 지시수량을 바르게 입력해 주세요!");
	}
}
]]></Script>
</Window>