<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="ogm325" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="보전이력분석검색" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Class">
				<Contents>
					<colinfo id="code1" size="256" summ="default" type="STRING"/>
					<colinfo id="code_name" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm200_method">
				<Contents>
					<colimtbPaDatnfo id="jobcd" size="256" summ="default" type="STRING"/>
					<colinfo id="kogub" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm200_hmd020pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc220pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc250pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc270pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc030pf_01"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm200_chk"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cmbKdown">
				<Contents>
					<colinfo id="downValue" size="256" summ="default" type="STRING"/>
					<record>
						<downValue>0</downValue>
					</record>
					<record>
						<downValue>0.5</downValue>
					</record>
					<record>
						<downValue>1.0</downValue>
					</record>
					<record>
						<downValue>1.5</downValue>
					</record>
					<record>
						<downValue>2.0</downValue>
					</record>
					<record>
						<downValue>2.5</downValue>
					</record>
					<record>
						<downValue>3.0</downValue>
					</record>
					<record>
						<downValue>3.5</downValue>
					</record>
					<record>
						<downValue>4.0</downValue>
					</record>
					<record>
						<downValue>4.5</downValue>
					</record>
					<record>
						<downValue>5.0</downValue>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="552" Id="Static0" TabOrder="7" Top="72" Width="1060"></Static>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="1" TabStop="FALSE" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="3" Top="8" Width="1032"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="4" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="3" Width="24"></File>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="32" Id="searchBar" TabOrder="4" Top="31" Width="1060"></Static>
		<Combo CodeColumn="code2" DataColumn="code_name" Height="18" Id="ComboBoxPlant" InnerDataset="ds_ComCode_PLNT" Left="104" TabOrder="3" Top="37" Width="120"></Combo>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static9" Left="632" TabOrder="7" Text="보&#32;전&#32;방&#32;법" Top="207" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="jobcd" DataColumn="kogub" Height="20" Id="cmbJobCd" InnerDataset="ds_ogm200_method" Left="728" OnChanged="cmbJobCd_OnChanged" OnClick="cmbJobCd_OnClick" TabOrder="7" Top="208" Width="280"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static1" Left="8" TabOrder="13" Text="사&#32;&#32;&#32;업&#32;&#32;&#32;부" Top="36" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static7" Left="8" TabOrder="14" Text="파트&#32;&#32;&#32;&#32;No" Top="212" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static8" Left="8" TabOrder="15" Text="라&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;인" Top="244" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="prtcd" DataColumn="prtnm" Height="18" Id="cmbprtcd" InnerDataset="ds_obc270pf" Left="104" OnChanged="cmbprtcd_OnChanged" OnClick="cmbprtcd_OnClick" TabOrder="6" Top="213" Width="344"></Combo>
		<Combo CodeColumn="lincd" DataColumn="linnm" Height="18" Id="cmblincd" InnerDataset="ds_obc030pf_01" Left="104" OnChanged="cmblincd_OnChanged" OnClick="cmblincd_OnClick" TabOrder="8" Top="243" Width="344"></Combo>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="80" Id="Static12" Left="504" TabOrder="18" Top="216" Width="72"></Static>
		<Checkbox Height="21" Id="ckbBM" Left="552" OnClick="ckbBM_OnClick" TabOrder="16" Top="218" Value="FALSE" Width="16"></Checkbox>
		<Static Height="16" Id="Static13" Left="518" TabOrder="20" Text="BM" Top="224" Width="26"></Static>
		<Checkbox Height="21" Id="ckbPM" Left="552" OnClick="ckbPM_OnClick" TabOrder="17" Top="244" Value="FALSE" Width="16"></Checkbox>
		<Static Height="11" Id="Static29" Left="518" TabOrder="22" Text="PM" Top="249" Width="26"></Static>
		<Checkbox Height="21" Id="ckbCM" Left="552" OnClick="ckbCM_OnClick" TabOrder="18" Top="268" Value="FALSE" Width="16"></Checkbox>
		<Static Height="11" Id="Static30" Left="518" TabOrder="23" Text="CM" Top="273" Width="26"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static31" Left="632" TabOrder="25" Text="실&#32;시&#32;부&#32;서" Top="239" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="sdpcd" DataColumn="sdpnm" Height="20" Id="cmbsdpcd" InnerDataset="ds_obc250pf" Left="728" OnClick="cmbsdpcd_OnClick" TabOrder="9" Top="240" Width="280"></Combo>
		<Static Align="Center" Font="굴림,9,Bold" Height="24" Id="Static11" Left="488" LineSpacing="5" TabOrder="26" Text="보전작업구분" Top="200" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static38" Left="632" TabOrder="27" Text="책&#32;&#32;&#32;임&#32;&#32;&#32;자" Top="272" VAlign="Middle" Width="92"></Static>
		<Edit Height="20" Id="txtwrkm1" Left="728" MaxLength="7" Number="TRUE" OnKeyDown="txtwrkm1_OnKeyDown" OnKillFocus="txtwrkm1_OnKillFocus" TabOrder="13" Top="272" UpperOnly="TRUE" UseIME="FALSE" Width="136"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtkornm" Left="872" MaxLength="15" Readonly="TRUE" TabOrder="14" TabStop="FALSE" Top="273" UpperOnly="TRUE" Width="136"></Edit>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="56" Id="Static14" Left="8" TabOrder="32" Top="104" Width="1040"></Static>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Height="18" Id="dtpwndats" Left="304" LeftMargin="20" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="4" Top="120" Width="136"></Calendar>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Height="18" Id="dtpwndate" Left="616" LeftMargin="20" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="5" Top="120" Width="136"></Calendar>
		<Static Font="굴림,9,Bold" Height="17" Id="Static6" Left="225" TabOrder="30" Text="검색개시일" Top="122" VAlign="Middle" Width="71"></Static>
		<Static Font="굴림,9,Bold" Height="17" Id="Static10" Left="537" TabOrder="31" Text="검색종료일" Top="122" VAlign="Middle" Width="71"></Static>
		<Static Font="굴림,9" Height="16" Id="Static15" Left="488" TabOrder="32" Text="~" Top="128" Width="24"></Static>
		<Static Font="굴림,11,Bold" Height="14" Id="Static19" Left="25" TabOrder="33" Text="수리코드" Top="346" VAlign="Middle" Width="103"></Static>
		<Button Height="26" Id="btnClear" ImageID="btn2_indi2" Left="960" OnClick="btnClear_OnClick" TabOrder="2" Text="표시클리어" Top="34" Width="85"></Button>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static2" Left="632" TabOrder="35" Text="정&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;지" Top="304" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" Font="굴림,9" Height="16" Id="Static4" Left="856" LineSpacing="5" TabOrder="36" Text="H이상" Top="308" VAlign="Middle" Width="64" WordWrap="TRUE"></Static>
		<Radio Height="104" Id="RadioCode" INDEX="-1" Left="8" OnClick="RadioCode_OnClick" TabOrder="19" Top="368" Width="1040">
			<Contents>
				<Layout code="subas" height="20" left="90" text="ASSY분류" top="20" width="100"/>
				<Layout code="comcd" height="20" left="300" text="셋트부품" top="20" width="100"/>
				<Layout code="deccd" height="20" left="550" text="분해불가부품" top="20" width="100"/>
				<Layout code="chocd" height="20" left="800" text="처치" top="10" width="100"/>
				<Layout code="hyocd" height="20" left="90" text="현상" top="60" width="100"/>
				<Layout code="caucd" height="20" left="300" text="원인" top="60" width="100"/>
				<Layout code="trucd" height="20" left="550" text="실원인" top="60" width="100"/>
			</Contents>
		</Radio>
		<Edit Height="21" Id="lblselcd" Left="56" TabOrder="20" TabStop="FALSE" Top="80" Visible="FALSE" Width="36"></Edit>
		<Edit Height="21" Id="lblAndOr" Left="96" TabOrder="21" TabStop="FALSE" Top="80" Visible="FALSE" Width="32"></Edit>
		<Edit Height="21" Id="lblsdpcd" Left="136" TabOrder="22" TabStop="FALSE" Top="80" Visible="FALSE" Width="32"></Edit>
		<Edit Height="21" Id="lblmshno" Left="176" TabOrder="23" TabStop="FALSE" Top="80" Visible="FALSE" Width="32"></Edit>
		<Edit Height="21" Id="lbllincd" Left="216" TabOrder="24" TabStop="FALSE" Top="80" Visible="FALSE" Width="32"></Edit>
		<Edit Height="21" Id="lblprtcd" Left="256" TabOrder="25" TabStop="FALSE" Top="80" Visible="FALSE" Width="32"></Edit>
		<Edit Height="21" Id="lblseljobcd" Left="296" TabOrder="26" TabStop="FALSE" Top="80" Visible="FALSE" Width="32"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtmshnm" Left="288" MaxLength="15" Readonly="TRUE" TabOrder="12" TabStop="FALSE" Top="280" UpperOnly="TRUE" Width="160"></Edit>
		<Button Height="24" Id="btnMshnm" Left="250" OnClick="btnMshnm_OnClick" TabOrder="11" Text="▶" Top="277" Width="32"></Button>
		<Edit Height="20" Id="txtmshno" Left="104" MaxLength="10" OnKeyDown="txtmshno_OnKeyDown" OnKillFocus="txtmshno_OnKillFocus" TabOrder="10" Top="280" UpperOnly="TRUE" UseIME="FALSE" Width="141"></Edit>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static3" Left="8" TabOrder="45" Text="설&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;비" Top="280" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="downValue" DataColumn="downValue" Height="18" Id="cmbKdown" InnerDataset="ds_cmbKdown" Left="728" ResetIndex="FIRST" TabOrder="15" Top="304" Width="136"></Combo>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : Jae hb
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : ogm325.xml
 * ● PROGRAM DESCRIPTION  : 보전이력분석검색
 * ● DATE WRITTEN         : 2011.10.13
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");

var jisno1;
var comps1;
var nowDate = today(); //날짜
var nowTime = GetDate(); //시간
var h=substr(nowTime,8,4); //시


var userId = G_ds_user.GetColumn(0,"USER_ID");
var userNm = G_ds_user.GetColumn(0,"USER_NAME");

var gmshnm;
var	gprtcd;		
var	gtimcd;

var stdate= addMonth(nowdate,-1); //현재날짜 - 1개월

function on_LoadCompleted(obj){
	getTitle();	
	getDesign();
	getComCode(); //공장구분 선택
	dtpwndats.Text = stdate; //개시날짜

	//getogm325_method(); //보전방법
	//getogm325_cmbsdpcd(); //실시부서
	//getogm325_cmbprtcd(); //파트코드
	//getogm325_cmblincd(); //라인코드
	dtpwndate.Text=nowDate;
	
	RadioCode.Value="subas";
	lblselcd.Value = RadioCode.Value;
	
	gFcOnTopButtonColor("1.2"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	

}

function getComCode(){
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		sArgument   += " CODE1=" + quote(company);		
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;
	ComboBoxPlant.Value=comps;
//	ComboBoxPlant.Enable = false; 
}

function getDesign(){	
	searchBar.Width = G_ds_design.GetColumn(0,"Width");
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	
}

/********************************************************************** 
 * 내용설명 : 조회
 **********************************************************************/ 
 function getogm325()
{
	if(length(trim(lblselcd.Value)) == 0)
	{
		alert(setPopMessage("3046"));
		return;
	}
	var str = dialog("psogmlib::ogm317.xml","comps1="+ComboBoxPlant.Value+" "+"selcd="+trim(lblselcd.Text)+" "+"wndats1="+dtpwndats.Value+" "+"wndate2="+dtpwndate.Value,300,300,"TitleBar=false");
	
//	var str = dialog("psogmlib::ogm317.xml","dd",300,300,"TitleBar=false");
	
	
	
	}


/*	
	var sKind		= "getogm325";						
	var sMethodName = "service::psogmlib/selectOgm325.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
*/
}
 
 
/********************************************************************** 
 * 내용설명 : 보전방법조회
 **********************************************************************/ 
 
function getogm325_method()
{
	var sKind		= "getogm325_method";						
	var sMethodName = "service::psogmlib/selectOgm200_method.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm200_method=ds_ogm200_method";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 실시부서조회
 **********************************************************************/ 
 
function getogm325_cmbsdpcd()
{
	var sKind		= "getogm325_cmbsdpcd";						
	var sMethodName = "service::psogmlib/selectOgm313_cmbsdpcd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc250pf=ds_obc250pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;
}


/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){
		alert(setPopMessage("1002"));
		setMessage("1002");
	// tran 성공	
	}else if(svcId=="setogm200"){
		alert(setPopMessage("1001"));
		setMessage("1001");
	}	
}

/********************************************************************** 
 * 내용설명 : 데이터셋 상태 체크
 **********************************************************************/ 
function ds_ogm200_OnRowPosChanged(obj,nOldRow,nRow){
	//로우타입 insert만 ED박스 enable
	if(ds_ogm200.GetRowType(ds_ogm200.currow)=="insert"){
		ed_maker.Enable=true;
	}else{
		ed_maker.Enable=false;
	}
}

/********************************************************************** 
 * 내용설명 : validation 체크
 **********************************************************************/ 
 
function validationChk(){

}

/********************************************************************** 
 * 내용설명 : Sort
 **********************************************************************/ 
function Grid0_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) lib_grid_SetGridSort(obj,nCell);
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	getogm325();
}

function fn_Input()
{
	if(checkInsertCount("ds_ogm200")== false) return;
	ds_ogm325.AddRow();
}

function fn_Delete()
{
	ds_ogm325.DeleteRow(ds_ogm200.currow);
}

function fn_Save()
{
	setogm325();
}

function fn_print()
{
	alert("fn_print");
}

function fn_Excel()
{
	setExcel();
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("1.2"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}

/********************************************************************** 
 * 내용설명 : 설비No 체크
 **********************************************************************/ 
 
 function GetPrtcdTimcdByMshno(comps,mshno)
{
	http.Sync = true;
	var sKind		= "getOgm200_chk";						
	var sMethodName = "service::psogmlib/selectOgm200_chk.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm200_chk=ds_ogm200_chk";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " MSHNO=" + quote(trim(txtmshno.value)); //설비No
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;
}


/********************************************************************** 
 * 내용설명 : 설비No 입력시 asc code 체크
 **********************************************************************/ 
function chk_mshno(mshno)
{
	var msg = "";
	for(var i = 0 ; i < mshno.length; i++){
		var ch =Asc(mshno.CharAt(i));

		switch(i)
		{
			case 0:
			case 1:
				if((ch < 48) || (ch > 57 && ch < 65) || (ch > 90 && ch < 97) || (ch > 122))
				{	
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "1,2번째자리에는 숫자 또는 영문자가 와야 합니다";
					return msg;
				}
				break;
			case 2:
				if((ch != 32 && ch < 65) || (ch > 90 && ch < 97) || (ch > 122))   
				{
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "3번째자리에는 영문자나 공란이 와야 합니다.";
					return msg;
				}
				break;
			case 3:
				if(ch != 32)
				{
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "4번째자리는 공란이 와야 합니다.";
					return msg;
				}
				break;
			case 4:
			case 5:
			case 6:
			case 7:
				if(ch < 48 || ch > 57)
				{
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "5 ~ 8번째짜리까지는 숫자가 와야 합니다.";
					return msg;
				}
				break;
			case 8:
			case 9:
				if((ch != 32 && ch < 48) || (ch  > 57 ))
				{
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "8 ~ 10번째자리까지는 공란이나 숫자가 와야 합니다";
					return msg;
				}
				break;
			}
		}
	return msg;
}


function txtmshno_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar != 13)
		return;
	txtwrkm1.SetFocus();	
}



/********************************************************************** 
 * 내용설명 : 책임자 확인
 **********************************************************************/ 
 function txtmshno_chk(){
 
 		if(trim(txtmshno.Text) != ""){
 		/*
		var chk = chk_mshno(trim(txtmshno.Text));
		if(chk != ""){
			alert(chk);
			return;
		}
		*/		
		//var ret = GetPrtcdTimcdByMshno(comps,trim(txtmshno.text));
		GetPrtcdTimcdByMshno(comps,trim(txtmshno.text));
		if(ds_ogm200_chk.GetColCount()==0){
			alert(setPopMessage("2526"));
			gmshnm="";
			gprtcd="";	
			gtimcd="";
			txtmshno.Text="";
			txtmshnm.Text="";
		}else{
			gmshnm = ds_ogm200_chk.GetColumn(0,"mshnm");
			gprtcd = ds_ogm200_chk.GetColumn(0,"prtcd");
			gtimcd = ds_ogm200_chk.GetColumn(0,"timcd");
//alert("선택gtimcd==="+gtimcd);
//alert("선택gprtcd==="+gprtcd);			
			txtmshnm.Text = gmshnm; 
			//cmbjobcd.Focus();
		}
	}
	else{
		alert(setPopMessage("3019"));
	}
} 


/********************************************************************** 
 * 내용설명 : 파트코드 조회
 **********************************************************************/ 

function getogm325_cmbprtcd(){
	
	var sKind		= "getogm325_cmbprtcd";						
	var sMethodName = "service::psogmlib/selectOgm313_cmbprtcd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc270pf=ds_obc270pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;
}


/********************************************************************** 
 * 내용설명 : 라인코드 조회
 **********************************************************************/ 

function getogm325_cmblincd(){
	
	var sKind		= "getogm325_cmblincd";						
	var sMethodName = "service::psogmlib/selectOgm313_cmblincd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc030pf_01=ds_obc030pf_01";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 책임자 조회
 **********************************************************************/ 
 
function getogm325_hmd020pf(sabun) 
{
	var sKind		= "getogm325_hmd020pf";						
	var sMethodName = "service::psogmlib/selectOgm200_hmd020pf.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm200_hmd020pf=ds_ogm200_hmd020pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " SABUN=" + sabun; //사번
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 책임자 확인 OnKeyDown
 **********************************************************************/ 
function txtwrkm1_OnKillFocus(obj)
{
	if(length(txtwrkm1.Text)==0){
		txtkornm.text ="";
		return;
	}
	getogm325_hmd020pf(trim(txtwrkm1.Text));
	if(ds_ogm200_hmd020pf.GetColCount()!=0){
		txtkornm.Text = ds_ogm200_hmd020pf.GetColumn(0,"KORNM");
	}	
	else{
		alert(setPopMessage("3015"));
		txtwrkm1.Text="";
		txtkornm.text ="";
	}
	lblsdpcd.value = ds_ogm200_hmd020pf.GetColumn(0,"SDPCD");
}

function btnMshnm_OnClick(obj)
{
	var str = dialog("psogmlib::ogm200_pop.xml","설비선택",300,300,"TitleBar=false");
	cmbprtcd.Value = "";
	cmblincd.Value = "";
}


function chk_box(){

	var CheckedCount = parseInt(ckbBM.Value)+parseInt(ckbPM.Value)+parseInt(ckbCM.Value);//합이 3
	var rvalue = " (";
	var checking = 0;
	if (ckbBM.Value == 1){ //ckbBM.Value가 체크되어있으면 1...
		checking = checking+1;
		rvalue = rvalue+"'"+"BM"+"'";
	}
	if (ckbPM.Value == 1){
		if (checking != 0) rvalue = rvalue+",";
		checking = checking+1;
		rvalue = rvalue+"'"+"PM"+"'";
	}
	if (ckbCM.Value == 1){
		if (checking != 0) rvalue = rvalue+",";
		checking = checking+1;
		rvalue = rvalue+"'"+"CM"+"'";
	}
	rvalue = rvalue+")";
}
function RadioCode_OnClick(obj)
{
	lblselcd.Value = RadioCode.Value;
}

function cmbJobCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ckbBM.Value="0";
	ckbPM.Value="0";
	ckbCM.Value="0";
}

function cmblincd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmbprtcd.Value="";
	txtmshno.Text="";
	txtmshnm.Text="";
}

function cmbprtcd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmblincd.Value="";
	txtmshno.Text="";
	txtmshnm.Text="";
}

function btnClear_OnClick(obj)
{
	ckbBM.Value="0";
	ckbPM.Value="0";
	ckbCM.Value="0";
	cmbprtcd.Value="";
	cmblincd.Value="";
	txtmshno.Text="";
	txtmshnm.Text="";
	cmbJobCd.Value="";
	cmbsdpcd.Value="";
	txtwrkm1.Text="";
	txtkornm.Text="";
	cmbKdown.Value="";

	dtpwndats.Text=stdate;
	dtpwndate.Text=nowDate;
	
}
function ckbBM_OnClick(obj,strValue)
{
	cmbJobCd.Value="";
}

function ckbPM_OnClick(obj,strValue)
{
	cmbJobCd.Value="";
}

function ckbCM_OnClick(obj,strValue)
{
	cmbJobCd.Value="";
}


function cmbprtcd_OnClick(obj)
{
	getogm325_cmbprtcd(); //파트코드	
}

function cmblincd_OnClick(obj)
{
	getogm325_cmblincd(); //라인코드
}

function cmbJobCd_OnClick(obj)
{
	getogm325_method(); //보전방법
}

function cmbsdpcd_OnClick(obj)
{
	getogm325_cmbsdpcd(); //실시부서
	
}



function txtmshno_OnKillFocus(obj)
{
	if(length(txtmshno.Text)==0){
		return;
	}
	txtmshno_chk();
}

function txtwrkm1_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar != 13)
		return;
	cmbKdown.SetFocus();	
}
]]></Script>
</Window>