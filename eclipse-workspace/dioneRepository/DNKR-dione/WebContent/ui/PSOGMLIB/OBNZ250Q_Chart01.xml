<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="632" Id="Chart01Pop" Left="8" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="주요설비(라인)" TooltipFont="Default,0" Top="8" Ver="1.0" Width="888" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_menuAuth">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_menuAuthGroup"></Dataset>
		</Datasets>
		<Image FillType="STRETCH" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="2" Width="874"></Image>
		<Static Align="Center" Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_user" Left="40" TabOrder="1" Top="8" Width="200"></Static>
		<Static Color="#333333" Font="돋움,9" Height="13" Id="Static0" Left="8" TabOrder="3" Text="주요설비(라인)실적그래프" Top="8" Width="200"></Static>
		<xChart Bottom="624" Chart3D="true" Height="592" Id="xChart0" NSeries="2" NValues="3" PersonalizedFlags="PersonalizedFlags_None" PointLabels="true" Right="880" Scrollable="true" Top="32" View3DDepth="10" Volume="40" WallWidth="0" Width="880">
			<_PersistData>&#13;&#10;/6yo0Sdr30NGWDYA8vJNQ/9oYXJ0RlgsIP9WZXJzaW9uPf82LjIuMTM0Mv8uMCwgQ3VsdP91cmU9bmV1dP9yYWwsIFB1Yv9saWNL&#13;&#10;ZXlUb/9rZW49YTE4N/84ZTIwNTJjMP84ZGNlElNvZv90d2FyZUZYLlr59B/y8wAj8vAgXgR+bA8AAAEB/v+BBZR5Bm8FAm8GBqUE&#13;&#10;kQUK6vLwEPLwA/Lw+///w3+CZQHy88ABkQUBBf9BcmlhbAAABJVBbwsEbwUFegWsBQD+Rg9YEi5IaWdo/WwpEHRTZXR0aZ9uZ3MQ&#13;&#10;CZMIRR8APQfxBQEBAAgCHRMff1gFLkF4aXOVAY74AQEAAjoQ8vNlFigTOOC3AvLyC0cZngfPH4B1CpsGhQ0GLZMSig+NBwIJDJsf&#13;&#10;rRANsR9iL3Qv5x9Q+R8LL50vxSUOWhgPegX0vAHy8VL59C5CYXMhZQAPEg8kDzYNF3cf/CL/DS5JR2FsbGW/cnlUeXBllQEUUjIl&#13;&#10;EfoJlxASxSUTAh31HUg/LmI0T2JqBK8uUGllUCEebjYyELcAlxBxM/LwFZQ/pj+4Nz8GLkN1cnZsMpYRxRbFJRfmP/g/CklIaVdM&#13;&#10;b3csKxjFJRktT/w/T7g3By5CdWJiS2xllhEaJE6WERu1T4qXEBzFJR16T4xPuDcI/y5TdXJmYWNl4MUqyzHy8lkFgAAoACjEvwDJ&#13;&#10;BiHkLUc/+yMJLv9MaW5lSW5mb5DbAr0s0wM6IULFL5cIAeS4GoEBIqpVaQcBD0T3ZWZhGDAuV2luD2Rvd3M=&#13;&#10;</_PersistData>
		</xChart>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : 제환복
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : OBNZ250Q_Chart01.xml
 * ● PROGRAM DESCRIPTION  : 주요설비(라인) 실적 그래프
 * ● DATE WRITTEN         : 2016.12.09
 ----------------------------------------------------------------*/

#include "script::lib_script_common.js";

var chartGubun;

function on_LoadCompleted(obj){
	loadingChart();
	//칸트차트사용으로 미사용
	//xChart0.LegendBox=true;	//properties에서 true로 주는경우 Legend의 글자가 짤려서보임
}
function loadingChart(){

	//var chartCnt = ds_OBNZ250Q.rowcount;
	var chartCnt = chartRow;
	xChart0.OpenData("COD_Values", 0, chartCnt);
	//xChart0.OpenData("COD_Values", 0, 3);
	xChart0.SerLegBox = true;
	xChart0.SerLeg(0) = "시간";
	xChart0.SerLeg(1) = "건수";
	
	for(var i=0;i<chartCnt;i++){
		xChart0.Value(0, i) = ds_OBNZ250Q.GetColumn(i,"L_STP");	//시간
		xChart0.Value(1, i) = ds_OBNZ250Q.GetColumn(i,"L_CNT");	//건수
	}		
	xChart0.CloseData("COD_Values");
	
	if(chartGubun==1){	//칸트
		xChart0.Gallery = "Gallery_Gantt";
		xChart0.View3DDepth = 0;
	}else if(chartGubun==2){	//2D 막대
		xChart0.Gallery = "Gallery_Bar";
		xChart0.View3DDepth = 0;
	}else if(chartGubun==3){	//3D 막대
		xChart0.Gallery = "Gallery_Bar";
		xChart0.View3DDepth = 50;
	}else if(chartGubun==4){	//꺽은선
		xChart0.Gallery = "Gallery_Lines";
		xChart0.View3DDepth = 0;
	}
	xChart0.AxisX.Gridlines = true;
	xChart0.AxisY.Gridlines = true;
	
	// 'In this case we are hardcoding the labels
	// 'but it would be the same if the labels are retrieved from the database
	/* X축 값설정 */
	for(var i=0;i<chartCnt;i++){
		xChart0.Legend(i) = ds_OBNZ250Q.GetColumn(i,"LINNM");//라인명출력		
	}
    xChart0.AxisY.LabelsFormat.CustomFormat = "#,##0.0"; // 출력될 라벨 포멧
}]]></Script>
</Window>