<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="808" Id="userList" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="인사기록카드" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_uploadFile">
				<Contents>
					<colinfo id="chk" size="256" summ="default" type="STRING"/>
					<colinfo id="fullname" size="256" summ="default" type="STRING"/>
					<colinfo id="filename" size="256" summ="default" type="STRING"/>
					<colinfo id="prog_bar" size="256" summ="default" type="STRING"/>
					<colinfo id="filesize" size="256" summ="default" type="INT"/>
					<colinfo id="progsize" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HMD150PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HMD170PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HMD180PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HMD190PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HMD160PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HMD220PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB2">
				<Contents>
					<colinfo id="APDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="APDCL" size="256" summ="default" type="STRING"/>
					<colinfo id="APDDL" size="256" summ="default" type="STRING"/>
					<colinfo id="APDNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB3">
				<Contents>
					<colinfo id="KNYYM" size="256" summ="default" type="STRING"/>
					<colinfo id="HOBONP" size="256" summ="default" type="STRING"/>
					<colinfo id="GYBONP" size="256" summ="default" type="STRING"/>
					<colinfo id="KIBONP" size="256" summ="default" type="STRING"/>
					<colinfo id="CJSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="HASUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="WHSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="TESUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="JMSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="JKSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="GSSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="BJSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="QLSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="TQSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="WFSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="YHSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="DOSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="GTSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="OTSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="PAMTTP" size="256" summ="default" type="STRING"/>
					<colinfo id="WYDSUDP" size="256" summ="default" type="STRING"/>
					<colinfo id="FILL1P" size="256" summ="default" type="STRING"/>
					<colinfo id="FILL2P" size="256" summ="default" type="STRING"/>
					<colinfo id="FILL3P" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB4">
				<Contents>
					<colinfo id="ADVYY" size="256" summ="default" type="STRING"/>
					<colinfo id="ADVPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADVET" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB5">
				<Contents>
					<colinfo id="EDTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="EEDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="EDTPL" size="256" summ="default" type="STRING"/>
					<colinfo id="EDTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDPOT" size="256" summ="default" type="STRING"/>
					<colinfo id="EDCLS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB6">
				<Contents>
					<colinfo id="SICGB" size="256" summ="default" type="STRING"/>
					<colinfo id="SICYY" size="256" summ="default" type="STRING"/>
					<colinfo id="FRSDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOSDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SICET" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB7">
				<Contents>
					<colinfo id="ACCYY" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="EEDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB8">
				<Contents>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="DCPMN" size="256" summ="default" type="STRING"/>
					<colinfo id="DCPSY" size="256" summ="default" type="STRING"/>
					<colinfo id="DCPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="DCPKD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB9">
				<Contents>
					<colinfo id="CFDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="EEDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="LOCAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB10">
				<Contents>
					<colinfo id="HYYMM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="HKAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SCHAT" size="256" summ="default" type="STRING"/>
					<colinfo id="STUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="STUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="KORNO" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAEZ02Q_TAB11">
				<Contents>
					<colinfo id="CDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="R0901" size="256" summ="default" type="STRING"/>
					<colinfo id="R0902" size="256" summ="default" type="STRING"/>
					<colinfo id="OUPAY" size="256" summ="default" type="STRING"/>
					<colinfo id="MGYAM" size="256" summ="default" type="STRING"/>
					<colinfo id="R3301" size="256" summ="default" type="STRING"/>
					<colinfo id="R3303" size="256" summ="default" type="STRING"/>
					<colinfo id="R4400" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="None" BorderColor="#b4b4b4" Height="29" Id="searchBar" Left="1" TabOrder="6" Top="30" Width="1057"></Static>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="1" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="1" Top="8" Width="1032"></Static>
		<Button AutoDraw="FALSE" Cursor="HAND" Height="25" Id="butPrt" ImageID="btn2_publ2" Left="972" OnClick="butPrt_OnClick" TabOrder="3" Top="34" Width="75"></Button>
		<Button AutoDraw="FALSE" Cursor="HAND" Height="25" Id="butUp" ImageID="btn2_regi2" Left="892" OnClick="butUp_OnClick" TabOrder="3" Top="34" Width="75"></Button>
		<Image BorderColor="#888888" Height="33" Id="img_Logo" ImageID="Denso_Log2" Left="3" TabOrder="5" Top="33" Width="128"></Image>
		<CyMultiLine BKSelColor="APPWORKSPACE" Border="Flat" Height="744" Id="MultiTab" MouseOverColor="cadetblue" PreLoad="TRUE" SelectFont="Default,10,Bold" TabButtonLocation="Right" TabOrder="6" Top="64" Width="1058">
			<Contents>
				<TabPage Height="742" Id="tab1" Left="1" scroll="true" TabOrder="1" Text="인사기록" Top="1" Url="pshumlib::HAEZ02Q_TAB1.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab2" Left="1" TabOrder="2" Text="인사발령" Top="1" Url="pshumlib::HAEZ02Q_TAB2.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab3" Left="1" TabOrder="3" Text="급여정보" Top="1" Url="pshumlib::HAEZ02Q_TAB3.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab4" Left="1" TabOrder="3" Text="인사고과" Top="1" Url="pshumlib::HAEZ02Q_TAB4.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab5" Left="1" TabOrder="3" Text="교육이수" Top="1" Url="pshumlib::HAEZ02Q_TAB5.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab6" Left="1" TabOrder="3" Text="병력사항" Top="1" Url="pshumlib::HAEZ02Q_TAB6.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab7" Left="1" TabOrder="3" Text="공상산재" Top="1" Url="pshumlib::HAEZ02Q_TAB7.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab8" Left="1" TabOrder="3" Text="상벌이력" Top="1" Url="pshumlib::HAEZ02Q_TAB8.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab9" Left="1" TabOrder="3" Text="해외근무" Top="1" Url="pshumlib::HAEZ02Q_TAB9.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab10" Left="1" TabOrder="3" Text="학자금지급" Top="1" Url="pshumlib::HAEZ02Q_TAB10.xml" Width="972"></TabPage>
				<TabPage Height="742" Id="tab11" Left="1" TabOrder="3" Text="퇴직금정산" Top="1" Url="pshumlib::HAEZ02Q_TAB11.xml" Width="972"></TabPage>
			</Contents>
		</CyMultiLine>
		<File Bottom="25" Height="24" Id="ProFile" Left="940" Right="964" TabOrder="7" Top="1" Width="24"></File>
		<CyHttpFile Height="24" Id="CyHttpFile0" Left="968" Top="1" Width="24"></CyHttpFile>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="7" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="7" Width="24"></File>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : 제환복
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : HAEZ02Q.xml
 * ● PROGRAM DESCRIPTION  : 인사기록카드
 * ● DATE WRITTEN         : 2016.04.26
 ----------------------------------------------------------------*/

#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";
#include "script::fileupdown.js"

var strSeparator = "	";

/*
* 2016.04.19 jhb
* KA창원 인사T장은 KA전사업부 열람가능하도록 PGM수정
* KA창원 이정호부장추가 C9040061
* 부모page의 Lib값을 사용하기위해 삭제함.
*/
//var Lib1 = G_ds_user.GetColumn(0,"LIB1");    //CIGMA LIBRARY(PERESLIB              PSRESLIB)
//var Lib2 = G_ds_user.GetColumn(0,"LIB2");    //MRP LIBRARY(PSEDBLIB                PSCDBLIB)
//var Lib3 = G_ds_user.GetColumn(0,"LIB3");    //인사급여 LIBRARY(PSEDBLIB           PSCDBLIB.PSHDBLIB.PSSDBLIB)

//확인해볼것!
//var company = G_ds_user.GetColumn(0,"COMPANY"); //PE      PS
//var comps = G_ds_user.GetColumn(0,"PLANT_CD"); //E1,      C1.H1.S1

var nowDate = today();
var file_name;
var file_size;

var gImgPath = "/picture/";
var imgVpath=G_baseURL+"DIONE_UPDOWN_FILE";

var imgUPDOWNpath="C:/Program Files/Apache Software Foundation/Tomcat 6.0/webapps/DIONE_UPDOWN_FILE/picture/";

//HASS03이 아닌 경우에는 저장/발행 버튼 활성화
var p_HASS03="";	//HASS03에서 사용

/********************************************************************** 
 * 내용설명 : 화면로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj){
	getTitle();	
	getDesign();
	getComCode();
	gFcOnTopButtonColor("1"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	

	if(p_HASS03=="HASS03"){
		butUp.Visible=false;
		butPrt.Visible=false;
	}
	
	getHAEZ02Q();	
}

/********************************************************************** 
 * 내용설명 : 공통코드 조회
 * 주요변수 : 
 **********************************************************************/ 
function getComCode(){

	http.Sync 	= true;

	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		sArgument   += " CODE1=" + quote(company);		
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
}

function getDesign(){
	//MainGrid.ToolTipText = setPopMessage("2053");
	/*
	MainGrid.BkColor = G_ds_design.GetColumn(0,"BkColor");
	MainGrid.BkColor2 = G_ds_design.GetColumn(0,"BkColor2");
	MainGrid.BkSelColor = G_ds_design.GetColumn(0,"BkSelColor");
	MainGrid.Face3dColor = G_ds_design.GetColumn(0,"Face3dColor");
	MainGrid.BoldHead = G_ds_design.GetColumn(0,"BoldHead");
	MainGrid.HeadHeight = G_ds_design.GetColumn(0,"HeadHeight");  //22
	MainGrid.Width = G_ds_design.GetColumn(0,"Width");            //1048
	MainGrid.Top = G_ds_design.GetColumn(0,"Top");                //64
	MainGrid.UserData = MainGrid.Height;
	*/	
	searchBar.Width = G_ds_design.GetColumn(0,"Width");           //1048
	searchBar.Height = G_ds_design.GetColumn(0,"SBHeight");	      //29
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	          //32
}


/********************************************************************** 
 * 내용설명 : 그룹 조회
 * 주요변수 : 
 **********************************************************************/ 
function getHAEZ02Q(){
	
	var sKind		= "getHAEZ02Q";						
	var sMethodName = "service::pshumlib/selectHAEZ02Q.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_HAEZ02Q=ds_HAEZ02Q";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += "@LIB1=" + quote(Lib1);
		sArgument += "@LIB2=" + quote(Lib2);
		sArgument += "@LIB3=" + quote(Lib3);
		sArgument += "@SABUN=" + quote(SABUN);
		sArgument += "@COMPS=" + quote(comps);
	http.Sync = true;
	var str = dialog("Common::PGMLOAD_HUM.xml","sKind=" + sKind + " " + "sMethodName=" + sMethodName + " " + "sOutDataSet=" + sOutDataSet + " " + "sArgument=" + sArgument,272,64,"TitleBar=false");
	http.Sync = false;
	
	if (str == 'T'){  //정상조회
		search_Detail();
		search_TAB();
		alert(setPopMessage("1004"));
		setMessage("1004");	
	}else if (str == 'B'){   //data값이 없을때
		alert(setPopMessage("1003"));
		setMessage("1003");	
	}else if (str == 'E'){   //error발생시
		alert(setPopMessage("1002"));
		
	}	

	var sabunname = SABUN;
	
	if(comps == 'E1'){
		if(length(toString(SABUN)) = 5){
			sabunname = "0" + SABUN;
		}else if(length(toString(SABUN)) = 4){
			sabunname = "00" + SABUN;
		}else if(length(toString(SABUN)) = 3){
			sabunname = "000" + SABUN;
		}else if(length(toString(SABUN)) = 2){
			sabunname = "0000" + SABUN;
		}		 
	}else{
		if(length(toString(SABUN)) = 6){
			sabunname = "0" + SABUN;
		}else if(length(toString(SABUN)) = 5){
			sabunname = "00" + SABUN;
		}
	}
	MultiTab.GetItem(0).img01.ImageID = G_baseURL+"DIONE_UPDOWN_FILE/picture/" + toLower(subStr(comps,0,1)) + sabunname + ".jpg";	
}


/********************************************************************** 
 * 내용설명 : 엑셀파일로 저장
 **********************************************************************/ 
function setExcel()
{
	setExcel();
}

/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	
	if (str == 'T'){  //정상조회
		alert(setPopMessage("1004"));
		setMessage("1004");	
	}else if (str == 'B'){   //data값이 없을때
		alert(setPopMessage("1003"));
		setMessage("1003");	
	}else if (str == 'E'){   //error발생시
		alert(setPopMessage("1002"));
		setMessage("1002");	
	}
}


function search_Detail(){

	var sKind		= "selectHAEZ02Q_Main";
	var sMethodName = "service::pshumlib/selectHAEZ02Q_Main.do";	// 서버에서 호출 될 Method 명
	var sInDataSet  = "";	// 자료 저장 시 보낼 DataSet 명칭
		sOutDataSet = "ds_HMD150PF=ds_HMD150PF ds_HMD170PF=ds_HMD170PF ds_HMD180PF=ds_HMD180PF";
		sOutDataSet += " ds_HMD190PF=ds_HMD190PF ds_HMD160PF=ds_HMD160PF ds_HMD220PF=ds_HMD220PF";// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(company);	//사업부(PE/PS)
		sArgument += " COMPS2=" + quote(CmbCOM.Value); //공장
		sArgument += " SABUN=" + quote(SABUN);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}
function search_TAB(){
	var sKind		= "search_TAB";
	var sMethodName = "service::pshumlib/selectHAEZ02Q_Tab.do";	// 서버에서 호출 될 Method 명
	var sInDataSet  = "";	// 자료 저장 시 보낼 DataSet 명칭
		sOutDataSet = "ds_HAEZ02Q_TAB2=ds_HAEZ02Q_TAB2 ds_HAEZ02Q_TAB3=ds_HAEZ02Q_TAB3 ds_HAEZ02Q_TAB4=ds_HAEZ02Q_TAB4";
		sOutDataSet += " ds_HAEZ02Q_TAB5=ds_HAEZ02Q_TAB5 ds_HAEZ02Q_TAB6=ds_HAEZ02Q_TAB6 ds_HAEZ02Q_TAB7=ds_HAEZ02Q_TAB7";// 조회 후 돌려 받을 DataSet 명칭		
		sOutDataSet += " ds_HAEZ02Q_TAB8=ds_HAEZ02Q_TAB8 ds_HAEZ02Q_TAB9=ds_HAEZ02Q_TAB9 ds_HAEZ02Q_TAB10=ds_HAEZ02Q_TAB10 ds_HAEZ02Q_TAB11=ds_HAEZ02Q_TAB11";// 조회 후 돌려 받을 DataSet 명칭		
	var sArgument   = "";
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(company);	//사업부(PE/PS)
		sArgument += " COMPS2=" + quote(CmbCOM.Value); //공장
		sArgument += " SABUN=" + quote(SABUN);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}
function butPrt_OnClick(obj)
{		
	//var str = dialog("pshumlib::HMD020_rep.xml","SABUN=" + SABUN,"인사기록카드",900,1024,"TitleBar=false");		
	//var str = dialog("pshumlib::HAEZ02R.xml","SABUN=" + SABUN,"인사기록카드",900,1024,"TitleBar=false");		
	var str = dialog("pshumlib::HAEZ02R.xml","SABUN=" + SABUN,"인사기록카드",700,"TitleBar=true");		
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤 함수들
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Input()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Delete()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}
function fn_Save()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_print()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Excel()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}
function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("1"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}
function butUp_OnClick(obj)
{
	
	var blobbuffer;

		FileDialog0.Filter = "Image Files(*.*)|*.*|";	
		FileDialog0.Type = "OPEN";
		if(FileDialog0.Open()){

			file_name = FileDialog0.FileName;
			var file_path = FileDialog0.FilePath;
			var path = file_path + "\\" + file_name;
			
			MultiTab.GetItem(0).img01.ImageID=path;
			ProFile.FileName = path;
						
			var ext = split(file_name,'.');
			//var imgName = ToLower(SubStr(comps,0,1)) + SABUN + "." + ToLower(ext[1]);
			var imgName="";
			if(comps == 'E1'){
				imgName = ToLower(SubStr(comps,0,1)) + lpad(SABUN,0,6) + "." + ToLower(ext[1]);
			}else{
				imgName = ToLower(SubStr(comps,0,1)) + lpad(SABUN,0,7) + "." + ToLower(ext[1]);
			}
			var	imgval = gImgPath + imgName;

			var imgtype= "IMGBF";
			
			//데이터셋에 로우 추가
			ds_uploadFile.addRow();
			//다이얼로그에서 선택한 파일의 경로명(파일명포함)을 데이터셋에 저장
			ds_uploadFile.SetColumn(ds_uploadFile.row,"fullname", path);
			//다이얼로그에서 선택한 파일명을 데이터셋에 저장
			ds_uploadFile.SetColumn(ds_uploadFile.row,"filename", imgName);	
		
			if(!file_Upload()){
				ds_uploadFile.DeleteAll();
				FileDialog0.FileName= "";
				return false;
			}
			else {
				FileDialog0.FileName= "";
			}
		}
		else{
			alert(setPopMessage("3040"));
		}
}

function file_Upload(obj)
{
	
	var ret;
	
	//파일선택 버튼을 이용해서 선택된 파일이 없는 경우 처리 생략
	if(ds_uploadFile.rowcount != 0){
	
		//데이터셋 로우 수 만큼 루프
		for ( var i = 0 ; i < ds_uploadFile.rowcount ; i++ )
		{
			// 풀경로 취득
			var file_url = ds_uploadFile.getColumn(i,"fullname");
			
			// 파일 사이즈 취득
			file_size = CyHttpFile0.GetFileSizeLocal(file_url);
			trace("파일사이즈" + file_size);
			
			//사이즈 체크(5MB제한)
			if(file_size > 5000000){
				alert("업로드 가능 용량은 5MB입니다. 확인하고 다시 시도해주십시오.");
				return false;
			}
			
			var extension = split(file_name,'.');
		
			if(toLower(extension[1]) != 'jpg'){
				alert("JPG 파일만 등록 가능합니다.");
				img01.ImageID = "";
				return false;
			}	
		
			//로컬에서 선택한 파일명을 취득하여 변수에 설정
			var str_param = ds_uploadFile.getColumn(i,"filename");
			//업로드 할 서버 경로와 파일명
			var str_param_server = imgUPDOWNpath + str_param;
			
			//스크립트 파일의 함수 호출 
			ret = gfn_FileWrite(CyHttpFile0, file_url, str_param_server, i, "prog_bar", CyHttpFile0);
									
			//호출함수 리턴값 처리
			if ( ret[0] == "FAIL" )
			{
				alert(ret[1]);
				break;
			}
		}
	}
	return true;	
}
]]></Script>
</Window>