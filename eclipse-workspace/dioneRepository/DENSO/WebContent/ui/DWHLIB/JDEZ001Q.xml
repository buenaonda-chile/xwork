<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="UserList" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="경비계획대실적" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_VComCode_PLNT">
				<Contents>
					<colinfo id="CODE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE2>DN</CODE2>
						<CODE_NAME>통합</CODE_NAME>
					</record>
					<record>
						<CODE2>PS</CODE2>
						<CODE_NAME>구KA</CODE_NAME>
					</record>
					<record>
						<CODE2>PE</CODE2>
						<CODE_NAME>구KE</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DWH" UseClientLayout="1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_F0006LB">
				<Contents>
					<colinfo id="MCMCU" size="256" summ="default" type="STRING"/>
					<colinfo id="MCDC" size="256" summ="default" type="STRING"/>
					<colinfo id="MCNAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MST650PF">
				<Contents>
					<colinfo id="DPCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="DPCODPNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BUCD">
				<Contents>
					<colinfo id="MCMCU" size="256" summ="default" type="STRING"/>
					<colinfo id="MCNAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DPCODE">
				<Contents>
					<colinfo id="DPCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="DPCODPNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_GBOBJ">
				<Contents>
					<colinfo id="GBOBJ" size="256" summ="default" type="STRING"/>
					<colinfo id="GBNAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SubSum" UseClientLayout="1">
				<Contents>
					<colinfo id="BA" size="256" summ="default" type="STRING"/>
					<colinfo id="AA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="CA" size="256" summ="default" type="STRING"/>
					<colinfo id="DA" size="256" summ="default" type="STRING"/>
					<record>
						<AA>0</AA>
						<BA>0</BA>
						<CA>0</CA>
						<DA>0</DA>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="2" TabStop="FALSE" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="0" Top="8" Width="1032"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="25" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="24" Width="24"></File>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="90" Id="searchBar" TabOrder="4" Top="32" Width="1048"></Static>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static1" Left="3" TabOrder="7" Text="JDE&#32;환경" Top="35" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static11" Left="119" TabOrder="8" Top="35" VAlign="Middle" Width="96"></Static>
		<Combo CodeColumn="code2" DataColumn="code_name" Enable="FALSE" Height="18" Id="ComboBoxPlant" INDEX="0" InnerDataset="ds_VComCode_PLNT" Left="123" OnChanged="ComboBoxPlant_OnChanged" TabOrder="5" Top="39" Width="88"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static3" Left="3" TabOrder="8" Text="계&#32;&#32;&#32;획&#32;&#32;&#32;년" Top="62" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static5" Left="119" TabOrder="9" Top="62" VAlign="Middle" Width="96"></Static>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Dateformat="yyyy" FocusIndex="0" Height="18" Id="cmb_GBFY" Left="123" LeftMargin="20" OnChanged="cmb_GBFY_OnChanged" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="6" Top="66" Value="TODAY" Width="88"></Calendar>
		<Button Height="25" Id="btnQuery" ImageID="btn2_search2" Left="920" OnClick="fn_Search" TabOrder="11" Text="조회" Top="3" Visible="FALSE" Width="78"></Button>
		<Button Height="25" Id="btnExcel" ImageID="sum_excel" Left="845" OnClick="fn_Excel" TabOrder="12" Text="조회" Top="3" Visible="FALSE" Width="75"></Button>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static0" Left="274" TabOrder="14" Text="부&#32;서&#32;코&#32;드" Top="32" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static2" Left="390" TabOrder="15" Top="32" VAlign="Middle" Width="146"></Static>
		<Combo CodeColumn="DPCODE" DataColumn="DPCODPNM" Height="18" Id="cmb_DPTCD_FR" ImeMode="none" INDEX="0" InnerDataset="ds_DPCODE" Left="394" OnChanged="common_OnChanged" TabOrder="13" Top="36" Width="140"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static4" Left="274" TabOrder="17" Text="BU코드" Top="89" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static6" Left="390" TabOrder="18" Top="89" VAlign="Middle" Width="146"></Static>
		<Combo CodeColumn="MCMCU" DataColumn="MCNAME" Height="18" Id="cmd_GBMCU_FR" INDEX="0" InnerDataset="ds_BUCD" Left="393" OnChanged="common_OnChanged" TabOrder="16" Top="93" Width="140"></Combo>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static7" Left="2" TabOrder="20" Text="정&#32;렬&#32;순&#32;서" Top="90" VAlign="Middle" Width="116"></Static>
		<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static8" Left="118" Style="static" TabOrder="21" Top="90" VAlign="Middle" Width="150"></Static>
		<Radio Border="None" Height="14" Id="rdoggub" INDEX="0" Left="120" OnClick="rdoggub_OnClick" TabOrder="19" Top="95" Width="140">
			<Contents>
				<Layout code="BU" height="12" left="10" text="BU" top="2" width="40"/>
				<Layout code="DP" height="12" left="50" text="부서" top="2" width="40"/>
				<Layout code="GB" height="12" left="100" text="계정" top="2" width="40"/>
			</Contents>
		</Radio>
		<Grid AreaSelect="true" AutoFitEndLine="Hide" BindDataset="ds_DWH" BKColor="MENU" BkColor2="LIGHT3D" BkSelColor="lavender" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="616" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="khaki" HeadBorder="Flat" HeadHeight="25" Height="496" Id="MainGrid" InputPanel="FALSE" LineColor="#888888" Right="1048" SelColor="black" TabOrder="-2" TabStop="FALSE" Top="120" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="GRAYTEXT" WheelScrollRow="1" Width="1048">
			<contents>
				<format id="Default"></format>
			</contents>
		</Grid>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static12" Left="390" TabOrder="27" Top="61" VAlign="Middle" Width="146"></Static>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static13" Left="274" TabOrder="26" Text="계&#32;정&#32;코&#32;드" Top="61" VAlign="Middle" Width="116"></Static>
		<Combo CodeColumn="GBOBJ" DataColumn="GBNAME" Height="18" Id="cmb_GBOBJ_FR" INDEX="0" InnerDataset="ds_GBOBJ" Left="394" OnChanged="common_OnChanged" TabOrder="25" Top="65" Width="140"></Combo>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static14" Left="550" TabOrder="29" Top="32" VAlign="Middle" Width="146"></Static>
		<Combo CodeColumn="DPCODE" DataColumn="DPCODPNM" Height="18" Id="cmb_DPTCD_TO" ImeMode="none" INDEX="0" InnerDataset="ds_DPCODE" Left="554" OnChanged="common_OnChanged" TabOrder="28" Top="36" Width="140"></Combo>
		<Static Align="Center" Height="21" Id="Static15" Left="535" TabOrder="30" Text="~" Top="37" VAlign="Middle" Width="18"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static17" Left="550" TabOrder="32" Top="89" VAlign="Middle" Width="146"></Static>
		<Combo CodeColumn="MCMCU" DataColumn="MCNAME" Height="18" Id="cmd_GBMCU_TO" INDEX="0" InnerDataset="ds_BUCD" Left="554" OnChanged="common_OnChanged" TabOrder="31" Top="93" Width="140"></Combo>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static18" Left="550" TabOrder="34" Top="61" VAlign="Middle" Width="146"></Static>
		<Combo CodeColumn="GBOBJ" DataColumn="GBNAME" Height="18" Id="cmb_GBOBJ_TO" INDEX="0" InnerDataset="ds_GBOBJ" Left="554" OnChanged="common_OnChanged" TabOrder="33" Top="65" Width="140"></Combo>
		<Static Align="Center" Height="21" Id="Static19" Left="536" TabOrder="35" Text="~" Top="66" VAlign="Middle" Width="18"></Static>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static9" Left="1" TabOrder="23" Text="환&#32;경&#32;구&#32;분" Top="2" VAlign="Middle" Visible="FALSE" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static10" Left="117" TabOrder="24" Top="2" VAlign="Middle" Visible="FALSE" Width="96"></Static>
		<Checkbox Height="18" Id="chK_SYSTEM" Left="130" OnClick="chK_SYSTEM_OnClick" TabOrder="22" Text="구환경" Top="7" Value="FALSE" Visible="FALSE" Width="80"></Checkbox>
		<Static Align="Center" Height="21" Id="Static16" Left="536" TabOrder="37" Text="~" Top="89" VAlign="Middle" Width="18"></Static>
		<Grid AreaSelect="true" AutoFitEndLine="Hide" BindDataset="ds_SubSum" BKColor="white" BkColor2="default" BkSelColor="white" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="121" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="khaki" HeadBorder="Flat" HeadHeight="25" Height="73" Id="Grid_Sub" InputPanel="FALSE" Left="832" LineColor="#888888" Right="1048" SelColor="black" TabOrder="38" TabStop="FALSE" Top="48" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="GRAYTEXT" WheelScrollRow="1" Width="216">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="75"/>
						<col width="100"/>
					</columns>
					<body>
						<cell align="center" bkcolor="SCROLLBAR" col="0" display="text" rowspan="4" text="누계"/>
						<cell align="center" bkcolor="SCROLLBAR" col="1" display="text" text="계획"/>
						<cell align="right" col="2" colid="BA" display="number"/>
						<cell align="center" bkcolor="SCROLLBAR" col="1" display="text" row="1" text="실적"/>
						<cell align="right" col="2" colid="AA" display="number" row="1"/>
						<cell align="center" bkcolor="SCROLLBAR" col="1" display="text" row="2" text="차이"/>
						<cell align="right" col="2" colid="CA" display="number" row="2"/>
						<cell align="center" bkcolor="SCROLLBAR" col="1" display="text" row="3" text="계획비(%)"/>
						<cell align="right" col="2" colid="DA" display="number" Mask="#,##0.00%" row="3"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Font="Default,9,Bold" Height="13" Id="Static20" Left="868" TabOrder="39" Text="&lt;기준년월&#32;:&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&gt;" Top="35" Width="159"></Static>
		<Static Font="Default,9,Bold" Height="13" Id="ed_Dummy" Left="948" TabOrder="36" Top="35" Width="60"></Static>
		<Image Cursor="HAND" Enable="FALSE" Height="17" Id="imgCODE" ImageID="ic_search" Left="797" OnClick="imgCODE_OnClick" Static="FALSE" TabOrder="40" Top="36" Width="15"></Image>
		<Checkbox Height="18" Id="chK_MultiDpcode" Left="701" OnClick="chK_MultiDpcode_OnClick" TabOrder="41" Text="다중부서선택" Top="36" Value="FALSE" Width="90"></Checkbox>
		<TextArea Border="SunkenEdge" Height="60" Id="ed_MultiCodeName" ImeMode="none" Left="698" Readonly="TRUE" TabOrder="42" Top="57" VScroll="TRUE" Width="134"></TextArea>
		<Edit CheckLength="Byte" Height="60" Id="ed_MultiCode" Left="832" Readonly="TRUE" TabOrder="43" Top="57" Visible="FALSE" Width="128"></Edit>
	</Form>
	<Script><![CDATA[ /*--------------------------------------------------------------
 * @version               : 1.0 
 * @author                : 제환복
 * @see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : JDEZ001Q
 * ● PROGRAM DESCRIPTION  : 경비계획대실적 LIST
 * ● DATE WRITTEN         : 2019.10.08
----------------------------------------------------------------*/

#include "script::lib_script_common.js";
#include "script::Grid_Script.js"

var strSeparator = "	";

var Lib1 = G_ds_user.GetColumn(0,"LIB1");
var Lib2 = G_ds_user.GetColumn(0,"LIB2");
var Lib4 = "CLTDTA";
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");

var GBOBJ_FR="91100";	//계정코드(FROM)
//var GBOBJ_TO="92590";	//계정코드(TO)
var GBOBJ_TO="94170";	//계정코드(TO)

var NotGBOBJ_FR="93110";	//제외계정코드(FROM)
var NotGBOBJ_TO="93990";	//제외계정코드(TO)

//누계용 글로벌 변수
var GrltSumBA=0;
var GrltSumAA=0;
var GrltSumCA=0;
var GrltSumDA=0;	

/********************************************************************** 
 * 내용설명 : 화면로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj){
	getTitle();	
	getDesign();
	gFcOnTopButtonColor("1"); //조회, 추가, 저장
	//getComCode(); //공장구분 선택
	//cmb_GBFY.Value=today();
	calculator_Year();
	//getF0006LB();	//계정코드
	getBUCODE();	//계정코드
	//getMst650PF();	//부서코드
	getDPCODE();	//부서코드
	getGBOBJ();	//계정코드
	MainGrid.UserData = MainGrid.Height;
	rdoggub_OnClick();
	//cmb_DPTCD_FR.Value=4700;
	//cmb_DPTCD_TO.Value=4702;
}


/********************************************************************** 
 * 내용설명 : 공통코드 조회
 * 주요변수 : 
 **********************************************************************/ 
function getDesign(){
	//MainGrid.ToolTipText = setPopMessage("2053");
	MainGrid.BkColor = G_ds_design.GetColumn(0,"BkColor");
	MainGrid.BkColor2 = G_ds_design.GetColumn(0,"BkColor2");
	MainGrid.BkSelColor = G_ds_design.GetColumn(0,"BkSelColor");
	MainGrid.Face3dColor = G_ds_design.GetColumn(0,"Face3dColor");
	MainGrid.BoldHead = G_ds_design.GetColumn(0,"BoldHead");
	MainGrid.HeadHeight = G_ds_design.GetColumn(0,"HeadHeight");
	MainGrid.Width = G_ds_design.GetColumn(0,"Width");
	//MainGrid.Top = G_ds_design.GetColumn(0,"Top");
	//MainGrid.Top = G_ds_design.GetColumn(0,"Top");
	
	searchBar.Width = G_ds_design.GetColumn(0,"Width");
	//searchBar.Height = G_ds_design.GetColumn(0,"SBHeight");	
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	
	
}
//미사용
function getComCode(){
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		//sArgument   += " CLASS='COMP'";
		sArgument   += " CODE1=" + quote(company);		
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ComboBoxPlant.Value=comps;
	//ComboBoxPlant.Enable = false; 
	
	ds_ComCode_PLNT.InsertRow(0);
	ds_ComCode_PLNT.SetColumn(0,"CLASS","PLANT");
	ds_ComCode_PLNT.SetColumn(0,"CODE1","");
	ds_ComCode_PLNT.SetColumn(0,"CODE2","");
	ds_ComCode_PLNT.SetColumn(0,"CODE_NAME","전체");
	ComboBoxPlant.Index = 0 ;
}
/********************************************************************** 
 * 내용설명 : JDE 계정코드조회
 * 주요변수 : 
 **********************************************************************/ 
 /* 미사용 - 2019.10.14
function getF0006LB(){
	var sKind		= "getF0006LB";						
	var sMethodName = "service::pscomlib/selectJdeF0006LB.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_F0006LB=ds_F0006LB";
	var sArgument   = "";
		sArgument += "LIB4="  + quote(Lib4);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ds_F0006LB.InsertRow(0);
	ds_F0006LB.SetColumn(0,"MCMCU","0");
	ds_F0006LB.SetColumn(0,"MCDC","전체");
	ds_F0006LB.SetColumn(0,"MCNAME","전체");
	cmd_GBMCU.Index=0;
}
*/
// 2019.10.14 : JDE F0902테이블에 등록된 BU코드만 보여줌
function getBUCODE(){
	var sKind		= "getBUCODE";						
	var sMethodName = "service::dwhlib/selectJdeF0902_BU.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_BUCD=ds_BUCD";
	var sArgument   = "";
		sArgument += " LIB4=" + quote(Lib4);
		sArgument += " GBFY=" + quote(substr(cmb_GBFY.Value,2,2)); //계획년(19)
		sArgument += " GBOBJ_FR=" + quote(GBOBJ_FR); //계정코드(FROM)
		sArgument += " GBOBJ_TO=" + quote(GBOBJ_TO); //계정코드(TO)		
		sArgument += " NotGBOBJ_FR=" + quote(NotGBOBJ_FR); //제외계정코드(FROM)
		sArgument += " NotGBOBJ_TO=" + quote(NotGBOBJ_TO); //제외계정코드(TO)

	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ds_BUCD.InsertRow(0);
	ds_BUCD.SetColumn(0,"MCMCU","");
	ds_BUCD.SetColumn(0,"MCNAME","전체");
	cmd_GBMCU_FR.Index=0;
	cmd_GBMCU_TO.Index=0;
}
/********************************************************************** 
 * 내용설명 : 부서코드조회
 * 주요변수 : 
 **********************************************************************/ 
  /* 미사용 - 2019.10.14
function getMst650PF(){
	var sKind		= "getMst650PF";						
	var sMethodName = "service::pscomlib/selectMst650PF.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_MST650PF=ds_MST650PF";
	var sArgument   = "";
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ds_MST650PF.InsertRow(0);
	ds_MST650PF.SetColumn(0,"DPCODE","");
	ds_MST650PF.SetColumn(0,"DPCODPNM","전체");
	cmb_DPTCD.Index=0;
}
*/
// 2019.10.14 : JDE F0902테이블에 등록된 부서코드만 보여줌
function getDPCODE(){
	var sKind		= "getDPCODE";						
	var sMethodName = "service::dwhlib/selectJdeF0902_DP.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_DPCODE=ds_DPCODE";
	var sArgument   = "";
		sArgument += " LIB4=" + quote(Lib4);
		sArgument += " GBFY=" + quote(substr(cmb_GBFY.Value,2,2)); //계획년(19)
		sArgument += " GBOBJ_FR=" + quote(GBOBJ_FR); //계정코드(FROM)
		sArgument += " GBOBJ_TO=" + quote(GBOBJ_TO); //계정코드(TO)
		sArgument += " NotGBOBJ_FR=" + quote(NotGBOBJ_FR); //제외계정코드(FROM)
		sArgument += " NotGBOBJ_TO=" + quote(NotGBOBJ_TO); //제외계정코드(TO)
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ds_DPCODE.InsertRow(0);
	ds_DPCODE.SetColumn(0,"DPCODE","0");
	ds_DPCODE.SetColumn(0,"DPCODPNM","전체");
	cmb_DPTCD_FR.Index=0;
	cmb_DPTCD_TO.Index=0;
}
/********************************************************************** 
 * 내용설명 : 계정코드
 * 주요변수 : 
 **********************************************************************/ 
// 2019.10.14 : JDE F0902테이블에 등록된 계정코드만 보여줌
function getGBOBJ(){
	var sKind		= "getGBOBJ";						
	var sMethodName = "service::dwhlib/selectJdeF0902_GBOBJ.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_GBOBJ=ds_GBOBJ";
	var sArgument   = "";
		sArgument += " LIB4=" + quote(Lib4);
		sArgument += " GBFY=" + quote(substr(cmb_GBFY.Value,2,2)); //계획년(19)
		sArgument += " GBOBJ_FR=" + quote(GBOBJ_FR); //계정코드(FROM)
		sArgument += " GBOBJ_TO=" + quote(GBOBJ_TO); //계정코드(TO)
		sArgument += " NotGBOBJ_FR=" + quote(NotGBOBJ_FR); //제외계정코드(FROM)
		sArgument += " NotGBOBJ_TO=" + quote(NotGBOBJ_TO); //제외계정코드(TO)
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ds_GBOBJ.InsertRow(0);
	ds_GBOBJ.SetColumn(0,"GBOBJ","");
	ds_GBOBJ.SetColumn(0,"GBNAME","전체");
	cmb_GBOBJ_FR.Index=0;
	cmb_GBOBJ_TO.Index=0;
}

/********************************************************************** 
 * 내용설명 : 화면조회
 * 주요변수 : 
 **********************************************************************/ 
function getDWH(){

	if(!validationChk()){
		return;
	}
	if(chK_MultiDpcode.Value=true){	//true:1 false:0
		if(length(trim(ed_MultiCode.Text)) = 0 ){
			alert("[알림]다중부서선택 후 조회하세요.");
			return;
		}
	}
	
	//부서코드
	var p_GBSBL1,p_GBSBL2;
	p_GBSBL1 = iif (trim(cmb_DPTCD_FR.Value) = 0, ds_DPCODE.GetColumn(1,"DPCODE"), trim(cmb_DPTCD_FR.Value));
	p_GBSBL2 = iif (trim(cmb_DPTCD_TO.Value) = 0, ds_DPCODE.GetColumn(ds_DPCODE.lastrow,"DPCODE"), trim(cmb_DPTCD_TO.Value));
	//trace(p_GBSBL1+"==="+p_GBSBL2);
	//BU코드
	var p_GBMCU1,p_GBMCU2;
	p_GBMCU1 = iif (length(trim(cmd_GBMCU_FR.Value)) == 0, "0", trim(cmd_GBMCU_FR.Value));
	p_GBMCU2 = iif (length(trim(cmd_GBMCU_TO.Value)) == 0, ds_BUCD.GetColumn(ds_BUCD.lastrow,"MCMCU"), trim(cmd_GBMCU_TO.Value));
	//trace(p_GBMCU1+"==="+p_GBMCU2);
	//계정코드
	var p_GBOBJ1,p_GBOBJ2;
	p_GBOBJ1 = iif (length(trim(cmb_GBOBJ_FR.Value)) == 0, "0", trim(cmb_GBOBJ_FR.Value));
	p_GBOBJ2 = iif (length(trim(cmb_GBOBJ_TO.Value)) == 0, ds_GBOBJ.GetColumn(ds_GBOBJ.lastrow,"GBOBJ"), trim(cmb_GBOBJ_TO.Value));
	
	//trace(p_GBOBJ1+"==="+p_GBOBJ2);
	var sKind		= "getDWH";						
	var sMethodName = "service::dwhlib/selectManagement.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_DWH=ds_DWH";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	//sArgument += "@LIB1="  + quote(Lib1);
	sArgument += "@LIB2="  + quote(Lib2);
	sArgument += "@LIB4="  + quote(Lib4);
	sArgument += "@COMPS=" + quote(ComboBoxPlant.Value);
	sArgument += "@GBFY=" + quote(substr(cmb_GBFY.Value,2,2)); //계획년(19)
	//sArgument += "@GBSBL=" + quote(cmb_DPTCD_FR.Value); //부서코드
	//sArgument += "@GBMCU=" + quote(cmd_GBMCU_FR.Value); //BU코드
	//sArgument += "@GBOBJ=" + quote(cmb_GBOBJ_FR.Value); //계정코드
	sArgument += "@P_GBSBL1=" + quote(p_GBSBL1); //부서코드(FR)
	sArgument += "@P_GBSBL2=" + quote(p_GBSBL2); //부서코드(TO)
	sArgument += "@P_GBMCU1=" + quote(p_GBMCU1); //BU코드(FR)
	sArgument += "@P_GBMCU2=" + quote(p_GBMCU2); //BU코드(TO)
	sArgument += "@P_GBOBJ1=" + quote(p_GBOBJ1); //계정코드(FR)
	sArgument += "@P_GBOBJ2=" + quote(p_GBOBJ2); //계정코드(TO)
	sArgument += "@P_MULTI=" + quote(chK_MultiDpcode.Value); //다중부서코드 사용여부
	sArgument += "@P_MULTICODE=" + quote(ed_MultiCode.Text); //다중부서코드
		
	sArgument += "@GBOBJ_FR=" + quote(GBOBJ_FR); //디폴트 계정코드(FROM)
	sArgument += "@GBOBJ_TO=" + quote(GBOBJ_TO); //디폴트 계정코드(TO)
	sArgument += "@NotGBOBJ_FR=" + quote(NotGBOBJ_FR); //제외계정코드(FROM)
	sArgument += "@NotGBOBJ_TO=" + quote(NotGBOBJ_TO); //제외계정코드(TO)	
	sArgument += "@SORTTYPE=" + quote(rdoggub.Value); //정렬순서
	sArgument += "@SQLID=" + "selectJDEZ001Q";	
	var str = dialog("Common::PGMLOAD_DWH.xml","sKind=" + sKind + " " + "sMethodName=" + sMethodName + " " + "sOutDataSet=" + sOutDataSet + " " + "sArgument=" + sArgument,272,64,"TitleBar=false");	
	if (str == 'T'){  //정상조회
		GrltSumBA=setSubSumXX("BA");
		GrltSumAA=setSubSumXX("AA");
		GrltSumCA=setSubSumXX("CA");
		GrltSumDA=setSubSumXX("DA");
		ds_SubSum.SetColumn(0,"BA",GrltSumBA);
		ds_SubSum.SetColumn(0,"AA",GrltSumAA);
		ds_SubSum.SetColumn(0,"CA",GrltSumCA);
		ds_SubSum.SetColumn(0,"DA",GrltSumDA);
		alert(setPopMessage("1004"));
		setMessage("1004");
	}else if (str == 'B'){   //data값이 없을때
		alert(setPopMessage("1003"));
		setMessage("1003");	
	}else if (str == 'E'){   //error발생시
		alert(setPopMessage("1002"));
		setMessage("1002");	
	}
}

/********************************************************************** 
 * 내용설명 : validation 체크
 **********************************************************************/ 
function validationChk(){
	var result = true;
	ComboBoxPlant.BKColor="white";
	cmb_GBFY.BKColor="white";
		
	if (ComboBoxPlant.Value == ""){
		ComboBoxPlant.BKColor="paleturquoise";
		alert(setPopMessage("2041"));//[알림] 사업부를 선택하세요.
		setMessage("2041");
		result = false;
	}
	if (cmb_GBFY.Value == ""){
		cmb_GBFY.BKColor="paleturquoise";
		alert(setPopMessage("4715"));//[알림]기준일자를 입력하세요.
		setMessage("4715");	
		result = false;
	}
	if(chK_SYSTEM.Value=true){
		if(ComboBoxPlant.Value="DN"){
			alert("[알림]환경구분체크 해지후 통합환경 조회가 가능합니다.");
			result = false;
		}
	}
	return result;
}

/********************************************************************** 
 * 내용설명 : 엑셀파일로 저장
 * 주요변수 : 
 **********************************************************************/ 
function setExcel()
{
	var fName   = "경비계획대실적_"+substr(cmb_GBFY.Value,0,4);
	var arrSheets  =  Array();  

	arrSheets[0]  = "MainGrid|경비계획대실적";
	/*
	if(rdoggub.Value="BU"){
		arrSheets[0]  = "MainGrid|경비계획대실적";
	}else if(rdoggub.Value="DP"){
		arrSheets[0]  = "MainGrid_Dual|경비계획대실적";
	}
	*/
	createExcelSheetS2(FileDialog0, fName ,arrSheets);
}


/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){
		alert(setPopMessage("1002"));
		setMessage("1002");
	}
}


function MainGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) lib_grid_SetGridSort(obj,nCell);
}

function MainGrid_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
// Ctrl + C
	if(bCtrl == 1 && nChar == 67) {

		// grd_Standard.AreaSelect = true;
		grd_fn_ClipboardCopy(obj, strSeparator);

	// Ctrl + V
	/*} else if(bCtrl == 1 && nChar == 86) {

		// grd_Standard.AreaSelect = true;
		grd_fn_ClipboardPaste(obj, strSeparator);

	// Ctrl + Z
	} else if(bCtrl == 1 && nChar == 90) {

		// grd_Standard.AreaSelect = true;
		grd_fn_CellReset(obj);*/
	}
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤 함수들
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	getDWH();
}

function fn_Input()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Delete()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Save()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_print()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Excel()
{
	setExcel();
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("1"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}

function common_OnChanged(obj,strOldText,strNewText)
{
	ds_DWH.ClearData();
	ds_SubSum.SetColumn(0,"BA",0);
	ds_SubSum.SetColumn(0,"AA",0);
	ds_SubSum.SetColumn(0,"CA",0);
	ds_SubSum.SetColumn(0,"DA",0);
	//ed_MultiCode.Text="";
	//ed_MultiCodeName.Text="";
}
function ComboBoxPlant_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//사업부별 라이브러리 선택
	if(ComboBoxPlant.Value="DN"){	//통합환경
		Lib4 = "CLTDTA";
	}else if(ComboBoxPlant.Value="PE"){	//구KE환경
		Lib4 = "CLTDTAE";
	}else if(ComboBoxPlant.Value="PS"){	//구KA환경
		Lib4 = "CLTDTAS";
	}
	//getF0006LB(); //사업부 계정코드로 초기화
	getBUCODE();	//계정코드
	getDPCODE();	//부서코드
	getGBOBJ();	//계정코드
	ds_DWH.ClearData();
	ds_SubSum.SetColumn(0,"BA",0);
	ds_SubSum.SetColumn(0,"AA",0);
	ds_SubSum.SetColumn(0,"CA",0);
	ds_SubSum.SetColumn(0,"DA",0);

}
function rdoggub_OnClick(obj)
{
	ds_DWH.ClearData();
	ds_SubSum.SetColumn(0,"BA",0);
	ds_SubSum.SetColumn(0,"AA",0);
	ds_SubSum.SetColumn(0,"CA",0);
	ds_SubSum.SetColumn(0,"DA",0);
	//ed_MultiCode.Text="";
	//ed_MultiCodeName.Text="";
	if(rdoggub.Value="BU"){
		//ds_DWH.GroupKey="BUDYEAR, BUDYEAR:GBMCU:MCDC, BUDYEAR:GBMCU:MCDC:GBSBL, BUDYEAR:GBMCU:MCDC:GBSBL:GBOBJ";
		MainGrid.contents = fn_makeGrdContents(rdoggub.Value);

	}else if(rdoggub.Value="DP"){
		//ds_DWH.GroupKey="BUDYEAR, BUDYEAR:GBSBL, BUDYEAR:GBSBL:GBMCU:MCDC, BUDYEAR:GBSBL:GBMCU:MCDC:GBOBJ";
		MainGrid.contents = fn_makeGrdContents(rdoggub.Value);
	}else if(rdoggub.Value="GB"){
		//ds_DWH.GroupKey="BUDYEAR, BUDYEAR:GBOBJ:GBSUB, BUDYEAR:GBOBJ:GBSUB:GBMCU:MCDC, BUDYEAR:GBOBJ:GBSUB:GBMCU:MCDC:GBSBL";
		MainGrid.contents = fn_makeGrdContents(rdoggub.Value);

	}
}

function cmb_GBFY_OnChanged(obj,strOldText,strNewText)
{
	if(substr(strOldText,0,4) != substr(strNewText,0,4)){
		getBUCODE();	//계정코드
		getDPCODE();	//부서코드
	}
	ds_DWH.ClearData();
	calculator_Year();
	ds_SubSum.SetColumn(0,"BA",0);
	ds_SubSum.SetColumn(0,"AA",0);
	ds_SubSum.SetColumn(0,"CA",0);
	ds_SubSum.SetColumn(0,"DA",0);
	ed_MultiCode.Text="";
	ed_MultiCodeName.Text="";
}

function chK_SYSTEM_OnClick(obj,strValue)
{
	if(chK_SYSTEM.Value=true){
		ComboBoxPlant.Enable=true;
	}else{
		ComboBoxPlant.Enable=false;
	}
}

function fn_makeGrdContents(p_Type)
{
	var strContents = "";
	strContents += "<contents>                                                ";
	strContents += "	<format id='Default'>                                 "; 
	strContents += "		<columns>                                         ";
	strContents += "			<col fix='left' width='40'/>                  ";
	strContents += "			<col fix='left' width='55'/>                  ";
	if(p_Type="BU"){
		strContents += "			<col fix='left' width='50'/>                  ";
		strContents += "			<col fix='left' width='180'/>                 ";
		strContents += "			<col fix='left' width='55'/>                  ";
		strContents += "			<col fix='left' width='55'/>                  ";
		strContents += "			<col fix='left' width='80'/>                  ";
		strContents += "			<col fix='left' width='180'/>                 ";
	}else if(p_Type="DP"){
		strContents += "			<col fix='left' width='50'/>                  ";
		strContents += "			<col fix='left' width='50'/>                 ";
		strContents += "			<col fix='left' width='180'/>                  ";
		strContents += "			<col fix='left' width='55'/>                  ";
		strContents += "			<col fix='left' width='80'/>                  ";
		strContents += "			<col fix='left' width='180'/>                 ";
	}else if(p_Type="GB"){
		strContents += "			<col fix='left' width='55'/>                  ";
		strContents += "			<col fix='left' width='80'/>                 ";
		strContents += "			<col fix='left' width='180'/>                  ";
		strContents += "			<col fix='left' width='50'/>                  ";
		strContents += "			<col fix='left' width='180'/>                  ";
		strContents += "			<col fix='left' width='55'/>                 ";
	}	
	strContents += "			<col fix='left' width='70'/>                  ";
	strContents += "			<col width='100'/>                            ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "			<col width='90'/>                             ";
	strContents += "		</columns>                                        "; 
	strContents += "		<head>                                            ";
	strContents += "<cell bkcolor='#dfdfdf' col='0' display='text' text='SEQ'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='1' display='text' text='회계년도'/>";
	
	if(p_Type="BU"){
		strContents += "<cell bkcolor='#dfdfdf' col='2' display='text' text='BU코드'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='3' display='text' text='BU명'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='4' display='text' text='부서코드'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='5' display='text' text='계정코드'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='6' display='text' text='계정코드SUB'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='7' display='text' text='계정코드명2'/>";
	}else if(p_Type="DP"){
		strContents += "<cell bkcolor='#dfdfdf' col='2' display='text' text='부서코드'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='3' display='text' text='BU코드'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='4' display='text' text='BU명'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='5' display='text' text='계정코드'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='6' display='text' text='계정코드SUB'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='7' display='text' text='계정코드명2'/>";
	}else if(p_Type="GB"){
		strContents += "<cell bkcolor='#dfdfdf' col='2' display='text' text='계정코드'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='3' display='text' text='계정코드SUB'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='4' display='text' text='계정코드명2'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='5' display='text' text='BU코드'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='6' display='text' text='BU명'/>";
		strContents += "<cell bkcolor='#dfdfdf' col='7' display='text' text='부서코드'/>";
	}
	strContents += "<cell bkcolor='#dfdfdf' col='8' display='text' text='구분'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='9' display='text' text='합계'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='10' display='text' text='04월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='11' display='text' text='05월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='12' display='text' text='06월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='13' display='text' text='07월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='14' display='text' text='08월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='15' display='text' text='09월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='16' display='text' text='10월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='17' display='text' text='11월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='18' display='text' text='12월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='19' display='text' text='01월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='20' display='text' text='02월'/>";
	strContents += "<cell bkcolor='#dfdfdf' col='21' display='text' text='03월'/>";
	strContents += "		</head>                                           ";
	strContents += "		<body>                                            "; 	
	strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='0' display='text' rowspan='4' expr='row+1'/>";
	strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='1' colid='BUDYEAR' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,BUDYEAR,1,&quot;소계&quot;,2,&quot;소계&quot;,3,&quot;소계&quot;,4,&quot;총계&quot;)'/>";
	
	if(p_Type="BU"){
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='2' colid='GBMCU' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBMCU,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='expr:decode(rowlevel,0,&quot;left&quot;,1,&quot;right&quot;,2,&quot;right&quot;,3,&quot;right&quot;,4,&quot;right&quot;)' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='3' colid='MCDC' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GMDL02,1,&quot;계정코드별&quot;,2,&quot;부서코드별&quot;,3,&quot;BU코드&quot;,4,&quot;회계년도&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='4' colid='GBSBL' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBSBL,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='5' colid='GBOBJ' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBOBJ,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='6' colid='GBSUB' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBSUB,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='left' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='7' colid='GMDL02' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GMDL02,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
	}else if(p_Type="DP"){
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='2' colid='GBSBL' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBSBL,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='3' colid='GBMCU' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBMCU,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='expr:decode(rowlevel,0,&quot;left&quot;,1,&quot;right&quot;,2,&quot;right&quot;,3,&quot;right&quot;,4,&quot;right&quot;)' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='4' colid='MCDC' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,MCDC,1,&quot;계정코드별&quot;,2,&quot;BU코드별&quot;,3,&quot;부서코드별&quot;,4,&quot;회계년도&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='5' colid='GBOBJ' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBOBJ,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='6' colid='GBSUB' display='text' rowspan='4' subsumexpr='decode(rowlevel,&#32;0,&#32;GBSUB,&#32;1,&quot;&quot;,&#32;2,&#32;&quot;&quot;,&#32;3,&#32;&quot;&quot;,&#32;4,&#32;&quot;&quot;)'/>";
		strContents += "<cell align='left' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='7' colid='GMDL02' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GMDL02,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
	}else if(p_Type="GB"){
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='2' colid='GBOBJ' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBOBJ,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='3' colid='GBSUB' display='text' rowspan='4' subsumexpr='decode(rowlevel,&#32;0,&#32;GBSUB,&#32;1,&quot;&quot;,&#32;2,&#32;&quot;&quot;,&#32;3,&#32;&quot;&quot;,&#32;4,&#32;&quot;&quot;)'/>";
		strContents += "<cell align='left' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='4' colid='GMDL02' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GMDL02,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='5' colid='GBMCU' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBMCU,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
		strContents += "<cell align='expr:decode(rowlevel,0,&quot;left&quot;,1,&quot;right&quot;,2,&quot;right&quot;,3,&quot;right&quot;,4,&quot;right&quot;)' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='6' colid='MCDC' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,MCDC,1,&quot;부서코드별&quot;,2,&quot;BU코드별&quot;,3,&quot;계정코드별&quot;,4,&quot;회계년도&quot;)'/>";
		strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='7' colid='GBSBL' display='text' rowspan='4' subsumexpr='decode(rowlevel,0,GBSBL,1,&quot;&quot;,2,&quot;&quot;,3,&quot;&quot;,4,&quot;&quot;)'/>";
	}
	strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='8' display='normal' subsumtext='계획' text='계획'/>";
	strContents += "<cell align='right' checklength='Byte' col='9' colid='TOTGBANBA' display='number' subsumexpr='TOTGBANBA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='10' colid='GBAN01BA' display='number' subsumexpr='GBAN01BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='11' colid='GBAN02BA' display='number' subsumexpr='GBAN02BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='12' colid='GBAN03BA' display='number' subsumexpr='GBAN03BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='13' colid='GBAN04BA' display='number' subsumexpr='GBAN04BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='14' colid='GBAN05BA' display='number' subsumexpr='GBAN05BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='15' colid='GBAN06BA' display='number' subsumexpr='GBAN06BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='16' colid='GBAN07BA' display='number' subsumexpr='GBAN07BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='17' colid='GBAN08BA' display='number' subsumexpr='GBAN08BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='18' colid='GBAN09BA' display='number' subsumexpr='GBAN09BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='19' colid='GBAN10BA' display='number' subsumexpr='GBAN10BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='20' colid='GBAN11BA' display='number' subsumexpr='GBAN11BA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='21' colid='GBAN12BA' display='number' subsumexpr='GBAN12BA.SUM'/>";
	strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' checklength='Byte' col='8' display='normal' row='1' subsumtext='실적' text='실적'/>";
	strContents += "<cell align='right' checklength='Byte' col='9' colid='TOTGBANAA' display='number' row='1' subsumexpr='TOTGBANAA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='10' colid='GBAN01AA' display='number' row='1' subsumexpr='GBAN01AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='11' colid='GBAN02AA' display='number' row='1' subsumexpr='GBAN02AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='12' colid='GBAN03AA' display='number' row='1' subsumexpr='GBAN03AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='13' colid='GBAN04AA' display='number' row='1' subsumexpr='GBAN04AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='14' colid='GBAN05AA' display='number' row='1' subsumexpr='GBAN05AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='15' colid='GBAN06AA' display='number' row='1' subsumexpr='GBAN06AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='16' colid='GBAN07AA' display='number' row='1' subsumexpr='GBAN07AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='17' colid='GBAN08AA' display='number' row='1' subsumexpr='GBAN08AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='18' colid='GBAN09AA' display='number' row='1' subsumexpr='GBAN09AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='19' colid='GBAN10AA' display='number' row='1' subsumexpr='GBAN10AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='20' colid='GBAN11AA' display='number' row='1' subsumexpr='GBAN11AA.SUM'/>";
	strContents += "<cell align='right' checklength='Byte' col='21' colid='GBAN12AA' display='number' row='1' subsumexpr='GBAN12AA.SUM'/>";
	strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' col='8' display='normal' row='2' subsumtext='차이' text='차이'/>";
	strContents += "<cell align='right' col='9' display='number' expr='ToFloat(TOTGBANBA)&#32;-&#32;ToFloat(TOTGBANAA)' row='2' subsumexpr='ToFloat(TOTGBANBA.SUM)&#32;-&#32;ToFloat(TOTGBANAA.SUM)'/>";
	strContents += "<cell align='right' col='10' display='number' expr='ToFloat(GBAN01BA)&#32;-&#32;ToFloat(GBAN01AA)' row='2' subsumexpr='ToFloat(GBAN01BA.SUM)&#32;-&#32;ToFloat(GBAN01AA.SUM)'/>";
	strContents += "<cell align='right' col='11' display='number' expr='ToFloat(GBAN02BA)&#32;-&#32;ToFloat(GBAN02AA)' row='2' subsumexpr='ToFloat(GBAN02BA.SUM)&#32;-&#32;ToFloat(GBAN02AA.SUM)'/>";
	strContents += "<cell align='right' col='12' display='number' expr='ToFloat(GBAN03BA)&#32;-&#32;ToFloat(GBAN03AA)' row='2' subsumexpr='ToFloat(GBAN03BA.SUM)&#32;-&#32;ToFloat(GBAN03AA.SUM)'/>";
	strContents += "<cell align='right' col='13' display='number' expr='ToFloat(GBAN04BA)&#32;-&#32;ToFloat(GBAN04AA)' row='2' subsumexpr='ToFloat(GBAN04BA.SUM)&#32;-&#32;ToFloat(GBAN04AA.SUM)'/>";
	strContents += "<cell align='right' col='14' display='number' expr='ToFloat(GBAN05BA)&#32;-&#32;ToFloat(GBAN05AA)' row='2' subsumexpr='ToFloat(GBAN05BA.SUM)&#32;-&#32;ToFloat(GBAN05AA.SUM)'/>";
	strContents += "<cell align='right' col='15' display='number' expr='ToFloat(GBAN06BA)&#32;-&#32;ToFloat(GBAN06AA)' row='2' subsumexpr='ToFloat(GBAN06BA.SUM)&#32;-&#32;ToFloat(GBAN06AA.SUM)'/>";
	strContents += "<cell align='right' col='16' display='number' expr='ToFloat(GBAN07BA)&#32;-&#32;ToFloat(GBAN07AA)' row='2' subsumexpr='ToFloat(GBAN07BA.SUM)&#32;-&#32;ToFloat(GBAN07AA.SUM)'/>";
	strContents += "<cell align='right' col='17' display='number' expr='ToFloat(GBAN08BA)&#32;-&#32;ToFloat(GBAN08AA)' row='2' subsumexpr='ToFloat(GBAN08BA.SUM)&#32;-&#32;ToFloat(GBAN08AA.SUM)'/>";
	strContents += "<cell align='right' col='18' display='number' expr='ToFloat(GBAN09BA)&#32;-&#32;ToFloat(GBAN09AA)' row='2' subsumexpr='ToFloat(GBAN09BA.SUM)&#32;-&#32;ToFloat(GBAN09AA.SUM)'/>";
	strContents += "<cell align='right' col='19' display='number' expr='ToFloat(GBAN10BA)&#32;-&#32;ToFloat(GBAN10AA)' row='2' subsumexpr='ToFloat(GBAN10BA.SUM)&#32;-&#32;ToFloat(GBAN10AA.SUM)'/>";
	strContents += "<cell align='right' col='20' display='number' expr='ToFloat(GBAN11BA)&#32;-&#32;ToFloat(GBAN11AA)' row='2' subsumexpr='ToFloat(GBAN11BA.SUM)&#32;-&#32;ToFloat(GBAN11AA.SUM)'/>";
	strContents += "<cell align='right' col='21' display='number' expr='ToFloat(GBAN12BA)&#32;-&#32;ToFloat(GBAN12AA)' row='2' subsumexpr='ToFloat(GBAN12BA.SUM)&#32;-&#32;ToFloat(GBAN12AA.SUM)'/>";
	strContents += "<cell align='center' bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;lightcyan&quot;,2,&quot;lightgoldenrodyellow&quot;,3,&quot;lightsalmon&quot;,&#32;4,&quot;lightcoral&quot;)' col='8' display='text' row='3' subsumtext='계획비(%)' text='계획비(%)'/>";
	strContents += "<cell align='right' col='9' display='number' expr='ToFloat(TOTGBANAA)/ToFloat(TOTGBANBA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(TOTGBANAA.SUM)/ToFloat(TOTGBANBA.SUM)*100'/>";
	strContents += "<cell align='right' col='10' display='number' expr='ToFloat(GBAN01AA)/ToFloat(GBAN01BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN01AA.SUM)/ToFloat(GBAN01BA.SUM)*100'/>";
	strContents += "<cell align='right' col='11' display='number' expr='ToFloat(GBAN02AA)/ToFloat(GBAN02BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN02AA.SUM)/ToFloat(GBAN02BA.SUM)*100'/>";
	strContents += "<cell align='right' col='12' display='number' expr='ToFloat(GBAN03AA)/ToFloat(GBAN03BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN03AA.SUM)/ToFloat(GBAN03BA.SUM)*100'/>";
	strContents += "<cell align='right' col='13' display='number' expr='ToFloat(GBAN04AA)/ToFloat(GBAN04BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN04AA.SUM)/ToFloat(GBAN04BA.SUM)*100'/>";
	strContents += "<cell align='right' col='14' display='number' expr='ToFloat(GBAN05AA)/ToFloat(GBAN05BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN05AA.SUM)/ToFloat(GBAN05BA.SUM)*100'/>";
	strContents += "<cell align='right' col='15' display='number' expr='ToFloat(GBAN06AA)/ToFloat(GBAN06BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN06AA.SUM)/ToFloat(GBAN06BA.SUM)*100'/>";
	strContents += "<cell align='right' col='16' display='number' expr='ToFloat(GBAN07AA)/ToFloat(GBAN07BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN07AA.SUM)/ToFloat(GBAN07BA.SUM)*100'/>";
	strContents += "<cell align='right' col='17' display='number' expr='ToFloat(GBAN08AA)/ToFloat(GBAN08BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN08AA.SUM)/ToFloat(GBAN08BA.SUM)*100'/>";
	strContents += "<cell align='right' col='18' display='number' expr='ToFloat(GBAN09AA)/ToFloat(GBAN09BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN09AA.SUM)/ToFloat(GBAN09BA.SUM)*100'/>";
	strContents += "<cell align='right' col='19' display='number' expr='ToFloat(GBAN10AA)/ToFloat(GBAN10BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN10AA.SUM)/ToFloat(GBAN10BA.SUM)*100'/>";
	strContents += "<cell align='right' col='20' display='number' expr='ToFloat(GBAN11AA)/ToFloat(GBAN11BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN11AA.SUM)/ToFloat(GBAN11BA.SUM)*100'/>";
	strContents += "<cell align='right' col='21' display='number' expr='ToFloat(GBAN12AA)/ToFloat(GBAN12BA)*100' LimitDec='2' Mask='#,##0.00%' row='3' subsumexpr='ToFloat(GBAN12AA.SUM)/ToFloat(GBAN12BA.SUM)*100'/>";
	strContents += "		</body>                                           ";
	//누계용 그리드	
	/*
	strContents += "		<summary>                                         ";
	strContents += "<cell align='center' col='0' colspan='5' display='text' rowspan='4' text='합계'/>";
	strContents += "<cell align='center' bkcolor='antiquewhite' col='5' display='text' rowspan='4' text='누계'/>";
	strContents += "<cell align='center' bkcolor='antiquewhite' col='6' display='text' text='계획'/>";
	strContents += "<cell align='right' bkcolor='antiquewhite' col='7' display='number' expr='setSubSum(&quot;BA&quot;)'/>";
	strContents += "<cell align='center' col='8' display='text' text='계획'/>";
	strContents += "<cell align='right' col='9' display='number' expr='SUM(&quot;TOTGBANBA&quot;)'/>";
	strContents += "<cell align='right' col='10' display='number' expr='SUM(&quot;GBAN01BA&quot;)'/>";
	strContents += "<cell align='right' col='11' display='number' expr='SUM(&quot;GBAN02BA&quot;)'/>";
	strContents += "<cell align='right' col='12' display='number' expr='SUM(&quot;GBAN03BA&quot;)'/>";
	strContents += "<cell align='right' col='13' display='number' expr='SUM(&quot;GBAN04BA&quot;)'/>";
	strContents += "<cell align='right' col='14' display='number' expr='SUM(&quot;GBAN05BA&quot;)'/>";
	strContents += "<cell align='right' col='15' display='number' expr='SUM(&quot;GBAN06BA&quot;)'/>";
	strContents += "<cell align='right' col='16' display='number' expr='SUM(&quot;GBAN07BA&quot;)'/>";
	strContents += "<cell align='right' col='17' display='number' expr='SUM(&quot;GBAN08BA&quot;)'/>";
	strContents += "<cell align='right' col='18' display='number' expr='SUM(&quot;GBAN09BA&quot;)'/>";
	strContents += "<cell align='right' col='19' display='number' expr='SUM(&quot;GBAN10BA&quot;)'/>";
	strContents += "<cell align='right' col='20' display='number' expr='SUM(&quot;GBAN11BA&quot;)'/>";
	strContents += "<cell align='right' col='21' display='number' expr='SUM(&quot;GBAN12BA&quot;)'/>";	
	strContents += "<cell align='center' bkcolor='antiquewhite' col='6' display='text' row='1' text='실적'/>";
	strContents += "<cell align='right' bkcolor='antiquewhite' col='7' display='number' expr='setSubSum(&quot;AA&quot;)' row='1'/>";
	strContents += "<cell align='center' col='8' display='text' row='1' text='실적'/>";
	strContents += "<cell align='right' col='9' display='number' expr='SUM(&quot;TOTGBANAA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='10' display='number' expr='SUM(&quot;GBAN01AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='11' display='number' expr='SUM(&quot;GBAN02AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='12' display='number' expr='SUM(&quot;GBAN03AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='13' display='number' expr='SUM(&quot;GBAN04AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='14' display='number' expr='SUM(&quot;GBAN05AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='15' display='number' expr='SUM(&quot;GBAN06AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='16' display='number' expr='SUM(&quot;GBAN07AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='17' display='number' expr='SUM(&quot;GBAN08AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='18' display='number' expr='SUM(&quot;GBAN09AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='19' display='number' expr='SUM(&quot;GBAN10AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='20' display='number' expr='SUM(&quot;GBAN11AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='21' display='number' expr='SUM(&quot;GBAN12AA&quot;)' row='1'/>";	
	strContents += "<cell align='center' bkcolor='antiquewhite' col='6' display='text' row='2' text='차이'/>";
	strContents += "<cell align='right' bkcolor='antiquewhite' col='7' display='number' expr='setSubSum(&quot;CA&quot;)' row='2'/>";	
	strContents += "<cell align='center' col='8' display='text' row='2' text='차이'/>";
	strContents += "<cell align='right' col='9' display='number' expr='ToFloat(SUM(&quot;TOTGBANBA&quot;))&#32;-&#32;ToFloat(SUM(&quot;TOTGBANAA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='10' display='number' expr='ToFloat(SUM(&quot;GBAN01BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN01AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='11' display='number' expr='ToFloat(SUM(&quot;GBAN02BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN02AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='12' display='number' expr='ToFloat(SUM(&quot;GBAN03BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN03AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='13' display='number' expr='ToFloat(SUM(&quot;GBAN04BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN04AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='14' display='number' expr='ToFloat(SUM(&quot;GBAN05BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN05AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='15' display='number' expr='ToFloat(SUM(&quot;GBAN06BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN06AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='16' display='number' expr='ToFloat(SUM(&quot;GBAN07BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN07AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='17' display='number' expr='ToFloat(SUM(&quot;GBAN08BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN08AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='18' display='number' expr='ToFloat(SUM(&quot;GBAN09BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN09AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='19' display='number' expr='ToFloat(SUM(&quot;GBAN10BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN10AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='20' display='number' expr='ToFloat(SUM(&quot;GBAN11BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN11AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='21' display='number' expr='ToFloat(SUM(&quot;GBAN12BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN12AA&quot;))' row='2'/>";
	strContents += "<cell align='center' bkcolor='antiquewhite' col='6' display='text' row='3' text='계획비(%)'/>";
	strContents += "<cell align='right' bkcolor='antiquewhite' col='7' display='number' expr='setSubSum(&quot;DA&quot;)' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='center' col='8' display='text' row='3' text='계획비(%)'/>";
	strContents += "<cell align='right' col='9' display='number' expr='ToFloat(SUM(&quot;TOTGBANAA&quot;))/ToFloat(SUM(&quot;TOTGBANBA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='10' display='number' expr='ToFloat(SUM(&quot;GBAN01AA&quot;))/ToFloat(SUM(&quot;GBAN01BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='11' display='number' expr='ToFloat(SUM(&quot;GBAN02AA&quot;))/ToFloat(SUM(&quot;GBAN02BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='12' display='number' expr='ToFloat(SUM(&quot;GBAN03AA&quot;))/ToFloat(SUM(&quot;GBAN03BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='13' display='number' expr='ToFloat(SUM(&quot;GBAN04AA&quot;))/ToFloat(SUM(&quot;GBAN04BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='14' display='number' expr='ToFloat(SUM(&quot;GBAN05AA&quot;))/ToFloat(SUM(&quot;GBAN05BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='15' display='number' expr='ToFloat(SUM(&quot;GBAN06AA&quot;))/ToFloat(SUM(&quot;GBAN06BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='16' display='number' expr='ToFloat(SUM(&quot;GBAN07AA&quot;))/ToFloat(SUM(&quot;GBAN07BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='17' display='number' expr='ToFloat(SUM(&quot;GBAN08AA&quot;))/ToFloat(SUM(&quot;GBAN08BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='18' display='number' expr='ToFloat(SUM(&quot;GBAN09AA&quot;))/ToFloat(SUM(&quot;GBAN09BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='19' display='number' expr='ToFloat(SUM(&quot;GBAN10AA&quot;))/ToFloat(SUM(&quot;GBAN10BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='20' display='number' expr='ToFloat(SUM(&quot;GBAN11AA&quot;))/ToFloat(SUM(&quot;GBAN11BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='21' display='number' expr='ToFloat(SUM(&quot;GBAN12AA&quot;))/ToFloat(SUM(&quot;GBAN12BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "		</summary>                                        ";
	*/
	strContents += "		<summary>                                         ";
	strContents += "<cell align='center' col='0' colspan='8' display='text' rowspan='4' text='합계'/>";
	strContents += "<cell align='center' col='8' display='text' text='계획'/>";
	strContents += "<cell align='right' col='9' display='number' expr='SUM(&quot;TOTGBANBA&quot;)'/>";
	strContents += "<cell align='right' col='10' display='number' expr='SUM(&quot;GBAN01BA&quot;)'/>";
	strContents += "<cell align='right' col='11' display='number' expr='SUM(&quot;GBAN02BA&quot;)'/>";
	strContents += "<cell align='right' col='12' display='number' expr='SUM(&quot;GBAN03BA&quot;)'/>";
	strContents += "<cell align='right' col='13' display='number' expr='SUM(&quot;GBAN04BA&quot;)'/>";
	strContents += "<cell align='right' col='14' display='number' expr='SUM(&quot;GBAN05BA&quot;)'/>";
	strContents += "<cell align='right' col='15' display='number' expr='SUM(&quot;GBAN06BA&quot;)'/>";
	strContents += "<cell align='right' col='16' display='number' expr='SUM(&quot;GBAN07BA&quot;)'/>";
	strContents += "<cell align='right' col='17' display='number' expr='SUM(&quot;GBAN08BA&quot;)'/>";
	strContents += "<cell align='right' col='18' display='number' expr='SUM(&quot;GBAN09BA&quot;)'/>";
	strContents += "<cell align='right' col='19' display='number' expr='SUM(&quot;GBAN10BA&quot;)'/>";
	strContents += "<cell align='right' col='20' display='number' expr='SUM(&quot;GBAN11BA&quot;)'/>";
	strContents += "<cell align='right' col='21' display='number' expr='SUM(&quot;GBAN12BA&quot;)'/>";
	strContents += "<cell align='center' col='8' display='text' row='1' text='실적'/>";
	strContents += "<cell align='right' col='9' display='number' expr='SUM(&quot;TOTGBANAA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='10' display='number' expr='SUM(&quot;GBAN01AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='11' display='number' expr='SUM(&quot;GBAN02AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='12' display='number' expr='SUM(&quot;GBAN03AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='13' display='number' expr='SUM(&quot;GBAN04AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='14' display='number' expr='SUM(&quot;GBAN05AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='15' display='number' expr='SUM(&quot;GBAN06AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='16' display='number' expr='SUM(&quot;GBAN07AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='17' display='number' expr='SUM(&quot;GBAN08AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='18' display='number' expr='SUM(&quot;GBAN09AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='19' display='number' expr='SUM(&quot;GBAN10AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='20' display='number' expr='SUM(&quot;GBAN11AA&quot;)' row='1'/>";
	strContents += "<cell align='right' col='21' display='number' expr='SUM(&quot;GBAN12AA&quot;)' row='1'/>";
	strContents += "<cell align='center' col='8' display='text' row='2' text='차이'/>";
	strContents += "<cell align='right' col='9' display='number' expr='ToFloat(SUM(&quot;TOTGBANBA&quot;))&#32;-&#32;ToFloat(SUM(&quot;TOTGBANAA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='10' display='number' expr='ToFloat(SUM(&quot;GBAN01BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN01AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='11' display='number' expr='ToFloat(SUM(&quot;GBAN02BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN02AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='12' display='number' expr='ToFloat(SUM(&quot;GBAN03BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN03AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='13' display='number' expr='ToFloat(SUM(&quot;GBAN04BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN04AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='14' display='number' expr='ToFloat(SUM(&quot;GBAN05BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN05AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='15' display='number' expr='ToFloat(SUM(&quot;GBAN06BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN06AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='16' display='number' expr='ToFloat(SUM(&quot;GBAN07BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN07AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='17' display='number' expr='ToFloat(SUM(&quot;GBAN08BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN08AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='18' display='number' expr='ToFloat(SUM(&quot;GBAN09BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN09AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='19' display='number' expr='ToFloat(SUM(&quot;GBAN10BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN10AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='20' display='number' expr='ToFloat(SUM(&quot;GBAN11BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN11AA&quot;))' row='2'/>";
	strContents += "<cell align='right' col='21' display='number' expr='ToFloat(SUM(&quot;GBAN12BA&quot;))&#32;-&#32;ToFloat(SUM(&quot;GBAN12AA&quot;))' row='2'/>";
	strContents += "<cell align='center' col='8' display='text' row='3' text='계획비(%)'/>";
	strContents += "<cell align='right' col='9' display='number' expr='ToFloat(SUM(&quot;TOTGBANAA&quot;))/ToFloat(SUM(&quot;TOTGBANBA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='10' display='number' expr='ToFloat(SUM(&quot;GBAN01AA&quot;))/ToFloat(SUM(&quot;GBAN01BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='11' display='number' expr='ToFloat(SUM(&quot;GBAN02AA&quot;))/ToFloat(SUM(&quot;GBAN02BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='12' display='number' expr='ToFloat(SUM(&quot;GBAN03AA&quot;))/ToFloat(SUM(&quot;GBAN03BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='13' display='number' expr='ToFloat(SUM(&quot;GBAN04AA&quot;))/ToFloat(SUM(&quot;GBAN04BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='14' display='number' expr='ToFloat(SUM(&quot;GBAN05AA&quot;))/ToFloat(SUM(&quot;GBAN05BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='15' display='number' expr='ToFloat(SUM(&quot;GBAN06AA&quot;))/ToFloat(SUM(&quot;GBAN06BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='16' display='number' expr='ToFloat(SUM(&quot;GBAN07AA&quot;))/ToFloat(SUM(&quot;GBAN07BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='17' display='number' expr='ToFloat(SUM(&quot;GBAN08AA&quot;))/ToFloat(SUM(&quot;GBAN08BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='18' display='number' expr='ToFloat(SUM(&quot;GBAN09AA&quot;))/ToFloat(SUM(&quot;GBAN09BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='19' display='number' expr='ToFloat(SUM(&quot;GBAN10AA&quot;))/ToFloat(SUM(&quot;GBAN10BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='20' display='number' expr='ToFloat(SUM(&quot;GBAN11AA&quot;))/ToFloat(SUM(&quot;GBAN11BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "<cell align='right' col='21' display='number' expr='ToFloat(SUM(&quot;GBAN12AA&quot;))/ToFloat(SUM(&quot;GBAN12BA&quot;))*100' Mask='#,##0.00%' row='3'/>";
	strContents += "		</summary>                                        ";
	strContents += "	</format>                                             ";
	strContents += "</contents>	                                              ";     
	return strContents;
}

//조회조건의 회계년도 계산
function calculator_Year(){
	var setMM=substr(cmb_GBFY.Value,4,2);
	var dummyYMD= addMonth(cmb_GBFY.Value,-1);
	var setYear;
	if(parseInt(setMM)<4){	//4월이전
		setYear= addMonth(cmb_GBFY.Value,-parseInt(setMM));
		cmb_GBFY.Value=setYear;
	}
	ed_Dummy.Value =substr(dummyYMD,0,6);
}
//당월까지 누계계산
function setSubSum(pFlag){
	trace(1);
	var rltsum=0;
	
	if(pFlag="BA"){
		rltsum=GrltSumBA;
	}else if(pFlag="AA"){
		rltsum=GrltSumAA;
	}else if(pFlag="CA"){
		rltsum=GrltSumCA;
	}else if(pFlag="DA"){
		rltsum=GrltSumDA;
	}
	return rltSum;
}
function setSubSumXX(pFlag){
	var rltsum=0;
	var rltSumBA=0;
	var rltSumAA=0;
	
	if(pFlag="BA"){
		rltsum=calculatorSubSum(pFlag);
	}else if(pFlag="AA"){
		rltsum=calculatorSubSum(pFlag);
	}else if(pFlag="CA"){
		rltSumBA=calculatorSubSum("BA");
		rltSumAA=calculatorSubSum("AA");
		rltsum =toFloat(rltSumBA)-toFloat(rltSumAA);
	}else if(pFlag="DA"){
		rltSumBA=calculatorSubSum("BA");
		rltSumAA=calculatorSubSum("AA");
		rltsum =toFloat(rltSumAA)/toFloat(rltSumBA)*100;
	}
	return rltSum;
}
function calculatorSubSum(pFlag){
	var setMM=substr(ed_Dummy.Value,4,2);
	//trace(setMM);
	var rltSum=0;
	if(parseInt(setMM) !=3){
	//trace(setMM+"=="+(parseInt(setMM)+3));
		for(i=0; i < ds_DWH.rowcount; i++){
			if(parseInt(setMM)>3){	//4월이후
				for(j=1; j <= parseInt(setMM)-3; j++){
					rltSum += toFloat(ds_DWH.GetColumn(i,"GBAN"+lpad(j,"0",2)+pFlag));
				}
			}else{
				for(j=1; j <= parseInt(setMM)+9; j++){
					rltSum += toFloat(ds_DWH.GetColumn(i,"GBAN"+lpad(j,"0",2)+pFlag));
				}
			}
		}
	}
	return rltSum;
}
function imgCODE_OnClick(obj,nX,nY)
{
	var rtn = dialog("dwhlib::JDEZ001Q_POP.xml","",584,538);
	if (length(rtn) != 0){
		ed_MultiCode.Text=rtn[0];
		//ed_MultiCodeName.Text=rtn[1];
		ed_MultiCodeName.Text = replace(rtn[1],",","\n\r");
	}
}

function chK_MultiDpcode_OnClick(obj,strValue)
{
	//trace(chK_MultiDpcode.Value);
	if(chK_MultiDpcode.Value=true){	//true:1 false:0
		cmb_DPTCD_FR.Enable=false;
		cmb_DPTCD_TO.Enable=false;
		cmb_DPTCD_FR.Index=0;
		cmb_DPTCD_TO.Index=0;
		imgCODE.Enable=true;
	}else{
		cmb_DPTCD_FR.Enable=true;
		cmb_DPTCD_TO.Enable=true;
		ed_MultiCode.Text="";
		ed_MultiCodeName.Text="";
		imgCODE.Enable=false;
	}
}
]]></Script>
</Window>