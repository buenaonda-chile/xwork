<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="ed_CHGAD" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="소득정산&#32;변동자료등록" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_GUBUN">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>0</cd>
						<cdnm>중도정산</cdnm>
					</record>
					<record>
						<cd>1</cd>
						<cdnm>연말정산</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAYZ011_HAY011PF" OnColumnChanged="ds_HAYZ011_HAY011PF_OnColumnChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="SABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PTJYM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGAD" size="256" summ="default" type="STRING"/>
					<colinfo id="FORTY" size="256" summ="default" type="INT"/>
					<colinfo id="IJJWN" size="256" summ="default" type="INT"/>
					<colinfo id="ERILM" size="256" summ="default" type="INT"/>
					<colinfo id="KRWTX" size="256" summ="default" type="INT"/>
					<colinfo id="FCWTX" size="256" summ="default" type="INT"/>
					<colinfo id="TX1AD" size="256" summ="default" type="INT"/>
					<colinfo id="TX3AD" size="256" summ="default" type="INT"/>
					<colinfo id="BDMTR" size="256" summ="default" type="INT"/>
					<colinfo id="FCWTF" size="256" summ="default" type="INT"/>
					<colinfo id="BDYT1" size="256" summ="default" type="INT"/>
					<colinfo id="BDYT2" size="256" summ="default" type="INT"/>
					<colinfo id="WFBCD" size="256" summ="default" type="INT"/>
					<colinfo id="CHBCD" size="256" summ="default" type="INT"/>
					<colinfo id="PTBCD" size="256" summ="default" type="INT"/>
					<colinfo id="KYBCA" size="256" summ="default" type="INT"/>
					<colinfo id="KYBCB" size="256" summ="default" type="INT"/>
					<colinfo id="TRBCD" size="256" summ="default" type="INT"/>
					<colinfo id="BUBCD" size="256" summ="default" type="INT"/>
					<colinfo id="SPFCD" size="256" summ="default" type="INT"/>
					<colinfo id="SOSCD" size="256" summ="default" type="INT"/>
					<colinfo id="CBUCD" size="256" summ="default" type="INT"/>
					<colinfo id="BYFL1" size="256" summ="default" type="INT"/>
					<colinfo id="BYFL2" size="256" summ="default" type="INT"/>
					<colinfo id="POFL1" size="256" summ="default" type="INT"/>
					<colinfo id="POFL2" size="256" summ="default" type="INT"/>
					<colinfo id="PGPPC" size="256" summ="default" type="INT"/>
					<colinfo id="PGPRC" size="256" summ="default" type="INT"/>
					<colinfo id="PHOSA" size="256" summ="default" type="INT"/>
					<colinfo id="PHOSB" size="256" summ="default" type="INT"/>
					<colinfo id="PEDUA" size="256" summ="default" type="INT"/>
					<colinfo id="PEDUB" size="256" summ="default" type="INT"/>
					<colinfo id="PNHOU" size="256" summ="default" type="INT"/>
					<colinfo id="PNMOU" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU1" size="256" summ="default" type="INT"/>
					<colinfo id="PNHUA" size="256" summ="default" type="INT"/>
					<colinfo id="PNHUM" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU2" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU3" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU4" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU5" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU6" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU7" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU8" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU9" size="256" summ="default" type="INT"/>
					<colinfo id="WDISA" size="256" summ="default" type="INT"/>
					<colinfo id="KIBMA" size="256" summ="default" type="INT"/>
					<colinfo id="KIBMB" size="256" summ="default" type="INT"/>
					<colinfo id="KIBMC" size="256" summ="default" type="INT"/>
					<colinfo id="KIBMD" size="256" summ="default" type="INT"/>
					<colinfo id="KIBME" size="256" summ="default" type="INT"/>
					<colinfo id="KIBOA" size="256" summ="default" type="INT"/>
					<colinfo id="KIBOB" size="256" summ="default" type="INT"/>
					<colinfo id="KIBOC" size="256" summ="default" type="INT"/>
					<colinfo id="KIBOD" size="256" summ="default" type="INT"/>
					<colinfo id="KIBOE" size="256" summ="default" type="INT"/>
					<colinfo id="SOFL1" size="256" summ="default" type="INT"/>
					<colinfo id="SOFL2" size="256" summ="default" type="INT"/>
					<colinfo id="YUNG1" size="256" summ="default" type="INT"/>
					<colinfo id="YUNG2" size="256" summ="default" type="INT"/>
					<colinfo id="JUNTJ" size="256" summ="default" type="INT"/>
					<colinfo id="SINYN" size="256" summ="default" type="INT"/>
					<colinfo id="CASHN" size="256" summ="default" type="INT"/>
					<colinfo id="JIGBN" size="256" summ="default" type="INT"/>
					<colinfo id="CJANG" size="256" summ="default" type="INT"/>
					<colinfo id="JIRON" size="256" summ="default" type="INT"/>
					<colinfo id="PBTSN" size="256" summ="default" type="INT"/>
					<colinfo id="AYSNI" size="256" summ="default" type="INT"/>
					<colinfo id="AYSYA" size="256" summ="default" type="INT"/>
					<colinfo id="BYSYI" size="256" summ="default" type="INT"/>
					<colinfo id="BYSYA" size="256" summ="default" type="INT"/>
					<colinfo id="HUSA1" size="256" summ="default" type="INT"/>
					<colinfo id="HUSA2" size="256" summ="default" type="INT"/>
					<colinfo id="HUSA3" size="256" summ="default" type="INT"/>
					<colinfo id="HUSA4" size="256" summ="default" type="INT"/>
					<colinfo id="KITA1" size="256" summ="default" type="INT"/>
					<colinfo id="KITA2" size="256" summ="default" type="INT"/>
					<colinfo id="KITA3" size="256" summ="default" type="INT"/>
					<colinfo id="KITA4" size="256" summ="default" type="INT"/>
					<colinfo id="KITA5" size="256" summ="default" type="INT"/>
					<colinfo id="TJMON" size="256" summ="default" type="INT"/>
					<colinfo id="THMON" size="256" summ="default" type="INT"/>
					<colinfo id="TGMON" size="256" summ="default" type="INT"/>
					<colinfo id="JENGN" size="256" summ="default" type="INT"/>
					<colinfo id="KIBUA" size="256" summ="default" type="INT"/>
					<colinfo id="LGSTK" size="256" summ="default" type="INT"/>
					<colinfo id="TOBM1" size="256" summ="default" type="INT"/>
					<colinfo id="TOBM2" size="256" summ="default" type="INT"/>
					<colinfo id="RPNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="RNOA1" size="256" summ="default" type="INT"/>
					<colinfo id="RNOB1" size="256" summ="default" type="INT"/>
					<colinfo id="RNOC1" size="256" summ="default" type="INT"/>
					<colinfo id="RDTS1" size="256" summ="default" type="INT"/>
					<colinfo id="RDTE1" size="256" summ="default" type="INT"/>
					<colinfo id="RPAT1" size="256" summ="default" type="INT"/>
					<colinfo id="RBAT1" size="256" summ="default" type="INT"/>
					<colinfo id="RGB11" size="256" summ="default" type="INT"/>
					<colinfo id="RT1X1" size="256" summ="default" type="INT"/>
					<colinfo id="RT1X2" size="256" summ="default" type="INT"/>
					<colinfo id="RT1X3" size="256" summ="default" type="INT"/>
					<colinfo id="RG1P1" size="256" summ="default" type="INT"/>
					<colinfo id="RG1P2" size="256" summ="default" type="INT"/>
					<colinfo id="RG1P3" size="256" summ="default" type="INT"/>
					<colinfo id="RG1P4" size="256" summ="default" type="INT"/>
					<colinfo id="RGB12" size="256" summ="default" type="INT"/>
					<colinfo id="RPNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="RNOA2" size="256" summ="default" type="INT"/>
					<colinfo id="RNOB2" size="256" summ="default" type="INT"/>
					<colinfo id="RNOC2" size="256" summ="default" type="INT"/>
					<colinfo id="RDTS2" size="256" summ="default" type="INT"/>
					<colinfo id="RDTE2" size="256" summ="default" type="INT"/>
					<colinfo id="RPAT2" size="256" summ="default" type="INT"/>
					<colinfo id="RBAT2" size="256" summ="default" type="INT"/>
					<colinfo id="RGB21" size="256" summ="default" type="INT"/>
					<colinfo id="RT2X1" size="256" summ="default" type="INT"/>
					<colinfo id="RT2X2" size="256" summ="default" type="INT"/>
					<colinfo id="RT2X3" size="256" summ="default" type="INT"/>
					<colinfo id="RG2P1" size="256" summ="default" type="INT"/>
					<colinfo id="RG2P2" size="256" summ="default" type="INT"/>
					<colinfo id="RG2P3" size="256" summ="default" type="INT"/>
					<colinfo id="RG2P4" size="256" summ="default" type="INT"/>
					<colinfo id="RGB22" size="256" summ="default" type="INT"/>
					<colinfo id="SIDAT" size="256" summ="default" type="INT"/>
					<colinfo id="SSDAT" size="256" summ="default" type="INT"/>
					<colinfo id="PEDTA" size="256" summ="default" type="STRING"/>
					<colinfo id="CYSYI" size="256" summ="default" type="INT"/>
					<colinfo id="CYSYA" size="256" summ="default" type="INT"/>
					<colinfo id="DYSYI" size="256" summ="default" type="INT"/>
					<colinfo id="DYSYA" size="256" summ="default" type="INT"/>
					<colinfo id="EYSYI" size="256" summ="default" type="INT"/>
					<colinfo id="EYSYA" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU10" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU11" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU12" size="256" summ="default" type="INT"/>
					<colinfo id="PNHU13" size="256" summ="default" type="INT"/>
					<colinfo id="KIBPA" size="256" summ="default" type="INT"/>
					<colinfo id="KIBPB" size="256" summ="default" type="INT"/>
					<colinfo id="KIBPC" size="256" summ="default" type="INT"/>
					<colinfo id="KIBPD" size="256" summ="default" type="INT"/>
					<colinfo id="SNDCD" size="256" summ="default" type="INT"/>
					<colinfo id="SMCCD" size="256" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_HAYZ011_HAY021PF_CanRowPosChange" DataSetType="Dataset" Id="ds_HAYZ011_HAY021PF" OnColumnChanged="ds_HAYZ011_HAY021PF_OnColumnChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="SABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="RELCD" size="256" summ="default" type="STRING"/>
					<colinfo id="RELNO" size="256" summ="default" type="INT"/>
					<colinfo id="RELNM" size="256" summ="default" type="STRING"/>
					<colinfo id="KORNO" size="256" summ="default" type="STRING"/>
					<colinfo id="KOCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="LIVCD" size="256" summ="default" type="STRING"/>
					<colinfo id="KIBCD" size="256" summ="default" type="INT"/>
					<colinfo id="KYANO" size="256" summ="default" type="INT"/>
					<colinfo id="KYBNO" size="256" summ="default" type="INT"/>
					<colinfo id="TRBNO" size="256" summ="default" type="INT"/>
					<colinfo id="BUBNO" size="256" summ="default" type="INT"/>
					<colinfo id="SPFCD" size="256" summ="default" type="INT"/>
					<colinfo id="CBUNO" size="256" summ="default" type="INT"/>
					<colinfo id="BTPNO" size="256" summ="default" type="INT"/>
					<colinfo id="CYFL1" size="256" summ="default" type="INT"/>
					<colinfo id="CYFL2" size="256" summ="default" type="INT"/>
					<colinfo id="CYFL3" size="256" summ="default" type="INT"/>
					<colinfo id="PGPCD" size="256" summ="default" type="INT"/>
					<colinfo id="PGPSK" size="256" summ="default" type="INT"/>
					<colinfo id="PGPSU" size="256" summ="default" type="INT"/>
					<colinfo id="PHOCD" size="256" summ="default" type="INT"/>
					<colinfo id="PHOSK" size="256" summ="default" type="INT"/>
					<colinfo id="PHOSU" size="256" summ="default" type="INT"/>
					<colinfo id="PEDCD" size="256" summ="default" type="INT"/>
					<colinfo id="PEDSK" size="256" summ="default" type="INT"/>
					<colinfo id="PEDSU" size="256" summ="default" type="INT"/>
					<colinfo id="PSICD" size="256" summ="default" type="INT"/>
					<colinfo id="PSISK" size="256" summ="default" type="INT"/>
					<colinfo id="PSISU" size="256" summ="default" type="INT"/>
					<colinfo id="CSHSK" size="256" summ="default" type="INT"/>
					<colinfo id="CSHSU" size="256" summ="default" type="INT"/>
					<colinfo id="JIGCD" size="256" summ="default" type="INT"/>
					<colinfo id="JIGBK" size="256" summ="default" type="INT"/>
					<colinfo id="JIKBU" size="256" summ="default" type="INT"/>
					<colinfo id="CJANK" size="256" summ="default" type="INT"/>
					<colinfo id="CJANU" size="256" summ="default" type="INT"/>
					<colinfo id="JIROU" size="256" summ="default" type="INT"/>
					<colinfo id="PBTSK" size="256" summ="default" type="INT"/>
					<colinfo id="PBTSU" size="256" summ="default" type="INT"/>
					<colinfo id="AYSIK" size="256" summ="default" type="INT"/>
					<colinfo id="AYSIU" size="256" summ="default" type="INT"/>
					<colinfo id="AYSAK" size="256" summ="default" type="INT"/>
					<colinfo id="AYSAU" size="256" summ="default" type="INT"/>
					<colinfo id="BYSIK" size="256" summ="default" type="INT"/>
					<colinfo id="BYSIU" size="256" summ="default" type="INT"/>
					<colinfo id="BYSAK" size="256" summ="default" type="INT"/>
					<colinfo id="BYSAU" size="256" summ="default" type="INT"/>
					<colinfo id="KIBAK" size="256" summ="default" type="INT"/>
					<colinfo id="KIBAU" size="256" summ="default" type="INT"/>
					<colinfo id="KIBBK" size="256" summ="default" type="INT"/>
					<colinfo id="KIBBU" size="256" summ="default" type="INT"/>
					<colinfo id="KIBCK" size="256" summ="default" type="INT"/>
					<colinfo id="KIBCU" size="256" summ="default" type="INT"/>
					<colinfo id="KIBDK" size="256" summ="default" type="INT"/>
					<colinfo id="KIBDU" size="256" summ="default" type="INT"/>
					<colinfo id="EFL1K" size="256" summ="default" type="INT"/>
					<colinfo id="EFL1U" size="256" summ="default" type="INT"/>
					<colinfo id="EFL2K" size="256" summ="default" type="INT"/>
					<colinfo id="EFL2U" size="256" summ="default" type="INT"/>
					<colinfo id="EFL3K" size="256" summ="default" type="INT"/>
					<colinfo id="EFL3U" size="256" summ="default" type="INT"/>
					<colinfo id="CYSIK" size="256" summ="default" type="INT"/>
					<colinfo id="CYSIU" size="256" summ="default" type="INT"/>
					<colinfo id="CYSAK" size="256" summ="default" type="INT"/>
					<colinfo id="CYSAU" size="256" summ="default" type="INT"/>
					<colinfo id="DYSIK" size="256" summ="default" type="INT"/>
					<colinfo id="DYSIU" size="256" summ="default" type="INT"/>
					<colinfo id="DYSAK" size="256" summ="default" type="INT"/>
					<colinfo id="DYSAU" size="256" summ="default" type="INT"/>
					<colinfo id="EYSIK" size="256" summ="default" type="INT"/>
					<colinfo id="EYSIU" size="256" summ="default" type="INT"/>
					<colinfo id="EYSAK" size="256" summ="default" type="INT"/>
					<colinfo id="EYSAU" size="256" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAYZ011_HAY041PF" OnColumnChanged="ds_HAYZ011_HAY041PF_OnColumnChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="SABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BNKCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BNKNM" size="256" summ="default" type="STRING"/>
					<colinfo id="GJBNB" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYYN" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYTT" size="256" summ="default" type="INT"/>
					<colinfo id="PAYTM" size="256" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HMD020PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_PCODE">
				<Contents>
					<colinfo id="PCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="PCONT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HAYZ011_CHECK"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_CD">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>11</cd>
						<cdnm>근로자퇴직급여보장법에&#32;따른&#32;퇴직연금</cdnm>
					</record>
					<record>
						<cd>21</cd>
						<cdnm>개인연금</cdnm>
					</record>
					<record>
						<cd>22</cd>
						<cdnm>연금저축</cdnm>
					</record>
					<record>
						<cd>31</cd>
						<cdnm>청약저축</cdnm>
					</record>
					<record>
						<cd>32</cd>
						<cdnm>주택청약종합저축</cdnm>
					</record>
					<record>
						<cd>34</cd>
						<cdnm>근로자주택마련저축</cdnm>
					</record>
					<record>
						<cd>51</cd>
						<cdnm>장기집합투자증권저축</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BANK">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>315</cd>
						<cdnm>경남은행</cdnm>
					</record>
					<record>
						<cd>516</cd>
						<cdnm>골든브릿지투자증권</cdnm>
					</record>
					<record>
						<cd>150</cd>
						<cdnm>사단법인과학기술인공제회</cdnm>
					</record>
					<record>
						<cd>311</cd>
						<cdnm>광주은행</cdnm>
					</record>
					<record>
						<cd>402</cd>
						<cdnm>교보생명보험</cdnm>
					</record>
					<record>
						<cd>509</cd>
						<cdnm>교보증권</cdnm>
					</record>
					<record>
						<cd>306</cd>
						<cdnm>국민은행</cdnm>
					</record>
					<record>
						<cd>419</cd>
						<cdnm>그린손해보험</cdnm>
					</record>
					<record>
						<cd>701</cd>
						<cdnm>근로복지공단</cdnm>
					</record>
					<record>
						<cd>171</cd>
						<cdnm>노무라금융투자</cdnm>
					</record>
					<record>
						<cd>432</cd>
						<cdnm>농협손해보험</cdnm>
					</record>
					<record>
						<cd>190</cd>
						<cdnm>농협중앙회및산하기관</cdnm>
					</record>
					<record>
						<cd>410</cd>
						<cdnm>뉴욕생명보험</cdnm>
					</record>
					<record>
						<cd>537</cd>
						<cdnm>다이와증권캐피탈마켓</cdnm>
					</record>
					<record>
						<cd>313</cd>
						<cdnm>대구은행</cdnm>
					</record>
					<record>
						<cd>514</cd>
						<cdnm>대신증권</cdnm>
					</record>
					<record>
						<cd>511</cd>
						<cdnm>대우증권</cdnm>
					</record>
					<record>
						<cd>409</cd>
						<cdnm>대한생명보험</cdnm>
					</record>
					<record>
						<cd>438</cd>
						<cdnm>더케이손해보험</cdnm>
					</record>
					<record>
						<cd>412</cd>
						<cdnm>동부생명보험</cdnm>
					</record>
					<record>
						<cd>527</cd>
						<cdnm>동부증권</cdnm>
					</record>
					<record>
						<cd>427</cd>
						<cdnm>동부화재해상보험</cdnm>
					</record>
					<record>
						<cd>413</cd>
						<cdnm>동양생명보험</cdnm>
					</record>
					<record>
						<cd>601</cd>
						<cdnm>동양종합금융증권</cdnm>
					</record>
					<record>
						<cd>407</cd>
						<cdnm>라이나생명보험</cdnm>
					</record>
					<record>
						<cd>436</cd>
						<cdnm>라이프플래닛생명보험</cdnm>
					</record>
					<record>
						<cd>420</cd>
						<cdnm>롯데손해보험</cdnm>
					</record>
					<record>
						<cd>531</cd>
						<cdnm>리딩투자증권</cdnm>
					</record>
					<record>
						<cd>535</cd>
						<cdnm>메리린치증권</cdnm>
					</record>
					<record>
						<cd>519</cd>
						<cdnm>메리츠종합금융증권</cdnm>
					</record>
					<record>
						<cd>426</cd>
						<cdnm>메리츠화재해상보험</cdnm>
					</record>
					<record>
						<cd>411</cd>
						<cdnm>메트라이프생명보험</cdnm>
					</record>
					<record>
						<cd>416</cd>
						<cdnm>미래에셋생명보험</cdnm>
					</record>
					<record>
						<cd>501</cd>
						<cdnm>미래에셋증권</cdnm>
					</record>
					<record>
						<cd>532</cd>
						<cdnm>바로투자증권</cdnm>
					</record>
					<record>
						<cd>513</cd>
						<cdnm>부국증권</cdnm>
					</record>
					<record>
						<cd>314</cd>
						<cdnm>부산은행</cdnm>
					</record>
					<record>
						<cd>539</cd>
						<cdnm>비엔지증권</cdnm>
					</record>
					<record>
						<cd>541</cd>
						<cdnm>비엔피파리바증권</cdnm>
					</record>
					<record>
						<cd>230</cd>
						<cdnm>산림조합</cdnm>
					</record>
					<record>
						<cd>405</cd>
						<cdnm>삼성생명보험</cdnm>
					</record>
					<record>
						<cd>529</cd>
						<cdnm>삼성증권</cdnm>
					</record>
					<record>
						<cd>428</cd>
						<cdnm>삼성화재해상보험</cdnm>
					</record>
					<record>
						<cd>250</cd>
						<cdnm>상호저축은행</cdnm>
					</record>
					<record>
						<cd>110</cd>
						<cdnm>새마을금고</cdnm>
					</record>
					<record>
						<cd>525</cd>
						<cdnm>솔로몬투자증권</cdnm>
					</record>
					<record>
						<cd>210</cd>
						<cdnm>수산업협동조합중앙회및산하기관</cdnm>
					</record>
					<record>
						<cd>515</cd>
						<cdnm>신영증권</cdnm>
					</record>
					<record>
						<cd>130</cd>
						<cdnm>신용협동조합</cdnm>
					</record>
					<record>
						<cd>170</cd>
						<cdnm>신한금융투자</cdnm>
					</record>
					<record>
						<cd>406</cd>
						<cdnm>신한생명보험</cdnm>
					</record>
					<record>
						<cd>308</cd>
						<cdnm>신한은행</cdnm>
					</record>
					<record>
						<cd>423</cd>
						<cdnm>아메리카인터내셔날어슈어런스캄파니</cdnm>
					</record>
					<record>
						<cd>430</cd>
						<cdnm>아이비케이연금보험</cdnm>
					</record>
					<record>
						<cd>505</cd>
						<cdnm>아이비케이투자증권</cdnm>
					</record>
					<record>
						<cd>403</cd>
						<cdnm>아이엔지생명보험</cdnm>
					</record>
					<record>
						<cd>415</cd>
						<cdnm>알리안츠생명보험</cdnm>
					</record>
					<record>
						<cd>507</cd>
						<cdnm>애플투자증권</cdnm>
					</record>
					<record>
						<cd>451</cd>
						<cdnm>에셋플러스자산운용</cdnm>
					</record>
					<record>
						<cd>536</cd>
						<cdnm>에스지증권</cdnm>
					</record>
					<record>
						<cd>524</cd>
						<cdnm>에스케이증권</cdnm>
					</record>
					<record>
						<cd>437</cd>
						<cdnm>에이스아메리칸화재해상보험</cdnm>
					</record>
					<record>
						<cd>522</cd>
						<cdnm>에이치엠씨투자증권</cdnm>
					</record>
					<record>
						<cd>528</cd>
						<cdnm>엔에이치투자증권</cdnm>
					</record>
					<record>
						<cd>422</cd>
						<cdnm>엘아이지손해보험</cdnm>
					</record>
					<record>
						<cd>506</cd>
						<cdnm>엘아이지투자증권</cdnm>
					</record>
					<record>
						<cd>418</cd>
						<cdnm>우리아비바생명보험</cdnm>
					</record>
					<record>
						<cd>304</cd>
						<cdnm>우리은행</cdnm>
					</record>
					<record>
						<cd>508</cd>
						<cdnm>우리투자증권</cdnm>
					</record>
					<record>
						<cd>350</cd>
						<cdnm>우정사업본부</cdnm>
					</record>
					<record>
						<cd>521</cd>
						<cdnm>유진투자증권</cdnm>
					</record>
					<record>
						<cd>502</cd>
						<cdnm>이트레이드증권</cdnm>
					</record>
					<record>
						<cd>270</cd>
						<cdnm>자산운용금융회사</cdnm>
					</record>
					<record>
						<cd>312</cd>
						<cdnm>전북은행</cdnm>
					</record>
					<record>
						<cd>425</cd>
						<cdnm>제일화재해상보험</cdnm>
					</record>
					<record>
						<cd>316</cd>
						<cdnm>제주은행</cdnm>
					</record>
					<record>
						<cd>307</cd>
						<cdnm>중소기업은행</cdnm>
					</record>
					<record>
						<cd>401</cd>
						<cdnm>케이비생명보험</cdnm>
					</record>
					<record>
						<cd>526</cd>
						<cdnm>케이비투자증권</cdnm>
					</record>
					<record>
						<cd>538</cd>
						<cdnm>코리아RB증권</cdnm>
					</record>
					<record>
						<cd>503</cd>
						<cdnm>키움증권</cdnm>
					</record>
					<record>
						<cd>504</cd>
						<cdnm>토러스투자증권</cdnm>
					</record>
					<record>
						<cd>435</cd>
						<cdnm>푸르덴셜생명보험</cdnm>
					</record>
					<record>
						<cd>414</cd>
						<cdnm>피씨에이생명보험</cdnm>
					</record>
					<record>
						<cd>512</cd>
						<cdnm>하나대투증권</cdnm>
					</record>
					<record>
						<cd>433</cd>
						<cdnm>하나생명보험</cdnm>
					</record>
					<record>
						<cd>305</cd>
						<cdnm>하나은행</cdnm>
					</record>
					<record>
						<cd>533</cd>
						<cdnm>하이투자증권</cdnm>
					</record>
					<record>
						<cd>301</cd>
						<cdnm>한국산업은행</cdnm>
					</record>
					<record>
						<cd>303</cd>
						<cdnm>한국스탠다드차타드제일은행</cdnm>
					</record>
					<record>
						<cd>302</cd>
						<cdnm>한국씨티은행</cdnm>
					</record>
					<record>
						<cd>309</cd>
						<cdnm>한국외환은행</cdnm>
					</record>
					<record>
						<cd>510</cd>
						<cdnm>한국투자증권</cdnm>
					</record>
					<record>
						<cd>530</cd>
						<cdnm>한맥투자증권</cdnm>
					</record>
					<record>
						<cd>517</cd>
						<cdnm>한양증권</cdnm>
					</record>
					<record>
						<cd>434</cd>
						<cdnm>한화생명보험</cdnm>
					</record>
					<record>
						<cd>421</cd>
						<cdnm>한화손해보험</cdnm>
					</record>
					<record>
						<cd>518</cd>
						<cdnm>한화증권</cdnm>
					</record>
					<record>
						<cd>523</cd>
						<cdnm>한화투자증권(푸르덴셜투자증권)</cdnm>
					</record>
					<record>
						<cd>408</cd>
						<cdnm>현대라이프생명보험(녹십자생명보험)</cdnm>
					</record>
					<record>
						<cd>520</cd>
						<cdnm>현대증권</cdnm>
					</record>
					<record>
						<cd>429</cd>
						<cdnm>현대해상화재보험</cdnm>
					</record>
					<record>
						<cd>317</cd>
						<cdnm>홍콩상하이은행(HSBC은행)</cdnm>
					</record>
					<record>
						<cd>404</cd>
						<cdnm>흥국생명보험</cdnm>
					</record>
					<record>
						<cd>540</cd>
						<cdnm>흥국증권</cdnm>
					</record>
					<record>
						<cd>424</cd>
						<cdnm>흥국화재해상보험</cdnm>
					</record>
					<record>
						<cd>543</cd>
						<cdnm>BOS증권</cdnm>
					</record>
					<record>
						<cd>544</cd>
						<cdnm>BS투자증권</cdnm>
					</record>
					<record>
						<cd>534</cd>
						<cdnm>JP모간증권</cdnm>
					</record>
					<record>
						<cd>417</cd>
						<cdnm>KDB생명보험(금호생명)</cdnm>
					</record>
					<record>
						<cd>545</cd>
						<cdnm>펀드온라인코리아</cdnm>
					</record>
					<record>
						<cd>542</cd>
						<cdnm>KTB투자증권</cdnm>
					</record>
					<record>
						<cd>431</cd>
						<cdnm>NH농협생명보험</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SMCCD">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>0</cd>
						<cdnm>해당없음</cdnm>
					</record>
					<record>
						<cd>1</cd>
						<cdnm>100%</cdnm>
					</record>
					<record>
						<cd>5</cd>
						<cdnm>50%</cdnm>
					</record>
					<record>
						<cd>7</cd>
						<cdnm>70%</cdnm>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="1" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="2" Top="8" Width="1032"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="4" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="3" Width="24"></File>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="33" Id="searchBar" TabOrder="3" Top="30" Width="1060"></Static>
		<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static1" Left="120" Style="static" TabOrder="4" Top="34" VAlign="Middle" Width="96"></Static>
		<Combo CodeColumn="code2" DataColumn="code_name" Height="19" Id="ComboBoxPlant" INDEX="0" InnerDataset="ds_ComCode_PLNT" Left="124" OnChanged="common_OnChanged" TabOrder="2" Top="37" Width="88"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static4" Left="4" TabOrder="6" Text="사&#32;&#32;&#32;업&#32;&#32;&#32;부" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static3" Left="648" TabOrder="7" Text="사&#32;번" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static2" Left="764" TabOrder="12" Top="34" VAlign="Middle" Width="280"></Static>
		<Edit CheckLength="Byte" Height="21" Id="ed_SABUN" Left="768" MaxLength="7" Number="TRUE" OnCharChanged="ed_SABUN_OnCharChanged" OnKillFocus="ed_SABUN_OnKillFocus" TabOrder="5" Top="37" UpperOnly="TRUE" UseIME="FALSE" Width="60"></Edit>
		<Image Cursor="HAND" Height="17" Id="imgCODE" ImageID="ic_search" Left="1024" OnClick="imgCODE_OnClick" Static="FALSE" TabOrder="6" Top="40" Width="15"></Image>
		<Button Height="25" Id="btnQuery" ImageID="btn2_search2" Left="671" OnClick="fn_Search" TabOrder="7" TabStop="FALSE" Text="조회" Top="11" Visible="FALSE" Width="75"></Button>
		<Button Height="26" Id="Button2" ImageID="btn2_add2" Left="754" OnClick="fn_Input" TabOrder="8" TabStop="FALSE" Text="추가" Top="11" Visible="FALSE" Width="75"></Button>
		<Button Height="27" Id="Button1" ImageID="sum_save" Left="835" OnClick="fn_Save" TabOrder="9" TabStop="FALSE" Text="Button2" Top="11" Visible="FALSE" Width="72"></Button>
		<Button Height="25" Id="Button0" ImageID="btn2_delete2" Left="910" OnClick="fn_Delete" TabOrder="10" TabStop="FALSE" Text="Button1" Top="11" Visible="FALSE" Width="75"></Button>
		<Static Height="14" Id="st_KORNM" Left="835" TabOrder="17" Top="39" Width="45"></Static>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static66" Left="834" TabOrder="18" Top="55" Width="45"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static16" Left="552" TabOrder="21" Top="34" VAlign="Middle" Width="88"></Static>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Dateformat="yyyy-MM" FocusIndex="0" Height="18" Id="cmb_PTJYM" Left="557" LeftMargin="10" OnChanged="common_OnChanged" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="4" Top="38" Value="TODAY" Width="80"></Calendar>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static13" Left="436" TabOrder="20" Text="정&#32;산&#32;년&#32;월" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static0" Left="340" Style="static" TabOrder="22" Top="34" VAlign="Middle" Width="88"></Static>
		<Combo CodeColumn="cd" DataColumn="cdnm" Height="19" Id="cmb_GUBUN" INDEX="0" InnerDataset="ds_GUBUN" Left="344" OnChanged="cmb_GUBUN_OnChanged" TabOrder="3" Top="37" Width="80"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static5" Left="224" TabOrder="24" Text="구&#32;분&#32;코&#32;드" Top="34" VAlign="Middle" Width="116"></Static>
		<Tab BKSelColor="SCROLLBAR" Border="Flat" BorderColor="APPWORKSPACE" Font="Default,10,Bold" Height="556" Id="MainGrid" MouseOverColor="cadetblue" PreLoad="TRUE" SelectFont="Default,10,Bold" TabOrder="11" Top="64" Width="1057">
			<Contents>
				<TabPage Height="532" Id="tab1" Left="2" scroll="true" TabOrder="1" Text="소득공제신고서" Top="22" Url="pshumlib::HAYZ011_TAB1.xml" Width="1053"></TabPage>
				<TabPage Height="532" Id="tab2" Left="2" TabOrder="2" Text="전근무지내역" Top="22" Url="pshumlib::HAYZ011_TAB2.xml" Width="1053"></TabPage>
				<TabPage Height="532" Id="tab3" Left="2" TabOrder="3" Text="연금저축&#32;공제(상세)" Top="22" Url="pshumlib::HAYZ011_TAB3.xml" Width="1053"></TabPage>
			</Contents>
		</Tab>
		<Static Height="14" Id="st_DPDPNM" Left="883" TabOrder="26" Top="39" Width="120"></Static>
		<Static Height="14" Id="st_CNDCD" Left="1005" TabOrder="27" Top="39" Width="15"></Static>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static6" Left="882" TabOrder="28" Top="55" Width="120"></Static>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static7" Left="1006" TabOrder="29" Top="55" Width="15"></Static>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : 제환복
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : HAYZ011.xml
 * ● PROGRAM DESCRIPTION  : 소득정산 변동자료등록
 * ● DATE WRITTEN         : 2015.01.05
 * ● DATE Revision        : 2015.05.13(재정산수정) 
 //주택저축장마, 주택마련저축 미사용
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
//var	Lib3 = "PSDIOLIB";    //인사급여 LIBRARY(PSEDBLIB           PSCDBLIB.PSHDBLIB.PSSDBLIB)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");
var btnFlag="";//조회,추가 버튼 flag


/*변경내역
* 2014 
*  1. BDYT1 추가 : 중소기업청년감면항목
*/
function on_LoadCompleted(obj){
	getTitle();
	getDesign();
	getComCode();	
	getPCODE();//관계코드
	gFcOnTopButtonColor("2.2"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
	ComboBoxPlant.SetFocus();
	MainGrid.UserData=MainGrid.Height;
	//ed_SABUN.value="120340";

}

function getComCode(){
	
	http.Sync 	= true;

	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		sArgument   += " CODE1=" + quote(company);		
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	ComboBoxPlant.Value=comps;
	ComboBoxPlant.Enable = false; 	
}

function getDesign(){
	//TAB 메뉴
	MainGrid.Top = G_ds_design.GetColumn(0,"Top");                //64
	MainGrid.Width = G_ds_design.GetColumn(0,"Width");            //1048
	MainGrid.UserData=MainGrid.Height;

	searchBar.Width = G_ds_design.GetColumn(0,"Width");           //1048
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	          //32
	//searchBar.Height = G_ds_design.GetColumn(0,"SBHeight");	      //29
}

/********************************************************************** 
 * 내용설명 : 관계코드 
 **********************************************************************/ 
function getPCODE(){
		

	var sKind		= "getPCODE";						
	var sMethodName = "service::pshumlib/selectPCODE.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_PCODE=ds_PCODE";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		//sArgument += " LIB1=" + quote(Lib1);
		//sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " PCODE=" + quote("FMCD%");	//PCODE
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;

}

/********************************************************************** 
 * 내용설명 : 화면 조회 
 **********************************************************************/ 
function getHAYZ011(){

	if(!validationChk()){
		return;
	}
	var p_PTJYM="";
	if(cmb_GUBUN.Value = 1){//연말정산인 경우
		p_PTJYM=substr(cmb_PTJYM.Value,0,4)+"13";
	}else{//중도정산인경우
		p_PTJYM =substr(cmb_PTJYM.Value,0,6);
	}
	var sKind		= "getHAYZ011";						
	var sMethodName = "service::pshumlib/selectHAYZ011.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_HAYZ011_HAY011PF=ds_HAYZ011_HAY011PF ds_HAYZ011_HAY021PF=ds_HAYZ011_HAY021PF ds_HAYZ011_HAY041PF=ds_HAYZ011_HAY041PF ds_HAYZ011_HAY061PF=ds_HAYZ011_HAY061PF ds_HAYZ011_HAY063PF=ds_HAYZ011_HAY063PF";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " SABUN=" + quote(ed_SABUN.Text);	//사번	
		sArgument += " PTJYM=" + quote(p_PTJYM);	//정산년월
		sArgument += " BTNFLAG=" + quote(btnFlag);	//버튼플래그
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync = false;

}

/********************************************************************** 
 * 내용설명 : 저장
 * 주요변수 : 
 * 			
 **********************************************************************/ 
 
 function setHAYZ011(){
 
	if(ds_HAYZ011_HAY011PF.rowcount>0){
		if(ds_HAYZ011_HAY021PF.rowcount<1){
			//alert("[알림]부양가족에 본인은 필수입력입니다.");	
			alert(setPopMessage("6501"));//[알림]부양가족에 본인은 필수입력입니다.
			setMessage("6501");
			return;
		}
	}

	var duVal=0;
	for(i=0; i<ds_HAYZ011_HAY021PF.rowcount; i++){
		if(ds_HAYZ011_HAY021PF.GetColumn(i,"RELCD")=="10"){
			duVal++;
		}
		if(duVal > 1){
			//alert("[알림]관계에서 '본인'인 코드가 2개이상으로 등록되었습니다.");
			alert(setPopMessage("6502"));  //[알림]관계에서 '본인'인 코드가 2개이상으로 등록되었습니다.
			setMessage("6502");	
			return;
		}	
	}
				
 	if(ds_HAYZ011_HAY021PF.GetRowType(ds_HAYZ011_HAY021PF.currow)=="update" ||ds_HAYZ011_HAY021PF.GetRowType(ds_HAYZ011_HAY021PF.currow)=="insert" ){
		if(!ds_HAYZ011_HAY021PF_CanRowPosChange()){
			return;
		}
	} 
	
	chk_HAY021();
	chk_HAY041();

	if(confirm("저장하시겠습니까? ") == false) return;
	
	var sKind		= "setHAYZ011";						
	var sMethodName = "service::pshumlib/saveHAYZ011.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "ds_HAYZ011_HAY011PF=ds_HAYZ011_HAY011PF:U ds_HAYZ011_HAY021PF=ds_HAYZ011_HAY021PF:U ds_HAYZ011_HAY041PF=ds_HAYZ011_HAY041PF:U";   				// 자료 저장 시 보낼 DataSet 명칭	 
	var sOutDataSet = "ds_HAYZ011_CHECK=ds_HAYZ011_CHECK";			// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync=false;

 }

/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){

	if (ds_HAYZ011_CHECK.GetRowCount() > 0){			
		for(var i=0;i<ds_HAYZ011_CHECK.GetRowCount();i++){		
			alert("메뉴명 : " +ds_HAYZ011_CHECK.GetColumn(i,"MENU") + " = " + ds_HAYZ011_CHECK.GetColumn(i,"RTMSG"));
		}
		//getHAYZ011();        //error항목이 존재시에는 재조회		
		return;
	}
	if(rtnCd<0){// tran 실패
		//alert("에러발생했다..내일해라.!");
		alert(setPopMessage("1002"));
	}else if(svcId=="getHAYZ011"){
		// 조회건수가 없을경우
		if((ds_HAYZ011_HAY011PF.rowcount <= 0)){
			//alert("조회된거 없다!");
			alert(setPopMessage("1003"));
		// 정상 조회
		} else {
			//alert("조회됐다.!");
			alert(setPopMessage("1004"));
		}
	}else if(svcId=="setHAYZ011"){
		//alert("정상적으로 처리됐다.!");
		alert(setPopMessage("1001"));
		//getHAYZ011();
	}
}

/********************************************************************** 
 * 내용설명 : validation 체크
 **********************************************************************/ 
function validationChk(){

	var result = true;
	ed_SABUN.BKColor="white";
	cmb_PTJYM.BKColor="white";

	if(cmb_PTJYM.Value == ""){
		cmb_PTJYM.BKColor="paleturquoise";
		//alert("[확인] 정산년월을 확인바랍니다.");	
		alert(setPopMessage("4036"));//[확인] 정산년월을 확인바랍니다.
		setMessage("4036");
		cmb_PTJYM.SetFocus();
		result = false;
	}
	else if(length(trim(st_KORNM.Text)) == 0){
		ed_SABUN.BKColor="paleturquoise";
		//alert("[알림]사번을 입력하세요.");	
		alert(setPopMessage("6120"));//[알림]사번을 입력하세요.
		setMessage("6120");
		ed_SABUN.SetFocus();
		result = false;
	}
	return result;
}

/********************************************************************** 
 * 내용설명 : 엑셀파일로 저장
 **********************************************************************/ 
function setExcel()
{


}

/********************************************************************** 
 * 내용설명 : Sort
 **********************************************************************/ 
function MainGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) lib_grid_SetGridSort(obj,nCell);
}

function common_OnChanged(obj,strText)
{
	ds_HAYZ011_HAY011PF.ClearData();
	ds_HAYZ011_HAY021PF.ClearData();
	ds_HAYZ011_HAY041PF.ClearData();
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	btnFlag="Search";
	getHAYZ011();	
}

function fn_Input()
{
	if(ds_HAYZ011_HAY011PF.rowcount=1){
		//alert("[알림] 메뉴에서 지원하지 않는 기능입니다.");
		alert(setPopMessage("9999"));//[알림] 메뉴에서 지원하지 않는 기능입니다.
		setMessage("9999");
		return;
	}
	if(ds_HAYZ011_HAY011PF.rowcount < 1){
		btnFlag="Input";
		getHAYZ011();
	}
	if(ds_HAYZ011_HAY011PF.rowcount < 1){
		ds_HAYZ011_HAY011PF.AddRow(); 
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SABUN",ed_SABUN.Text);//사번
		var p_PTJYM="";
		if(cmb_GUBUN.Value = 1){//연말정산인 경우
			p_PTJYM=substr(cmb_PTJYM.Value,0,4)+"13";
		}else{//중도정산인경우
			p_PTJYM =substr(cmb_PTJYM.Value,0,6);
		}
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PTJYM",p_PTJYM); //정산년월
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"CHGAD",ds_HMD020PF.GetColumn(0,"CUADR"));//현주소
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PEDTA",ds_HMD020PF.GetColumn(0,"PEDTA"));//우편번호(HAY011PF에 필드없음. 보여주기만함.
		//ed_PEDTA.Value=ds_HMD020PF.GetColumn(0,"PEDTA");//우편번호(HAY011PF에 필드없음. 보여주기만함.

		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"FORTY",0); //외국인단일세율
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"IJJWN",0); //이주지원금
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"ERILM",0); //임원퇴직소득한도
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KRWTX",0); //국내근로과세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"FCWTX",0); //국외근로과세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"TX1AD",0); //추가갑근세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"TX3AD",0); //추가주민세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"BDMTR",0); //출산／보육
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"FCWTF",0); //국외근로비과세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"BDYT1",0); //비과소득１(2014년추가 : 중기기업청년감면)
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"BDYT2",0); //비과소득２
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"WFBCD",0); //배우자
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"CHBCD",0); //２０이하
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PTBCD",0); //５５이상
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KYBCA",0); //경로우대60
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KYBCB",0); //경로우대75
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"TRBCD",0); //장애자
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"BUBCD",0); //부녀세대주
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SPFCD",0); //한부모
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SOSCD",0); //소수공제
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"CBUCD",0); //자녀양육비
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"BYFL1",0); //부양공백１
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"BYFL2",0); //다자녀추가(공제 삭제 :2014년부터)
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"POFL1",0); //출산／입양(공제 삭제 :2014년부터)
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"POFL2",0); //추가공제２
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PGPPC",0); //보험료
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PGPRC",0); //장애자보험
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PHOSA",0); //의료비Ａ
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PHOSB",0); //의료비Ｂ
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PEDUA",0); //본인교육비
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PEDUB",0); //직계교육비
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHOU",0); //주택자금(미사용함)
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNMOU",0); //주택저축(미사용함)
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU1",0); //주택임차기관
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHUA",0); //주택임차거주
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHUM",0); //월세액
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU2",0); //주택자금１０
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU3",0); //주택자금１５
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU4",0); //주택자금３０
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU5",0); //주택예비１
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU6",0); //주택자금고정
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU7",0); //주택자금기타
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU8",0); //주택예비３
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU9",0); //주택예비２
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"WDISA",0); //혼인이사외
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBMA",0); //법정기부금
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBMB",0); //지정기부금
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBMC",0); //특례기부금
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBMD",0); //종교기부금
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBME",0); //기부금예비
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBOA",0); //이월기부법정
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBOB",0); //이월기부지정
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBOC",0); //이월기부특례
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBOD",0); //이월기부종료
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBOE",0); //이월기부예비
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SOFL1",0); //상품반지대
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SOFL2",0); //특별공제２
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"YUNG1",0); //연금저축１
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"YUNG2",0); //연금저축２
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"JUNTJ",0); //중기투자
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SINYN",0); //신용카드
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"CASHN",0); //현금영수증
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"JIGBN",0); //직불카드
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"CJANG",0); //전통시장
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"JIRON",0); //학원지로
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PBTSN",0); //대중교통
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"AYSNI",0); //본인신용등(14년도 추가)
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"AYSYA",0); //하반기본인신용제외(14년도 추가) -> 본인신용제외
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"BYSYI",0); //13본인신용(14년도 추가) -> 전년도본인신용
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"BYSYA",0); //13본인신용제외(14년도 추가) -> 전년도본인신용제외
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"HUSA1",0); //주택저축청약
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"HUSA2",0); //주택저축장마
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"HUSA3",0); //주택저축종합
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"HUSA4",0); //주택저축근로
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KITA1",0); //신용의료비
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KITA2",0); //주택마련저축
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KITA3",0); //퇴직연금저축
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KITA4",0); //기타공백４
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KITA5",0); //기타공백５
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"TJMON",0); //재형저축
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"THMON",0); //주택자금
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"TGMON",0); //주식저축
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"JENGN",0); //증권저축
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBUA",0); //기부정치자
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"LGSTK",0); //장기집합증권(14년도 추가)
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"TOBM1",0); //외국납부공
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"TOBM2",0); //세공공백２
		//ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RPNM1",""); //근무지명
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RNOA1",0); //등록번호１
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RNOB1",0); //등록번호２
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RNOC1",0); //등록번호３
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RDTS1",0); //전１입사일S
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RDTE1",0); //전１퇴사일E
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RPAT1",0); //급여총액
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RBAT1",0); //상여총액
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RGB11",0); //전１공백１
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RT1X1",0); //소득세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RT1X2",0); //방위세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RT1X3",0); //주민세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RG1P1",0); //의료보험료
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RG1P2",0); //고용보험료
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RG1P3",0); //국민연금료
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RG1P4",0); //노조비
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RGB12",0); //비과세
		//ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RPNM2",""); //근무지명
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RNOA2",0); //등록번호１
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RNOB2",0); //등록번호２
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RNOC2",0); //등록번호３
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RDTS2",0); //전１입사일S
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RDTE2",0); //전１퇴사일E
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RPAT2",0); //급여총액
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RBAT2",0); //상여총액
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RGB21",0); //전２공백１
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RT2X1",0); //소득세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RT2X2",0); //방위세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RT2X3",0); //주민세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RG2P1",0); //의료보험료
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RG2P2",0); //고용보험료
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RG2P3",0); //국민연금료
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RG2P4",0); //노조비
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"RGB22",0); //비과세
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SIDAT",0); //입력일자
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SSDAT",0); //처리일자
		//15년도추가
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"CYSYI",0); //전년도-1 본인신용
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"CYSYA",0); //전년도-1 본인신용제외
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"DYSYI",0); //상반기본인신용
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"DYSYA",0); //상반기본인신용제외
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"EYSYI",0); //하반기본인신용
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"EYSYA",0); //하반기본인신용제외
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU10",0); //15년 주택자금10 고정
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU11",0); //15년 주택자금15 고정 AND 비거치
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU12",0); //15년 주택자금15 고정 OR 비거치
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"PNHU13",0); //15년 주택자금15 기타
		
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBPA",0); //이월세액기부법정
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBPB",0); //이월세액기부지정
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBPC",0); //이월세액기부특례
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBPD",0); //이월세액기부종교
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"KIBPE",0); //이월세액기부예비
		//16년도추가
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SNDCD",2); //외국법인소속 파견근로자여부(1또는2)
		ds_HAYZ011_HAY011PF.SetColumn(ds_HAYZ011_HAY011PF.currow,"SMCCD",0); //중소기업감면코드(1:100, 5:50, 7:70)

	}
}

function fn_Delete()
{
	if(ds_HAYZ011_HAY011PF.rowcount < 1) return;			//삭제가 없으면 건너뛰기	
	ds_HAYZ011_HAY011PF.DeleteAll();
	ds_HAYZ011_HAY021PF.DeleteAll();
	ds_HAYZ011_HAY041PF.DeleteAll();		
	alert(setPopMessage("1011"));	
	setPopMessage("1011");
}

function fn_Save()
{
	setHAYZ011();
}

function fn_print()
{
	alert("fn_print");
}

function fn_Excel()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("2.2"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}

/********************************************************************** 
 * 내용설명 : 사용자 조회 
 **********************************************************************/ 
function imgCODE_OnClick(obj,nX,nY)
{
	var sTemp="zzzzzzzzzz";
	var selectnumber = "H6";
	var PAYCD = 3; //1이면 기능직 2이면 직반장 3이면 전체
	var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" +  sTemp + " " + "PAYCD=" + PAYCD,584,528);
	if (length(rtn) != 0){
		ed_SABUN.Text=rtn[0];
		st_KORNM.Text=rtn[1];
	}	
}

function ed_SABUN_OnKillFocus(obj)
{
	if(length(trim(obj.Text)) < 1) return;
	http.usewaitcursor = false;
	http.Sync 	= true;
	var sKind		= "getHMD020PF";		
	var sMethodName = "service::pscomlib/selectINSAMasterPopup2.do"; //연말정산용
	var sInDataSet  = "";
	var sOutDataSet = "ds_HMD020PF=ds_Select";
	var sArgument   = "";
		sArgument  += " LIB2=" + quote(Lib2);
		sArgument  += " LIB3=" + quote(Lib3);
		sArgument  += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument  += " SABUN=" + quote(ed_SABUN.Text);//사번
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
	if (ds_HMD020PF.GetRowCount() < 1){
		alert(setPopMessage("4062")); //[확인] 사용자가 존재하지 않습니다.
		setMessage("4062");
		st_KORNM.Text = "";
		ed_SABUN.SetFocus();
		return;
	}
	st_KORNM.Text = ds_HMD020PF.GetColumn(0,"A2");	//이름
	st_DPDPNM.Text = ds_HMD020PF.GetColumn(0,"A3");	//부서명
	st_CNDCD.Text = ds_HMD020PF.GetColumn(0,"CNDCD");	//변동코드
	http.usewaitcursor = true;	
}

function ed_SABUN_OnCharChanged(obj,strPreText,strPostText)
{
	st_KORNM.Text ="";
	st_DPDPNM.Text ="";
	st_CNDCD.Text ="";
	ds_HAYZ011_HAY011PF.ClearData();
	ds_HAYZ011_HAY021PF.ClearData();
	ds_HAYZ011_HAY041PF.ClearData();
}

//구분코드변경
function cmb_GUBUN_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_HAYZ011_HAY011PF.ClearData();
	ds_HAYZ011_HAY021PF.ClearData();
	ds_HAYZ011_HAY041PF.ClearData();
	
	if(cmb_GUBUN.Value = 1){//연말정산 클릭시 년월설정(전년도12월)
		cmb_PTJYM.Enable=false;
		/* //수정2015.05.13
		if(parseInt(substr(today(),4,2)) < 4){
			//alert(parseInt(substr(today(),0,4))-1);
			cmb_PTJYM.Value=parseInt(substr(today(),0,4))-1+"1231";//수정2015.05.13
		}
		*/
		if(parseInt(substr(cmb_PTJYM.Value,4,2)) < 4){
			//alert(parseInt(substr(today(),0,4))-1);
			cmb_PTJYM.Value=parseInt(substr(cmb_PTJYM.Value,0,4))-1+"1231";
		}else{
			cmb_PTJYM.Value=substr(cmb_PTJYM.Value,0,4)+"1231";
		}
	}else{
		cmb_PTJYM.Enable=true;
	}
}
//Sub 추가버튼
function btn_add_OnClick(obj)
{
	//if(checkInsertCount("ds_HAYZ011_HAY021PF")== false) return;
	//if(ds_HAYZ011_HAY021PF.rowcount < 1) fn_Search(); 
	if(ds_HAYZ011_HAY011PF.rowcount < 1) return;
	if(MainGrid.TabIndex=0){//부양가족 Row추가
		ds_HAYZ011_HAY021PF.AddRow();
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"SABUN",ed_SABUN.Text);//사번
		
		if(ds_HAYZ011_HAY021PF.rowcount==1){
			ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"RELCD","10"); //사내관계코드
		}else{
			ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"RELCD","00"); //사내관계코드
		}
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"RELNO",0); //정산관계코드
		//ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"RELNM",0); //부양자성명
		//ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KORNO",0); //주민등록번호
		//ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KOCHK",0); //주민등록체크
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"LIVCD","Y"); //동거여부
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBCD",1); //기본
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KYANO",0); //경로우대60
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KYBNO",0); //경로우대70
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"TRBNO",0); //장애인
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BUBNO",0); //부녀세대주
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"SPFCD",0); //한부모
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CBUNO",0); //자녀양육
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BTPNO",0); //출생，입양
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYFL1",0); //공제예비１
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYFL2",0); //공제예비２
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYFL3",0); //공제예비３
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PGPCD",0); //보험료여부
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PGPSK",0); //보험료금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PGPSU",0); //보험료금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PHOCD",0); //의료비여부
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PHOSK",0); //의료비금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PHOSU",0); //의료비금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PEDCD",0); //교육비여부
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PEDSK",0); //교육비금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PEDSU",0); //교육비금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PSICD",0); //카드여부
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PSISK",0); //카드금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PSISU",0); //카드금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CSHSK",0); //현금금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CSHSU",0); //현금금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"JIGCD",0); //직불여부
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"JIGBK",0); //직불금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"JIKBU",0); //직불금액
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CJANK",0); //전통시장
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CJANU",0); //전통시장
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"JIROU",0); //학원지로
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PBTSK",0); //대중교통
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PBTSU",0); //대중교통
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"AYSIK",0); //본인신용등(국) - 14년도추가
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"AYSIU",0); //본인신용등(외) - 14년도추가
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"AYSAK",0); //하반기본인신용제외(국) - 14년도추가 -> 본인신용제외(국) 
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"AYSAU",0); //하반기본인신용제외(외) - 14년도추가 -> 본인신용제외(외)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BYSIK",0); //13본인신용(국) - 14년도추가 -> 전년도본인신용(국)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BYSIU",0); //13본인신용(외) - 14년도추가 -> 전년도본인신용(외)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BYSAK",0); //13본인신용제외(국) - 14년도추가 -> 전년도본인신용제외(국)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BYSAU",0); //13본인신용제외(외) - 14년도추가 -> 전년도본인신용제외(외)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBAK",0); //기부금법정
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBAU",0); //기부금법정
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBBK",0); //기부금지정
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBBU",0); //기부금지정
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBCK",0); //기부금특례
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBCU",0); //기부금특례
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBDK",0); //기부금종교
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"KIBDU",0); //기부금종교
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EFL1K",0); //소득공제１
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EFL1U",0); //소득공제１
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EFL2K",0); //소득공제２
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EFL2U",0); //소득공제２
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EFL3K",0); //소득공제３
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EFL3U",0); //소득공제３
		//15년도 추가
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYSIK",0); //전년도-1 본인신용(국)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYSIU",0); //전년도-1 본인신용(외) 
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYSAK",0); //전년도-1 본인신용제외(국)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYSAU",0); //전년도-1 본인신용제외(외)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"DYSIK",0); //상반기본인신용(국)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"DYSIU",0); //상반기본인신용(외) 
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"DYSAK",0); //상반기본인신용제외(국)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"DYSAU",0); //상반기본인신용제외(외) 
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EYSIK",0); //하반기본인신용(국)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EYSIU",0); //하반기본인신용(외) 
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EYSAK",0); //하반기본인신용제외(국)
		ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EYSAU",0); //하반기본인신용제외(외) 

	}
	else if(MainGrid.TabIndex=2){//연금저축  Row추가
		ds_HAYZ011_HAY041PF.AddRow();
		ds_HAYZ011_HAY041PF.SetColumn(ds_HAYZ011_HAY041PF.currow,"SABUN",ed_SABUN.Text); //사번
		ds_HAYZ011_HAY041PF.SetColumn(ds_HAYZ011_HAY041PF.currow,"INCCD",0); //소득공제구분
		ds_HAYZ011_HAY041PF.SetColumn(ds_HAYZ011_HAY041PF.currow,"PAYTT",0); //불입금액
		ds_HAYZ011_HAY041PF.SetColumn(ds_HAYZ011_HAY041PF.currow,"PAYTM",0); //납입급액
	}
}
//Sub 삭제버튼
function btn_delete_OnClick(obj)
{
	if(MainGrid.TabIndex=0){//부양가족 Row삭제
		if(ds_HAYZ011_HAY021PF.rowcount < 1) return;			//삭제가 없으면 건너뛰기		
		ds_HAYZ011_HAY021PF.DeleteRow(ds_HAYZ011_HAY021PF.currow);	//삭제		
		alert(setPopMessage("1011"));	
		setPopMessage("1011");
	}
	else if(MainGrid.TabIndex=2){//연금저축  Row삭제
		if(ds_HAYZ011_HAY041PF.rowcount < 1) return;			//삭제가 없으면 건너뛰기		
		ds_HAYZ011_HAY041PF.DeleteRow(ds_HAYZ011_HAY041PF.currow);	//삭제		
		alert(setPopMessage("1011"));	
		setPopMessage("1011");
	}
}

/********************************************************************** 
 * 내용설명 : Default Value Settin
 * type이 int형이고 null값이면 0으로 초기화해줌.
 **********************************************************************/ 
//소득공제신고서
function ds_HAYZ011_HAY011PF_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	http.usewaitcursor = false;
	//type이 int형이고 null값이면 0으로 초기화해줌.
	if(length(trim(varNewValue))=0){
		if(ds_HAYZ011_HAY011PF.GetColType(strColumnID)=="INT"){
			ds_HAYZ011_HAY011PF.SetColumn(nRow,strColumnID,0);
			//alert(strColumnID);
		}
	}
	http.usewaitcursor = true;
}
//부양가족
function ds_HAYZ011_HAY021PF_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	http.usewaitcursor = false;
	//type이 int형이고 null값이면 0으로 초기화해줌.
	if(length(trim(varNewValue))=0){
		if(ds_HAYZ011_HAY021PF.GetColType(strColumnID)=="INT"){
			ds_HAYZ011_HAY021PF.SetColumn(nRow,strColumnID,0);
			//alert(strColumnID);
		}
	}
	http.usewaitcursor = true;
}
//연금저축
function ds_HAYZ011_HAY041PF_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	http.usewaitcursor = false;
	//type이 int형이고 null값이면 0으로 초기화해줌.
	if(length(trim(varNewValue))=0){
		if(ds_HAYZ011_HAY041PF.GetColType(strColumnID)=="INT"){
			ds_HAYZ011_HAY041PF.SetColumn(nRow,strColumnID,0);
		}
	}
	if(strColumnID == "BNKNM"){
		if(length(trim(varNewValue))!=0){
			ds_BANK.FindRow("cdnm", varNewValue);
			ds_HAYZ011_HAY041PF.SetColumn(nRow,"BNKCD",ds_BANK.GetColumn(ds_BANK.FindRow("cdnm", varNewValue),"cd"));
		}
	}
	http.usewaitcursor = true;
}
/********************************************************************** 
 * 내용설명 : validation check
 **********************************************************************/ 
 //부양가족
function ds_HAYZ011_HAY021PF_CanRowPosChange(obj,nOldRow,nRow)
{
	http.usewaitcursor = false;
	if(ds_HAYZ011_HAY021PF.GetRowType(ds_HAYZ011_HAY021PF.currow)=="update" ||ds_HAYZ011_HAY021PF.GetRowType(ds_HAYZ011_HAY021PF.currow)=="insert" ){
		//var p_RELNM=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "RELNM");//성명
		var p_KORNO=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "KORNO");//주민등록번호
		var p_KOCHK=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "KOCHK");//주민등록체크
		
		var p_PGPSK=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "PGPSK");//보험료(국)
		var p_PGPSU=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "PGPSU");//보험료(외)
		var p_PHOSK=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "PHOSK");//의료비(국)
		var p_PHOSU=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "PHOSU");//의료비(외)
		var p_PEDSK=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "PEDSK");//교육비(국)
		var p_PEDSU=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "PEDSU");//교육비(외)
		var p_PSISK=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "PSISK");//카드(국)
		var p_PSISU=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "PSISU");//카드(외)
		var p_CSHSK=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "CSHSK");//현금
		
		var p_RELCD=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "RELCD");//관계
		var p_SPFCD=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "SPFCD");//한부모
		var p_BUBNO=ds_HAYZ011_HAY021PF.GetColumn(ds_HAYZ011_HAY021PF.currow, "BUBNO");//부녀자
		
		//주민등록번호 체크
		if(length(trim(p_KORNO))!=0){
			if(length(p_KORNO)!=13){
				//alert("[알림]주민등록번호는 13자리입니다.");
				alert(setPopMessage("6503"));//[알림]주민등록번호는 13자리입니다.
				setMessage("6503");	
				return false; 
			}
			if((substr(p_KORNO,2,2) < "01" || substr(p_KORNO,2,2)  > "12") || (substr(p_KORNO,4,2) < "01" || substr(p_KORNO,4,2)  > "31")){
				//alert("[알림]주민등록번호의 잘못된 (월,일) 입니다.");
				alert(setPopMessage("6504"));//[알림]주민등록번호의 잘못된 (월,일) 입니다.
				setMessage("6504");	
//alert(substr(p_KORNO,2,2)+"=="+substr(p_KORNO,4,2));
				return false; 
			}
			//주민등록번호확인(규칙)
			/*
      i = Val(Left(KorNo, 1)) * 2
      i = Val(Mid(KorNo, 2, 1)) * 3 + i
      i = Val(Mid(KorNo, 3, 1)) * 4 + i
      i = Val(Mid(KorNo, 4, 1)) * 5 + i
      i = Val(Mid(KorNo, 5, 1)) * 6 + i
      i = Val(Mid(KorNo, 6, 1)) * 7 + i
      i = Val(Mid(KorNo, 7, 1)) * 8 + i
      i = Val(Mid(KorNo, 8, 1)) * 9 + i
      i = Val(Mid(KorNo, 9, 1)) * 2 + i
      i = Val(Mid(KorNo, 10, 1)) * 3 + i
      i = Val(Mid(KorNo, 11, 1)) * 4 + i
      i = Val(Mid(KorNo, 12, 1)) * 5 + i
      j = Int(i / 11)
      k = 11 - (i Mod 11)

      If Mid(KorNo, 13, 1) <> Right(Trim(str(k)), 1) Then
         SS.Col = 0: SS.Text = "": ModifiedCount1 = ModifiedCount1 - 1
         MsgBox "잘못된 주민등록번호입니다!!" & Chr(13) & _
                "수정 또는 CHK에 0을 입력하세요!!!", 0 + 48, "알림"
         SS.Col = 4: SS.Text = "": SS.Action = 0: SS.EditMode = True: Exit Sub
      End If
			*/
			if(p_KOCHK !="0"){//주민번호체크가 안된경우만 동작
				var chk_P1=0;
				var chk_P2=0;
				//int chk_P1, chk_P2, chk_P3=0;
				for(i=0; i <length(p_KORNO)-1; i++){
					if(i <8 ){
						chk_P1+=parseInt(substr(p_KORNO,i,1))*(i+2);
					}else{
						chk_P1+=parseInt(substr(p_KORNO,i,1))*(i-6);
					}
				}
				chk_P2 = 11-(chk_P1 % 11);
				if(substr(p_KORNO,12,1) != right(chk_P2,1)){
					//alert("[알림]잘못된 주민등록번호입니다."+chk_P2);
					alert(setPopMessage("6505"));	//[알림]잘못된 주민등록번호입니다.
					setMessage("6505");	
					return false; 
				}
			}
			var duVal = 0; //중복확인
			for(i=0; i <ds_HAYZ011_HAY021PF.rowcount; i++){
				if(p_KORNO == ds_HAYZ011_HAY021PF.GetColumn(i,"KORNO")){
					duVal++;
				}
				if(duVal > 1){
					//alert("[알림]이미 입력된 주민등록번호입니다.");
					alert(setPopMessage("6506"));	//[알림]이미 입력된 주민등록번호입니다.
					setMessage("6506");	
					return false;
				}	
			}
		
			if(p_PGPSK+p_PGPSU !=0){//보험료여부
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PGPCD", 1);
			}else{
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PGPCD", 0);
			}
			if(p_PHOSK+p_PHOSU !=0){//의료비여부
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PHOCD", 1);
			}else{
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PHOCD", 0);
			}
			if(p_PEDSK+p_PEDSU !=0){//교육비여부
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PEDCD", 1);
			}else{
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PEDCD", 0);
			}
			if(p_PSISK+p_PSISU+p_CSHSK !=0){//카드여부
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PSICD", 1);
			}else{
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"PSICD", 0);
			}
			//본인이 아닌경우는 한부모 필드를 0으로초기화
			if(p_RELCD !="10"){
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"SPFCD", 0);//한부모 초기화
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"AYSIK",0); //본인신용등(국) - 14년도추가
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"AYSIU",0); //본인신용등(외) - 14년도추가
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"AYSAK",0); //하반기본인신용제외(국) - 14년도추가 ->본인신용제외(국) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"AYSAU",0); //하반기본인신용제외(외) - 14년도추가 ->본인신용제외(외) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BYSIK",0); //13본인신용(국) - 14년도추가 -> 전년도기본인신용(국) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BYSIU",0); //13본인신용(외) - 14년도추가 -> 전년도기본인신용(외) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BYSAK",0); //13본인신용제외(국) - 14년도추가 -> 전년도기본인신용제외(국) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BYSAU",0); //13본인신용제외(외) - 14년도추가 -> 전년도기본인신용제외(외) 
				//15년도 추가
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYSIK",0); //전년도-1 본인신용(국)
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYSIU",0); //전년도-1 본인신용(외) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYSAK",0); //전년도-1 본인신용제외(국)
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"CYSAU",0); //전년도-1 본인신용제외(외)
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"DYSIK",0); //상반기본인신용(국)
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"DYSIU",0); //상반기본인신용(외) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"DYSAK",0); //상반기본인신용제외(국)
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"DYSAU",0); //상반기본인신용제외(외) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EYSIK",0); //하반기본인신용(국)
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EYSIU",0); //하반기본인신용(외) 
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EYSAK",0); //하반기본인신용제외(국)
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"EYSAU",0); //하반기본인신용제외(외) 
			}
			//본인이며 부녀자와 한부모 모두 체크된경우 부녀자체크해제(한부모공제율이 큼)
			if(p_RELCD =="10" && p_SPFCD=1 && p_BUBNO){
				ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BUBNO", 0);
			}
			//2015년추가
			// 출생자동계산
			var p_BIRTHAGE="";
			if(p_RELCD!="10"){//본인외 부양가족공제 확인
				if(substr(p_KORNO,6,1)=="1" ||substr(p_KORNO,6,1)=="2"){
					p_BIRTHAGE="19"+substr(p_KORNO,0,2);
				}else{
					p_BIRTHAGE="20"+substr(p_KORNO,0,2);
				}
				if(p_BIRTHAGE==substr(cmb_PTJYM.Value,0,4)){
					ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BTPNO",1); //출생1
				}else{
					ds_HAYZ011_HAY021PF.SetColumn(ds_HAYZ011_HAY021PF.currow,"BTPNO",0); //출생0	
				}
			}
		}
	}
	return true;
	http.usewaitcursor = true;
}

//부양가족집계
function chk_HAY021 (){
	//주민등록번호가 없는 ROW삭제
	for(i=ds_HAYZ011_HAY021PF.rowcount; i>=0; i--){
		if(length(trim(ds_HAYZ011_HAY021PF.GetColumn(i,"KORNO")))==0){
			ds_HAYZ011_HAY021PF.DeleteRow(i);
		}
	}
	//보험료합계
	ds_HAYZ011_HAY011PF.SetColumn(0,"PGPPC",ds_HAYZ011_HAY021PF.Sum("PGPSK")+ds_HAYZ011_HAY021PF.Sum("PGPSU"));//일반보험료
	ds_HAYZ011_HAY011PF.SetColumn(0,"KIBMA",ds_HAYZ011_HAY021PF.Sum("KIBAK")+ds_HAYZ011_HAY021PF.Sum("KIBAU"));//법정기부
	ds_HAYZ011_HAY011PF.SetColumn(0,"KIBMB",ds_HAYZ011_HAY021PF.Sum("KIBBK")+ds_HAYZ011_HAY021PF.Sum("KIBBU"));//지정기부
	ds_HAYZ011_HAY011PF.SetColumn(0,"JIGBN",ds_HAYZ011_HAY021PF.Sum("JIGBK")+ds_HAYZ011_HAY021PF.Sum("JIKBU"));//직불카드
	ds_HAYZ011_HAY011PF.SetColumn(0,"JIRON",ds_HAYZ011_HAY021PF.Sum("JIROU"));//학원지로
	ds_HAYZ011_HAY011PF.SetColumn(0,"KIBMC",ds_HAYZ011_HAY021PF.Sum("KIBCK")+ds_HAYZ011_HAY021PF.Sum("KIBCU"));//특례기부금
	ds_HAYZ011_HAY011PF.SetColumn(0,"KIBMD",ds_HAYZ011_HAY021PF.Sum("KIBDK")+ds_HAYZ011_HAY021PF.Sum("KIBDU"));//종교단체기부금
	ds_HAYZ011_HAY011PF.SetColumn(0,"CJANG",ds_HAYZ011_HAY021PF.Sum("CJANK")+ds_HAYZ011_HAY021PF.Sum("CJANU"));//전통시장
	ds_HAYZ011_HAY011PF.SetColumn(0,"PBTSN",ds_HAYZ011_HAY021PF.Sum("PBTSK")+ds_HAYZ011_HAY021PF.Sum("PBTSU"));//대중교통
	
	ds_HAYZ011_HAY011PF.SetColumn(0,"SINYN",ds_HAYZ011_HAY021PF.Sum("PSISK")+ds_HAYZ011_HAY021PF.Sum("PSISU"));//신용카드
	ds_HAYZ011_HAY011PF.SetColumn(0,"CASHN",ds_HAYZ011_HAY021PF.Sum("CSHSK"));//현금영수증

	ds_HAYZ011_HAY011PF.SetColumn(0,"SPFCD",ds_HAYZ011_HAY021PF.Sum("SPFCD"));//한부모

	//14년도 연말정산 추가내역
	//==============
	ds_HAYZ011_HAY011PF.SetColumn(0,"AYSNI",ds_HAYZ011_HAY021PF.Sum("AYSIK")+ds_HAYZ011_HAY021PF.Sum("AYSIU"));//본인신용등
	ds_HAYZ011_HAY011PF.SetColumn(0,"AYSYA",ds_HAYZ011_HAY021PF.Sum("AYSAK")+ds_HAYZ011_HAY021PF.Sum("AYSAU"));//하반기본인신용제외
	ds_HAYZ011_HAY011PF.SetColumn(0,"BYSYI",ds_HAYZ011_HAY021PF.Sum("BYSIK")+ds_HAYZ011_HAY021PF.Sum("BYSIU"));//13본인신용
	ds_HAYZ011_HAY011PF.SetColumn(0,"BYSYA",ds_HAYZ011_HAY021PF.Sum("BYSAK")+ds_HAYZ011_HAY021PF.Sum("BYSAU"));//13본인신용제외
	//==============
	//15년도 추가내역
	ds_HAYZ011_HAY011PF.SetColumn(0,"CYSYI",ds_HAYZ011_HAY021PF.Sum("CYSIK")+ds_HAYZ011_HAY021PF.Sum("CYSIU"));//전년도-1 본인신용
	ds_HAYZ011_HAY011PF.SetColumn(0,"CYSYA",ds_HAYZ011_HAY021PF.Sum("CYSAK")+ds_HAYZ011_HAY021PF.Sum("CYSAU"));//전년도-1 본인신용제외
	ds_HAYZ011_HAY011PF.SetColumn(0,"DYSYI",ds_HAYZ011_HAY021PF.Sum("DYSIK")+ds_HAYZ011_HAY021PF.Sum("DYSIU"));//상반기본인신용
	ds_HAYZ011_HAY011PF.SetColumn(0,"DYSYA",ds_HAYZ011_HAY021PF.Sum("DYSAK")+ds_HAYZ011_HAY021PF.Sum("DYSAU"));//상반기본인신용제외
	ds_HAYZ011_HAY011PF.SetColumn(0,"EYSYI",ds_HAYZ011_HAY021PF.Sum("EYSIK")+ds_HAYZ011_HAY021PF.Sum("EYSIU"));//하반기본인신용
	ds_HAYZ011_HAY011PF.SetColumn(0,"EYSYA",ds_HAYZ011_HAY021PF.Sum("EYSAK")+ds_HAYZ011_HAY021PF.Sum("EYSAU"));//하반기본인신용제외

	
	
	var p_RELCD="", p_TRBNO=0, p_KYANO=0, p_KYBNO=0, p_KIBCD=0, p_KORNO="";//사내관계코드,장애인,경로우대60,경로우대70,기본,주민번호
	var p_BUBNO=0, p_CBUNO=0, p_BTPNO=0;//부녀자,자녀,출생/입양
	var p_AGE=0;//나이
	var p_BIRTHAGE=0;	//2015년추가 출생변수생성
	var p_PHOSB=0, p_PHOSA=0;//의료비(본인,경로,장애), 의료비(그외)
	var p_PEDUA=0, p_PEDUB=0;//교육비(본인), 교육비(그외)
	var p_WFBCD=0,p_CHBCD=0, p_PTBCD=0, p_KYBCA=0, p_KYBCB=0, p_TRBCD=0, p_BUBCD=0, p_SPFCD=0, p_CBUCD=0, p_BYFL2=0, p_POFL1=0;
	//배우자,20이하,55이상,경로우대60,경로우대75,장애자,부녀세대주,한부모,자녀양육,다자녀추가,출산/입양-> HAY011PF


	for(i=0; i<ds_HAYZ011_HAY021PF.rowcount; i++){
		p_RELCD =ds_HAYZ011_HAY021PF.GetColumn(i,"RELCD");//사내관계코드
		p_TRBNO =ds_HAYZ011_HAY021PF.GetColumn(i,"TRBNO");//장애인
		p_KYANO =ds_HAYZ011_HAY021PF.GetColumn(i,"KYANO");//경로우대60
		p_KYBNO =ds_HAYZ011_HAY021PF.GetColumn(i,"KYBNO");//경로우대70
		
		p_BUBNO =ds_HAYZ011_HAY021PF.GetColumn(i,"BUBNO");//부녀자
		p_CBUNO =ds_HAYZ011_HAY021PF.GetColumn(i,"CBUNO");//자녀
		p_BTPNO =ds_HAYZ011_HAY021PF.GetColumn(i,"BTPNO");//출생/입양(공제 삭제 :2014년부터)

		//정산관계코드처리
		/*
		if(p_RELCD=="10"){//본인
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",0);
		}else if(p_RELCD=="20"){//배우자
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",3);
		}else if(p_RELCD=="30" || p_RELCD=="31" || p_RELCD=="32"){//자녀-직계비속
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",4);
		}else if(p_RELCD=="40" || p_RELCD=="41" || p_RELCD=="60" || p_RELCD=="61" || p_RELCD=="70" || p_RELCD=="71"){//부,모,조부,조모-직계존속
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",1);
		}else if(p_RELCD=="46" || p_RELCD=="47" || p_RELCD=="62" || p_RELCD=="63"){//배우자부,모,조부,조모-배우자직계존속
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",2);
		}else if(p_RELCD=="50" || p_RELCD=="51" || p_RELCD=="52" || p_RELCD=="53"){//형,제,누나,여동생-형제자매
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",5);
		}else if(p_RELCD=="00" || p_RELCD=="42" || p_RELCD=="43" || p_RELCD=="44" || p_RELCD=="45"){//백,숙,부,모-기타
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",6);
		}*/
		//2014년 수정
		if(p_RELCD=="10"){//본인
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",0);
		}else if(p_RELCD=="20"){//배우자
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",3);
		}else if(p_RELCD=="30" || p_RELCD=="31" || p_RELCD=="32"){//자녀-직계비속
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",4);
		}else if(p_RELCD=="40" || p_RELCD=="41" || p_RELCD=="60" || p_RELCD=="61" || p_RELCD=="70" || p_RELCD=="71"){//부,모,조부,조모-직계존속
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",1);
		}else if(p_RELCD=="46" || p_RELCD=="47" || p_RELCD=="62" || p_RELCD=="63"){//배우자부,모,조부,조모-배우자직계존속
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",2);
		}else if(p_RELCD=="50" || p_RELCD=="51" || p_RELCD=="52" || p_RELCD=="53" || p_RELCD=="64" || p_RELCD=="65"){//형,제,누나,여동생-형제자매
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",6);
		}else if(p_RELCD=="00" || p_RELCD=="42" || p_RELCD=="43" || p_RELCD=="44" || p_RELCD=="45" || p_RELCD=="66" || p_RELCD=="67" || p_RELCD=="68" || p_RELCD=="69"){//백,숙,부,모-기타
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",7);
		}//추가(화성적용 외손주)
		else if(p_RELCD=="80" ){//외손주
			ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",5);
		}
		//추가
		//else if((p_RELCD=="20" || p_RELCD=="30" || p_RELCD=="31" || p_RELCD=="32") && p_TRBNO !=0){//직계비속(배우자포함)장애인 경우
		//	ds_HAYZ011_HAY021PF.SetColumn(i,"RELNO",5);
		//}
		
		//의료비처리
		if(p_RELCD=="10" || p_TRBNO !=0 || p_KYANO !=0 || p_KYBNO !=0){
			p_PHOSB+=ds_HAYZ011_HAY021PF.GetColumn(i,"PHOSK")+ds_HAYZ011_HAY021PF.GetColumn(i,"PHOSU");//의료비(본인,경로,장애)		
		}else{
			p_PHOSA+=ds_HAYZ011_HAY021PF.GetColumn(i,"PHOSK")+ds_HAYZ011_HAY021PF.GetColumn(i,"PHOSU");//의료비(그외)		
		}
		//교육비처리
		if(p_RELCD=="10"){
			p_PEDUA+=ds_HAYZ011_HAY021PF.GetColumn(i,"PEDSK")+ds_HAYZ011_HAY021PF.GetColumn(i,"PEDSU");//교육비(본인)		
		}else{
			p_PEDUB+=ds_HAYZ011_HAY021PF.GetColumn(i,"PEDSK")+ds_HAYZ011_HAY021PF.GetColumn(i,"PEDSU");//교육비(그외)		
		}
		//부양가족공제 확인
		p_KIBCD = ds_HAYZ011_HAY021PF.GetColumn(i,"KIBCD");//기본
		p_KORNO = ds_HAYZ011_HAY021PF.GetColumn(i,"KORNO");//주민번호
		if(p_RELCD!="10" && p_KIBCD !=0 ){//본인외 부양가족공제 확인
			if(substr(p_KORNO,6,1)=="1" ||substr(p_KORNO,6,1)=="2"){
				p_AGE = parseInt(substr(cmb_PTJYM.Value,0,4))-parseInt("19"+substr(p_KORNO,0,2));//2000년이전출생자
				p_BIRTHAGE="19"+substr(p_KORNO,0,2);
//alert(p_AGE+"이전");
			}else{
				p_AGE = parseInt(substr(cmb_PTJYM.Value,0,4))-parseInt("20"+substr(p_KORNO,0,2));//2000년이후출생자
				p_BIRTHAGE="20"+substr(p_KORNO,0,2);
//alert(p_AGE+"이후");//0005084925418
			}
			if(p_RELCD=="20"){//배우자
				p_WFBCD = 1;
			}else if(p_AGE <= 20){//20세이하
				p_CHBCD+=1;
				if(p_RELCD=="30" || p_RELCD=="31" || p_RELCD=="32"){//다자녀추가공제(공제 삭제 :2014년부터)
					p_BYFL2+=1;//다자녀수로 자녀세액공제함(2014년도)
				}
			}else if(p_AGE >= 60 || (p_AGE > 20 && p_TRBNO != 0)){//60세이상(기존 여 55세 이상 남 60세 이상 또는 장애자)
				p_PTBCD+=1;
			}
		}
		if(p_KYANO != 0){//경로1
			p_KYBCA+=1;
		}
		if(p_KYBNO != 0){//경로2
			p_KYBCB+=1;
		}
		if(p_TRBNO != 0){//장애자(코드1~3까지입력가능)
			p_TRBCD+=1;
		}
		if(p_BUBNO != 0){//부녀자
			p_BUBCD+=1;
		}
		//필요하나?
		if(p_CBUNO != 0){//자녀
			p_CBUCD+=1;
		}
		//(공제 삭제 :2014년부터)
		//재추가 : 2015.05.13 14년도 재정산부터
		/*
		if(p_BTPNO != 0){//출생/입양
			p_POFL1+=1;
		}
		*/
		//======2015년 수정
		if(p_BTPNO != 0){//출생/입양
			if(p_BIRTHAGE==substr(cmb_PTJYM.Value,0,4)){
				p_POFL1+=1;
			}
		}
	}
	ds_HAYZ011_HAY011PF.SetColumn(0,"PHOSB",p_PHOSB);//의료비(본인,경로,장애)	
	ds_HAYZ011_HAY011PF.SetColumn(0,"PHOSA",p_PHOSA);//의료비(그외)	
	ds_HAYZ011_HAY011PF.SetColumn(0,"PEDUA",p_PEDUA);//교육비(본인)
	ds_HAYZ011_HAY011PF.SetColumn(0,"PEDUB",p_PEDUB);//교육비(그외)	
	
	ds_HAYZ011_HAY011PF.SetColumn(0,"WFBCD",p_WFBCD);//배우자
	ds_HAYZ011_HAY011PF.SetColumn(0,"CHBCD",p_CHBCD);//20세이하
	ds_HAYZ011_HAY011PF.SetColumn(0,"BYFL2",p_BYFL2);//다자녀추가공제(공제 삭제 :2014년부터)
	ds_HAYZ011_HAY011PF.SetColumn(0,"PTBCD",p_PTBCD);//60세이상
	ds_HAYZ011_HAY011PF.SetColumn(0,"KYBCA",p_KYBCA);//경로1
	ds_HAYZ011_HAY011PF.SetColumn(0,"KYBCB",p_KYBCB);//경로2
	ds_HAYZ011_HAY011PF.SetColumn(0,"TRBCD",p_TRBCD);//장애자
	ds_HAYZ011_HAY011PF.SetColumn(0,"BUBCD",p_BUBCD);//부녀자
	ds_HAYZ011_HAY011PF.SetColumn(0,"CBUCD",p_CBUCD);//자녀
	//ds_HAYZ011_HAY011PF.SetColumn(0,"POFL1",p_POFL1);//출생/입양(공제 삭제 :2014년부터)
	ds_HAYZ011_HAY011PF.SetColumn(0,"POFL1",p_POFL1);//출생/입양(공제 추가 :2015년부터)

	//소수공제 로직제외(2015.01.09)

	
/*
	var p_RELCD="", p_TRBNO=0, p_KYANO=0, p_KYBNO=0;//사내관계코드, 장애인, 경로우대60, 경로우대70
	//의료비처리
	var p_PHOSB=0, p_PHOSA=0;//의료비(본인,경로,장애), 의료비(그외)
	for(i=0; i<ds_HAYZ011_HAY021PF.rowcount; i++){
		p_RELCD =ds_HAYZ011_HAY021PF.GetColumn(i,"RELCD");//사내관계코드
		p_TRBNO =ds_HAYZ011_HAY021PF.GetColumn(i,"TRBNO");//장애인
		p_KYANO =ds_HAYZ011_HAY021PF.GetColumn(i,"KYANO");//경로우대60
		p_KYBNO =ds_HAYZ011_HAY021PF.GetColumn(i,"KYBNO");//경로우대70
		
		//and && OR ||
		if(p_RELCD=="10" || p_TRBNO !=0 || p_KYANO !=0 || p_KYBNO !=0){
			p_PHOSB+=ds_HAYZ011_HAY021PF.GetColumn(i,"PHOSK")+ds_HAYZ011_HAY021PF.GetColumn(i,"PHOSU");//의료비(본인,경로,장애)		
		}else{
			p_PHOSA+=ds_HAYZ011_HAY021PF.GetColumn(i,"PHOSK")+ds_HAYZ011_HAY021PF.GetColumn(i,"PHOSU");//의료비(그외)		
		}
	}
	ds_HAYZ011_HAY011PF.SetColumn(0,"PHOSB",p_PHOSB);//의료비(본인,경로,장애)	
	ds_HAYZ011_HAY011PF.SetColumn(0,"PHOSA",p_PHOSA);//의료비(그외)	
	//교육비처리
	var p_PEDUA=0, p_PEDUB=0;//교육비(본인), 교육비(그외)
	for(i=0; i<ds_HAYZ011_HAY021PF.rowcount; i++){
		p_RELCD =ds_HAYZ011_HAY021PF.GetColumn(i,"RELCD");//사내관계코드		
		if(p_RELCD=="10"){
			p_PEDUA+=ds_HAYZ011_HAY021PF.GetColumn(i,"PEDSK")+ds_HAYZ011_HAY021PF.GetColumn(i,"PEDSU");//교육비(본인)		
		}else{
			p_PEDUB+=ds_HAYZ011_HAY021PF.GetColumn(i,"PEDSK")+ds_HAYZ011_HAY021PF.GetColumn(i,"PEDSU");//교육비(그외)		
		}
	}
	ds_HAYZ011_HAY011PF.SetColumn(0,"PEDUA",p_PEDUA);//교육비(본인)
	ds_HAYZ011_HAY011PF.SetColumn(0,"PEDUB",p_PEDUB);//교육비(그외)	
	
*/		
		/*
		alert(ds_HAYZ011_HAY021PF.Sum("PGPSK")+ds_HAYZ011_HAY021PF.Sum("PGPSU"));//일반보험료
		alert(ds_HAYZ011_HAY021PF.Sum("KIBAK")+ds_HAYZ011_HAY021PF.Sum("KIBAU"));//법정기부
		alert(ds_HAYZ011_HAY021PF.Sum("KIBBK")+ds_HAYZ011_HAY021PF.Sum("KIBBU"));//지정기부
		alert(ds_HAYZ011_HAY021PF.Sum("JIGBK")+ds_HAYZ011_HAY021PF.Sum("JIKBU"));//직불카드
		alert(ds_HAYZ011_HAY021PF.Sum("JIROU"));//학원지로
		alert(ds_HAYZ011_HAY021PF.Sum("KIBCK")+ds_HAYZ011_HAY021PF.Sum("KIBCU"));//특례기부금
		alert(ds_HAYZ011_HAY021PF.Sum("KIBDK")+ds_HAYZ011_HAY021PF.Sum("KIBDU"));//종교단체기부금
		alert(ds_HAYZ011_HAY021PF.Sum("CJANK")+ds_HAYZ011_HAY021PF.Sum("CJANU"));//전통시장
		alert(ds_HAYZ011_HAY021PF.Sum("PBTSK")+ds_HAYZ011_HAY021PF.Sum("PBTSU"));//대중교통
		*/
}

//연금저축확인
function chk_HAY041(){
	//계좌번호가 없는 ROW삭제
	for(i=ds_HAYZ011_HAY041PF.rowcount; i>=0; i--){
		if(length(trim(ds_HAYZ011_HAY041PF.GetColumn(i,"INCCD")))==0 || length(trim(ds_HAYZ011_HAY041PF.GetColumn(i,"BNKCD")))==0 || length(trim(ds_HAYZ011_HAY041PF.GetColumn(i,"GJBNB")))==0){
		//if(length(trim(ds_HAYZ011_HAY041PF.GetColumn(i,"INCCD")))==0 && length(trim(ds_HAYZ011_HAY041PF.GetColumn(i,"BNKCD")))==0){
		//if(length(trim(ds_HAYZ011_HAY041PF.GetColumn(i,"GJBNB")))==0){
			ds_HAYZ011_HAY041PF.DeleteRow(i);
		}
	}
	var p_KITA3=0,  p_YUNG1=0,  p_YUNG2=0,  p_HUSA1=0,  p_HUSA3=0,  p_HUSA4=0,  p_LGSTK=0;
	//퇴직연금, 개인연금, 연금저축, 주택저축청약, 주택저축종합, 주택저축근로, 장기집합증권
	//연금저축공제 금액 합계생성 -> HAY011PF저장
	for(i=0; i<ds_HAYZ011_HAY041PF.rowcount; i++){
		var p_INCCD=""; //소득공제구분
			p_INCCD = trim(ds_HAYZ011_HAY041PF.GetColumn(i,"INCCD"));
		if(p_INCCD=="11"){
			p_KITA3+=ds_HAYZ011_HAY041PF.GetColumn(i,"PAYTT");//퇴직연금 코드11
		}else if(p_INCCD=="21"){
			p_YUNG1+=ds_HAYZ011_HAY041PF.GetColumn(i,"PAYTT");//개인연금 코드21
		}else if(p_INCCD=="22"){
			p_YUNG2+=ds_HAYZ011_HAY041PF.GetColumn(i,"PAYTT");//연금저축 코드22
		}else if(p_INCCD=="31"){
			p_HUSA1+=ds_HAYZ011_HAY041PF.GetColumn(i,"PAYTT");//주택저축청약 코드31
		}else if(p_INCCD=="32"){
			p_HUSA3+=ds_HAYZ011_HAY041PF.GetColumn(i,"PAYTT");//주택저축종합 코드32
		}else if(p_INCCD=="34"){
			p_HUSA4+=ds_HAYZ011_HAY041PF.GetColumn(i,"PAYTT");//주택저축근로 코드34
		}else if(p_INCCD=="51"){
			p_LGSTK+=ds_HAYZ011_HAY041PF.GetColumn(i,"PAYTT");//장기집합증권 코드51
		}
	}
	ds_HAYZ011_HAY011PF.SetColumn(0,"KITA3", p_KITA3);//퇴직연금 코드11
	ds_HAYZ011_HAY011PF.SetColumn(0,"YUNG1", p_YUNG1);//개인연금 코드21
	ds_HAYZ011_HAY011PF.SetColumn(0,"YUNG2", p_YUNG2);//연금저축 코드22
	ds_HAYZ011_HAY011PF.SetColumn(0,"HUSA1", p_HUSA1);//주택저축청약 코드31
	ds_HAYZ011_HAY011PF.SetColumn(0,"HUSA3", p_HUSA3);//주택저축종합 코드32
	ds_HAYZ011_HAY011PF.SetColumn(0,"HUSA4", p_HUSA4);//주택저축근로 코드34
	ds_HAYZ011_HAY011PF.SetColumn(0,"LGSTK", p_LGSTK);//장기집합증권 코드51
}]]></Script>
</Window>