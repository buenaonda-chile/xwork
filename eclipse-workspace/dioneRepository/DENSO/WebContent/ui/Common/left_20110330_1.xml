<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="632" Id="eKins_left" Left="8" OnLoadCompleted="eKins_left_OnLoadCompleted" OnSize="fn_onSize" OnTimer="form_OnTimer" PidAttrib="7" Style="sty_form" Title="Frame&#32;Left" TooltipFont="Default,0" Top="8" Ver="1.0" Width="224" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Menu">
				<Contents>
					<colinfo id="MENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MENUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MENULVL" size="256" summ="default" type="STRING"/>
					<colinfo id="UPMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="PRINTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PROGID" size="256" summ="default" type="STRING"/>
					<record>
						<MENUID>A</MENUID>
						<MENULVL>0</MENULVL>
						<MENUNM>사용자관리</MENUNM>
						<PRINTSEQ></PRINTSEQ>
						<PROGID></PROGID>
						<UPMENUID></UPMENUID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_popMenu">
				<Contents>
					<colinfo id="LEV" size="256" summ="default" type="STRING"/>
					<colinfo id="ID" size="256" summ="default" type="STRING"/>
					<colinfo id="NM" size="256" summ="default" type="STRING"/>
					<colinfo id="STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG" size="256" summ="default" type="STRING"/>
					<record>
						<ID>1</ID>
						<IMG></IMG>
						<LEV>0</LEV>
						<NM>즐겨찾기&#32;추가</NM>
						<STAT>ENABLE</STAT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_menuAuth"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_leftTopMenu"></Dataset>
		</Datasets>
		<Image FillType="STRETCH" Height="582" Id="Image3" ImageID="new_left_bg" Left="8" TabOrder="4" Top="8" Width="207"></Image>
		<Image Height="6" Id="Image1" ImageID="new_left_bg3" Left="8" LeftMargin="0" TabOrder="3" Top="2" Width="209"></Image>
		<Image Height="9" Id="Image4" ImageID="leftBack_treeTop" Left="17" TabOrder="5" Top="223" Width="188"></Image>
		<Image Height="9" Id="Image5" ImageID="leftBack_treeBottom" Left="17" TabOrder="6" Top="581" Width="188"></Image>
		<Div Height="213" Id="Div0" Left="12" TabOrder="7" Text="Div0" Top="8" Width="200">
			<Contents></Contents>
		</Div>
		<Image Height="13" Id="Image0" ImageID="new_left_bg2" Left="8" TabOrder="8" Top="590" Width="207"></Image>
		<Image FillType="STRETCH" Height="355" Id="Image6" ImageID="leftBack_treeMid" Left="17" TabOrder="9" Top="226" Width="188"></Image>
		<TreeView BindDataset="G_ds_menu" Border="None" BorderColor="#b8b8b8" Expand="FALSE" Height="352" Id="TreeView0" ImageID="img_lefticon" InnerImageCount="8" Left="23" LevelColumn="LEV" OnClick="Tab_menu_OnClick" OnMouseOver="Tab_menu_tpg_main_TreeView0_OnMouseOver" RowHeight="18" TabOrder="2" TEXTColumn="MENU_NAME" Top="227" Width="179"></TreeView>
		<Image Cursor="HAND" Height="32" Id="Image2" ImageID="menu_close" Left="208" OnClick="img_close_OnClick" Static="FALSE" TabOrder="1" Top="200" Width="7"></Image>
		<Button Align="Left" AutoDraw="FALSE" Color="white" Cursor="HAND" Font="Default,9,Bold" Height="21" Id="Button0" ImageID="sum_display" Left="16" OnClick="Div0_Button2_OnClick" OnMouseOut="Button0_OnMouseOut" OnMouseOver="Button0_OnMouseOver" TabOrder="10" Top="36" Width="189"></Button>
		<Button Align="Left" AutoDraw="FALSE" Color="white" Cursor="HAND" Font="돋움,9,Bold" Height="21" Id="Button5" ImageID="sum_SCM" Left="16" OnClick="Div0_Button5_OnClick" OnMouseOut="Button5_OnMouseOut" OnMouseOver="Button5_OnMouseOver" TabOrder="11" Top="82" Width="189"></Button>
		<Button Align="Left" AutoDraw="FALSE" Color="white" Cursor="HAND" Font="돋움,9,Bold" Height="21" Id="Button6" ImageID="sum_pdm" Left="16" OnClick="Div0_Button6_OnClick" OnMouseOut="Button6_OnMouseOut" OnMouseOver="Button6_OnMouseOver" TabOrder="12" Top="105" Width="189"></Button>
		<Button Align="Left" AutoDraw="FALSE" Color="white" Cursor="HAND" Font="돋움,9,Bold" Height="21" Id="Button7" ImageID="sum_K-sox" Left="16" OnClick="Div0_Button7_OnClick" OnMouseOut="Button7_OnMouseOut" OnMouseOver="Button7_OnMouseOver" TabOrder="13" Top="128" Width="189"></Button>
		<Button AutoDraw="FALSE" Color="white" Cursor="HAND" Font="돋움,9,Bold" Height="21" Id="Button2" ImageID="sum_bin" Left="16" OnClick="Div0_Button0_OnClick" OnMouseOut="Button2_OnMouseOut" OnMouseOver="Button2_OnMouseOver" TabOrder="14" Top="197" Width="189"></Button>
		<Button Align="Left" AutoDraw="FALSE" Color="white" Cursor="HAND" Font="Default,9,Bold" Height="21" Id="Button1" ImageID="sum_printer" Left="16" OnClick="Div0_Button1_OnClick" OnMouseOut="Button1_OnMouseOut" OnMouseOver="Button1_OnMouseOver" TabOrder="15" Top="59" Width="189"></Button>
		<Button AutoDraw="FALSE" Color="white" Cursor="HAND" Font="돋움,9,Bold" Height="21" Id="Button3" ImageID="sum_bin" Left="16" OnClick="Div0_Button0_OnClick" OnMouseOut="Button3_OnMouseOut" OnMouseOver="Button3_OnMouseOver" TabOrder="16" Top="151" Width="189"></Button>
		<Button AutoDraw="FALSE" Color="white" Cursor="HAND" Font="돋움,9,Bold" Height="21" Id="Button4" ImageID="sum_bin" Left="16" OnClick="Div0_Button0_OnClick" OnMouseOut="Button4_OnMouseOut" OnMouseOver="Button4_OnMouseOver" TabOrder="17" Top="174" Width="189"></Button>
		<Button Align="Left" AutoDraw="FALSE" Color="white" Cursor="HAND" Font="돋움,9,Bold" Height="21" Id="Button8" ImageID="sum_main" Left="17" OnClick="Div0_Button0_OnClick" OnMouseOut="Button8_OnMouseOut" OnMouseOver="Button8_OnMouseOver" TabOrder="18" Top="11" Width="93"></Button>
		<Button Align="Left" AutoDraw="FALSE" Color="white" Cursor="HAND" Font="돋움,9,Bold" Height="21" Id="Button9" ImageID="sum_favorites" Left="112" OnClick="Div0_Button8_OnClick" OnMouseOut="Button9_OnMouseOut" OnMouseOver="Button9_OnMouseOver" TabOrder="19" Top="11" Width="93"></Button>
	</Form>
	<Script><![CDATA[#include "script::Mi_common.js";
#include "script::lib_script_common.js";

var treeType  = 1;
var btnMenuId = "";

function eKins_left_OnLoadCompleted(obj)
{
	// user정보, 메뉴권한, 메뉴리스트 등 정보를 가져온다.
	fcGetMenuTree('1');
	Div0.Button0.ImageStatus = "SELECT";

	title_user.Value = USER_ID;

	http.Sync 	= true;
	var sKind		= "getUserAuth";		
	var sMethodName = "service::user/menuAuth.do";  					
	var sInDataSet  = "";
	var sOutDataSet = "ds_menuAuth=ds_menuAuth";
	var sArgument   = "";
		sArgument   += " USER_ID=" + quote(G_ds_user.GetColumn(0,"USER_Id"));
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	
	var sKind		= "getLeftTopMenu";		
	var sMethodName = "service::login/selectLeftTopMenu.do";  					
	var sInDataSet  = "";
	var sOutDataSet = "ds_leftTopMenu=ds_leftTopMenu";
	var sArgument   = "";
		sArgument   += " COMPANY=" + quote(G_ds_user.GetColumn(0,"COMPANY"));
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	
}


function leftTopMenuAuthCheck(menu){
	
	for(i=0;i<ds_menuAuth.rowcount;i++){
		if(ds_menuAuth.GetColumn(i,"MENU_ID") == menu){
			if(ds_menuAuth.GetColumn(i,"USER_YN") == '1') {
				return true;
			} else {
				if(menu=35||menu=36||menu=37||menu==51||menu==38||menu==10057) { //35,36,37,51 디스플레이 세션, 38,10057 프린터 세션
					return false;								
				} else {
					alert(setPopMessage("1007"));	// 20110103l-koowgnojeel, 1007 == 권한이 없습니다. 관리자에게 문의하세요.
					return false;				
				}
			}
		}
	}
}


//메뉴 클릭시 버튼 표시(ㅛㅛ)
function tab_menu_OnClick(obj,nOldRow,nNewRow)
{

	//폴더명::파일명.XML뺀 
	var sUrl = G_ds_menu.GetColumn(nNewRow, "INIT_URL");
	var menuNm = G_ds_menu.GetColumn(nNewRow, "MENU_NAME");
	var lev  = G_ds_menu.GetColumn(nNewRow,'LEV');

	var str = checkMenuPassword(G_ds_menu.GetColumn(nNewRow, "MENU_ID"),G_ds_menu.GetColumn(nNewRow,'PW_CHECK'));


	if(str != "1"){
		return false ;
	} else {

		if(length(trim(sUrl)) > 0 ){
			global.FrameBottom.fcOpenMDI(sUrl,"",menuNm);
			bottomSet();
		}	
	}
}

function checkMenuPassword(menuId,pwCheck)
{

	var check = true ;

	for(i=0;i<global.FrameBottom.ds_winButton.rowcount;i++)
	{
		if(global.FrameBottom.ds_winButton.GetColumn(i,"MENU_ID") == menuId)
		{

			check = false ;
			break;
		}
	}
	
	if(pwCheck != "1")
	{
		check = false;
	}
	
	var str = "";
	
	
	if(check == true)
	{
		str = dialog("Group1::BHZZ100CP.xml","",400,190,"TitleBar=ture", 500,300);
	} else {
		str = "1";
	}

	return str;

}


function tab_menu_tpg_main_TreeView0_OnMouseOver(obj,nX,nY,nRow)
{
	obj.ToolTipText = ds_Menu.GetColumn(nRow, "MENUNM");
}

//왼쪽창 닫기
function img_close_OnClick(obj,nX,nY)
{
	//GetTopWindow().div_content.width = 2000;
	//GetTopWindow().div_content.titleBar.width = 1260;
	//GetTopWindow().div_content.searchBar.width = 1260;	
	//GetTopWindow().div_content.MainGrid.Right = 1260;

	global.FrameLeft.visible = false;
	global.FrameLeftClose.visible = true;

}

//모두닫기버튼 클릭시
function img_allClose_OnClick(obj,nX,nY)
{
	global.FrameBottom.fcCloseAllWindow();
}

function tab_bookMark_OnClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	alert("aaaaaaaaaa");
	//폴더명::파일명.XML뺀 
	var sUrl = G_ds_menu.GetColumn(nRow, "INIT_URL");
	var menuNm = G_ds_menu.GetColumn(nRow, "MENU_NAME");
	var lev  = G_ds_menu.GetColumn(nRow,'LEV');
	trace(sUrl);
	trace(lev);

	var str = checkMenuPassword(G_ds_menu.GetColumn(nRow, "MENU_ID"),G_ds_menu.GetColumn(nRow,'PW_CHECK'));

	if(str != "1"){
		return false ;
	} else {

		if(length(trim(sUrl)) > 0 ){
			global.FrameBottom.fcOpenMDI(sUrl,"",menuNm);
			bottomSet();
		}	
	}

}

function fn_onSize(obj,nCx,nCy,nState)
{
	TreeView0.Bottom = nCy - 24;
	
	Image3.Bottom = nCy -13;
	Image6.Bottom = nCy -22;

	Image5.Top = nCy - 22;
	Image5.Bottom = nCy -13;	
	
	Image0.Top = nCy - 13;
	Image0.Bottom = nCy;
}

function fcOpenPopMDI(menuId)
{

	if(ds_leftTopMenu.FindRow("MENU_ID", menuId) < 0){
		alert(setPopMessage("1006"));
		setMessage("1006");	
	}

	for(i=0;i<ds_leftTopMenu.rowcount;i++)
	{
		if(ds_leftTopMenu.GetColumn(i,"MENU_ID") == menuId)
		{
			var sUrl = ds_leftTopMenu.GetColumn(i,"INIT_URL");
			var menuNm = ds_leftTopMenu.GetColumn(i,"MENU_NAME");
			var lev  = ds_leftTopMenu.GetColumn(i,"LEV");
			
			if(length(trim(sUrl)) > 0 ){

				if(ds_leftTopMenu.GetColumn(i,"POPUP_YN") == "Y")
				{
					if(ds_leftTopMenu.GetColumn(i,"POPUP_W") == "" || ds_leftTopMenu.GetColumn(i,"POPUP_H") == "" ){
						var str = Open(sUrl,"",ds_leftTopMenu.GetColumn(i,"POPUP_W"),ds_leftTopMenu.GetColumn(i,"POPUP_H"),"Taskbar=true resize=true",210,90);
					} else {
						var str = Open(sUrl,"",ds_leftTopMenu.GetColumn(i,"POPUP_W"),ds_leftTopMenu.GetColumn(i,"POPUP_H"),"Taskbar=true resize=true AutoSize=false",210,90);
					}
					// 팝업세션 메뉴로그 저장
					global.FrameBottom.saveMenuLog(G_ds_user.GetColumn(0,"USER_ID"),menuId);
				} else {
					global.FrameBottom.fcOpenMDI(sUrl,"",menuNm);
				}
			}				
		}
	}
	
	
	
}



//  좌측 상단 메뉴 SESSION1~4
function Div0_Button2_OnClick(obj)
{	
	setTimer(35,1500); //SESSION1
	setTimer(36,3000); //SESSION2		
	setTimer(51,4500); //SESSION3
	setTimer(37,6000); //SESSION4		
}

function Div0_Button3_OnClick(obj)
{
	// 실제 메뉴아이디를 넣어주세요
	/*btnMenuId = '36'; //SESSION2
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;

	fcOpenPopMDI(btnMenuId);	*/
}

function Div0_Button4_OnClick(obj)
{
	// 실제 메뉴아이디를 넣어주세요
	/*btnMenuId = '51'; //SESSION3
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;
	
	fcOpenPopMDI(btnMenuId);	*/
}

function Div0_Button9_OnClick(obj)
{
	// 실제 메뉴아이디를 넣어주세요
	/*btnMenuId = '37'; //SESSION4
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;
	
	fcOpenPopMDI(btnMenuId);	*/
}

function Div0_Button1_OnClick(obj)
{
	setTimer(38,1000); //PRINT SESSION1	
	setTimer(10057,2000); //PRINT SESSION2
}

//SCM
function Div0_Button5_OnClick(obj)
{	
	// 실제 메뉴아이디를 넣어주세요
	btnMenuId = '39';
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;

	fcOpenPopMDI(btnMenuId);
}

//PDM
function Div0_Button6_OnClick(obj)
{		
	// 실제 메뉴아이디를 넣어주세요
	btnMenuId = '40';
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;
	
	fcOpenPopMDI(btnMenuId);
}

//K-SOX
function Div0_Button7_OnClick(obj)
{		
	// 실제 메뉴아이디를 넣어주세요
	btnMenuId = '41';
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;

	fcOpenPopMDI(btnMenuId);
}

//타이머
function form_OnTimer(obj,nEventID)
{
	killTimer(nEventID);
	
	btnMenuId = nEventID;
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;
	fcOpenPopMDI(btnMenuId);
	
	/*
    killTimer(1);

	// 실제 메뉴아이디를 넣어주세요
	btnMenuId = '35';
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;
	fcOpenPopMDI(btnMenuId);		
    
    killTimer(1);
    
	// 실제 메뉴아이디를 넣어주세요
	btnMenuId = '36';
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;
	fcOpenPopMDI(btnMenuId);	

    killTimer(1);	
	
	// 실제 메뉴아이디를 넣어주세요
	btnMenuId = '51';
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;
	fcOpenPopMDI(btnMenuId);	
	
    killTimer(1);	
	
	// 실제 메뉴아이디를 넣어주세요
	btnMenuId = '37';
	if(leftTopMenuAuthCheck(btnMenuId) == false) return false ;
	fcOpenPopMDI(btnMenuId);	*/
}

function Div0_Button0_OnClick(obj)
{
	treeType = 1;
	fcGetMenuTree('1');
	TreeView0.ImageID = "img_lefticon";
}

function Div0_Button8_OnClick(obj)
{
	treeType = 2;
	fcGetMenuTreeBookMark();
	TreeView0.ImageID = "img_lefticon2";
}

function Button8_OnMouseOut(obj)
{
	Button8.ImageStatus = "pop";				
}

function Button8_OnMouseOver(obj,nX,nY)
{
	Button8.ImageStatus = "select";				
}

function Button9_OnMouseOut(obj)
{
	Button9.ImageStatus = "pop";				
}

function Button9_OnMouseOver(obj,nX,nY)
{
	Button9.ImageStatus = "select";				
}

function Button0_OnMouseOut(obj)
{
	Button0.ImageStatus = "pop";				
}
function Button0_OnMouseOver(obj,nX,nY)
{
	Button0.ImageStatus = "select";				
}

function Button1_OnMouseOut(obj)
{
	Button1.ImageStatus = "pop";				
}
function Button1_OnMouseOver(obj,nX,nY)
{
	Button1.ImageStatus = "select";				
}

function Button5_OnMouseOut(obj)
{
	Button5.ImageStatus = "pop";				
}
function Button5_OnMouseOver(obj,nX,nY)
{
	Button5.ImageStatus = "select";				
}

function Button6_OnMouseOut(obj)
{
	Button6.ImageStatus = "pop";				
}
function Button6_OnMouseOver(obj,nX,nY)
{
	Button6.ImageStatus = "select";				
}

function Button7_OnMouseOut(obj)
{
	Button7.ImageStatus = "pop";				
}
function Button7_OnMouseOver(obj,nX,nY)
{
	Button7.ImageStatus = "select";				
}

function Button3_OnMouseOut(obj)
{
	Button3.ImageStatus = "pop";				
}
function Button3_OnMouseOver(obj,nX,nY)
{
	Button3.ImageStatus = "select";				
}

function Button4_OnMouseOut(obj)
{
	Button4.ImageStatus = "pop";				
}
function Button4_OnMouseOver(obj,nX,nY)
{
	Button4.ImageStatus = "select";				
}

function Button2_OnMouseOut(obj)
{
	Button2.ImageStatus = "pop";				
}
function Button2_OnMouseOver(obj,nX,nY)
{
	Button2.ImageStatus = "select";				
}

function Button7_OnMouseOut(obj)
{
	Button7.ImageStatus = "pop";				
}
function Button7_OnMouseOver(obj,nX,nY)
{
	Button7.ImageStatus = "select";				
}


]]></Script>
</Window>