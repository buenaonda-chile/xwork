<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="784" Id="OBMZ200" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="보전의뢰작업(등록)" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="720" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ200" UseClientLayout="1">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="ERYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ERSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ERTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LINCD" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ERRCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ERRTX" size="256" summ="default" type="STRING"/>
					<colinfo id="REYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RETIM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE1" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE2" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE3" size="256" summ="default" type="STRING"/>
					<colinfo id="MSGFG" size="256" summ="default" type="STRING"/>
					<colinfo id="MSGTM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DETIM" size="256" summ="default" type="STRING"/>
					<colinfo id="MRYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="MRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="MPYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="MPTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="FNYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="FNTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="QAYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="QATIM" size="256" summ="default" type="STRING"/>
					<colinfo id="PLYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="PLTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="HIYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="HITIM" size="256" summ="default" type="STRING"/>
					<colinfo id="JISNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN1" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER1" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER2" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN3" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER3" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN4" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_LINCD">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MSHNO">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="LINCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ERRCD" UseClientLayout="1">
				<Contents>
					<colinfo id="ERRCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ERRNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ160PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ200_CHECK"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_uploadFile">
				<Contents>
					<colinfo id="chk" size="256" summ="default" type="STRING"/>
					<colinfo id="fullname" size="256" summ="default" type="STRING"/>
					<colinfo id="filename" size="256" summ="default" type="STRING"/>
					<colinfo id="prog_bar" size="256" summ="default" type="STRING"/>
					<colinfo id="filesize" size="256" summ="default" type="INT"/>
					<colinfo id="progsize" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ200_ERSEQ">
				<Contents>
					<colinfo id="ERSEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_managerYN"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SEUCD"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DISASTER"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SEUCD_R">
				<Contents>
					<colinfo id="USEUTF0" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUNM0" size="256" summ="default" type="STRING"/>
					<colinfo id="USEUTF1" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="USEUTF2" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="USEUTF3" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="USEUTF4" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUNM4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DISASTER_R">
				<Contents>
					<colinfo id="USEUTF0" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCNM0" size="256" summ="default" type="STRING"/>
					<colinfo id="USEUTF1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="USEUTF2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="USEUTF3" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="USEUTF4" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCNM4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="744" Id="searchBar" TabOrder="28" Top="32" Width="712"></Static>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="0" TabStop="FALSE" Width="722"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="16" Id="title_text" Left="16" TabOrder="0" Top="8" Width="416"></Static>
		<Button Height="26" Id="btn_CLOSE" ImageID="closeBtn" Left="632" OnClick="btn_CLOSE_OnClick" TabOrder="0" Text="닫기" Top="40" Width="74"></Button>
		<Button Height="27" Id="btn_save_pop" ImageID="sum_save" Left="552" OnClick="fn_Save2" TabOrder="4" TabStop="FALSE" Text="Button2" Top="40" Width="72"></Button>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static0" Left="1" TabOrder="5" Text="에러발생일시" Top="32" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static1" Left="1" TabOrder="6" Text="보전의뢰일시" Top="64" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static2" Left="1" TabOrder="7" Text="제품코드" Top="96" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static3" Left="1" TabOrder="8" Text="라인명" Top="128" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static5" Left="1" TabOrder="9" Text="에러내용" Top="192" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static4" Left="1" TabOrder="10" Text="설비명" Top="160" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="90" Id="Static6" Left="1" TabOrder="11" Text="의뢰내용" Top="224" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static7" Left="1" TabOrder="12" Text="의뢰접수일시" Top="316" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static8" Left="1" TabOrder="13" Text="인원배치일시" Top="348" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static9" Left="1" TabOrder="14" Text="수리완료일시" Top="380" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static10" Left="341" TabOrder="15" Text="품질확인일시" Top="316" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static11" Left="341" TabOrder="16" Text="계획보전전환" Top="348" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static12" Left="341" TabOrder="17" Text="이력등록일시" Top="380" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static13" Left="1" TabOrder="18" Text="첨부파일#1" Top="444" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static14" Left="1" TabOrder="19" Text="첨부파일#2" Top="476" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static15" Left="1" TabOrder="20" Text="첨부파일#3" Top="508" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<TextArea BindDataset="ds_OBMZ200" CheckLength="Byte" Column="ERRTX" Height="88" Id="ed_ERRTX" Left="136" MaxLength="200" TabOrder="21" Top="224" Width="536"></TextArea>
		<Calendar BindDataset="ds_OBMZ200" Border="Flat" BorderColor="SCROLLBAR" Column="ERYMD" Dateformat="yyyy-MM-dd" EditAlign="CENTER" FocusIndex="0" Height="30" Id="cmb_ERYMD" Left="136" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="22" Top="32" Value="TODAY" Width="100"></Calendar>
		<Calendar BindDataset="ds_OBMZ200" Border="Flat" BorderColor="SCROLLBAR" Column="REYMD" Dateformat="yyyy-MM-dd" EditAlign="CENTER" FocusIndex="0" Height="30" Id="cmb_REYMD" Left="136" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="23" Top="64" Value="TODAY" Width="100"></Calendar>
		<Combo BindDataset="ds_OBMZ200" CodeColumn="CD" Column="PRDCD" DataColumn="CDNM" Enable="FALSE" Height="28" Id="cmb_PRDCD2" ImeMode="none" INDEX="0" InnerDataset="ds_PRDCD" Left="136" Search="FILTERED" TabOrder="24" Top="96" Width="300"></Combo>
		<Combo BindDataset="ds_OBMZ200" CodeColumn="CD" Column="LINCD" DataColumn="CDNM" Enable="FALSE" Height="28" Id="cmb_LINCD" ImeMode="none" INDEX="0" InnerDataset="ds_LINCD" Left="136" Search="FILTERED" TabOrder="25" Top="128" Width="300"></Combo>
		<Combo BindDataset="ds_OBMZ200" CodeColumn="CD" Column="MSHNO" DataColumn="CDNM" Enable="FALSE" Height="28" Id="cmb_MSHNO" ImeMode="none" INDEX="0" InnerDataset="ds_MSHNO" Left="136" Search="FILTERED" TabOrder="26" Top="160" Width="300"></Combo>
		<Combo BindDataset="ds_OBMZ200" CodeColumn="ERRCD" Column="ERRCD" DataColumn="ERRNM" Height="28" Id="cmb_ERRCD" ImeMode="none" INDEX="0" InnerDataset="ds_ERRCD" Left="136" Search="FILTERED" TabOrder="27" Top="192" Width="300"></Combo>
		<MaskEdit Align="Center" BindDataset="ds_OBMZ200" Column="ERTIM" Height="30" Id="cmb_ERTIM" Left="240" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="29" Top="32" Type="STRING" Width="96"></MaskEdit>
		<MaskEdit Align="Center" BindDataset="ds_OBMZ200" Column="RETIM" Height="30" Id="cmb_RETIM" Left="240" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="30" Top="64" Type="STRING" Width="96"></MaskEdit>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static16" Left="344" TabOrder="31" Text="SEQ" Top="32" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<MaskEdit Align="Center" BindDataset="ds_OBMZ200" Column="ACTIM" Enable="FALSE" Height="30" Id="cmb_ACTIM" Left="240" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="33" Top="316" Type="STRING" Width="96"></MaskEdit>
		<Calendar BindDataset="ds_OBMZ200" Border="Flat" BorderColor="SCROLLBAR" Column="ACYMD" Dateformat="yyyy-MM-dd" EditAlign="CENTER" Enable="FALSE" FocusIndex="0" Height="30" Id="cmb_ACYMD" Left="136" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="32" Top="316" Width="100"></Calendar>
		<MaskEdit Align="Center" BindDataset="ds_OBMZ200" Column="DETIM" Enable="FALSE" Height="30" Id="cmb_DETIM" Left="240" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="35" Top="348" Type="STRING" Width="96"></MaskEdit>
		<Calendar BindDataset="ds_OBMZ200" Border="Flat" BorderColor="SCROLLBAR" Column="DEYMD" Dateformat="yyyy-MM-dd" EditAlign="CENTER" Enable="FALSE" FocusIndex="0" Height="30" Id="cmb_DEYMD" Left="136" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="34" Top="348" Width="100"></Calendar>
		<MaskEdit Align="Center" BindDataset="ds_OBMZ200" Column="FNTIM" Enable="FALSE" Height="30" Id="cmb_FNTIM" Left="240" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="37" Top="380" Type="STRING" Width="96"></MaskEdit>
		<Calendar BindDataset="ds_OBMZ200" Border="Flat" BorderColor="SCROLLBAR" Column="FNYMD" Dateformat="yyyy-MM-dd" EditAlign="CENTER" Enable="FALSE" FocusIndex="0" Height="30" Id="cmb_FNYMD" Left="136" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="36" Top="380" Width="100"></Calendar>
		<MaskEdit Align="Center" BindDataset="ds_OBMZ200" Column="QATIM" Enable="FALSE" Height="30" Id="cmb_QATIM" Left="580" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="39" Top="316" Type="STRING" Width="96"></MaskEdit>
		<Calendar BindDataset="ds_OBMZ200" Border="Flat" BorderColor="SCROLLBAR" Column="QAYMD" Dateformat="yyyy-MM-dd" EditAlign="CENTER" Enable="FALSE" FocusIndex="0" Height="30" Id="cmb_QAYMD" Left="476" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="38" Top="316" Width="100"></Calendar>
		<MaskEdit Align="Center" BindDataset="ds_OBMZ200" Column="PLTIM" Enable="FALSE" Height="30" Id="cmb_PLTIM" Left="580" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="41" Top="348" Type="STRING" Width="96"></MaskEdit>
		<Calendar BindDataset="ds_OBMZ200" Border="Flat" BorderColor="SCROLLBAR" Column="PLYMD" Dateformat="yyyy-MM-dd" EditAlign="CENTER" Enable="FALSE" FocusIndex="0" Height="30" Id="cmb_PLYMD" Left="476" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="40" Top="348" Width="100"></Calendar>
		<MaskEdit Align="Center" BindDataset="ds_OBMZ200" Column="HITIM" Enable="FALSE" Height="30" Id="cmb_HITIM" Left="580" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="43" Top="380" Type="STRING" Width="96"></MaskEdit>
		<Calendar BindDataset="ds_OBMZ200" Border="Flat" BorderColor="SCROLLBAR" Column="HIYMD" Dateformat="yyyy-MM-dd" EditAlign="CENTER" Enable="FALSE" FocusIndex="0" Height="30" Id="cmb_HIYMD" Left="476" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="42" Top="380" Width="100"></Calendar>
		<Button Height="30" Id="btn_FILE1" Left="135" OnClick="btn_FILE_OnClick" TabOrder="44" Text="첨부파일선택" Top="444" Width="104"></Button>
		<Button Height="30" Id="btn_FILE2" Left="135" OnClick="btn_FILE_OnClick" TabOrder="45" Text="첨부파일선택" Top="476" Width="104"></Button>
		<Button Height="30" Id="btn_FILE3" Left="135" OnClick="btn_FILE_OnClick" TabOrder="46" Text="첨부파일선택" Top="508" Width="104"></Button>
		<Edit Border="Default" BorderColor="SCROLLBAR" CheckLength="Byte" Enable="FALSE" Height="30" Id="st_PATH1" ImeMode="none" Left="242" MaxLength="15" TabOrder="47" TabStop="FALSE" Top="444" UpperOnly="TRUE" Width="190"></Edit>
		<Edit Border="Default" BorderColor="SCROLLBAR" CheckLength="Byte" Enable="FALSE" Height="30" Id="st_PATH2" ImeMode="none" Left="242" MaxLength="15" TabOrder="48" TabStop="FALSE" Top="476" UpperOnly="TRUE" Width="190"></Edit>
		<Edit Border="Default" BorderColor="SCROLLBAR" CheckLength="Byte" Enable="FALSE" Height="30" Id="st_PATH3" ImeMode="none" Left="242" MaxLength="15" TabOrder="49" TabStop="FALSE" Top="508" UpperOnly="TRUE" Width="190"></Edit>
		<Checkbox Align="LEFT" Font="Default,11" Height="30" Id="chk_Del1" Left="626" TabOrder="50" Text="삭제" Top="447" Value="FALSE" Width="50"></Checkbox>
		<Checkbox Align="LEFT" Font="Default,11" Height="30" Id="chk_Del2" Left="626" TabOrder="51" Text="삭제" Top="477" Value="FALSE" Width="50"></Checkbox>
		<Checkbox Align="LEFT" Font="Default,11" Height="30" Id="chk_Del3" Left="626" TabOrder="52" Text="삭제" Top="508" Value="FALSE" Width="50"></Checkbox>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static17" Left="1" TabOrder="53" Text="관리번호" Top="412" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static18" Left="441" TabOrder="54" Text="작업자1" Top="96" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="114" Id="Static21" Left="1" TabOrder="55" Text="필요&#10;안전보호구" Top="540" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="114" Id="Static22" Left="136" TabOrder="56" Top="542" Width="544"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="114" Id="Static23" Left="1" TabOrder="57" Text="발생재해" Top="656" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="114" Id="Static24" Left="136" TabOrder="58" Top="658" Width="544"></Static>
		<Image Cursor="HAND" Enable="FALSE" Height="17" Id="imgCODE1" ImageID="ic_search" Left="676" OnClick="imgCODE_OnClick" Static="FALSE" TabOrder="60" Top="100" Width="15"></Image>
		<Static Align="Center" BindDataset="ds_OBMZ200" Column="WORKER1" Height="22" Id="st_KORNM1" Left="605" TabOrder="61" Top="96" VAlign="Middle" Width="60"></Static>
		<Edit BindDataset="ds_OBMZ200" CheckLength="Byte" Column="SABUN1" Enable="FALSE" Height="30" Id="ed_SABUN1" Left="523" MaxLength="7" Number="TRUE" OnCharChanged="ed_SABUN_OnCharChanged" OnKillFocus="ed_SABUN_OnKillFocus" TabOrder="59" Top="96" UpperOnly="TRUE" UseIME="FALSE" Width="75"></Edit>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static66" Left="604" TabOrder="62" Top="121" Width="65"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static19" Left="441" TabOrder="63" Text="작업자2" Top="128" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Image Cursor="HAND" Enable="FALSE" Height="17" Id="imgCODE2" ImageID="ic_search" Left="676" OnClick="imgCODE_OnClick" Static="FALSE" TabOrder="65" Top="132" Width="15"></Image>
		<Static Align="Center" BindDataset="ds_OBMZ200" Column="WORKER2" Height="22" Id="st_KORNM2" Left="605" TabOrder="66" Top="128" VAlign="Middle" Width="60"></Static>
		<Edit BindDataset="ds_OBMZ200" CheckLength="Byte" Column="SABUN2" Enable="FALSE" Height="30" Id="ed_SABUN2" Left="523" MaxLength="7" Number="TRUE" OnCharChanged="ed_SABUN_OnCharChanged" OnKillFocus="ed_SABUN_OnKillFocus" TabOrder="64" Top="128" UpperOnly="TRUE" UseIME="FALSE" Width="75"></Edit>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static25" Left="604" TabOrder="67" Top="153" Width="65"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static26" Left="441" TabOrder="68" Text="작업자3" Top="160" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Image Cursor="HAND" Enable="FALSE" Height="17" Id="imgCODE3" ImageID="ic_search" Left="676" OnClick="imgCODE_OnClick" Static="FALSE" TabOrder="70" Top="164" Width="15"></Image>
		<Static Align="Center" BindDataset="ds_OBMZ200" Column="WORKER3" Height="22" Id="st_KORNM3" Left="605" TabOrder="71" Top="160" VAlign="Middle" Width="60"></Static>
		<Edit BindDataset="ds_OBMZ200" CheckLength="Byte" Column="SABUN3" Enable="FALSE" Height="30" Id="ed_SABUN3" Left="523" MaxLength="7" Number="TRUE" OnCharChanged="ed_SABUN_OnCharChanged" OnKillFocus="ed_SABUN_OnKillFocus" TabOrder="69" Top="160" UpperOnly="TRUE" UseIME="FALSE" Width="75"></Edit>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static28" Left="604" TabOrder="72" Top="185" Width="65"></Static>
		<Static Align="Center" BindDataset="ds_OBMZ200" Border="Flat" Column="ERSEQ" Height="30" Id="st_ERSEQ" Left="437" TabOrder="73" Top="32" VAlign="Middle" Width="60"></Static>
		<Static Align="Center" BindDataset="ds_OBMZ200" Border="Flat" Column="ERYMD" Height="30" Id="st_ERRYMD" Left="136" TabOrder="74" Top="413" VAlign="Middle" Width="60"></Static>
		<Static Align="Center" Border="Flat" Height="30" Id="Static29" Left="200" TabOrder="75" Text="-" Top="413" VAlign="Middle" Width="30"></Static>
		<Static Align="Center" BindDataset="ds_OBMZ200" Border="Flat" Column="ERSEQ" Height="30" Id="st_ERSEQ1" Left="235" TabOrder="78" Top="413" VAlign="Middle" Width="60"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="28" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="654" Right="678" TabOrder="104" Top="4" Type="Save" Width="24"></FileDialog>
		<File Bottom="28" Height="24" Id="File" Left="686" Right="710" TabOrder="103" Top="4" Width="24"></File>
		<CyHttpFile Height="24" Id="CyHttpFile0" Left="614" Top="4" Width="24"></CyHttpFile>
		<FileDialog AppendExtDefault="TRUE" Bottom="28" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog1" Left="582" Right="606" TabOrder="105" Top="4" Type="Save" Width="24"></FileDialog>
		<Edit BindDataset="ds_OBMZ200" Border="Default" BorderColor="SCROLLBAR" CheckLength="Byte" Column="FILE1" Enable="FALSE" Height="30" Id="st_FNAME1" ImeMode="none" Left="434" MaxLength="15" TabOrder="77" TabStop="FALSE" Top="444" UpperOnly="TRUE" Width="190"></Edit>
		<Edit BindDataset="ds_OBMZ200" Border="Default" BorderColor="SCROLLBAR" CheckLength="Byte" Column="FILE2" Enable="FALSE" Height="30" Id="st_FNAME2" ImeMode="none" Left="434" MaxLength="15" TabOrder="78" TabStop="FALSE" Top="476" UpperOnly="TRUE" Width="190"></Edit>
		<Edit BindDataset="ds_OBMZ200" Border="Default" BorderColor="SCROLLBAR" CheckLength="Byte" Column="FILE3" Enable="FALSE" Height="30" Id="st_FNAME3" ImeMode="none" Left="434" MaxLength="15" TabOrder="79" TabStop="FALSE" Top="508" UpperOnly="TRUE" Width="190"></Edit>
		<Button Height="25" Id="btnPrint" ImageID="sum_print" Left="632" OnClick="fn_print" TabOrder="80" Text="조회" Top="71" Width="75"></Button>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="30" Id="Static20" Left="441" TabOrder="83" Text="작업자4" Top="192" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Image Cursor="HAND" Enable="FALSE" Height="17" Id="imgCODE4" ImageID="ic_search" Left="676" OnClick="imgCODE_OnClick" Static="FALSE" TabOrder="85" Top="196" Width="15"></Image>
		<Static Align="Center" BindDataset="ds_OBMZ200" Column="WORKER4" Height="22" Id="Static27" Left="605" TabOrder="86" Top="192" VAlign="Middle" Width="60"></Static>
		<Edit BindDataset="ds_OBMZ200" CheckLength="Byte" Column="SABUN4" Enable="FALSE" Height="30" Id="Edit0" Left="523" MaxLength="7" Number="TRUE" OnCharChanged="ed_SABUN_OnCharChanged" OnKillFocus="ed_SABUN_OnKillFocus" TabOrder="84" Top="192" UpperOnly="TRUE" UseIME="FALSE" Width="75"></Edit>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static30" Left="604" TabOrder="87" Top="217" Width="65"></Static>
		<Ubi Bottom="776" Height="144" Id="Ubi0" Left="544" Right="712" scale="140" Top="632" Visible="FALSE" Width="168">
			<_PersistData>&#13;&#10;/6wbswZu/wAAAQBdEQAAd+IOAPjy//7//fL4/PcMDwACBVQAWQBfUABFADD48QH+8C8DMQA0LwABNQH99S8CXgBuSQR0+vn+8G8L&#13;&#10;MgA1agAsAGkLBGUPbwUB+/Tu8aEDFAazBP40AgdEAGUAZgAfYQB1AGxXA/jymQHs+fvXBPC/+vQFUwDFaMIAZVcBAgP59QN0X628&#13;&#10;ubTM1AcU+vRzAjAvAP70ATEA&#13;&#10;</_PersistData>
		</Ubi>
		<Button Height="25" Id="btnClose" ImageID="btn2_cancel2" Left="640" OnClick="fn_Close" TabOrder="82" Text="조회" Top="640" Visible="FALSE" Width="75"></Button>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : Jae hb
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : OBMZ200_POP.xml
 * ● PROGRAM DESCRIPTION  : 전라인가동현황-라인현황입력(설비선택)
 * ● DATE WRITTEN         : 2017.02.26
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";
#include "script::fileupdown.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
//var Lib2 = "PSDIOLIB"; // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");

var imgUPDOWNpath="C:/Program Files/Apache Software Foundation/Tomcat 6.0/webapps/DIONE_UPDOWN_FILE/bojen/";

var p_PRDCD="";
var p_LINCD="";
var p_MSHNO="";
var p_MSHERR="";

var g_userclass=""; //권한등급 Param

function on_LoadCompleted(obj){
	getTitle();

	getLINCD();	//라인코드
	managerYN(Lib2, ComboBoxPlant.Value, "3", G_ds_user.GetColumn(0,"USER_ID"));
	g_userclass=trim(ds_managerYN.GetColumn(0,"MAGER"));

	if(p_AFLAG="SEL"){
		trace("SEL");
		title_text="보전의뢰작업-등록";
		p_PRDCD=cmb_PRDCD.Value;
		p_LINCD=ds_OBMZ190.GetColumn(p_ROW, "LINCD");
		p_MSHNO=ds_OBMZ190.GetColumn(p_ROW, "MSHNO");
		
		ds_OBMZ200.AddRow();
		ds_OBMZ200.SetColumn(0,"COMPS",ComboBoxPlant.Value);//사업부
		ds_OBMZ200.SetColumn(0,"ERYMD",today());//에러발생일시
		ds_OBMZ200.SetColumn(0,"REYMD",today());//보전의뢰일시
		ds_OBMZ200.SetColumn(0,"PRDCD",cmb_PRDCD.Value);//제품코드
		ds_OBMZ200.SetColumn(0,"LINCD",ds_OBMZ190.GetColumn(p_ROW,"LINCD"));//라인코드
		ds_OBMZ200.SetColumn(0,"MSHNO",ds_OBMZ190.GetColumn(p_ROW,"MSHNO"));//설비코드
		ds_OBMZ200.SetColumn(0,"ERTIM",ds_OBMZ190.GetColumn(p_ROW,"ERRTM_M"));//에러발생시각
		ds_OBMZ200.SetColumn(0,"RETIM",substr(getDate(),8,4));//보전의뢰시각
		st_ERRYMD.Value = cmb_ERYMD.Value;	
	}else{
		trace("MOD");
		title_text="보전의뢰작업-수정";
		p_PRDCD=ds_OBMZ210.GetColumn(p_ROW, "PRDCD");
		p_LINCD=ds_OBMZ210.GetColumn(p_ROW, "LINCD");
		p_MSHNO=ds_OBMZ210.GetColumn(p_ROW, "MSHNO");
		
		getOBMZ200_POP();
		
		if(g_userclass="M"){	//보전관리자만 해당 메뉴 사용가능
			cmb_ACYMD.Enable=true;	//의뢰접수일시
			cmb_ACTIM.Enable=true;
			cmb_DEYMD.Enable=true;	//인원배치
			cmb_DETIM.Enable=true;	//
			cmb_PLYMD.Enable=true;	//계획보전
			cmb_PLTIM.Enable=true;	//
			cmb_HIYMD.Enable=true;	//이력등록
			cmb_HITIM.Enable=true;	//
		}
	}
	
	getMSHNO();	//설비코드
	getMSHERR();	//에러코드
	getSEUCD(); //필요보호구
	getDISCD();	//재해
	drawing_SEC();
	
	if(p_AFLAG="PRINT"){
		fn_print();
		close();
	}

}

/********************************************************************** 
 * 내용설명 : 라인코드 조회
 **********************************************************************/ 
function getLINCD(){
	var sKind		= "getLINCD";						
	var sMethodName = "service::psogmlib/selectMSTCODE.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_LINCD=ds_MSTCODE";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //코드
		sArgument += " SQLID=" + "selectMSTLINCD_PRD";
		//sArgument += " PRDCD=" + quote(cmb_PRDCD.Value);	//제품코드
		sArgument += " PRDCD=" + quote(p_PRDCD);	//제품코드
			
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}

/********************************************************************** 
 * 내용설명 : 설비명 조회
 **********************************************************************/ 
function getMSHNO(){
	
	var sKind		= "getMSHNO";						
	var sMethodName = "service::psogmlib/selectMSTCODE.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_MSHNO=ds_MSTCODE";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //코드
		sArgument += " SQLID=" + "selectMSHNO";
		//sArgument += " LINCD=" + quote(ds_OBMZ190.GetColumn(p_ROW, "LINCD")); //라인코드
		sArgument += " LINCD=" + quote(p_LINCD); //라인코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}

/********************************************************************** 
 * 내용설명 : 에러내용 조회
 **********************************************************************/ 
function getMSHERR(){	
	
	var sKind		= "getMSHERR";						
	var sMethodName = "service::psogmlib/selectOBMZ110.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ERRCD=ds_OBMZ110";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부	
		//sArgument += " LINCD=" + quote(ds_OBMZ190.GetColumn(p_ROW, "LINCD")); //라인코드
		//sArgument += " MSHNO=" + quote(ds_OBMZ190.GetColumn(p_ROW, "MSHNO")); //설비코드
		sArgument += " LINCD=" + quote(p_LINCD); //라인코드
		sArgument += " MSHNO=" + quote(p_MSHNO); //설비코드
	http.Sync 	= true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync 	= false;
}
/********************************************************************** 
 * 내용설명 : 필요보호구 조회
 **********************************************************************/ 
function getSEUCD()
{
	var sKind		= "getOBMZ130_A";						
	var sMethodName = "service::psogmlib/selectOBMZ130.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_SEUCD=ds_OBMZ130";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부	
		sArgument += " LINCD=" + quote(p_LINCD); //라인코드
		sArgument += " MSHNO=" + quote(p_MSHNO); //설비코드
	http.Sync 	= true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync 	= false;
	//trace(ds_SEUCD.SaveXML());
}
/********************************************************************** 
 * 내용설명 : 발생재해  조회
 **********************************************************************/ 
function getDISCD()
{
	//하단 라인 조회
	var sKind		= "getOBMZ150_A";						
	var sMethodName = "service::psogmlib/selectOBMZ150.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_DISASTER =ds_OBMZ150";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부	
		sArgument += " LINCD=" + quote(p_LINCD); //라인코드
		sArgument += " MSHNO=" + quote(p_MSHNO); //설비코드
	http.Sync 	= true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync 	= false;
}


/********************************************************************** 
 * 내용설명 : 조회
 **********************************************************************/ 
function getOBMZ200_POP(){

	var sKind		= "getOBMZ200_POP";						
	var sMethodName = "service::psogmlib/selectOBMZ200.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_OBMZ200=ds_OBMZ200";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부	
		sArgument += " ERYMD=" + quote(ds_OBMZ210.GetColumn(p_ROW,"ERYMD")); //에러발생일	
		sArgument += " ERSEQ=" + quote(ds_OBMZ210.GetColumn(p_ROW,"ERSEQ")); //SEQ
	http.Sync 	= true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync 	= false;
}
/********************************************************************** 
 * 내용설명 : 저장
 **********************************************************************/ 
function btn_save_pop(obj){

	if(confirm("[알림]등록하시겠습니까?")==true){

		fileDelete(); //파일삭제
	
		var sKind		= "setOBMZ200_POP";						
		var sMethodName = "service::psogmlib/saveOBMZ200.do";
		var sInDataSet  = "ds_OBMZ200=ds_OBMZ200:U";
		var sOutDataSet = "ds_OBMZ200_CHECK=ds_OBMZ200_CHECK ds_OBMZ200_ERSEQ=ds_OBMZ200_ERSEQ";
		var sArgument   = "";
			//sArgument += " LIB1=" + quote(Lib1);
			sArgument += " LIB2=" + quote(Lib2);
			sArgument += " LIB3=" + quote(Lib3);
			//sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부	
		sArgument += " USER_ID=" + quote(G_ds_user.GetColumn(0,"USER_ID"));
		http.Sync=true;
		Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
		http.Sync=false;

	}
}

/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	if(svcId=="setOBMZ200_POP"){
		// tran 실패
		var rlt="T";	
		if(rtnCd<0){
			alert(setPopMessage("1002"));
			setMessage("1002");
		}else{
				var t_ERSEQ, t_OFNAME, t_SFNAME;
		//trace(ds_OBMZ200_ERSEQ.SaveXML());
				if(length(trim(st_ERSEQ1.Text))==0){
					t_ERSEQ=lpad(ds_OBMZ200_ERSEQ.GetColumn(0,"ERSEQ"),"0",3);
					trace("t_ERSEQ=="+t_ERSEQ);
					
					//ds_OBMZ200.SetColumn(0, getObj, file_name);
					for(i=0; i<ds_uploadFile.rowcount; i++){
						t_OFNAME=ds_uploadFile.GetColumn(i,"filename");	
		//trace("t_OFNAME=="+t_OFNAME);			
		//trace(substr(t_OFNAME, (indexOf(t_OFNAME,"_")+1)));
						t_SFNAME = st_ERRYMD.Text+"_"+t_ERSEQ+substr(t_OFNAME, (indexOf(t_OFNAME,"_")+1));
	//trace(substr(t_SFNAME, (indexOf(t_SFNAME,"_")+1)));
						var str1=substr(t_SFNAME, (indexOf(t_SFNAME,"_")+1));
	//trace(substr(substr(str1,(indexOf(str1,"_")+1)),0,5));
						var str2 =substr(substr(str1,(indexOf(str1,"_")+1)),0,5);

						ds_OBMZ200.SetColumn(0, str2, t_SFNAME);
						ds_uploadFile.SetColumn(i,"filename", t_SFNAME);
		//trace("t_SFNAME=="+t_SFNAME);
					}
				}
				//저장시 파일이 업로드됨.
				if(ds_uploadFile.rowcount >0){
					if(!file_Upload()){
							ds_uploadFile.ClearData();
							FileDialog0.FileName= "";
							alert("[알림]파일업로드중 오류가 발생하였습니다. 다시 시도해주시기 바랍니다.");
							return false;			
					}
					else {
						FileDialog0.FileName= "";
					}
				}
		
			//alert(setPopMessage("1001"));
			setMessage("1001");
			//close(rlt);
			//close();
			if(p_AFLAG="SEL"){
				close(rlt);
			}else{
				close();
			}
		}
	}
}

function ed_SABUN_OnCharChanged(obj,strPreText,strPostText)
{
//trace(substr(obj.id,8,1));
	if(substr(obj.id,8,1)="1"){
		st_KORNM1.Text ="";
	}else if(substr(obj.id,8,1)="2"){
		st_KORNM2.Text ="";
	}else if(substr(obj.id,8,1)="3"){
		st_KORNM3.Text ="";
	}
}
function ed_SABUN_OnKillFocus(obj)
{
	if(length(trim(obj.Text)) < 1) return;
	http.usewaitcursor = false;
	http.Sync 	= true;
	var sKind		= "getOBMZ160PF";		
	var sMethodName = "service::pscomlib/selectOBMZ160PFPopup.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_OBMZ160PF=ds_Select";
	var sArgument   = "";
		sArgument  += " LIB2=" + quote(Lib2);
		sArgument  += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument  += " SABUN=" + quote(obj.Text);//사번
		//sArgument  += " KORNM2=" + quote(varNewValue);//이름
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
	if (ds_OBMZ160PF.rowcount< 1){
		alert(setPopMessage("4062")); //[확인] 사용자가 존재하지 않습니다.
		setMessage("4062");
		if(substr(obj.id,8,1)="1"){
			st_KORNM1.Text = "";
			ed_SABUN1.SetFocus();
		}else if(substr(obj.id,8,1)="2"){
			st_KORNM2.Text = "";
			ed_SABUN2.SetFocus();
		}else if(substr(obj.id,8,1)="3"){
			st_KORNM3.Text = "";
			ed_SABUN3.SetFocus();
		}
		return;
	}
	if(substr(obj.id,8,1)="1"){
		st_KORNM1.Text = ds_OBMZ160PF.GetColumn(0,"A2");	//이름
	}else if(substr(obj.id,8,1)="2"){
		st_KORNM2.Text = ds_OBMZ160PF.GetColumn(0,"A2");	//이름
	}else if(substr(obj.id,8,1)="3"){
		st_KORNM3.Text = ds_OBMZ160PF.GetColumn(0,"A2");	//이름
	}
	
	http.usewaitcursor = true;	
}


function imgCODE_OnClick(obj,nX,nY)
{
	var sTemp="zzzzzzzzzz";
	var selectnumber = "Q";
		var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp+ " " + "P_COMPS=" + ComboBoxPlant.Value,584,528);
	if (length(rtn) != 0){
		if(substr(obj.id,7,1)="1"){
//trace(substr(obj.id,7,1)+"==" +rtn[0]+"===" + rtn[1]);
			ed_SABUN1.Text = rtn[0];
			st_KORNM1.Text = rtn[1];
		}else if(substr(obj.id,7,1)="2"){
			ed_SABUN2.Text = rtn[0];
			st_KORNM2.Text = rtn[1];
		}else if(substr(obj.id,7,1)="3"){
			ed_SABUN3.Text = rtn[0];
			st_KORNM3.Text = rtn[1];
		}else if(substr(obj.id,7,1)="4"){
			ed_SABUN3.Text = rtn[0];
			st_KORNM3.Text = rtn[4];
		}
	}
}

/********************************************************************** 
 * 내용설명 : 시각체크 함수 object로 데이터를 받아 공통으로 사용함.
 **********************************************************************/ 
function timeChk_OnKillFocus(obj){
	if(length(trim(obj.Value)) != 0){
		var mtb = substr(obj.Text,0,2)+ substr(obj.Text,3,2);
		obj.Value = ReplaceToZero(mtb);
		var patim = trim(obj.Value);
		var hour = patim.substr(0,2);
		var min = patim.substr(2,2);

		if((hour < 00 || hour > 24) || (min < 00 || min > 60)){
			alert(setPopMessage("3029"));
			obj.setfocus();
			obj.Value="";
		}
	}	
}
/********************************************************************** 
 * 내용설명 : 시각체크 _를 0으로 치환함..
 **********************************************************************/ 
function ReplaceToZero(value)
{	
	var r=replace(value,"_","0");
	return(r);
}
function fn_Save2(obj)
{
	btn_save_pop();
}
function btn_CLOSE_OnClick(obj)
{
	Close();
}
function btn_FILE_OnClick(obj)
{
	var getObj = substr(obj.id,4);
	
//trace(getObj);

	FileDialog0.Filter = "ALL File(.*)|*.*";	
	FileDialog0.Type = "OPEN";
	if (!FileDialog0.Open()) {
		alert(setPopMessage("1009"));	//  파일 선택 창을 여는데 실패하였습니다.
		/*
		if(	getObj="FILE1"){
			st_PATH1.Text = "";
		}else if(getObj="FILE2"){
			st_PATH2.Text = "";
		}else if(getObj="FILE3"){
			st_PATH3.Text = "";
		}
		return;
		*/
	} 
	var file_name = FileDialog0.FileName;
	var file_path = FileDialog0.FilePath;
	var path = file_path + "\\" + file_name;
	setMessageDirect(path);	
	
	
	//ds_OBMZ200.SetColumn(0, getObj, file_name);
	var sFName = st_ERRYMD.Text+"_"+st_ERSEQ1.Text+"_"+getObj+substr(file_name, indexOf(file_name,"."));
	ds_OBMZ200.SetColumn(0, getObj, sFName);
	
	if(	getObj="FILE1"){
		st_PATH1.Text = file_name;
		st_FNAME1.Text = sFName;
	}else if(getObj="FILE2"){
		st_PATH2.Text = file_name;
		st_FNAME2.Text = sFName;
	}else if(getObj="FILE3"){
		st_PATH3.Text = file_name;
		st_FNAME3.Text = sFName;
	}
	

//trace("findrow"+ds_uploadFile.FindRow("filename",sFName));
	//기존에 저장된 DATASET삭제
	if("findrow"+ds_uploadFile.FindRow("filename",sFName) >= 0){
		ds_uploadFile.DeleteRow(ds_uploadFile.FindRow("filename",sFName));
	}
	//데이터셋에 로우 추가
	ds_uploadFile.addRow();	
	//다이얼로그에서 선택한 파일의 경로명(파일명포함)을 데이터셋에 저장
	ds_uploadFile.SetColumn(ds_uploadFile.row,"fullname", path);
	//다이얼로그에서 선택한 파일명을 데이터셋에 저장
	//ds_uploadFile.SetColumn(ds_uploadFile.row,"filename", file_name);
	ds_uploadFile.SetColumn(ds_uploadFile.row,"filename", sFName);	

	//trace(ds_OBMZ200.SaveXML());
	//trace(ds_uploadFile.SaveXML());
	
}

//파일업로드
function file_Upload(obj)
{
	//전라인가동현황 업로드경로
	var gImgPath ="Maintenance/";

	if(ComboBoxPlant.Value =="E1"){
		 gImgPath = gImgPath + "KE/";
	}else if(ComboBoxPlant.Value =="C1"){
		 gImgPath = gImgPath + "KAC/";
	}else if(ComboBoxPlant.Value =="H1"){
		 gImgPath = gImgPath + "KAH/";
	}else if(ComboBoxPlant.Value =="S1"){
		 gImgPath = gImgPath + "KAS/";
	}
	
	var ret;
	//파일선택 버튼을 이용해서 선택된 파일이 없는 경우 처리 생략
	if(ds_uploadFile.rowcount != 0){
		//데이터셋 로우 수 만큼 루프
		for ( var i = 0 ; i < ds_uploadFile.rowcount ; i++ )
		{
			// 풀경로 취득
			var file_url = ds_uploadFile.getColumn(i,"fullname");	
				trace(file_url);
			//로컬에서 선택한 파일명을 취득하여 변수에 설정
			var str_param = ds_uploadFile.getColumn(i,"filename");
			//업로드 할 서버 경로와 파일명
			var str_param_server = imgUPDOWNpath + gImgPath + str_param;
			//스크립트 파일의 함수 호출 
			ret = gfn_FileWrite(CyHttpFile0, file_url, str_param_server, i, "prog_bar", CyHttpFile0);									
			//호출함수 리턴값 처리
			if ( ret[0] == "FAIL" )
			{
				alert(ret[1]);
				break;
			}
		}
	}
	return true;	
}

function fileDelete()
{
	if(chk_Del1.Value=true){
		ds_OBMZ200.SetColumn(0,"FILE1","");
	}
	if(chk_Del2.Value=true){
		ds_OBMZ200.SetColumn(0,"FILE2","");
	}
	if(chk_Del3.Value=true){
		ds_OBMZ200.SetColumn(0,"FILE3","");
	}
}
			
function drawing_SEC(){

	var p_EQUCD, p_EQUNM, p_USETF, strObj;
	var p_pos_x=150;
	var p_pos_y=547;
	var p_width=90;
	var p_height=24;
	var p_plus_w=105;
	var p_plus_h=24;
	var j=0;
	var k=0;
	ds_SEUCD_R.AddRow();
	for(i=0; i<ds_SEUCD.rowcount; i++){
		p_EQUCD=trim(ds_SEUCD.GetColumn(i,"EQUCD"));	//보호구코드
		p_EQUNM=trim(ds_SEUCD.GetColumn(i,"EQUNM"));	//보호구명칭
		p_USETF=trim(ds_SEUCD.GetColumn(i,"USETF"));	//사용유무

		strObj	= "left='"+ (parseInt(p_pos_x) + parseInt(p_plus_w)*j)+"' top='"+ (parseInt(p_pos_y) + parseInt(p_plus_h)*k) +
					"' Value='"+ p_USETF+"' Text='"+ p_EQUNM+ "' width= 90 height= 24 ";	
		create( "Checkbox", "Chkbox1_"+p_EQUCD, strObj);
				
		ds_SEUCD_R.SetColumn(ds_SEUCD_R.currow,"USEUTF"+j,p_USETF);
		ds_SEUCD_R.SetColumn(ds_SEUCD_R.currow,"EQUNM"+j,p_EQUNM);
		
		j++;
		
		if((i+1)%5=0){	
			j=0;
			k++;
			ds_SEUCD_R.AddRow();
		}

	}
	//trace(ds_SEUCD_R.SaveXML());
	
	var p_ACCCD, p_ACCNM, p_USETF, strObj;
	var p_pos_y2=665;
	j=0;
	k=0;
	ds_DISASTER_R.AddRow();
	for(i=0; i<ds_DISASTER.rowcount; i++){
		p_ACCCD=trim(ds_DISASTER.GetColumn(i,"ACCCD"));	//보호구코드
		p_ACCNM=trim(ds_DISASTER.GetColumn(i,"ACCNM"));	//보호구명칭
		p_USETF=trim(ds_DISASTER.GetColumn(i,"USETF"));	//사용유무

		strObj	= "left='"+ (parseInt(p_pos_x) + parseInt(p_plus_w)*j)+"' top='"+ (parseInt(p_pos_y2) + parseInt(p_plus_h)*k) +
					"' Value='"+ p_USETF+ "' Text='"+ p_ACCNM+ "' width= 90 height= 24 ";	
		create( "Checkbox", "Chkbox2_"+p_ACCCD, strObj);
		
		ds_DISASTER_R.SetColumn(ds_DISASTER_R.currow,"USEUTF"+j,p_USETF);
		ds_DISASTER_R.SetColumn(ds_DISASTER_R.currow,"ACCNM"+j,p_ACCNM);
				
		j++;
		
		if((i+1)%5=0){	
			j=0;
			k++;
			ds_DISASTER_R.AddRow();
		}		
	}
	//trace(ds_DISASTER_R.SaveXML());
}
			
function fn_print()
{
	if (ds_OBMZ200.rowcount < 1){
		alert(setPopMessage("1003"));
		setMessage("1003");	
		return;
	}
	//Ubi0.printset();
/*

	http.Sync = true;
	var sKind		= "getOBNZ200R";						
	var sMethodName = "service::psogmlib/selectOBNZ200R.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBNZ200R=ds_OBNZ200R";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " LINCD=" + quote(cmb_LINCD.Value);	//라인코드
		sArgument += " MSHNO=" + quote(cmb_MSHNO.Value);	//설버No
		sArgument += " PYEAR=" + quote(substr(cmb_PYEAR.Value,0,4));	//점검년도		
		sArgument += " PLNDT=" + quote(cmb_PLNDT.Value);	//점검계획일
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
*/
	if(ds_OBMZ200.rowcount > 0){
		Ubi0.setJrfFileDir(G_baseURL+"ui/PSOGMLIB/report/");
		Ubi0.setJrfFileName("OBMZ200R.jrf");
		Ubi0.SetDataset("ds_OBMZ200R", "ds_OBMZ200");//DATA LIST
		Ubi0.SetDataset("ds_PRDCD", "ds_PRDCD");//LINE 코드
		Ubi0.SetDataset("ds_LINCD", "ds_LINCD");//LINE 코드
		Ubi0.SetDataset("ds_MSHNO", "ds_MSHNO");//설비명
		Ubi0.SetDataset("ds_ERRCD", "ds_ERRCD");//에러코드
		
		Ubi0.SetDataset("ds_SEUCD_R", "ds_SEUCD_R");//필요보호구 DATASET
		Ubi0.SetDataset("ds_DISASTER_R", "ds_DISASTER_R");//발생재해 DATASET
/*
	Ubi0.Visible=true;
	btnClose.Visible=true;
	Ubi0.Retrieve();
	Ubi0.printset();
	btnClose.SetFocus();
*/

	Ubi0.Retrieve();
	Ubi0.printset();
	}
}

function fn_Close(obj)
{
	Ubi0.Visible=false;
	btnClose.Visible=false;
}
]]></Script>
</Window>