<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="ogm203" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="신규이력등록" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Class">
				<Contents>
					<colinfo id="code1" size="256" summ="default" type="STRING"/>
					<colinfo id="code_name" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm200">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="JISNO" size="256" summ="default" type="STRING"/>
					<colinfo id="TIMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBCD" size="256" summ="default" type="STRING"/>
					<colinfo id="KDOWN" size="256" summ="default" type="STRING"/>
					<colinfo id="PADAT" size="256" summ="default" type="INT"/>
					<colinfo id="PATIM" size="256" summ="default" type="INT"/>
					<colinfo id="URDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="URTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="KSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="KSTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="WATHR" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKM1" size="256" summ="default" type="STRING"/>
					<colinfo id="SDPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="HYOSN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNOTE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm200ALL"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm200_chk"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm200_method">
				<Contents>
					<colimtbPaDatnfo id="jobcd" size="256" summ="default" type="STRING"/>
					<colinfo id="kogub" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm200_hmd020pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cmbKdown">
				<Contents>
					<colinfo id="downValue" size="256" summ="default" type="STRING"/>
					<record>
						<downValue>0</downValue>
					</record>
					<record>
						<downValue>5</downValue>
					</record>
					<record>
						<downValue>10</downValue>
					</record>
					<record>
						<downValue>15</downValue>
					</record>
					<record>
						<downValue>20</downValue>
					</record>
					<record>
						<downValue>25</downValue>
					</record>
					<record>
						<downValue>30</downValue>
					</record>
					<record>
						<downValue>35</downValue>
					</record>
					<record>
						<downValue>40</downValue>
					</record>
					<record>
						<downValue>45</downValue>
					</record>
					<record>
						<downValue>49</downValue>
					</record>
					<record>
						<downValue>100</downValue>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc150pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc230pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc170pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc020pf">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc010pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc220pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc060pf_01"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc060pf_02">
				<Contents>
					<colinfo id="comcd" size="256" summ="default" type="STRING"/>
					<colinfo id="cpart" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc070pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc050pf_01"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc050pf_02">
				<Contents>
					<colinfo id="deccd" size="256" summ="default" type="STRING"/>
					<colinfo id="dpart" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc160pf">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc190pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc180pf">
				<Contents>
					<colinfo id="hyocd" size="256" summ="default" type="STRING"/>
					<colinfo id="hkdnm" size="256" summ="default" type="STRING"/>
					<colinfo id="hyonm" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc120pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc110pf">
				<Contents>
					<colinfo id="caucd" size="256" summ="default" type="STRING"/>
					<colinfo id="ckdnm" size="256" summ="default" type="STRING"/>
					<colinfo id="cause" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc100pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc090pf">
				<Contents>
					<colinfo id="trucd" size="256" summ="default" type="STRING"/>
					<colinfo id="tkdnm" size="256" summ="default" type="STRING"/>
					<colinfo id="trunm" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc210pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obc200pf">
				<Contents>
					<colinfo id="effcd" size="256" summ="default" type="STRING"/>
					<colinfo id="effnm" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obj200pf_03"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obj220pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_managerYN"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm203_cmplt"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm_maxNum"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm203_pepcdChk"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm203_prtRep">
				<Contents>
					<colinfo id="PRTNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="PTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKER" size="256" summ="default" type="STRING"/>
					<colinfo id="QUATY" size="256" summ="default" type="STRING"/>
					<colinfo id="PRICE" size="256" summ="default" type="STRING"/>
					<colinfo id="AMONT" size="256" summ="default" type="STRING"/>
					<colinfo id="DELCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obj210pf_01"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obj220pf_del"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obj230pf"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm203_rep">
				<Contents>
					<colinfo id="JISNO" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="LINNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBCD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBNM" size="256" summ="default" type="STRING"/>
					<colinfo id="KDOWN" size="256" summ="default" type="STRING"/>
					<colinfo id="INOCD" size="256" summ="default" type="STRING"/>
					<colinfo id="INONM" size="256" summ="default" type="STRING"/>
					<colinfo id="EMGCD" size="256" summ="default" type="STRING"/>
					<colinfo id="EMGNM" size="256" summ="default" type="STRING"/>
					<colinfo id="QORCD" size="256" summ="default" type="STRING"/>
					<colinfo id="QORNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBAS" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="COMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPART" size="256" summ="default" type="STRING"/>
					<colinfo id="DECCD" size="256" summ="default" type="STRING"/>
					<colinfo id="DPART" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHOCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHONM" size="256" summ="default" type="STRING"/>
					<colinfo id="HYOCD" size="256" summ="default" type="STRING"/>
					<colinfo id="HYONM" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TRUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TRUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="PADAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PATIM" size="256" summ="default" type="STRING"/>
					<colinfo id="URDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="URTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="KSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="KSTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="WNDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="WNTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKM1" size="256" summ="default" type="STRING"/>
					<colinfo id="KORNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="SDPNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKM2" size="256" summ="default" type="STRING"/>
					<colinfo id="KORNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="SDPNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="SDPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBCN" size="256" summ="default" type="STRING"/>
					<colinfo id="SCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="PCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="REPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EFFCD" size="256" summ="default" type="STRING"/>
					<colinfo id="EFFNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ECOST" size="256" summ="default" type="STRING"/>
					<colinfo id="HYOSN" size="256" summ="default" type="STRING"/>
					<colinfo id="WONIN" size="256" summ="default" type="STRING"/>
					<colinfo id="DAECH" size="256" summ="default" type="STRING"/>
					<colinfo id="JANHR" size="256" summ="default" type="STRING"/>
					<colinfo id="WATHR" size="256" summ="default" type="STRING"/>
					<colinfo id="STPHR" size="256" summ="default" type="STRING"/>
					<colinfo id="MNTHR" size="256" summ="default" type="STRING"/>
					<colinfo id="BFRHR" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTHR" size="256" summ="default" type="STRING"/>
					<colinfo id="CMPLT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="TEIMA" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKAN" size="256" summ="default" type="STRING"/>
					<colinfo id="IMGBF" size="256" summ="default" type="STRING"/>
					<colinfo id="IMGAF" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="560" Id="Static0" TabOrder="12" Top="64" Width="1060"></Static>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="40" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="40" Top="8" Width="1032"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="4" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="3" Width="24"></File>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="32" Id="searchBar" TabOrder="41" Top="31" Width="1060"></Static>
		<Combo CodeColumn="code2" DataColumn="code_name" Height="18" Id="ComboBoxPlant" InnerDataset="ds_ComCode_PLNT" Left="104" OnChanged="common_OnChanged" TabOrder="1" Top="37" Width="120"></Combo>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static2" Left="232" TabOrder="52" Text="지시&#32;&#32;&#32;&#32;No" Top="36" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static3" Left="8" TabOrder="45" Text="설비&#32;&#32;&#32;&#32;&#32;No" Top="72" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static4" Left="8" TabOrder="46" Text="발&#32;생&#32;일&#32;시" Top="264" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static5" Left="8" TabOrder="47" Text="의&#32;뢰&#32;일&#32;시" Top="296" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static6" Left="8" TabOrder="48" Text="개&#32;시&#32;일&#32;시" Top="328" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static7" Left="8" TabOrder="49" Text="현&#32;상&#32;파&#32;악" Top="424" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static8" Left="8" TabOrder="50" Text="처&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;치" Top="536" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static9" Left="436" TabOrder="51" Text="보&#32;전&#32;방&#32;법" Top="71" VAlign="Middle" Width="92"></Static>
		<Edit Enable="FALSE" Height="20" Id="txtjisno" ImeMode="none" Left="328" MaxLength="15" TabOrder="41" Top="36" UpperOnly="TRUE" Width="141"></Edit>
		<Edit Height="20" Id="txtmshno" Left="104" MaxLength="10" OnKeyDown="txtmshno_OnKeyDown" OnKillFocus="txtmshno_OnKillFocus" TabOrder="2" Top="72" UpperOnly="TRUE" UseIME="FALSE" Width="100"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtmshnm" Left="240" MaxLength="15" Readonly="TRUE" TabOrder="88" TabStop="FALSE" Top="72" UpperOnly="TRUE" Width="192"></Edit>
		<Combo CodeColumn="jobcd" DataColumn="kogub" Height="18" Id="cmbJobCd" InnerDataset="ds_ogm200_method" Left="532" OnChanged="cmbjobcd_OnChanged" OnClick="cmbJobCd_OnClick" TabOrder="4" Top="72" Width="220"></Combo>
		<Button Height="20" Id="Button0" Left="206" OnClick="ogm200_pop_OnClick" TabOrder="3" Text="▶" Top="72" Width="32"></Button>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Height="20" Id="mtbKsDat" Left="104" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="20" Top="328" Width="88"></Calendar>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Height="20" Id="mtbUrDat" Left="104" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="18" Top="296" Width="88"></Calendar>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Height="20" Id="mtbPaDat" Left="104" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="16" Top="264" Width="88"></Calendar>
		<TextArea CheckLength="Byte" Height="48" Id="txtDaech" Left="104" MaxLength="500" OnKeyDown="txtDaech_OnKeyDown" OnKillFocus="txtDaech_OnKillFocus" TabOrder="35" Top="536" Width="616"></TextArea>
		<TextArea CheckLength="Byte" Height="48" Id="txthyosn" Left="104" MaxLength="320" OnKillFocus="txthyosn_OnKillFocus" TabOrder="33" Top="424" Width="616"></TextArea>
		<MaskEdit Align="Center" Height="20" Id="mtbKsTim" Left="192" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="21" Top="328" Type="STRING" Width="64"></MaskEdit>
		<MaskEdit Align="Center" Height="20" Id="mtbUrTim" Left="192" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="19" Top="296" Type="STRING" Width="64"></MaskEdit>
		<MaskEdit Align="Center" Height="20" Id="mtbPaTim" Left="192" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="17" Top="264" Type="STRING" Width="64"></MaskEdit>
		<Edit Height="21" Id="lblKdown" Left="680" TabOrder="43" Top="40" Visible="FALSE" Width="56"></Edit>
		<Edit Height="21" Id="lblsdpcd" Left="744" TabOrder="44" Top="40" Visible="FALSE" Width="64"></Edit>
		<Edit Height="21" Id="lbljisno" Left="568" TabOrder="42" Top="40" Visible="FALSE" Width="56"></Edit>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static11" Left="754" TabOrder="52" Text="기&#32;능&#32;저&#32;하" Top="72" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="downValue" DataColumn="downValue" Height="18" Id="cmbKdown" InnerDataset="ds_cmbKdown" Left="849" OnChanged="cmbKdown_OnChanged" ResetIndex="FIRST" TabOrder="5" Top="72" Width="200"></Combo>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static12" Left="8" TabOrder="53" Text="작&#32;업&#32;완&#32;료" Top="592" VAlign="Middle" Width="92"></Static>
		<Edit Height="20" Id="txtCmplt" Left="104" MaxLength="1" OnKillFocus="txtCmplt_OnKillFocus" TabOrder="37" Top="592" Width="121"></Edit>
		<TextArea CheckLength="Byte" Height="48" Id="txtWonin" Left="104" MaxLength="500" OnKillFocus="txtWonin_OnKillFocus" TabOrder="34" Top="480" Width="616"></TextArea>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static13" Left="8" TabOrder="54" Text="원&#32;인&#32;추&#32;구" Top="480" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static14" Left="8" TabOrder="55" Text="내&#32;외&#32;구&#32;분" Top="104" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="inocd" DataColumn="inoutNm" DisplayRowCnt="5" Height="16" Id="cmbInoCd" InnerDataset="ds_obc020pf" Left="104" OnChanged="cmbInoCd_OnChanged" OnClick="cmbInoCd_OnClick" TabOrder="6" Top="104" Width="328"></Combo>
		<Combo CodeColumn="emgcd" DataColumn="emgNm" Height="18" Id="cmbEmgCd" InnerDataset="ds_obc010pf" Left="532" OnChanged="cmbEmgCd_OnChanged" OnClick="cmbEmgCd_OnClick" TabOrder="7" Top="104" Width="220"></Combo>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static15" Left="436" TabOrder="56" Text="우선도" Top="104" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="qorcd" DataColumn="qornm2" Height="18" Id="cmbQorCd" InnerDataset="ds_obc170pf" Left="849" OnChanged="cmbQorCd_OnChanged" OnClick="cmbQorCd_OnClick" TabOrder="8" Top="104" Width="200"></Combo>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static16" Left="754" TabOrder="57" Text="품질확인" Top="104" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static17" Left="8" TabOrder="58" Text="작&#32;업&#32;개&#32;소" Top="136" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static18" Left="8" TabOrder="59" Text="현&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;상" Top="232" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="hyocd" DataColumn="hyocd" DisplayRowCnt="0" Height="18" Id="cmbHyoCd" InnerDataset="ds_obc180pf" Left="104" OnClick="cmbHyoCd_OnClick" TabOrder="13" Top="231" Width="88"></Combo>
		<Combo CodeColumn="caucd" DataColumn="caucd" DisplayRowCnt="0" Height="18" Id="cmbCauCd" InnerDataset="ds_obc110pf" Left="468" OnClick="cmbCauCd_OnClick" TabOrder="14" Top="232" Width="80"></Combo>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static19" Left="372" TabOrder="60" Text="원&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;인" Top="232" VAlign="Middle" Width="92"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="88" Id="Static20" Left="104" TabOrder="61" Top="136" Width="944"></Static>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static21" Left="136" TabOrder="62" Text="설비부위분류" Top="144" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="subas" DataColumn="assnm2" Height="18" Id="cmbSubas" InnerDataset="ds_obc230pf" Left="112" OnChanged="cmbSubas_OnChanged" OnClick="cmbSubas_OnClick" TabOrder="9" Top="168" Width="142"></Combo>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static22" Left="448" TabOrder="63" Text="ASSY부품" Top="144" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="comcd" DataColumn="comcd" DisplayRowCnt="0" Height="18" Id="cmbComCd" InnerDataset="ds_obc060pf_02" Left="424" OnClick="cmbComCd_OnClick" TabOrder="10" Top="168" Width="142"></Combo>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static23" Left="604" TabOrder="64" Text="단위부품" Top="144" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="deccd" DataColumn="deccd" DisplayRowCnt="0" Height="18" Id="cmbDecCd" InnerDataset="ds_obc050pf_02" Left="581" OnClick="cmbDecCd_OnClick" TabOrder="11" Top="168" Width="142"></Combo>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static24" Left="916" TabOrder="65" Text="처치" Top="144" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="chocd" DataColumn="chonm2" Height="18" Id="cmbChoCd" InnerDataset="ds_obc160pf" Left="893" OnChanged="cmbChoCd_OnChanged" OnClick="cmbChoCd_OnClick" TabOrder="12" Top="168" Width="142"></Combo>
		<Edit Enable="FALSE" Height="20" Id="txtAssNm" Left="112" TabOrder="47" Top="192" Visible="FALSE" Width="140"></Edit>
		<Edit Height="20" Id="txtAssNo" Left="269" MaxLength="32767" Number="TRUE" TabOrder="45" Text="01" Top="168" UseIME="FALSE" Width="140"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtCpart" Left="424" TabOrder="48" Top="192" Width="140"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtDpart" Left="581" TabOrder="49" Top="192" Width="140"></Edit>
		<Edit Height="20" Id="txtPrtNo" Left="738" MaxLength="32767" Number="TRUE" TabOrder="46" Text="001" Top="167" UseIME="FALSE" Width="140"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtChoNm" Left="893" TabOrder="52" Top="193" Visible="FALSE" Width="140"></Edit>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static25" Left="292" TabOrder="66" Text="ASSY&#32;NO" Top="144" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static26" Left="760" TabOrder="67" Text="부품&#32;No" Top="144" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="trucd" DataColumn="trucd" DisplayRowCnt="0" Height="18" Id="cmbTruCd" InnerDataset="ds_obc090pf" Left="828" OnClick="cmbTruCd_OnClick" TabOrder="15" Top="232" Width="80"></Combo>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static27" Left="733" TabOrder="68" Text="실&#32;&#32;&#32;원&#32;&#32;&#32;인" Top="232" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static28" Left="8" TabOrder="69" Text="생산장애시간" Top="392" VAlign="Middle" Width="92"></Static>
		<Static Font="굴림,10" Height="19" Id="Static29" Left="195" TabOrder="70" Text="H" Top="397" Width="21"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" Height="20" Id="txtJanHr" Left="104" LowerOnly="TRUE" MaxLength="5" TabOrder="24" Top="393" UseIME="FALSE" Width="88"></Edit>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static30" Left="372" TabOrder="71" Text="재&#32;발&#32;방&#32;지" Top="392" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="repcd" DataColumn="repnm2" Height="18" Id="cmbRepCd" InnerDataset="ds_obc150pf" Left="469" OnChanged="cmbRepCd_OnChanged" OnClick="cmbRepCd_OnClick" TabOrder="29" Top="392" Width="243"></Combo>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static32" Left="8" TabOrder="72" Text="완&#32;료&#32;일&#32;시" Top="360" VAlign="Middle" Width="92"></Static>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Height="20" Id="mtbWnDat" Left="104" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="22" Top="360" Width="88"></Calendar>
		<MaskEdit Align="Center" Height="20" Id="mtbWnTim" Left="192" Mask="##시##분" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="23" Top="360" Type="STRING" Width="64"></MaskEdit>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="40" Id="Static33" Left="369" TabOrder="73" Top="256" Width="355"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="72" Id="Static34" Left="368" TabOrder="74" Top="305" Width="152"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static35" Left="372" TabOrder="75" Text="수리대기시간" Top="265" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static36" Left="552" TabOrder="76" Text="설비정지시간" Top="265" VAlign="Middle" Width="92"></Static>
		<Edit Align="RIGHT" Enable="FALSE" Height="20" Id="txtWatHr" Left="468" TabOrder="83" TabStop="FALSE" Top="265" Width="80"></Edit>
		<Edit Align="RIGHT" Enable="FALSE" Height="20" Id="txtStpHr" Left="647" TabOrder="82" TabStop="FALSE" Top="265" Width="73"></Edit>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static37" Left="372" TabOrder="77" Text="준비" Top="328" VAlign="Middle" Width="72"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static38" Left="372" TabOrder="78" Text="실보전시간" Top="353" VAlign="Middle" Width="72"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" Height="20" Id="txtBfrHr" Left="448" MaxLength="6" TabOrder="25" Top="328" UseIME="FALSE" Width="48"></Edit>
		<Edit Align="RIGHT" AutoSelect="TRUE" Height="20" Id="txtWrkHr" Left="448" MaxLength="6" TabOrder="26" Top="352" UseIME="FALSE" Width="48"></Edit>
		<Static Height="13" Id="Static39" Left="500" TabOrder="79" Text="분" Top="331" Width="20"></Static>
		<Static Height="13" Id="Static40" Left="500" TabOrder="80" Text="분" Top="355" Width="20"></Static>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static42" Left="372" TabOrder="81" Text="작업시간" Top="306" VAlign="Middle" Width="72"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="120" Id="Static41" Left="730" TabOrder="82" Top="256" Width="318"></Static>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static43" Left="733" TabOrder="83" Text="외&#32;주&#32;업&#32;자" Top="265" VAlign="Middle" Width="92"></Static>
		<TextArea Height="55" Id="txtSubCn" Left="736" MaxLength="40" TabOrder="30" Top="288" Width="307"></TextArea>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static44" Left="856" TabOrder="84" Text="비용" Top="350" VAlign="Middle" Width="56"></Static>
		<Edit Align="RIGHT" Height="20" Id="txtSCost" Left="913" MaxLength="9" TabOrder="31" Text="0" Top="350" UseIME="FALSE" Width="98"></Edit>
		<Static Height="15" Id="Static45" Left="1016" TabOrder="85" Text="천원" Top="352" Width="26"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static46" Left="733" TabOrder="86" Text="효&#32;과&#32;구&#32;분" Top="392" VAlign="Middle" Width="92"></Static>
		<Combo CodeColumn="effcd" DataColumn="effcd" DisplayRowCnt="0" Height="18" Id="cmbEffCd" InnerDataset="ds_obc200pf" Left="828" OnClick="cmbEffCd_OnClick" TabOrder="32" Top="392" Width="56"></Combo>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static47" Left="828" TabOrder="89" Text="비용" Top="422" VAlign="Middle" Width="56"></Static>
		<Edit Align="RIGHT" Enable="FALSE" Height="20" Id="txtECost" Left="888" MaxLength="8" TabOrder="38" Text="txtECost" Top="422" UseIME="FALSE" Width="128"></Edit>
		<Static Height="15" Id="Static48" Left="1024" TabOrder="91" Text="천원" Top="424" Width="26"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static49" Left="828" TabOrder="93" Text="비용" Top="446" VAlign="Middle" Width="56"></Static>
		<Edit Align="RIGHT" Enable="FALSE" Height="20" Id="txtPCost" Left="888" TabOrder="39" Text="txtPCost" Top="448" UseIME="FALSE" Width="127"></Edit>
		<Static Height="15" Id="Static50" Left="1024" TabOrder="94" Text="천원" Top="448" Width="26"></Static>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static1" Left="8" TabOrder="106" Text="사&#32;&#32;&#32;업&#32;&#32;&#32;부" Top="36" VAlign="Middle" Width="92"></Static>
		<Grid BindDataset="ds_obc190pf" BkColor2="default" BoldHead="true" Bottom="416" Enable="true" EndLineColor="default" Height="160" Id="Grid_cmbHyoCd" InputPanel="FALSE" Left="104" LineColor="default" OnCellClick="Grid_cmbHyoCd_OnCellClick" Right="224" RowHeight="20" TabOrder="57" TabStop="true" Top="256" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="120">
			<contents>
				<format id="Default">
					<columns>
						<col width="92"/>
					</columns>
					<body>
						<cell col="0" colid="hkdnm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc180pf" BkColor2="default" BoldHead="true" Bottom="416" Enable="true" EndLineColor="default" Height="160" Id="PopHKndCd" InputPanel="FALSE" Left="104" LineColor="default" OnCellClick="PopHKndCd_OnCellClick" Right="384" RowHeight="20" TabOrder="58" TabStop="true" Top="256" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="280">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="75"/>
						<col width="145"/>
					</columns>
					<body>
						<cell col="0" colid="hyocd" display="text"/>
						<cell col="1" colid="hkdnm" display="text"/>
						<cell col="2" colid="hyonm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit Enable="FALSE" Height="20" Id="txtHyoNm" Left="192" TabOrder="59" Top="232" Width="168"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtCauNm" Left="552" TabOrder="62" Top="232" Width="168"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtTruNm" Left="909" TabOrder="63" Top="232" Width="139"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtEffNm" Left="888" TabOrder="66" Top="392" Width="160"></Edit>
		<Edit Height="21" Id="lblcallpart" Left="488" TabOrder="69" TabStop="FALSE" Top="40" Visible="FALSE" Width="64"></Edit>
		<Edit Height="21" Id="lblIsStatusError" Left="488" TabOrder="70" TabStop="FALSE" Top="24" Visible="FALSE" Width="64"></Edit>
		<Edit Height="21" Id="lblIsSelectedCancel" Left="488" TabOrder="71" TabStop="FALSE" Top="8" Visible="FALSE" Width="64"></Edit>
		<Edit Height="21" Id="lbldptcd" Left="680" TabOrder="72" TabStop="FALSE" Top="16" Visible="FALSE" Width="48"></Edit>
		<Edit Height="21" Id="lblPrtCd" Left="568" TabOrder="73" TabStop="FALSE" Top="16" Visible="FALSE" Width="51"></Edit>
		<Edit Height="21" Id="lblNewOrEdit" Left="624" TabOrder="74" TabStop="FALSE" Top="40" Visible="FALSE" Width="48"></Edit>
		<Edit Height="21" Id="lblTimCd" Left="744" TabOrder="75" TabStop="FALSE" Top="16" Visible="FALSE" Width="64"></Edit>
		<Edit Height="21" Id="lblcallboard" Left="624" TabOrder="76" TabStop="FALSE" Top="16" Visible="FALSE" Width="48"></Edit>
		<Edit Align="CENTER" BKColor="black" Color="white" Font="굴림,9,Bold" Height="21" Id="lblCmplt" Left="232" OnCharChanged="lblCmplt_OnCharChanged" TabOrder="85" TabStop="FALSE" Text="미완료" Top="592" Width="54"></Edit>
		<Grid BindDataset="ds_obj220pf" BkColor2="default" BoldHead="true" Bottom="552" Enable="true" EndLineColor="default" Height="80" Id="Grid0" InputPanel="FALSE" Left="733" LineColor="default" Right="1048" TabOrder="84" TabStop="FALSE" Top="472" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="315">
			<contents>
				<format id="Default">
					<columns>
						<col width="69"/>
						<col width="107"/>
						<col width="39"/>
						<col width="80"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" display="text" text="부품명"/>
						<cell bkcolor="#dfdfdf" col="1" display="text" text="규격"/>
						<cell bkcolor="#dfdfdf" col="2" display="text" text="수량"/>
						<cell bkcolor="#dfdfdf" col="3" display="text" text="금액"/>
					</head>
					<body>
						<cell col="0" colid="prtnm" display="text"/>
						<cell col="1" colid="ptype" display="text"/>
						<cell align="center" col="2" colid="quaty" display="text"/>
						<cell align="right" col="3" colid="AMONT" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static52" Left="733" TabOrder="134" Text="비&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;고" Top="560" VAlign="Middle" Width="92"></Static>
		<TextArea CheckLength="Byte" Height="52" Id="txtCNote" Left="832" MaxLength="60" OnKillFocus="txtCNote_OnKillFocus" TabOrder="36" Top="560" Width="219"></TextArea>
		<Grid BindDataset="ds_obc210pf" BkColor2="default" BoldHead="true" Bottom="501" Enable="true" EndLineColor="default" Height="85" Id="Grid_cmbEffCd" InputPanel="FALSE" Left="828" LineColor="default" OnCellClick="Grid_cmbEffCd_OnCellClick" Right="916" RowHeight="20" TabOrder="67" TabStop="true" Top="416" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="88">
			<contents>
				<format id="Default">
					<columns>
						<col width="65"/>
					</columns>
					<body>
						<cell col="0" colid="ekdnm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Font="굴림,9,Bold" Height="26" Id="btnChnPrt" ImageID="btn2_exch2" Left="736" OnClick="btnChnPrt_OnClick" TabOrder="78" TabStop="FALSE" Top="443" Width="75"></Button>
		<Button Font="굴림,9,Bold" Height="26" Id="brd3btneffdet" ImageID="btn2_impr2" Left="736" OnClick="brd3btneffdet_OnClick" TabOrder="77" TabStop="FALSE" Top="416" Width="75"></Button>
		<Button Height="26" Id="brd3btncfile" ImageID="btn2_appe2" Left="811" OnClick="brd3btncfile_OnClick" TabOrder="79" TabStop="FALSE" Text="Button1" Top="34" Width="75"></Button>
		<Button Height="25" Id="btnprint" ImageID="btn2_publ2" Left="888" OnClick="btnprint_OnClick" TabOrder="80" TabStop="FALSE" Text="Button1" Top="34" Width="75"></Button>
		<Static Height="13" Id="Static51" Left="291" TabOrder="140" Text="작업완료에&#32;공란이면&#32;미완료,&apos;1&apos;이면&#32;완료입니다." Top="595" VAlign="Middle" Width="269"></Static>
		<Button Height="26" Id="btnClear" ImageID="btn2_indi2" Left="966" OnClick="btnClear_OnClick" TabOrder="81" TabStop="FALSE" Text="표시클리어" Top="34" Width="85"></Button>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="72" Id="Static53" Left="524" TabOrder="142" Top="304" Width="200"></Static>
		<Grid BindDataset="ds_obc070pf" BkColor2="default" BoldHead="true" Bottom="277" Enable="true" EndLineColor="default" Height="85" Id="Grid_cmbDecCd" InputPanel="FALSE" Left="584" LineColor="default" OnCellClick="Grid_cmbDecCd_OnCellClick" Right="768" RowHeight="20" TabOrder="54" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="184">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="130"/>
					</columns>
					<body>
						<cell col="0" colid="kndcd" combotext="kndcd" display="text"/>
						<cell col="1" colid="kndnm" combotext="kndnm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit Enable="FALSE" Height="20" Id="txtkornm" Left="664" MaxLength="15" Readonly="TRUE" TabOrder="86" TabStop="FALSE" Top="328" UpperOnly="TRUE" Width="56"></Edit>
		<Edit Height="20" Id="txtwrkm1" Left="600" MaxLength="7" Number="TRUE" OnKeyDown="txtwrkm1_OnKeyDown" OnKillFocus="txtwrkm1_OnKillFocus" TabOrder="27" Top="328" UpperOnly="TRUE" UseIME="FALSE" Width="64"></Edit>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static55" Left="528" TabOrder="144" Text="책&#32;&#32;&#32;임&#32;&#32;&#32;자" Top="328" VAlign="Middle" Width="72"></Static>
		<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="20" Id="Static10" Left="528" TabOrder="145" Text="부&#32;책&#32;임&#32;자" Top="353" VAlign="Middle" Width="72"></Static>
		<Edit Height="20" Id="txtWrkm2" Left="600" MaxLength="7" Number="TRUE" OnKeyDown="txtWrkm2_OnKeyDown" OnKillFocus="txtWrkm2_OnKillFocus" TabOrder="28" Top="353" UpperOnly="TRUE" UseIME="FALSE" Width="64"></Edit>
		<Edit Enable="FALSE" Height="20" Id="txtKorNm2" Left="664" MaxLength="15" Readonly="TRUE" TabOrder="87" TabStop="FALSE" Top="353" UpperOnly="TRUE" Width="56"></Edit>
		<Grid BindDataset="ds_obc200pf" BkColor2="default" BoldHead="true" Bottom="566" Enable="true" EndLineColor="default" Height="150" Id="PopEKndCd" InputPanel="FALSE" Left="804" LineColor="default" OnCellClick="PopEKndCd_OnCellClick" Right="1054" RowHeight="20" TabOrder="68" TabStop="true" Top="416" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="250">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="195"/>
					</columns>
					<body>
						<cell col="0" colid="effcd" display="text"/>
						<cell col="1" colid="effnm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc100pf" BkColor2="default" BoldHead="true" Bottom="406" Enable="true" EndLineColor="default" Height="150" Id="Grid_cmbTruCd" InputPanel="FALSE" Left="827" LineColor="default" OnCellClick="Grid_cmbTruCd_OnCellClick" Right="927" RowHeight="20" TabOrder="65" TabStop="true" Top="256" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="100">
			<contents>
				<format id="Default">
					<columns>
						<col width="70"/>
					</columns>
					<body>
						<cell col="0" colid="tkdnm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc090pf" BkColor2="default" BoldHead="true" Bottom="406" Enable="true" EndLineColor="default" Height="150" Id="PopTKndCd" InputPanel="FALSE" Left="827" LineColor="default" OnCellClick="PopTKndCd_OnCellClick" Right="1052" RowHeight="20" TabOrder="64" TabStop="true" Top="256" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="225">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="50"/>
						<col width="120"/>
					</columns>
					<body>
						<cell col="0" colid="trucd" display="text"/>
						<cell col="1" colid="tkdnm" display="text"/>
						<cell col="2" colid="trunm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc220pf" BkColor2="default" BoldHead="true" Bottom="277" Enable="true" EndLineColor="default" Height="85" Id="Grid_cmbComCd" InputPanel="FALSE" Left="424" LineColor="default" OnCellClick="Grid_cmbComCd_OnCellClick" Right="608" RowHeight="20" TabOrder="50" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="184">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="131"/>
					</columns>
					<body>
						<cell col="0" colid="kndcd" combotext="kndcd" display="text"/>
						<cell col="1" colid="kndnm" combotext="kndnm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc060pf_01" BkColor2="default" BoldHead="true" Bottom="336" Enable="true" EndLineColor="default" Height="144" Id="PopKndCd" InputPanel="FALSE" Left="424" LineColor="default" OnCellClick="PopKndCd_OnCellClick" Right="496" RowHeight="20" TabOrder="51" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="72">
			<contents>
				<format id="Default">
					<columns>
						<col width="47"/>
					</columns>
					<body>
						<cell col="0" colid="umhen" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Border="Flat" BorderColor="white" Font="굴림,9,Bold" Height="20" Id="Static54" Left="532" TabOrder="143" Text="책&#32;&#32;&#32;임" Top="306" VAlign="Middle" Width="72"></Static>
		<Grid BindDataset="ds_obc060pf_02" BkColor2="default" BoldHead="true" Bottom="342" Enable="true" EndLineColor="default" Height="150" Id="PopUmhen" InputPanel="FALSE" Left="424" LineColor="default" OnCellClick="PopUmhen_OnCellClick" Right="624" RowHeight="20" TabOrder="53" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="200">
			<contents>
				<format id="Default">
					<columns>
						<col width="41"/>
						<col width="130"/>
					</columns>
					<body>
						<cell col="0" colid="comcd" display="text"/>
						<cell col="1" colid="cpart" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc050pf_01" BkColor2="default" BoldHead="true" Bottom="342" Enable="true" EndLineColor="default" Height="150" Id="PopDKndCd" InputPanel="FALSE" Left="584" LineColor="default" OnCellClick="PopDKndCd_OnCellClick" Right="656" RowHeight="20" TabOrder="55" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="72">
			<contents>
				<format id="Default">
					<columns>
						<col width="47"/>
					</columns>
					<body>
						<cell col="0" colid="umhen" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc050pf_02" BkColor2="default" BoldHead="true" Bottom="342" Enable="true" EndLineColor="default" Height="150" Id="PopDUmhen" InputPanel="FALSE" Left="584" LineColor="default" OnCellClick="PopDUmhen_OnCellClick" Right="784" RowHeight="20" TabOrder="56" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="200">
			<contents>
				<format id="Default">
					<columns>
						<col width="41"/>
						<col width="130"/>
					</columns>
					<body>
						<cell col="0" colid="deccd" display="text"/>
						<cell col="1" colid="dpart" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc120pf" BkColor2="default" BoldHead="true" Bottom="406" Enable="true" EndLineColor="default" Height="150" Id="Grid_cmbCauCd" InputPanel="FALSE" Left="468" LineColor="default" OnCellClick="Grid_cmbCauCd_OnCellClick" Right="588" RowHeight="20" TabOrder="60" TabStop="true" Top="256" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="120">
			<contents>
				<format id="Default">
					<columns>
						<col width="92"/>
					</columns>
					<body>
						<cell col="0" colid="ckdnm" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_obc110pf" BkColor2="default" BoldHead="true" Bottom="406" Enable="true" EndLineColor="default" Height="150" Id="PopCkndCd" InputPanel="FALSE" Left="468" LineColor="default" OnCellClick="PopCkndCd_OnCellClick" Right="732" RowHeight="20" TabOrder="61" TabStop="true" Top="256" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="264">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="75"/>
						<col width="130"/>
					</columns>
					<body>
						<cell col="0" colid="caucd" display="text"/>
						<cell col="1" colid="ckdnm" display="text"/>
						<cell col="2" colid="cause" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : Jae hb
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : ogm203.xml
 * ● PROGRAM DESCRIPTION  : 신규이력등록
 * ● DATE WRITTEN         : 2011.08.31
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");
var nowDate = today(); //날짜
var nowTime = GetDate(); //시간
var h=substr(nowTime,8,4); //시

var imgVpath=G_baseURL+"DIONE_UPDOWN_FILE";

var userId = G_ds_user.GetColumn(0,"USER_ID");
var userNm = G_ds_user.GetColumn(0,"USER_NAME");

var adusr =substr(userId,1,7);
var adusrNm =userNm; //책임자Nm

var gmshnm;
var	gprtcd;		
var	gtimcd;
var	WatHr="";
var	StpHr="";
var MntHr="";
var PlantCd;  //지시no 입력시 사업부구분
var KndCd=""; //ASSY부품_PopKndCd 조회시사용
var umhen=""; //ASSY부품_PopUmhen 조회시사용
var dKndCd=""; //단위부품_PopKndCd 조회시사용
var dumhen=""; //단위부품_PopUmhen 조회시사용
var hKind=""; //현상_cmbHyoCd 조회시사용
var cKind=""; //현상_PopCkndCd 조회시사용
var tKind=""; //실원인_PopTKndCd조회
var NoCnt=1;
var flag="";
var g_userclass=""; //권한등급 Param

function on_LoadCompleted(obj){
	
	getTitle();	
	getDesign();
	getComCode(); //공장구분 선택
	//mtbKsDat.Text =nowDate; //개시날짜

	//mtbKsTim.Text =h; //개시시각
	txtwrkm1.Text =substr(userId,1,7); //책임자ID
	txtkornm.Text =userNm; //책임자Nm
	ogm200_jisno(); //지시no
	//getogm200_method(); //보전방법
	//getogm203_cmbInoCd(); //내외구분
	//getogm203_cmbEmgCd(); //우선도
	//getogm203_cmbQorCd(); //품질확인
	//getogm203_cmbSubas(); //설비부위분류
	//getogm203_cmbRepCd(); //재발방지
	//getogm203_cmbChoCd(); //처치
	
	//Default value
	//cmbKdown.Value = "0";
	txtJanHr.Text = "0.0";
	txtBfrHr.Text = "0.0";
	txtWrkHr.Text = "0.0";
	txtSCost.Text = "0";
	txtECost.Text = "0";
	txtPCost.Text = "0";
	
	gFcOnTopButtonColor("2.5"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
	//InqIryok();
	managerYN(Lib2, ComboBoxPlant.Value, "2", G_ds_user.GetColumn(0,"USER_ID"));
	g_userclass=trim(ds_managerYN.GetColumn(0,"MAGER"));
	

}

function getComCode(){
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		sArgument   += " CODE1=" + quote(company);		
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ComboBoxPlant.Value=comps;
	ComboBoxPlant.Enable = false; 
}

function getDesign(){	
	searchBar.Width = G_ds_design.GetColumn(0,"Width");
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	
}


function inqParts(){
	var sKind		= "inqParts";						
	var sMethodName = "service::psogmlib/selectOgm219_obj220pf_InqParts.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obj220pf=ds_obj220pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 보전방법조회
 **********************************************************************/ 
 
function getogm200_method()
{
	var sKind		= "getogm200_method";						
	var sMethodName = "service::psogmlib/selectOgm200_method.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm200_method=ds_ogm200_method";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : insert, update, delete
 **********************************************************************/ 	
function setogm203(){

	txtmshno.BKColor= "white";
	txtWrkm1.BKColor= "white";
	txtHyosn.BKColor= "white";
	txtmshno.BKColor= "white";
	cmbJobCd.BKColor= "white";
	cmbInoCd.BKColor= "white";
	cmbEmgCd.BKColor= "white";
	cmbQorCd.BKColor= "white";
	cmbSubas.BKColor= "white";
	txtAssNo.BKColor= "white";
	cmbComCd.BKColor= "white";
	cmbDecCd.BKColor= "white";
	txtPrtNo.BKColor= "white";
	cmbChoCd.BKColor= "white";
	cmbHyoCd.BKColor= "white";
	cmbCauCd.BKColor= "white";
	cmbTruCd.BKColor= "white";
	mtbPaDat.BKColor= "white";
	mtbPaTim.BKColor= "white";
	mtbUrDat.BKColor= "white";
	mtbUrTim.BKColor= "white";
	cmbKdown.BKColor= "white";
	mtbKsDat.BKColor= "white";
	mtbKsTim.BKColor= "white";
	mtbWnDat.BKColor= "white";
	mtbWnTim.BKColor= "white";
	txtBfrHr.BKColor= "white";
	txtWrkHr.BKColor= "white";
	txtJanHr.BKColor= "white";
	cmbRepCd.BKColor= "white";
	txtECost.BKColor= "white";
	txtHyosn.BKColor= "white";
	txtWonin.BKColor= "white";
	txtDaech.BKColor= "white";
	txtWrkm1.BKColor= "white";
		
var rslt=true;
if(!validationChk()){
	rslt=false;
}
else {
//-------------------------------------
	
	var BfrHrValue="";
	var WrkHrValue="";
	if(parseInt(trim(txtBfrHr.Text)) == 0)
		 BfrHrValue = 0;
	else
		 BfrHrValue = (parseFloat(txtBfrHr.Text)/60);
		
	if(parseInt(trim(txtWrkHr.Text)) == 0)
		 WrkHrValue = 0;
	else
		 WrkHrValue = (parseFloat(txtWrkHr.Text)/60);
		
	var TotHr = (BfrHrValue + WrkHrValue);
	
	var Padat = mtbPaDat.Value;
	if (Padat == "") Padat = "0";
				
	var UrDat = mtbUrDat.Value;
	if (UrDat == "") UrDat = "0";
	
	var WnDat = mtbWnDat.Value;
	if (WnDat == "") WnDat = "0";

	var Wrkm2 = trim(txtWrkm2.Text);
	if (length(Wrkm2) == 0) Wrkm2 = "0";


	if(!flag_chk()){
		return false;
	}
//alert(flag);

	var sKind		= "setogm203";						
	var sMethodName = "service::psogmlib/saveOGM203.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";               //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "";    							     // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	sArgument += " LIB2=" + quote(Lib2);
	sArgument += " FLAG=" + quote(trim(flag));
	sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
	//sArgument += " JISNO=" + quote(PlantCd);
	sArgument += " JISNO=" + quote(txtjisno.Text);
	sArgument += " TIMCD=" + quote(trim(lblTimCd.Text));
	sArgument += " PRTCD=" + quote(trim(lblPrtCd.Text));
	sArgument += " MSHNO=" + quote(trim(txtmshno.Text));
	sArgument += " DPTCD=" + quote(lbldptcd.Value);
	sArgument += " SDPCD=" + quote(lblsdpcd.Value);
	sArgument += " JOBCD=" + quote(cmbJobCd.Value);				
	sArgument += " KDOWN=" + quote(cmbKdown.Value);
	sArgument += " INOCD=" + quote(cmbInoCd.Value);
	sArgument += " EMGCD=" + quote(cmbEmgCd.Value);
	sArgument += " QORCD=" + quote(cmbQorCd.Value);
	sArgument += " SUBAS=" + quote(cmbSubas.Value);
	sArgument += " ASSNO=" + quote(trim(txtAssNo.Text));
	sArgument += " COMCD=" + quote(cmbComCd.Value);
	sArgument += " DECCD=" + quote(cmbDecCd.Value);
	sArgument += " PRTNO=" + quote(trim(txtPrtNo.Text));
	sArgument += " CHOCD=" + quote(cmbChoCd.Value);
	sArgument += " HYOCD=" + quote(cmbHyoCd.Value);
	sArgument += " CAUCD=" + quote(cmbCauCd.Value);
	sArgument += " TRUCD=" + quote(cmbTruCd.Value);
	sArgument += " PADAT=" + quote(Padat);
	sArgument += " PATIM=" + quote(mtbPaTim.Value);
	sArgument += " URDAT=" + quote(UrDat);
	sArgument += " URTIM=" + quote(mtbUrTim.Value);
	sArgument += " KSDAT=" + quote(mtbKsDat.Value);
	sArgument += " KSTIM=" + quote(mtbKsTim.Value);
	sArgument += " WNDAT=" + quote(WnDat);
	sArgument += " WNTIM=" + quote(mtbWnTim.Value);
	sArgument += " WRKM1=" + quote(trim(txtWrkm1.Text));
	sArgument += " WRKM2=" + quote(Wrkm2);
	sArgument += " SUBCN=" + quote(trim(txtSubCn.Text));
	sArgument += " SCOST=" + quote(trim(txtSCost.Text));
	sArgument += " PCOST=" + quote(trim(txtPCost.Text));
	sArgument += " REPCD=" + quote(cmbRepCd.Value);
	sArgument += " EFFCD=" + quote(cmbEffCd.Value);
	sArgument += " ECOST=" + quote(trim(txtECost.Text));
	sArgument += " HYOSN=" + quote(trim(txtHyosn.Text));
	sArgument += " WONIN=" + quote(trim(txtWonin.Text));
	sArgument += " DAECH=" + quote(trim(txtDaech.Text));
	sArgument += " JANHR=" + quote(parseFloat(trim(txtJanHr.Text)));
	sArgument += " WATHR=" + quote(parseFloat(trim(txtWatHr.Text)));
	sArgument += " STPHR=" + quote(parseFloat(trim(txtStpHr.Text)));
	sArgument += " MNTHR=" + quote(parseFloat(trim(MntHr)));
	sArgument += " BFRHR=" + quote(parseFloat(trim(txtBfrHr.Text)));
	sArgument += " WRKHR=" + quote(parseFloat(trim(txtWrkHr.Text)));
	sArgument += " TOTHR=" + quote(Round(TotHr,'1'));
	sArgument += " CMPLT=" + quote(trim(txtCmplt.Text));
	sArgument += " NOCNT=" + quote(NoCnt);
	sArgument += " CNOTE=" + quote(trim(txtCNote.Text));
	sArgument += " ADDAT=" + quote(parseInt(nowDate));
	sArgument += " ADTIM=" + quote(h);
	sArgument += " ADUSR=" + quote(adusr);
	sArgument += " CHDAT=" + quote(parseInt(nowDate));
	sArgument += " CHTIM=" + quote(h);
	sArgument += " CHUSR=" + quote(adusr);

	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync = false;
	
	
		if(trim(lblcallpart.Text) != "partbfr" && trim(lblcallpart.Text) != "partaft") 
		//lblcallpart = 'partbft' 또는 'partaft'인 경우 개선상세나 교환부품에서 부분저장을 요구한 경우임
		{
			if(trim(txtCmplt.Text) == "1") //완료등록을 하겠다고 선택한 경우
			{
				if(trim(cmbRepCd.Value) == "1") //재발방지코드가 1.재발방지가 필요한 수리인 경우
				{
					getogm203_pepcdChk();
				}
			}
		}		
	}
	return rslt;
}

/********************************************************************** 
 * 내용설명 : 삭제
 **********************************************************************/ 
 function chk_ogm203Del(){
	
	var msg = "삭제를 하시겠습니까?";
	
	if(Confirm(msg)){
		if (length(trim(txtjisno.Value)) == 0)
			{
				alert(setPopMessage("3034"));
				return;
			}
	
			var jisno = trim(txtjisno.Text);
			
			//첨부파일삭제처리
			getOgm219_obj230pf();
//alert(ds_obj230pf.GetRowCount());						
			
			if (ds_obj230pf.GetRowCount() > 0){
				var dcomps = ComboBoxPlant.Value;
				var djisno = trim(txtjisno.Text);
				var dtname = "obj230pf";
				var flag="0";
//alert("첨부파일삭제처리");						
				setogm203Del(dcomps, djisno, dtname, flag);
			}
			//교환부품삭제처리
			getOgm219_inqParts();
//alert(ds_obj220pf_del.GetRowCount());						
			if (ds_obj220pf_del.GetRowCount()>0){
				var dcomps = ComboBoxPlant.Value;
				var djisno = trim(txtjisno.Text);
				var dtname = "obj220pf";
				var flag="1";
				setogm203Del(dcomps, djisno, dtname, flag);
//alert("교환부품삭제처리");						
			}
			//개선상세삭제처리
			getogm204_obj210pf_01();
//alert(ds_obj210pf_01.GetRowCount());						
			if (ds_obj210pf_01.GetRowCount()>0){
				var dcomps = ComboBoxPlant.Value;
				var djisno = trim(txtjisno.Text);
				var dtname = "obj210pf";
				var flag="2";
				setogm203Del(dcomps, djisno, dtname, flag);
//alert("개선상세삭제처리");						
			}
			
			//설비이력삭제처리
			var dcomps = ComboBoxPlant.Value;
			var djisno = trim(txtjisno.Text);
			var dtname = "obj200pf";
			var flag="3";
			setogm203Del(dcomps, djisno, dtname, flag);
			text_clear();

//alert("설비이력삭제처리");						
		}
	else{
		return;
	}
}

function setogm203Del(dcomps, djisno, dtname, flag){

	var sKind		= "setogm203Del";						
	var sMethodName = "service::psogmlib/delOGM203.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";               //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "";    							     // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	sArgument += " LIB2=" + quote(Lib2);
	sArgument += " TNAME=" + quote(dtname); //TABLE명
	sArgument += " DCOMPS=" + quote(dcomps);
	sArgument += " DJISNO=" + quote(djisno);
	http.Sync = true;
	if(flag == "3"){
		Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	}
	else {
		Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	}
	http.Sync = false;
	
}

/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){
		alert(setPopMessage("1002"));
		setMessage("1002");
	// tran 성공	
	}else if(svcId=="setogm203"){
		alert(setPopMessage("1001"));
		setMessage("1001");
		//삭제
	}
	else if(svcId=="setogm203Del"){
		alert(setPopMessage("1001"));
		setMessage("1001");
	//교환부품등록
	}
	else if(svcId=="setogm205"){
		alert(setPopMessage("1001"));
		setMessage("1001");
	//교환부품삭제
	}else if(svcId=="setogm205_delete"){
		alert(setPopMessage("1001"));
		setMessage("1001");
	//개선상세 도면등록
	}else if(svcId=="setogm204_obj210pf_addimg"){
		alert(setPopMessage("1001"));
		setMessage("1001");
	//개선상세 등록
	}else if(svcId=="setogm204_obj210pf_insert"){
		alert(setPopMessage("1001"));
		setMessage("1001");
	}
}

/********************************************************************** 
 * 내용설명 : 데이터셋 상태 체크
 **********************************************************************/ 
function ds_ogm200_OnRowPosChanged(obj,nOldRow,nRow){
	//로우타입 insert만 ED박스 enable
	if(ds_ogm200.GetRowType(ds_ogm200.currow)=="insert"){
		ed_maker.Enable=true;
	}else{
		ed_maker.Enable=false;
	}
}


/********************************************************************** 
 * 내용설명 : validation 체크
 **********************************************************************/ 
function validationChk(){
	
	lblIsStatusError.Text = "N";
	var msg="";
	//var rslt=true;
	
	//////////////////////////////////////////////////////////////////////////
	//1. 필수입력필드체크부분                                                  //
	//2. 완료등록,미완료등록일때 jobcd의 값(PM,CM,BM)에 따라 에러체크 처리 하는 부분 //
	/////////////////////////////////////////////////////////////////////////
	
	//1. 필수입력필드 체크
	if(length(trim(txtmshno.Text)) == 0 || length(trim(txtWrkm1.Text)) == 0 || length(trim(txtHyosn.Text)) == 0 || mtbKsDat.Value == "" || mtbKsTim.Value == "")
	{
		alert(setPopMessage("3000"));
		
		if(length(trim(txtmshno.Text)) == 0)
			txtmshno.BKColor= "paleturquoise";
		if(length(trim(txtWrkm1.Text)) == 0)
			txtWrkm1.BKColor= "paleturquoise";
		if(length(trim(txtHyosn.Text)) == 0)
			txtHyosn.BKColor= "paleturquoise";
		if(mtbKsDat.Value == "")
			mtbKsDat.BKColor= "paleturquoise";
		if(mtbKsTim.Value == "")
			mtbKsTim.BKColor= "paleturquoise";			
			
		lblIsStatusError.Text = "N";  //Y는 에러상태,N는 미에러상태
	
		return false;
	}
	
	//2. 완료등록,미완료등록일때 jobcd의 값(PM,CM,BM)에 따라 에러체크 처리 하는 부분 
	if(trim(txtCmplt.Value) == "1") //완료등록일 경우
	{


		var chk = check_data203();
		if (chk != true) 
		{
			alert(setPopMessage("3000"));
			return false;
		}
		
		if (cmbKdown.Value == "")
		{
			alert(setPopMessage("3018"));
			return false;
		}
		if(length(trim(txtJanHr.Text)) != 0)
		{
			if(parseFloat(trim(txtJanHr.Text)) < 0)
			{
				alert(setPopMessage("3007"));
				return false;
			}
		}
		else
		{
			alert(setPopMessage("3008"));
			return false;
		}
	
		if(length(trim(txtBfrHr.Text)) != 0)
		{
			if(parseFloat(trim(txtBfrHr.Text)) < 0)
			{
				alert(setPopMessage("3009"));
				return false;
			}
		}
		else
		{
				alert(setPopMessage("3010"));
		return false;
		}
			
		if(length(trim(txtWrkHr.Text)) != 0)
		{
			if(parseFloat(trim(txtWrkHr.Text)) < 0)
			{
				alert(setPopMessage("3011"));
			return false;
			}
		}	
		else
		{
			alert(setPopMessage("3012"));
			return false;
		}
	}
		
	//시각법칙 위반체크 및 수리대기시간,정지시간을 구한다.
	if(trim(lblcallpart.Text) != "partbfr" && trim(lblcallpart.Text) != "partaft") 
	{
		
		if(length(trim(mtbPaTim.Value)) != 0)
		{
		//timeChk_OnKillFocus(mtbPaTim);
			var mtb = substr(mtbPaTim.Text,0,2)+ substr(mtbPaTim.Text,3,2);
			mtbPaTim.Value = ReplaceToZero(mtb);
			var patim = trim(mtbPaTim.Value);
			var hour = patim.substr(0,2);
			var min = patim.substr(2,2);
	
			if((hour < 00 || hour > 24) || (min < 00 || min > 60)){
				alert(setPopMessage("3020"));
			return false;
			}
			
		}
				
		if(length(trim(mtbUrTim.Value)) != 0)
		{
			var mtb = substr(mtbUrTim.Text,0,2)+ substr(mtbUrTim.Text,3,2);
			mtbUrTim.value= ReplaceToZero(mtb);
			var urtim = trim(mtbUrTim.Value);
			var hour = urtim.substr(0,2);
			var min = urtim.substr(2,2);
		
			if((hour < 00 || hour > 24) || (min < 00 || min > 60))
			{
				alert(setPopMessage("3021"));
			return false;
			}
		}
		
		if(length(trim(mtbKsTim.Value)) != 0)
		{
			var mtb = substr(mtbKsTim.Text,0,2)+ substr(mtbKsTim.Text,3,2);
			mtbKsTim.value= ReplaceToZero(mtb);
			var kstim = trim(mtbKsTim.Value);
			var hour = kstim.substr(0,2);
			var min = kstim.substr(2,2);
		
			if((hour < 00 || hour > 24) || (min < 00 || min > 60))
			{
				alert(setPopMessage("3022"));
			return false;
			}
		}
				
		if(length(trim(mtbWnTim.Value)) != 0)
		{
			var mtb = substr(mtbWnTim.Text,0,2)+ substr(mtbWnTim.Text,3,2);
			mtbWnTim.value= ReplaceToZero(mtb);
			var wntim = trim(mtbWnTim.Value);
			var hour = wntim.substr(0,2);
			var min = wntim.substr(2,2);
		
			if((hour < 00 || hour > 24) || (min < 00 || min > 60))
			{
				alert(setPopMessage("3023"));
			return false;
			}
		}
	}
	if(trim(cmbJobCd.Value) == "21" || trim(cmbJobCd.Value) == "22")
	{
		if(length(mtbPaDat.Value) == 0 || length(mtbPaTim.Value) == 0 ){ 
				alert(setPopMessage("3002"));
		return false;
		}
		if(length(trim(mtbUrDat.Value)) == 0 || length(trim(mtbUrTim.Value)) == 0 ){
				alert(setPopMessage("3003"));
		return false;
		}
		
		var PaValue = mtbPaDat.Value+mtbPaTim.Value;
		var UrValue = mtbUrDat.Value+mtbUrTim.Value;
		
		if(PaValue > UrValue)
		{
			alert(setPopMessage("3004"));
			return false;
		}
		
		if(length(trim(mtbKsDat.Value)) == 0 || length(trim(mtbKsTim.Value)) == 0 ){
			alert(setPopMessage("3005"));
			return false;
		}
		
		var KsValue = mtbKsDat.Value + mtbKsTim.Value;
		
		if(KsValue < UrValue)
		{
			alert(setPopMessage("3006"));
			return false;
		}
		
		//수리대기시간을 구한다.
		WatHr = GetWatHr(mtbKsDat.Value,mtbKsTim.Value,mtbUrDat.Value,mtbUrTim.Value);
		
		if(WatHr < 0)
		{
			alert(setPopMessage("3013"));
			return false;
		}
		else
		{
			txtWatHr.Text = ""+WatHr;
		}
		
		if(trim(txtCmplt.Text) == "1") //완료등록인 경우
		{
			if(length(trim(mtbWnDat.Value)) == 0 || length(trim(mtbWnTim.Value)) == 0 ){
				alert(setPopMessage("3024"));
				return false;
			}
		
			var WnValue = mtbWnDat.Value + mtbWnTim.Value;
		
			if(WnValue <= KsValue)
			{
				alert(setPopMessage("3025"));
				return false;
			}
			
			if(trim(cmbJobCd.Value) == "22")
			{
				//jobcd == 22일 경우 설비정지시간은 (완료시간-발생시간)*기능저하 
				StpHr = parseFloat(GetStpHr(mtbWnDat.Value, mtbWnTim.Value, mtbPaDat.Value, mtbPaTim.Value)) * (parseFloat(cmbKdown.Value)/100);
			}
			else // jobcd = 21일 경우
			{
				StpHr = GetStpHr(mtbWnDat.Value, mtbWnTim.Value, mtbPaDat.Value, mtbPaTim.Value);
			}
			if(StpHr < 0)
			{
				alert(setPopMessage("3026"));
				return false;
			}
			else
			{
				if(StpHr >= 3) //완료저장에서 stphr >= 3인 경우
				alert(setPopMessage("3027"));
				txtStpHr.Text = ""+StpHr;
			}	
			var kdown = trim(cmbKdown.Value);
			if(kdown != "")
			{
				if(parseInt(kdown) > 0)
					MntHr = GetMntHr(mtbWnDat.Value, mtbWnTim.Value, mtbKsDat.Value, mtbKsTim.Value);
				else
					MntHr = 0;
			}
			//txtMntHr.Text = ""+MntHr;
		}
		else //완료등록이 아닌경우
		{
			if(length(trim(mtbWnDat.Value)) != 0 && length(trim(mtbWnTim.Value)) != 0 ){
				if(length(mtbKsDat.Value) != 0 && length(mtbWnTim.Value) != 0)
					var KsValue = mtbKsDat.Value + mtbKsTim.Value;
				else
					var KsValue = 0;
					
				var WnValue = mtbWnDat.Value + mtbWnTim.Value;
		
				if(WnValue <= KsValue)
				{
					alert(setPopMessage("3025"));
				return false;
				}
				if(trim(cmbJobCd.Value) == "22")
				{
					StpHr = parseFloat(GetStpHr(mtbWnDat.Value, mtbWnTim.Value, mtbPaDat.Value, mtbPaTim.Value)) * (parseFloat(cmbKdown.Value)/100);
				}
				else
				{
					StpHr = GetStpHr(mtbWnDat.Value, mtbWnTim.Value, mtbPaDat.Value, mtbPaTim.Value);
				}
				
				if(StpHr < 0)
				{
					alert(setPopMessage("3026"));
					return false;
				}
				else
				{
					
					txtStpHr.Text = ""+StpHr;
				}
				
				var kdown = trim(cmbKdown.Value);
				if(length(kdown) != 0)
				{
					if(parseInt(kdown) > 0)
						MntHr = GetMntHr(mtbWnDat.Value, mtbWnTim.Value, mtbKsDat.Value, mtbKsTim.Value);
					else
						MntHr = 0;
				}
			}			
			else //완료시각의 입력값이 없는 경우
			{	
				WatHr = 0;
				StpHr = 0;
				MntHr = 0;
			}
		}
	}
	else //PM,CM인 경우
	{
		if(length(trim(mtbKsDat.Value)) == 0 || length(trim(mtbKsTim.Value)) == 0)
		{
			alert(setPopMessage("3005"));
			return false;
		}
		
		var KsValue = mtbKsDat.Value + mtbKsTim.Value;
	
		if(trim(txtCmplt.Text) == "1") //완료등록인 경우
		{
			if(length(mtbWnDat.Value) == 0 || length(mtbWnTim.Value) == 0)
			{
				alert(setPopMessage("3024"));
				return false;
			}
	
			var WnValue = mtbWnDat.Value + mtbWnTim.Value;
		
			if(WnValue <= KsValue)
			{
				alert(setPopMessage("3025"));
				return false;
			}
			
			WatHr = 0;
			txtWatHr.Text = ""+WatHr;
//			txtWatHr.Text = "";
			
			StpHr = 0;
			txtStpHr.Text = ""+StpHr;
//			txtStpHr.Text = "";
	
			var kdown = trim(cmbKdown.Value);
			if(length(kdown) != 0)
			{
				if(parseInt(kdown) > 0)
					MntHr = GetMntHr(mtbWnDat.Value, mtbWnTim.Value, mtbKsDat.Value, mtbKsTim.Value);
				else
					MntHr = 0;
			}
		}
		else //완료등록이 아닌경우
		{
			if(length(trim(mtbWnDat.Value)) != 0 && length(trim(mtbWnTim.Value)) != 0)
			{
				var WnValue = mtbWnDat.Value + mtbWnTim.Value;
		
				if(WnValue <= KsValue)
				{
					alert(setPopMessage("3025"));
					return false;
				}
			
				WatHr = 0;
				txtWatHr.Text = "";
			
				StpHr = 0;
				txtStpHr.Text = "";
				
				var kdown = trim(cmbKdown.Value);
				if(length(kdown) != 0)
				{
					if(parseInt(kdown) > 0)
						MntHr = GetMntHr(mtbWnDat.Value, mtbWnTim.Value, mtbKsDat.Value, mtbKsTim.Value);
					else
						MntHr = 0;
				}
			}			
			else //완료시각의 입력값이 없는 경우
			{	
				WatHr = 0;
				StpHr = 0;
				MntHr = 0;
			}
		}
	}
	
	if(trim(lblcallpart.Text) != "partbfr" && trim(lblcallpart.Text) != "partaft"){
		if (trim(txtCmplt.Value) != "1")
			 msg = "작업완료에 공란이면 미완료,'1'이면 완료입니다.\n\n완료되지 않았으면 나중에 재등록 하겠습니까?";
	
		if (trim(txtCmplt.Value) == "1")
			 msg = "작업완료 등록을 하시겠습니까?";
		
		if(Confirm(msg)){
//alert("Confirm ==>ok");
		}
		else{
			return false;
		}
	}
	
	else //부분등록인 경우
	{
		//부분저장의 사전등록이면 확인메시지 표시 부분저장의 처리후저장이면 확인메시지 패스
		if(trim(lblcallpart.Text) == "partbfr") 
		{
			/*if(g_userclass == "M") //관리자인 경우,
			{
				lblIsSelectedCancel.Text = "N";
			}
			else //일반책임자
			{
		*/	if (trim(txtCmplt.Value) != "1")
				 msg = "작업완료에 공란이면 미완료,'1'이면 완료입니다.\n\n완료되지 않았으면 나중에 재등록 하겠습니까?";
			
			if (trim(txtCmplt.Value) == "1")
				 msg = "작업완료 등록을 하시겠습니까?";
			
			if(Confirm(msg)){
				lblIsSelectedCancel.Text = "N";
			}
			else{
				lblIsSelectedCancel.Text = "Y"; //선택대화창에서 취소버튼을 누른경우, 개선상세나,교환부품화면으로 못들어가게 체크하는 변수
				return false;
			}
		}
	}
	
	//부분저장이 아니고,완료등록일때의 체크항목 체크처리
	
	if(trim(lblcallpart.Text) != "partbfr" && trim(lblcallpart.Text) != "partaft") 
	{
		if(trim(txtCmplt.Text) == "1") //완료등록을 하겠다고 선택한 경우
		{
			//품질확인코드가 QorCd >= 1 메시지 처리
			if(parseInt(trim(cmbQorCd.Value)) >= 1)
			{
				alert(setPopMessage("3028"));
			}
			
		}
	}
	return true;
}

/********************************************************************** 
 * 내용설명 : 엑셀파일로 저장
 **********************************************************************/ 
 /*----------------------------------------------
저장
 
function setExcel()
{
	var fName   = "작업개시등록";
	var arrSheets  =  Array();  

	arrSheets[0]  = "MainGrid|Maker관리";
	createExcelSheetS2(FileDialog0, fName ,arrSheets);

}
*/
/********************************************************************** 
 * 내용설명 : 상위메뉴 변경시 초기화
 **********************************************************************/ 

function common_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_ogm200.DeleteAll();
	//ds_ogm200ALL.DeleteAll();
}

/********************************************************************** 
 * 내용설명 : Sort
 **********************************************************************/ 
function Grid0_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) lib_grid_SetGridSort(obj,nCell);
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	//getogm203_loading();
	//alert("버튼에 대한 권한이 없습니다.");
}

function fn_Input()
{
	if(checkInsertCount("ds_ogm200")== false) return;
	ds_ogm200.AddRow();
}

function fn_Delete()
{
	chk_ogm203Del();
}

function fn_Save()
{
	setogm203();
}

function fn_print()
{
	alert("fn_print");
}

function fn_Excel()
{
	setExcel();
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("2.5"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}

/********************************************************************** 
 * 내용설명 : 설비No 체크
 **********************************************************************/ 
 


/********************************************************************** 
 * 내용설명 : 설비No 입력시 asc code 체크
 **********************************************************************/ 
function chk_mshno(mshno)
{
	var msg = "";
	for(var i = 0 ; i < mshno.length; i++){
		var ch =Asc(mshno.CharAt(i));

		switch(i)
		{
			case 0:
			case 1:
				if((ch < 48) || (ch > 57 && ch < 65) || (ch > 90 && ch < 97) || (ch > 122))
				{	
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "1,2번째자리에는 숫자 또는 영문자가 와야 합니다";
					return msg;
				}
				break;
			case 2:
				if((ch != 32 && ch < 65) || (ch > 90 && ch < 97) || (ch > 122))   
				{
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "3번째자리에는 영문자나 공란이 와야 합니다.";
					return msg;
				}
				break;
			case 3:
				if(ch != 32)
				{
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "4번째자리는 공란이 와야 합니다.";
					return msg;
				}
				break;
			case 4:
			case 5:
			case 6:
			case 7:
				if(ch < 48 || ch > 57)
				{
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "5 ~ 8번째짜리까지는 숫자가 와야 합니다.";
					return msg;
				}
				break;
			case 8:
			case 9:
				if((ch != 32 && ch < 48) || (ch  > 57 ))
				{
					gmshnm="";
					gprtcd="";	
					gtimcd="";
					txtmshno.Text="";
					txtmshnm.Text="";
					msg = "8 ~ 10번째자리까지는 공란이나 숫자가 와야 합니다";
					return msg;
				}
				break;
			}
		}
	return msg;
}

/********************************************************************** 
 * 내용설명 : 상위메뉴 변경시 초기화
 **********************************************************************/ 
 
function GetPrtcdTimcdByMshno(comps,mshno)
{
	http.Sync = true;
	var sKind		= "getOgm200_chk";						
	var sMethodName = "service::psogmlib/selectOgm200_chk.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm200_chk=ds_ogm200_chk";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " MSHNO=" + quote(trim(txtmshno.value)); //설비No
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 보전방법조회
 **********************************************************************/ 
 
function getogm200_method()
{
	var sKind		= "getogm200_method";						
	var sMethodName = "service::psogmlib/selectOgm200_method.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm200_method=ds_ogm200_method";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}



/********************************************************************** 
 * 내용설명 : 설비조회 Popup창 생성
 **********************************************************************/ 
 	
function ogm200_pop_OnClick(obj)
{
	var str = dialog("psogmlib::ogm200_pop.xml","설비선택",300,300,"TitleBar=false");

}

/********************************************************************** 
 * 내용설명 : 보전방법 선택시 시각 및 lblKdown 데이터 입력
 **********************************************************************/ 
function cmbjobcd_OnChanged(obj)
{
//alert(cmbjobcd.Value);
	if(trim(cmbjobcd.Value) == "21" || trim(cmbjobcd.Value) == "22"){
		//모든시각입력 가능하게...
		mtbPaDat.Enable = true;
		mtbPaTim.Enable = true;
		mtbUrDat.Enable = true;
		mtbUrTim.Enable = true;
		if (trim(cmbjobcd.Value) == "21"){   //기능저하 처리부분
			cmbKdown.Value = "100";
		}
		else { // 22 사후수리일때
				cmbKdown.Value = "0";
		}	
		/*
		if (trim(cmbjobcd.Value) == "21") {  //기능저하 처리부분
			lblKdown.Value = "100";
		}	
		else { // 22 사후수리일때
				lblKdown.Value = "";
			}
		*/		
	}		
	else{
		//개시시각과 완료시각만 가능하게 한다..
		mtbPaDat.Enable = false;
		mtbPaTim.Enable = false;
		mtbUrDat.Enable = false;
		mtbUrTim.Enable = false;
		mtbPaDat.Value="";
		mtbPaTim.Value="";
		mtbUrDat.Value="";
		mtbUrTim.Value="";
		txtWatHr.Text="0";
		txtStpHr.Text="0";
		WatHr=0;
		
		if(trim(cmbjobcd.Value) != "21" || trim(cmbjobcd.Value) != "22"){
			cmbKdown.Value = "0";
		}
		else		{
			cmbKdown.Value = "0";
		}
		/*
		if(trim(cmbjobcd.Value) != "21" || trim(cmbjobcd.Value) != "22"){
			lblKdown.Value = "0";
		}
		else		{
			lblKdown.Value = "";
		}
		*/
		//PopJobCd.visible = false; 필요없음.
	}
	cmbKdown.SetFocus();
}



/********************************************************************** 
 * 내용설명 : 책임자 조회
 **********************************************************************/ 
 
function getogm200_hmd020pf(sabun) 
{
	var sKind		= "getogm200_hmd020pf";						
	var sMethodName = "service::psogmlib/selectOgm200_hmd020pf.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm200_hmd020pf=ds_ogm200_hmd020pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " SABUN=" + sabun; //사번
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 시각체크 함수 object로 데이터를 받아 공통으로 사용함.
 **********************************************************************/ 

function timeChk_OnKillFocus(obj){
//alert(obj.Value);
	if(length(trim(obj.Value)) != 0){
		var mtb = substr(obj.Text,0,2)+ substr(obj.Text,3,2);
//alert(mtb);
		obj.Value = ReplaceToZero(mtb);
		var patim = trim(obj.Value);
//alert(patim);
		var hour = patim.substr(0,2);
		var min = patim.substr(2,2);

		if((hour < 00 || hour > 24) || (min < 00 || min > 60)){
			alert(setPopMessage("3029"));
			obj.setfocus();
			obj.Value="";
		}
	}	
}

/********************************************************************** 
 * 내용설명 : 시각체크 _를 0으로 치환함..
 **********************************************************************/ 
function ReplaceToZero(value)
{	
	var r=replace(value,"_","0");
	return(r);
}

/********************************************************************** 
 * 내용설명 : 수리대기시간 구함.
 **********************************************************************/ 
function GetWatHr(KsDate,KsTime,UrDate,UrTime)
{
var GuGan_Start;
var GuGan_End;
var GuGan1_Start;
var GuGan1_End;
var GuGan2_Start;
var GuGan2_End;
			
//alert(KsDate+KsTime+"----------"+UrDate+UrTime);
	var KsDateValue = KsDate;
	var KsTimeValue = KsTime;
	var UrDateValue = UrDate;
	var UrTimeValue = UrTime;
	
	var EndTimeOfDay = "2359";
	
	
	var loopCnt = GetDateDif(KsDate,UrDate);
//alert("GetWatHr----" +loopCnt);	
	if (loopCnt > 0)
	{
		 GuGan1_Start = UrTimeValue;
		 GuGan1_End = EndTimeOfDay ;
		 GuGan2_Start = "000";
		 GuGan2_End = KsTimeValue;
//alert("GuGan1_Start----" +GuGan1_Start+"GuGan1_End----" +GuGan1_End+"GuGan2_Start----" +GuGan2_Start+"GuGan2_End----" +GuGan2_End);	
		
	}
	else
	{
		GuGan1_Start = UrTimeValue;
		GuGan1_End = KsTimeValue;
//alert("GuGan1_Start----" +GuGan1_Start+"GuGan1_End----" +GuGan1_End);
		
	}

	var DiffValue = 0;
	
	for (var index =0; index <= loopCnt; index++)
	{
		if((index % 2) == 0)
		{
			GuGan_Start = GuGan1_Start;
			GuGan_End = GuGan1_End;
		}
		if ((index % 2) == 1)
		{
			GuGan_Start = GuGan2_Start;
			GuGan_End = GuGan2_End;
		}
		if (index > 1)  //하루이상일 경우 하루종일치의 식사시간감안
		{
			DiffValue += 140;
		}
		if (ParseInt(GuGan_Start) <= 1300 && ParseInt(GuGan_End) >= 1400)
			DiffValue += 60;
		if (ParseInt(GuGan_Start) <= 1800 && ParseInt(GuGan_End) >= 1830)
			DiffValue += 30;
		if (ParseInt(GuGan_Start) <= 0 && ParseInt(GuGan_End) >= 30)
			DiffValue += 30;
		if (ParseInt(GuGan_Start) <= 730 && ParseInt(GuGan_End) >= 750) 
			DiffValue += 20;
	}
	
	var a = GetDateDif(KsDate,UrDate) * 1440;
	var b =  DiffValue;
	var c = ParseInt(KsTime.substr(0,2))*60+ParseInt(KsTime.substr(2,2));
	var d = ParseInt(UrTime.substr(0,2)) * 60 + ParseInt(UrTime.substr(2,2));
		
	var Waits_h = ((a+c) - (b+ d))/60;

	return (Round(Waits_h,'1'));	
}


function GetStpHr(WnDate,WnTime,PaDate,PaTime)
{

	var GuGan_Start;
	var GuGan_End;
	var GuGan1_Start;
	var GuGan1_End;
	var GuGan2_Start;
	var GuGan2_End;

	var WnDateValue = WnDate;
	var WnTimeValue = WnTime;
	var PaDateValue = PaDate;
	var PaTimeValue = PaTime;

	var EndTimeOfDay = "2359";
	
	var loopCnt = GetDateDif(WnDate,PaDate);
	if (loopCnt > 0)
	{
		var GuGan1_Start = PaTimeValue;
		var GuGan1_End = EndTimeOfDay ;
		var GuGan2_Start = "000";
		var GuGan2_End = WnTimeValue;
	}
	else
	{
		GuGan1_Start = PaTimeValue;
		GuGan1_End = WnTimeValue;
	}
	var DiffValue = 0;
	
	for (var index =0; index <= loopCnt; index++)
	{
		if ((index % 2) == 0)
			{
				GuGan_Start = GuGan1_Start;
				GuGan_End = GuGan1_End;
			}
		if((index % 2) == 1)
			{
				GuGan_Start = GuGan2_Start;
				GuGan_End = GuGan2_End;
			}
		if(index > 1)
			{
				DiffValue += 140; //하루이상일경우 하루종일의 식사시간감안값
			}
		if (ParseInt(GuGan_Start) <= 1300 && ParseInt(GuGan_End) >= 1400)
			DiffValue += 60;
		if (ParseInt(GuGan_Start) <= 1800 && ParseInt(GuGan_End) >= 1830)
			DiffValue += 30;
		if (ParseInt(GuGan_Start) <= 0 && ParseInt(GuGan_End) >= 30)
			DiffValue += 30;
		if (ParseInt(GuGan_Start) <= 730 && ParseInt(GuGan_End) >= 750) 
			DiffValue += 20;
			
	}
	
	var a = GetDateDif(WnDate,PaDate) * 1440;
	var b =  DiffValue;
	var c = ParseInt(WnTime.substr(0,2))*60+ParseInt(WnTime.substr(2,2));
	var d = ParseInt(PaTime.substr(0,2)) * 60 + ParseInt(PaTime.substr(2,2));
		
	var Stp_h = ((a+c) - (b + d))/60;
	
	return (Round(Stp_h,'1'));
}

/********************************************************************** 
 * 내용설명 : 날짜사이의 차이 일수를 구하는 함수
 **********************************************************************/ 
function GetDateDif(Date1,Date2)
{
	//두날짜사이의 차이 일수를 구하는 함수
	//조건 : Date1 > Date2가 될것
	if(Date1 == Date2)
		return 0;
	else
	{
		var DateU=DateTime(Date1.substr(0,4),Date1.substr(4,2),Date1.substr(6,2));
		var DateL=DateTime(Date2.substr(0,4),Date2.substr(4,2),Date2.substr(6,2));

	var loopCnt=DateU-DateL;
//alert(loopCnt);
	return loopCnt;
	}
	/*
		var span = _GetDateTimeSpan(-1,0,0,0);
		var loopCnt = 0;
		do
		{
			DateU.Plus(span);
			++loopCnt;
			var Value1 = _ConvertDateToString(DateU);
			var Value2 = _ConvertDateToString(DateL);
		} while (Value1 != Value2)
		return loopCnt;
	}
	*/
}

function ogm200_jisno(){
		if(length(txtjisno.Value) == 0)
			{
				switch(substr(ComboBoxPlant.Value,0,1))
				{
					case "C" :
						PlantCd = "PC";
						break;
					case "H" :
						 PlantCd = "PH";
						break;
					case "S" :
						PlantCd = "PS";
						break;
					//ke 추가(2017.01.09)
					case "E" :
						PlantCd = "PE";
						break;
				}
			
		return;
		}
		PlantCd= txtjisno.Text;

}


function txtmshno_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar != 13){
		return;
	}
	cmbJobCd.SetFocus();
}
/********************************************************************** 
 * 내용설명 : 책임자 확인
 **********************************************************************/ 
 function txtmshno_chk(){
 
 		if(trim(txtmshno.Text) != ""){
 		/*
		var chk = chk_mshno(trim(txtmshno.Text));
		if(chk != ""){
			alert(chk);
			return;
		}
		*/
		
		//var ret = GetPrtcdTimcdByMshno(comps,trim(txtmshno.text));
		GetPrtcdTimcdByMshno(comps,trim(txtmshno.text));
		if(ds_ogm200_chk.GetColCount()==0){
			alert(setPopMessage("2526"));
			gmshnm="";
			gprtcd="";	
			gtimcd="";
			txtmshno.Text="";
			txtmshnm.Text="";
		}else{
			gmshnm = ds_ogm200_chk.GetColumn(0,"mshnm");
			gprtcd = ds_ogm200_chk.GetColumn(0,"prtcd");
			gtimcd = ds_ogm200_chk.GetColumn(0,"timcd");
//alert("선택gtimcd==="+gtimcd);
//alert("선택gprtcd==="+gprtcd);			
			txtmshnm.Text = gmshnm; 
			lblTimCd.Text = gtimcd;
			lblPrtCd.Text = gprtcd;
			//cmbjobcd.Focus();
		}
	}
	else{
		alert(setPopMessage("3019"));
	}
} 
/********************************************************************** 
 * 내용설명 : 책임자 확인 OnKeyDown
 **********************************************************************/ 
 
function txtwrkm1_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar != 13)
	return;
	txtWrkm2.SetFocus();
//txtkornm.text =""; //초기화

}

function txtwrkm1_OnKillFocus(obj)
{
	if(length(txtwrkm1.Text)==0){
		txtkornm.text ="";
		return;
	}
	getogm200_hmd020pf(trim(txtwrkm1.Text));
	if(ds_ogm200_hmd020pf.GetColCount()!=0){
		txtkornm.Text = ds_ogm200_hmd020pf.GetColumn(0,"KORNM");
	}	
	else{
		alert(setPopMessage("3015"));
		txtwrkm1.Text="";
		txtkornm.text ="";
	}
	lblsdpcd.value = ds_ogm200_hmd020pf.GetColumn(0,"SDPCD");
	lbldptcd.value = ds_ogm200_hmd020pf.GetColumn(0,"DPTCD");// 20130130
}

/********************************************************************** 
 * 내용설명 : 부책임자 확인 OnKeyDown
 **********************************************************************/ 
function txtWrkm2_OnKillFocus(obj)
{
	if(length(txtWrkm2.Text)==0){
		txtKorNm2.text ="";
		return;
	}
	getogm200_hmd020pf(trim(txtwrkm2.Text));
	if(ds_ogm200_hmd020pf.GetColCount()!=0){
		txtKorNm2.Text = ds_ogm200_hmd020pf.GetColumn(0,"KORNM");
	}	
	else{
		alert(setPopMessage("3015"));
		txtwrkm2.Text="";
		txtKorNm2.text ="";
	}
	//lblsdpcd.value = ds_ogm200_hmd020pf.GetColumn(0,"SDPCD");
}


/********************************************************************** 
 * 내용설명 : 내외구분 조회
 **********************************************************************/ 
function getogm203_cmbInoCd()
{

	var sKind		= "getogm203_cmbInoCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbInoCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc020pf=ds_obc020pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : 우선도 조회
 **********************************************************************/ 
function getogm203_cmbEmgCd()
{

	var sKind		= "getogm203_cmbEmgCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbEmgCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc010pf=ds_obc010pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : 품질확인 조회
 **********************************************************************/ 
function getogm203_cmbQorCd()
{

	var sKind		= "getogm203_cmbQorCds";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbQorCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc170pf=ds_obc170pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}


/********************************************************************** 
 * 내용설명 : 재발방지 조회
 **********************************************************************/ 
function getogm203_cmbRepCd()
{

	var sKind		= "getogm203_cmbRepCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbRepCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc150pf=ds_obc150pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 설비부위분류 조회
 **********************************************************************/ 
function getogm203_cmbSubas()
{

	var sKind		= "getogm203_cmbSubas";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbSubas.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc230pf=ds_obc230pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : ASSY부품 조회
 **********************************************************************/ 
function getogm203_cmbComCd()
{

	var sKind		= "getogm203_cmbComCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbComCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc220pf=ds_obc220pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : ASSY부품_PopKndCd 조회
 **********************************************************************/ 
function getogm203_PopKndCd(KndCd)
{
	var sKind		= "getogm203_PopKndCd";						
	var sMethodName = "service::psogmlib/selectOGM203_PopKndCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc060pf_01=ds_obc060pf_01";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " KNDCD=" + quote(KndCd); //cmbComCd코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : ASSY부품_PopUmhen조회
 **********************************************************************/ 
function getogm203_PopUmhen(KndCd, umhen)
{
	var sKind		= "getogm203_PopUmhen";						
	var sMethodName = "service::psogmlib/selectOGM203_PopUmhen.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc060pf_02=ds_obc060pf_02";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " KNDCD=" + quote(KndCd); //cmbComCd코드
		sArgument += " UMHEN=" + quote(umhen); //cmbComCd코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

function cmbComCd_OnClick(obj)
{
	getogm203_cmbComCd();//ASSY부품
	if(PopKndCd.Visible=false && PopUmhen.Visible=false){
		Grid_cmbComCd.Visible=true;	
	}
}

/********************************************************************** 
 * 내용설명 : 단위부품_PopKndCd 조회
 **********************************************************************/ 
function getogm203_cmbDecCd()
{
	var sKind		= "getogm203_cmbDecCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbDecCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc070pf=ds_obc070pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 단위부품_PopDKndCd 조회
 **********************************************************************/ 
function getogm203_PopDKndCd(dKndCd)
{
	var sKind		= "getogm203_PopDKndCd";						
	var sMethodName = "service::psogmlib/selectOGM203_PopDKndCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc050pf_01=ds_obc050pf_01";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " KNDCD=" + quote(dKndCd); //cmbComCd코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 단위부품_PopDUmhen조회
 **********************************************************************/ 
function getogm203_PopDUmhen(dKndCd, dumhen)
{
	var sKind		= "getogm203_PopDUmhen";						
	var sMethodName = "service::psogmlib/selectOGM203_PopDUmhen.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc050pf_02=ds_obc050pf_02";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " KNDCD=" + quote(dKndCd); //cmbComCd코드
		sArgument += " UMHEN=" + quote(dumhen); //cmbComCd코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : 처치
 **********************************************************************/ 
function getogm203_cmbChoCd()
{
	var sKind		= "getogm203_cmbChoCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbChoCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc160pf=ds_obc160pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}


function cmbDecCd_OnClick(obj)
{
	getogm203_cmbDecCd();
	if(PopDKndCd.Visible=false && PopDUmhen.Visible=false){
		Grid_cmbDecCd.Visible=true;
	}
}

/********************************************************************** 
 * 내용설명 : 현상_cmbHyoCd 조회
 **********************************************************************/ 
function getogm203_cmbHyoCd()
{
	var sKind		= "getogm203_cmbHyoCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbHyoCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc190pf=ds_obc190pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : 현상_PopHKndCd조회
 **********************************************************************/ 
function getogm203_PopHKndCd(hkind)
{
	var sKind		= "getogm203_cmbHyoCd";						
	var sMethodName = "service::psogmlib/selectOGM203_PopHKndCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc180pf=ds_obc180pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " HKIND=" + quote(trim(hkind)); //hkind
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

function cmbHyoCd_OnClick(obj)
{
	getogm203_cmbHyoCd();
	if(PopHKndCd.Visible=false){
		Grid_cmbHyoCd.Visible=true;
	}
}

/********************************************************************** 
 * 내용설명 : 원인_cmbCauCd 조회
 **********************************************************************/ 
function getogm203_cmbCauCd()
{
	var sKind		= "getogm203_cmbCauCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbCauCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc120pf=ds_obc120pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : 원인_PopCkndCd 조회
 **********************************************************************/ 
function getogm203_PopCKndCd(cKind)
{
	var sKind		= "getogm203_PopCKndCd";						
	var sMethodName = "service::psogmlib/selectOGM203_PopCKndCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc110pf=ds_obc110pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " CKIND=" + quote(trim(cKind)); //hkind
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

function cmbCauCd_OnClick(obj)
{
	getogm203_cmbCauCd();
	if(PopCkndCd.Visible=false){
		Grid_cmbCauCd.Visible=true;
	}
}

/********************************************************************** 
 * 내용설명 : 실원인_cmbTruCd조회
 **********************************************************************/ 
function getogm203_cmbTruCd()
{
	var sKind		= "getogm203_cmbTruCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbTruCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc100pf=ds_obc100pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : 실원인_PopTKndCd조회
 **********************************************************************/ 
function getogm203_PopTKndCd(tkind)
{
	var sKind		= "getogm203_PopTKndCd";						
	var sMethodName = "service::psogmlib/selectOGM203_PopTKndCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc090pf=ds_obc090pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " TKIND=" + quote(trim(tkind)); //hkind
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

function cmbTruCd_OnClick(obj)
{
	getogm203_cmbTruCd();
	if(PopTKndCd.Visible=false){
		Grid_cmbTruCd.Visible=true;
	}
}

/********************************************************************** 
 * 내용설명 : 효과구분_cmbEffCd조회
 **********************************************************************/ 
function getogm203_cmbEffCd()
{
	var sKind		= "getogm203_cmbEffCd";						
	var sMethodName = "service::psogmlib/selectOGM203_cmbEffCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc210pf=ds_obc210pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;

}
/********************************************************************** 
 * 내용설명 : 효과구분_PopEKndCd조회
 **********************************************************************/ 
function getogm203_PopEKndCd(ekind)
{
	var sKind		= "getogm203_PopEKndCd";						
	var sMethodName = "service::psogmlib/selectOGM203_PopEKndCd.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obc200pf=ds_obc200pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " EKIND=" + quote(trim(ekind)); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

function cmbEffCd_OnClick(obj)
{
	getogm203_cmbEffCd();
	if(PopEKndCd.Visible=false){
		Grid_cmbEffCd.Visible=true;
	}
}

function txtCmplt_OnKillFocus(obj)
{
	var cmplt=txtCmplt.Text;
	var ch =Asc(cmplt.CharAt(0));
	
	if(ch  == 49){	
		lblCmplt.Text = "완료";
	}
	else if(ch != 49){	
		txtCmplt.Text = "";
		lblCmplt.Text = "미완료";
	}	
}

function brd3btneffdet_OnClick(obj)
{	
	//초기화시킴
	lblcallpart.Text = ""; 
	//부분저장시 저장하는 루틴에서 에러체크할때 에러가 발생했어면 개선상세나 부품교환화면으로 들어가지 못하게 처리
	if(lblIsStatusError.Text == "Y") 
		return;
		
	if(length(trim(txtjisno.Text))  == 0) 
	{
		alert(setPopMessage("3030"));
		return;
	}


	var cmplt = chk_Cmplt();
/*	
	if (g_userclass != "M" && cmplt == "1"){
		alert(setPopMessage("3031"));
		return false;
	}
*/	
	//개선상세버튼을 누르면 입력한 내용을 자동저장되게 함.
	lblcallpart.Text = "partbfr"; //"partbfr"이면 개선상세나 교환부품에 들어가기전 저장하는것임(부분저장);
	
	if(!setOgm203()){
		return;
	}
	else{
	
	//저장할때 저장을 선택하는 대화창에서 취소버튼을 누른경우, 개선상세나,교환부품화면으로 못들어가게 처리
	if(trim(lblIsSelectedCancel.Text) == "Y") 
	{
		lblIsSelectedCancel.Text = "N"; //초기화처리
		return; 
	}

	var str = dialog("psogmlib::ogm204.xml","개선상세",300,300,"Resize=true", -1,0);
	//var str = dialog("psogmlib::ogm204.xml","개선상세",300,300,"TitleBar=false");
	}
}

function btnChnPrt_OnClick(obj)
{

	//초기화시킴
	lblcallpart.Text = ""; 
	
	if(length(trim(txtjisno.Text)) == 0) 
	{
		alert(setPopMessage("3032"));
		return;
	}
	
	//if (g_userclass == "G" && trim(txtCmplt.Text) == "1")
/*
	if (g_userclass == "G" && trim(txtCmplt.Text) == "1")
	{
		alert(setPopMessage("3031"));
		return;
	}
*/	
	//교환부품버튼을 누르면 자동저장되게 함.
	lblcallpart.Text = "partbfr"; //"partbfr"이면 개선상세나 교환부품에 들어가기전 저장하는것임(부분저장);
	if(!setOgm203()){
		return;
	}
	else{
	//저장할때 저장을 선택하는 대화창에서 취소버튼을 누른경우, 개선상세나,교환부품화면으로 못들어가게 처리
		if(trim(lblIsSelectedCancel.Text) == "Y") 
		{
			lblIsSelectedCancel.Text = "N"; //초기화처리
			return; 
		}
		
	
		var str = dialog("psogmlib::ogm205.xml","교환부품입력",300,300,"TitleBar=false");
	}
}


function check_data203()
{
	var chks = 0;
	if (length(trim(txtWrkm1.Text)) == 0)
	{
		txtWrkm1.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(txtmshno.Text)) == 0)
	{
		txtmshno.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(cmbJobCd.Value)) == 0)
	{
		cmbJobCd.BKColor= "paleturquoise";
		chks+=1;
	}
	
	if (length(trim(cmbInoCd.Value)) == 0)
	{
		cmbInoCd.BKColor= "paleturquoise";
		chks+=1;
	}	
	if (length(trim(cmbEmgCd.Value)) == 0)
	{
		cmbEmgCd.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(cmbQorCd.Value)) == 0)
	{
		cmbQorCd.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(cmbSubas.Value)) == 0)
	{
		cmbSubas.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(txtAssNo.Text)) == 0)
	{
		txtAssNo.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(cmbComCd.Value)) == 0)
	{
		cmbComCd.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(cmbDecCd.Value)) == 0)
	{
		cmbDecCd.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(txtPrtNo.Text)) == 0)
	{
		txtPrtNo.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(cmbChoCd.Value)) == 0)
	{
		cmbChoCd.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(cmbHyoCd.Value)) == 0)
	{
		cmbHyoCd.BKColor= "paleturquoise";
		chks+=1;
	}
//	var hyocd = board.GetChild("cmbHyoCd");
	if(trim(cmbHyoCd.Value) != "99") //99 해당없슴
	{
		if (length(trim(cmbCauCd.Value)) == 0)
		{
			cmbCauCd.BKColor= "paleturquoise";
			chks+=1;
		}
		if (length(trim(cmbTruCd.Value)) == 0)
		{
			cmbTruCd.BKColor= "paleturquoise";
			chks+=1;
		}
	}
//	var jobcd = board.GetChild("cmbJobCd");
	if(trim(cmbJobCd.Value) == "21" || trim(cmbJobCd.Value) == "22") 
	{
		if (mtbPaDat.Enable == true)
		{
			if (trim(mtbPaDat.Value) == "")
			{
				mtbPaDat.BKColor= "paleturquoise";
				chks+=1;
			}
		}
		if (mtbPaTim.Enable == true)
		{
			if (trim(mtbPaTim.Value) == "")
			{
				mtbPaTim.BKColor= "paleturquoise";
				chks+=1;
			}
		}
		if (mtbUrDat.Enable == true)
		{
			if (trim(mtbUrDat.Value) == "")
			{
				mtbUrDat.BKColor= "paleturquoise";
				chks+=1;
			}
		}
		if (mtbUrTim.Enable == true)
		{
			if (trim(mtbUrTim.Value) == "")
			{
				mtbUrTim.BKColor= "paleturquoise";
				chks+=1;
			}
		}
		
		if (trim(cmbKdown.Value) == "")
		{
			cmbKdown.BKColor= "paleturquoise";
			chks+=1;
		}
	
		if (length(mtbKsDat.Value) == 0)
		{
			mtbKsDat.BKColor= "paleturquoise";
			chks+=1;
		}
		if (length(mtbKsTim.Value) == 0)
		{
			mtbKsTim.BKColor= "paleturquoise";
			chks+=1;
		}
		if (length(mtbWnDat.Value) == 0)
		{
			mtbWnDat.BKColor= "paleturquoise";
			chks+=1;
		}
		if (length(mtbWnTim.Value) == 0)
		{
			mtbWnTim.BKColor= "paleturquoise";
			chks+=1;
		}
		if (length(trim(txtBfrHr.Text)) == 0)
		{
			txtBfrHr.BKColor= "paleturquoise";
			chks+=1;
		}
		if (length(trim(txtWrkHr.Text)) == 0)
		{
			txtWrkHr.BKColor= "paleturquoise";
			chks+=1;
		}
		if (length(trim(txtJanHr.Text)) == 0)
		{
			txtJanHr.BKColor= "paleturquoise";
			chks+=1;
		}
	}
	if (length(trim(cmbRepCd.Value)) == 0)
	{
		cmbRepCd.BKColor= "paleturquoise";
		chks+=1;
	}

	if (length(trim(txtECost.Text)) == 0)
	{
		txtECost.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(txtHyosn.Value)) == 0)
	{
		txtHyosn.BKColor= "paleturquoise";
		chks+=1;
	}
	
	if (length(trim(txtWonin.Text)) == 0)
	{
		txtWonin.BKColor= "paleturquoise";
		chks+=1;
	}
	if (length(trim(txtDaech.Text)) == 0)
	{
		txtDaech.BKColor= "paleturquoise";
		chks+=1;
	}
	if (chks > 0) 
		return false;
	else
		return true;
}

function GetMntHr(WnDate,WnTime,KsDate,KsTime)
{
	var WnDateValue = WnDate;
	var WnTimeValue = WnTime;
	var KsDateValue = KsDate;
	var KsTimeValue = KsTime;
	
	var a = GetDateDif(WnDate,KsDate) * 1440;
	
	var b = parseInt(WnTime.substr(0,2))* 60 + parseInt(WnTime.substr(2,2));
		
	var c = parseInt(KsTime.substr(0,2)) * 60 + parseInt(KsTime.substr(2,2));
	
		
	var Mnt_h = ((a+b) - c)/60;
	return (Round(Mnt_h,'1'));
}

function txtDaech_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if(nChar == 9){
	txtCmplt.Text="1";
	}
}

function cmbSubas_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmbComCd.SetFocus();
	if(length(cmbComCd.Value)==0){
		cmbComCd_OnClick();
	}
}

function cmbChoCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmbHyoCd.SetFocus();
	if(length(cmbHyoCd.Value)==0){
		cmbHyoCd_OnClick();
	}
}

function cmbKdown_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmbInoCd.SetFocus();
}

function cmbInoCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmbEmgCd.SetFocus();
}

function cmbEmgCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmbQorCd.SetFocus();
}

function cmbQorCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmbSubas.SetFocus();
}

function cmbRepCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmbEffCd.SetFocus();
//	cmbEffCd_OnClick();
}

/********************************************************************** 
 * 내용설명 : 교환부품 close시 변경내역 재적용
 **********************************************************************/ 
function ogm205_close(){
	//부품교환처리후 변화된 값 반영처리
	InqParts();
	ogm203_pcostChk();
			
	//부품교환의 수정내용(부품비)을 반영하기 위해 재저장처리
	lblcallpart.Text = "partaft"; //"partaft"이면 개선상세나 교환부품에 나온후 효과금액,부품비 수정후 저장하는것임(부분저장);
	setogm203();
	lblcallpart.Text = "";
}
/********************************************************************** 
 * 내용설명 : 교환부품 금액 확인
 **********************************************************************/ 
function ogm203_pcostChk(){
	var RowCnt = ds_obj220pf.GetRowCount();
	var PCost = 0;
	for(i =0; i < RowCnt; i++)
	{
		PCost += parseInt(ds_obj220pf.GetColumn(i,"AMONT"));
	}
			
	var strPCost = PCost/1000;
//	strPCost = Math.ceil((PCost/1000)).toString();
	if(strPCost.length > 3)
	txtPCost.Text = strPCost;
	//txtPCost.Text = NumFormat(strPCost);
	else
	txtPCost.Text = strPCost;
	//txtPCost.Text = NumFormat(strPCost);
}
/********************************************************************** 
 * 내용설명 : 개선상세 금액
 **********************************************************************/ 
function getogm203D_effdet(){
	
	var sKind		= "getogm203D_effdet";						
	var sMethodName = "service::psogmlib/selectOgm204_obj210pf.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm203D_effdet=ds_obj210pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(txtjisno.Text); //지시No
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	
	var effTsum=trim(ds_ogm203D_effdet.GetColumn(0,"T_SUM"));
	if(length(effTsum)==0){
		txtECost.Text = "0";
	//txtECost.Text = NumFormat(trim(ds_ogm203D_effdet.GetColumn(0,"T_SUM")));
	}
		txtECost.Text = effTsum;

}
function cmbJobCd_OnClick(obj)
{
	getogm200_method(); //보전방법
}

function cmbInoCd_OnClick(obj)
{
	getogm203_cmbInoCd(); //내외구분
}

function cmbEmgCd_OnClick(obj)
{
	getogm203_cmbEmgCd(); //우선도
}

function cmbQorCd_OnClick(obj)
{
	getogm203_cmbQorCd(); //품질확인
}

function cmbSubas_OnClick(obj)
{
	getogm203_cmbSubas(); //설비부위분류
}

function cmbRepCd_OnClick(obj)
{
	getogm203_cmbRepCd(); //재발방지
}

function cmbChoCd_OnClick(obj)
{
	getogm203_cmbChoCd(); //처치
}

/********************************************************************** 
 * 내용설명 : 개선상세 close시 변경내역 재적용
 **********************************************************************/ 
function ogm204_close(){

	lblcallpart.Text = "";

}
function flag_chk(){

	var cmplt = chk_Cmplt();
	
	if(length(txtjisno.Text) == 0){
		flag="insert"; 
		getogm_maxNum();
	}
	else {
		if(cmplt == "-1"){
			flag="insert"; 
			getogm_maxNum();
		}
	
		else if(g_userclass == "M") //권한등급이 관리자책임자인경우
		{
				flag="update"; 
		}
		else if (g_userclass != "M"){
			if(cmplt == "1") //완료수정인 경우 경고메시지
			{
				alert(setPopMessage("3031"));
				lblIsStatusError.Text = "N";  //Y는 에러상태,N는 미에러상태
				return false;
			}
			else{
				flag="update"; 		
			}
		}
	}	
	return true;
}
/********************************************************************** 
 * 내용설명 : 등록여부확인
 **********************************************************************/ 
function chk_Cmplt(){

	var sKind		= "chk_Cmplt";						
	var sMethodName = "service::psogmlib/selectOgm203_cmplt.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm203_cmplt=ds_ogm203_cmplt";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)); //사업부
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	//alert(ds_ogm203_cmplt.GetColCount());

	if(ds_ogm203_cmplt.GetColCount() == 0)
	{
		//alert(setPopMessage("3033"));
		return "-1";
	}
	if(trim(ds_ogm203_cmplt.GetColumn(0,"CMPLT")) == "1")
	{
		return "1";
	}
	else
	{
		return "0";
	}
}
/********************************************************************** 
 * 내용설명 : 첨부파일이 있는지 검색후, 있어면 첨부버튼 enable,없어면 disable 삭제용
 **********************************************************************/ 
function getOgm219_obj230pf(){
	var sKind		= "getOgm219_obj230pf";						
	var sMethodName = "service::psogmlib/selectOgm219_obj230pf.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obj230pf=ds_obj230pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)); //지시No
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}
/********************************************************************** 
 * 내용설명 : 개선테이블에 jisno가있는지 확인 삭제용
 **********************************************************************/ 
function getogm204_obj210pf_01(){
	
	var sKind		= "getogm204_obj210pf_01";						
	var sMethodName = "service::psogmlib/selectOgm204_obj210pf_01.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obj210pf_01=ds_obj210pf_01";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)); //지시No
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}

/********************************************************************** 
 * 내용설명 : parts테이블에서 교환품 목록검색 삭제용
 **********************************************************************/ 
function getOgm219_inqParts(){
	var sKind		= "getOgm219_inqParts";						
	var sMethodName = "service::psogmlib/selectOgm219_obj220pf_InqParts.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obj220pf_del=ds_obj220pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)); //지시No
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}

/********************************************************************** 
 * 내용설명 : 첨부파일이 있는지 검색후, 있어면 첨부버튼 enable,없어면 disable 삭제용
 **********************************************************************/ 
function getOgm219_obj230pf(){
	var sKind		= "getOgm219_obj230pf";						
	var sMethodName = "service::psogmlib/selectOgm219_obj230pf.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obj230pf=ds_obj230pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)); //지시No
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}
/********************************************************************** 
 * 내용설명 : 개선테이블에 jisno가있는지 확인 삭제용
 **********************************************************************/ 
function getogm204_obj210pf_01(){
	
	var sKind		= "getogm204_obj210pf_01";						
	var sMethodName = "service::psogmlib/selectOgm204_obj210pf_01.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obj210pf_01=ds_obj210pf_01";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)); //지시No
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}

/********************************************************************** 
 * 내용설명 : parts테이블에서 교환품 목록검색 삭제용
 **********************************************************************/ 
function getOgm219_inqParts(){
	var sKind		= "getOgm219_inqParts";						
	var sMethodName = "service::psogmlib/selectOgm219_obj220pf_InqParts.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_obj220pf_del=ds_obj220pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)); //지시No
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}
function brd3btncfile_OnClick(obj)
{
	if(length(trim(txtjisno.Text))  == 0) 
	{
		alert(setPopMessage("3052"));
		return;
	}
	
	if (g_userclass != "M" && trim(txtCmplt.Text) == "1")
	{
		alert(setPopMessage("3053"));
		return;
	}
	var str = dialog("psogmlib::ogm206.xml","파일첨부",300,300,"TitleBar=false");

}

function btnprint_OnClick(obj)
{
	if(length(trim(txtjisno.Text))  == 0) 
	{
		alert(setPopMessage("3034"));
		return;
	}
	else {
		reportQuery();
		reportQuery_prt();
		//dialog("psogmlib::ogm220_rep.xml","");
		dialog("psogmlib::ogm203_rep.xml", "",300,300,"TitleBar=false",-1,0);
   	    //dialog("psogmlib::ogm203_rep.xml","보고서발행",300,300,"Resize=true", -1,0);

	}
	
}
/********************************************************************** 
 * 내용설명 : Report 출력
 **********************************************************************/ 
function reportQuery()
{
	var sKind		= "getogm203_rep";						
	var sMethodName = "service::psogmlib/selectOgm203_rep.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm203_rep=ds_ogm203_rep";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(txtjisno.Text); //지시No
		sArgument += " IMGPATH=" + quote(imgVpath); //SQL이미지경로
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 예비품내역 Report 출력 --교환부품등록의 조회 controller사용(OGM205)
 **********************************************************************/ 
function reportQuery_prt()
{
	var sKind		= "getogm203_prtRep";						
	var sMethodName = "service::psogmlib/selectOgm205_obj220pf.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm203_prtRep=ds_ogm205_obj220pf";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " JISNO=" + quote(txtjisno.Text); //지시No
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : jisno MAX구하기
 **********************************************************************/ 
function getogm_maxNum()
{
	var sKind		= "getogm_maxNum";						
	var sMethodName = "service::psogmlib/selectOgm_maxNum.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm_maxNum=ds_ogm_maxNum";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " PLTCD=" + quote(PlantCd); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	txtjisno.Text = PlantCd+(parseInt(trim(ds_ogm_maxNum.GetColumn(0,"autonum")))+1);
	updateOgm_maxNum();
}

/********************************************************************** 
 * 내용설명 : 재발방지추가등록내역 조회
 **********************************************************************/ 
function getogm203_pepcdChk()
{
	var sKind		= "getogm203_pepcdChk";						
	var sMethodName = "service::psogmlib/selectOgm203_pepcdChk.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm203_pepcdChk=ds_ogm203_pepcdChk";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " JISNO=" + quote(trim(txtjisno.Text)+"P"); //사업부
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	
	if(ds_ogm203_pepcdChk.GetRowCount()==0){
		var pefalg="insert";
		setogm203_pepcd(pefalg);
		alert("계획공사에 재발방지 작업등록 합니다.\n\n신규지시번호는 "+trim(txtjisno.Text)+"P입니다.\n\n진행중작업에서 확인해주세요");

	}
	else{
		var pefalg="update";
		alert("계획공사에 재발방지 작업등록 합니다.\n\n신규지시번호는 "+trim(txtjisno.Text)+"입니다.\n\n진행중작업에서 확인해주세요");
		setogm203_pepcd(pefalg);
	}
}

function setogm203_pepcd(pefalg)
{
	var sKind		= "setogm203_pepcd";						
	var sMethodName = "service::psogmlib/saveOGM203_pepcd.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";               //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "";    							     // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	sArgument += " LIB2=" + quote(Lib2);
	sArgument += " FLAG=" + quote(pefalg);
	sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
	sArgument += " JISNO=" + quote(trim(txtjisno.Text)+"P");
	sArgument += " TIMCD=" + quote(trim(lblTimCd.Value));
	sArgument += " PRTCD=" + quote(trim(lblPrtCd.Value));
	sArgument += " MSHNO=" + quote(trim(txtmshno.Text));
	//sArgument += " DPTCD=" + quote(lbldptcd.Value);
	sArgument += " SDPCD=" + quote(lblsdpcd.Value);
	sArgument += " SUBAS=" + quote(cmbSubas.Value);
	sArgument += " ASSNO=" + quote(trim(txtAssNo.Text));
	sArgument += " COMCD=" + quote(cmbComCd.Value);
	sArgument += " DECCD=" + quote(cmbDecCd.Value);
	sArgument += " PRTNO=" + quote(trim(txtPrtNo.Text));
	sArgument += " CHOCD=" + quote(cmbChoCd.Value);
	sArgument += " KSDAT=" + quote(mtbKsDat.Value);
	sArgument += " KSTIM=" + quote(mtbKsTim.Value);
	sArgument += " WRKM1=" + quote(trim(txtWrkm1.Text));
	sArgument += " HYOSN=" + quote(trim(txtHyosn.Text));
	sArgument += " WONIN=" + quote(trim(txtWonin.Text));
	sArgument += " DAECH=" + quote(trim(txtDaech.Text));
	sArgument += " CMPLT=" + quote(" ");
	sArgument += " NOCNT=" + quote(NoCnt);

	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;

}

//자동체번 테이블에서 max값으로 레코드 저장후 수정된 max값(max+1)을 update해주는 함수
function updateOgm_maxNum()
{
	var sKind		= "insert_next_maxvalue";						
	var sMethodName = "service::psogmlib/updateOgm_maxNum.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " PLTCD=" + quote(PlantCd); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

function text_clear(){
	txtjisno.Text="";
	txtmshno.Text="";
	txtmshnm.Text="";
	txtWrkm1.Text="";
	txtHyosn.Text="";
	txtmshno.Text="";
	cmbJobCd.Text="";
	cmbInoCd.Value="";
	cmbEmgCd.Value="";
	cmbQorCd.Value="";
	cmbSubas.Value="";
	txtAssNo.Text="01";
	cmbComCd.Value="";
	cmbDecCd.Value="";
	txtPrtNo.Text="001";
	cmbChoCd.Value="";
	cmbHyoCd.Value="";
	cmbCauCd.Value="";
	cmbTruCd.Value="";
	mtbPaDat.Text="";
	mtbPaTim.Text="";
	mtbUrDat.Text="";
	mtbUrTim.Text="";
	cmbKdown.Value="0";
	mtbKsDat.Text="";
	mtbKsTim.Text="";
	mtbWnDat.Text="";
	mtbWnTim.Text="";
	txtBfrHr.Text="0.0";
	txtWrkHr.Text="0.0";
	txtJanHr.Text="0.0";
	cmbRepCd.Value="";
	txtECost.Text="0";
	txtHyosn.Text="";
	txtWonin.Text="";
	txtDaech.Text="";
	txtWrkm1.Text=adusr;
	txtkornm.Text=adusrNm;
	txtWrkm2.Text="";
	txtKorNm2.Text="";
	cmbEffCd.Value="";
	txtEffNm.Text="";
	txtPCost.Text="0";
	txtCpart.Text="";
	txtDpart.Text="";
	txtWatHr.Text="0.0";
	txtStpHr.Text="0.0";
	txtHyoNm.Text="";
	txtCauNm.Text="";
	txtTruNm.Text="";
	txtSubCn.Text="";
	txtSCost.Text="0";
	txtCNote.Text="";
	lblPrtCd.Text="";
	lblIsSelectedCancel.Text="";
	lblIsStatusError.Text="";
	lblcallpart.Text="";
	lbljisno.Text="";
	lblcallboard.Text="";
	lblNewOrEdit.Text="";
	lbldptcd.Text="";
	lblKdown.Text="";
	lblTimCd.Text="";
	lblsdpcd.Text="";
	
		txtmshno.BKColor= "white";
	txtWrkm1.BKColor= "white";
	txtHyosn.BKColor= "white";
	txtmshno.BKColor= "white";
	cmbJobCd.BKColor= "white";
	cmbInoCd.BKColor= "white";
	cmbEmgCd.BKColor= "white";
	cmbQorCd.BKColor= "white";
	cmbSubas.BKColor= "white";
	txtAssNo.BKColor= "white";
	cmbComCd.BKColor= "white";
	cmbDecCd.BKColor= "white";
	txtPrtNo.BKColor= "white";
	cmbChoCd.BKColor= "white";
	cmbHyoCd.BKColor= "white";
	cmbCauCd.BKColor= "white";
	cmbTruCd.BKColor= "white";
	mtbPaDat.BKColor= "white";
	mtbPaTim.BKColor= "white";
	mtbUrDat.BKColor= "white";
	mtbUrTim.BKColor= "white";
	cmbKdown.BKColor= "white";
	mtbKsDat.BKColor= "white";
	mtbKsTim.BKColor= "white";
	mtbWnDat.BKColor= "white";
	mtbWnTim.BKColor= "white";
	txtBfrHr.BKColor= "white";
	txtWrkHr.BKColor= "white";
	txtJanHr.BKColor= "white";
	cmbRepCd.BKColor= "white";
	txtECost.BKColor= "white";
	txtHyosn.BKColor= "white";
	txtWonin.BKColor= "white";
	txtDaech.BKColor= "white";
	txtWrkm1.BKColor= "white";
	
	ds_obj220pf.DeleteAll();
}

function btnClear_OnClick(obj)
{
	text_clear();
	grid_clean();

}

function txthyosn_OnKillFocus(obj)
{
	chkbyte_db2(obj);
}

function txtWonin_OnKillFocus(obj)
{
	chkbyte_db2(obj);
}

function txtDaech_OnKillFocus(obj)
{
	chkbyte_db2(obj);
}

function txtCNote_OnKillFocus(obj)
{
	chkbyte_db2(obj);
}
//DB2에서 한글입력시 양쪽에 1byte씩생성됨, 두글자입력시6byte, 한글자입력시 4Byte
function chkbyte_db2(obj){
	
	var chkbyte = 0;
	var msgVal = obj.Text;
	var temval = "";
	var ch = "";
	for(var i = 0 ; i < msgVal.length; i++){
			temval = ch;
			ch =Asc(msgVal.CharAt(i));

		if(i == (msgVal.length)-1){
			if( length(urlEncode(ch)) > 4){
				if(length(urlEncode(temval)) > 4){
					chkbyte +=3;
				}
				else {
					chkbyte +=4;
				}
			}
			else{
				if(length(urlEncode(temval)) > 4){
					chkbyte +=2;
				}
				else {
					chkbyte++;
				}
			}
		
		}
		else{
			if( length(urlEncode(ch)) > 4){
				if(length(urlEncode(temval)) > 4){
					chkbyte +=2;
				}
				else {
					chkbyte +=3;
				}
			}
			else{
				if(length(urlEncode(temval)) > 4){
					chkbyte +=2;
				}
				else {
					chkbyte++;
				}
			}
		}
		if(chkbyte > obj.MaxLength){
			//alert("total==="+chkbyte);
			//alert("입력범위"+ obj.MaxLength+"Byte 를 초과했습니다. 초과된 부분은 삭제합니다.");
			alert(setPopMessage("2561"));
			var dcVal=substr(obj.Text,0,i);
			obj.Text = dcVal;
			break;	
		}
	}
}


function txtmshno_OnKillFocus(obj)
{
	
	if(length(txtmshno.Text)==0){
		return;
	}
	txtmshno_chk();
}

function txtWrkm2_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar != 13)
		return;
	cmbRepCd.SetFocus();
}

//double => oneclick 변경
function Grid_cmbHyoCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	hkind=ds_obc190pf.GetColumn(nRow,"HKIND");
	Grid_cmbHyoCd.Visible=false;
	PopHKndCd.Visible=true;
	getogm203_PopHKndCd(hkind);
}

function PopHKndCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	cmbHyoCd.Value = ds_obc180pf.GetColumn(nRow,"HYOCD");
	txtHyoNm.Text = ds_obc180pf.GetColumn(nRow,"HYONM");
	PopHKndCd.Visible=false;
	cmbCauCd.SetFocus();
	if(length(trim(cmbCauCd.Value))==0){
		if(trim(cmbHyoCd.Value) == "99"){
			return;
		}
		cmbCauCd_OnClick();
	}	
}

function Grid_cmbComCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	KndCd=ds_obc220pf.GetColumn(nRow,"KNDCD");
	Grid_cmbComCd.Visible=false;
	PopKndCd.Visible=true;
	getogm203_PopKndCd(KndCd);
}

function PopKndCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	umhen=ds_obc060pf_01.GetColumn(nRow,"UMHEN");
	PopKndCd.Visible=false;
	PopUmhen.Visible=true;
	getogm203_PopUmhen(KndCd, umhen);
}

function PopUmhen_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	cmbComCd.Value = ds_obc060pf_02.GetColumn(nRow,"COMCD");
	txtCpart.Text = ds_obc060pf_02.GetColumn(nRow,"CPART");
	PopUmhen.Visible=false;
	cmbDecCd.SetFocus();
	if(length(trim(cmbDecCd.Value))==0){
		cmbDecCd_OnClick();
	}
}

function Grid_cmbDecCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	dKndCd = ds_obc070pf.GetColumn(nRow,"KNDCD");
	Grid_cmbDecCd.Visible=false;
	PopDKndCd.Visible=true;
	getogm203_PopDKndCd(dKndCd);
}

function PopDKndCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	dumhen = ds_obc050pf_01.GetColumn(nRow,"UMHEN");
	PopDKndCd.Visible=false;
	PopDUmhen.Visible=true;
	getogm203_PopDUmhen(dKndCd, dumhen);
}

function PopDUmhen_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	cmbDecCd.Value = ds_obc050pf_02.GetColumn(nRow,"DECCD");
	txtDpart.Text = ds_obc050pf_02.GetColumn(nRow,"DPART");
	PopDUmhen.Visible=false;
	cmbChoCd.SetFocus();
}

function Grid_cmbCauCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	ckind=ds_obc120pf.GetColumn(nRow,"CKIND");
	Grid_cmbCauCd.Visible=false;
	PopCkndCd.Visible=true;
	getogm203_PopCKndCd(cKind);
}


function PopCkndCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	cmbCauCd.Value = ds_obc110pf.GetColumn(nRow,"CAUCD");
	txtCauNm.Text = ds_obc110pf.GetColumn(nRow,"CAUSE");
	PopCkndCd.Visible=false;
	cmbTruCd.SetFocus();
	if(length(trim(cmbTruCd.Value))==0){
		cmbTruCd_OnClick();
	}
}

function Grid_cmbTruCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	tkind=ds_obc100pf.GetColumn(nRow,"TKIND");
	Grid_cmbTruCd.Visible=false;
	PopTKndCd.Visible=true;
	getogm203_PopTKndCd(tkind);	
}

function PopTKndCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	cmbTruCd.Value = ds_obc090pf.GetColumn(nRow,"TRUCD");
	txtTruNm.Text = ds_obc090pf.GetColumn(nRow,"TRUNM");
	PopTKndCd.Visible=false;
	if(mtbPaDat.Enable==false){
		mtbKsDat.SetFocus();
	}
	mtbPaDat.SetFocus();
}

function Grid_cmbEffCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	ekind=ds_obc210pf.GetColumn(nRow,"EKIND");
	Grid_cmbEffCd.Visible=false;
	PopEKndCd.Visible=true;
	getogm203_PopEKndCd(ekind);	
}

function PopEKndCd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	cmbEffCd.Value = ds_obc200pf.GetColumn(nRow,"EFFCD");
	txtEffNm.Text = ds_obc200pf.GetColumn(nRow,"EFFNM");
	PopEKndCd.Visible=false;	
}

function grid_clean(){

	Grid_cmbHyoCd.Visible=false;
	PopHKndCd.Visible=false;
	
	Grid_cmbComCd.Visible=false;
	PopKndCd.Visible=false;
	PopUmhen.Visible=false;

	Grid_cmbDecCd.Visible=false;
	PopDKndCd.Visible=false;
	PopDUmhen.Visible=false;
	
	Grid_cmbCauCd.Visible=false;
	PopCkndCd.Visible=false;
	Grid_cmbTruCd.Visible=false;
	PopTKndCd.Visible=false;
	Grid_cmbEffCd.Visible=false;
	PopEKndCd.Visible=false;
}]]></Script>
</Window>