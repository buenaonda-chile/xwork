<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="#ede2af" Height="1000" Id="UserList" Left="8" OnFocus="UserList_OnFocus" OnLoadCompleted="on_LoadCompleted" OnTimer="UserList_OnTimer" PidAttrib="7" Title="전광판&#32;생산현황&#32;조회" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1280" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_OBSE01_1"></Dataset>
			<Dataset DataSetType="Dataset" Id="Line"></Dataset>
		</Datasets>
		<Static BKColor="#f9f7e3" Border="Flat" BorderColor="black" Height="168" Id="Static19" Left="448" TabOrder="28" Top="744" Width="816"></Static>
		<Static BKColor="#f9f7e3" Border="Flat" BorderColor="black" Height="328" Id="Static5" Left="448" TabOrder="27" Top="408" Width="816"></Static>
		<Static BKColor="#f9f7e3" Border="Flat" BorderColor="black" Height="328" Id="Static4" Left="448" TabOrder="26" Top="72" Width="816"></Static>
		<Static BKColor="#f9f7e3" Border="Flat" BorderColor="black" Height="840" Id="Static12" Left="8" TabOrder="24" Top="72" Width="424"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="25" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="24" Width="24"></File>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static8" Left="464" TabOrder="1" Text="금일생산" Top="88" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static0" Left="464" TabOrder="2" Text="생산능력" Top="248" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static1" Left="464" TabOrder="4" Text="달성율&#32;&#32;&#32;" Top="584" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static2" Left="464" TabOrder="3" Text="생산실적" Top="424" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" BKColor="#f9f7e3" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static3" Left="464" TabOrder="5" Text="싸이클타임" Top="760" VAlign="Middle" VClip="Top" Width="400"></Static>
		<Static Align="Center" Border="None" BorderColor="white" Color="black" Font="맑은&#32;고딕,24,Bold" Height="50" Id="st_TIME" Left="1112" TabOrder="16" Top="16" VAlign="Middle" Width="150"></Static>
		<Static Align="Center" Border="None" BorderColor="white" Color="black" Font="맑은&#32;고딕,24,Bold" Height="50" Id="st_DATE" Left="928" TabOrder="17" Top="16" VAlign="Middle" Width="180"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,41,Bold" Height="64" Id="Static13" Left="800" TabOrder="18" Text="(A)" Top="137" VAlign="Middle" VClip="Top" Width="72"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,41,Bold" Height="64" Id="Static14" Left="800" TabOrder="19" Text="(B)" Top="301" VAlign="Middle" VClip="Top" Width="72"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,41,Bold" Height="64" Id="Static15" Left="800" TabOrder="20" Text="(C)" Top="475" VAlign="Middle" VClip="Top" Width="72"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,41,Bold" Height="64" Id="Static16" Left="808" TabOrder="21" Text="B)" Top="637" VAlign="Middle" VClip="Top" Width="72"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,41,Bold" Height="64" Id="Static17" Left="712" TabOrder="22" Text="(C" Top="637" VAlign="Middle" VClip="Top" Width="72"></Static>
		<Static Align="Center" Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,41,Bold" Height="64" Id="Static18" Left="760" TabOrder="23" Text="÷" Top="637" VAlign="Middle" VClip="Top" Width="72"></Static>
		<Image BorderColor="black" DisableBKColor="#f9f7e3" Enable="FALSE" FillType="STRETCH" Height="344" Id="img_LIND" Left="9" TabOrder="25" Top="536" Width="422"></Image>
		<Static Align="Center" BKColor="white" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static21" Left="880" TabOrder="29" Top="248" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Static Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,48,Bold" Height="90" Id="Static7" Left="1184" TabOrder="11" Text="대" Top="273" Width="70"></Static>
		<MaskEdit Align="Right" BindDataset="ds_OBSE01_1" Border="None" BorderColor="black" Column="ATOQY" DisableBKColor="white" DisableColor="blue" Enable="FALSE" Font="맑은&#32;고딕,60,Bold" Height="138" Id="MaskEdit2" Left="882" TabOrder="9" Top="249" Value="MaskEdit0" Width="300"></MaskEdit>
		<Static Align="Center" BKColor="white" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static22" Left="880" TabOrder="31" Top="424" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Static Align="Center" BKColor="white" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static23" Left="880" TabOrder="32" Top="584" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Static Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,48,Bold" Height="90" Id="Static10" Left="1184" TabOrder="14" Text="%" Top="608" Width="70"></Static>
		<MaskEdit Align="Right" BindDataset="ds_OBSE01_1" BKColor="white" Border="None" BorderColor="black" Column="ATOQY_RATE" DisableBKColor="white" DisableColor="blue" Enable="FALSE" Font="맑은&#32;고딕,60,Bold" Height="138" Id="MaskEdit0" Left="882" TabOrder="7" Top="585" Value="MaskEdit0" Width="300"></MaskEdit>
		<Static Align="Center" BKColor="white" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static24" Left="880" TabOrder="33" Top="760" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Static Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,48,Bold" Height="90" Id="Static11" Left="1104" TabOrder="15" Text="초/대" Top="785" Width="150"></Static>
		<Edit Align="RIGHT" BindDataset="ds_OBSE01_1" BKColor="white" Border="None" BorderColor="black" Column="CYCTM" DisableBKColor="white" DisableColor="blue" Enable="FALSE" Font="맑은&#32;고딕,60,Bold" Height="138" Id="Edit4" Left="882" Number="TRUE" Readonly="TRUE" TabOrder="6" Text="105" Top="761" Width="220"></Edit>
		<Static Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,48,Bold" Height="90" Id="Static9" Left="1184" TabOrder="13" Text="대" Top="449" Width="70"></Static>
		<MaskEdit Align="Right" BindDataset="ds_OBSE01_1" BKColor="white" Border="None" BorderColor="black" Column="PRDQY" DisableBKColor="white" DisableColor="blue" Enable="FALSE" Font="맑은&#32;고딕,60,Bold" Height="138" Id="MaskEdit1" Left="882" TabOrder="8" Top="425" Value="MaskEdit0" Width="300"></MaskEdit>
		<Static Align="Center" BKColor="white" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="140" Id="Static20" Left="880" TabOrder="30" Top="88" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Static Border="None" BorderColor="black" Color="black" Font="맑은&#32;고딕,48,Bold" Height="90" Id="Static6" Left="1184" TabOrder="12" Text="대" Top="113" Width="70"></Static>
		<MaskEdit Align="Right" BindDataset="ds_OBSE01_1" Border="None" BorderColor="black" Column="FSTQY" DisableBKColor="white" DisableColor="blue" Enable="FALSE" Font="맑은&#32;고딕,60,Bold" Height="138" Id="MaskEdit3" Left="882" TabOrder="10" Top="89" Value="MaskEdit0" Width="300"></MaskEdit>
		<Static Align="Center" Border="None" BorderColor="#b4b4b4" Color="blue" Font="맑은&#32;고딕,60,Bold" Height="140" Id="st_LINENM" Left="56" TabOrder="34" Text="라인명" Top="152" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" BindDataset="ds_OBSE01_1" Border="None" BorderColor="#b4b4b4" Color="blue" Column="CARNM" Font="맑은&#32;고딕,60,Bold" Height="140" Id="st_CARNM" Left="56" TabOrder="35" Text="차종명" Top="288" VAlign="Middle" VClip="Top" Width="350"></Static>
	</Form>
	<Script><![CDATA[ /*--------------------------------------------------------------
 * @version               : 1.0 
 * @author                : 민명규
 * @see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : OBSE01.xml
 * ● PROGRAM DESCRIPTION  : 전광판 생산현황 조회
 * ● DATE WRITTEN         : 2014.07.10
----------------------------------------------------------------*/

#include "script::lib_script_common.js";

var Lib1 = G_ds_user.GetColumn(0,"LIB1");    //CIGMA LIBRARY(PERESLIB              PSRESLIB)
var Lib2 = G_ds_user.GetColumn(0,"LIB2");    //MRP LIBRARY(PSEDBLIB                PSCDBLIB)
var Lib3 = G_ds_user.GetColumn(0,"LIB3");    //인사급여 LIBRARY(PSEDBLIB           PSCDBLIB.PSHDBLIB.PSSDBLIB)

var company = G_ds_user.GetColumn(0,"COMPANY"); //PE      PS
var comps = G_ds_user.GetColumn(0,"PLANT_CD"); //E1,      C1.H1.S1

var nowDate=today();
var LINE;
var arr = array();
var imgVpath="http://dione.dnke.kr/DIONE_UPDOWN_FILE/dnke_monitoring/";

/********************************************************************** 
 * 개 발 자 :  
 * 개발일자 : 2012-09-26
 * 내용설명 : 화면로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj){
	
	//getTitle();	
	//gFcOnTopButtonColor("1"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)
	//var fnmae=toUpper("LineName");
	var path = "C:\\LineName.txt";

	file.FileName = path;//파일명은 대소문자구분안함.
	file.Open("r"); // Option ( r:read, t:text, b:binary, w:write, a:append )
	arr = split(file.Read(),"\n");
	LINE = toUpper(trim(arr[0]));
	if(length(trim(LINE))=0){
		alert("[알림]저장된 라인코드가 없습니다.");
		return;
	}
	file.Close();
	st_LINENM.Text=toUpper(trim(arr[1]));
	st_CARNM.Text=LINE;
	
	//img_LIND.ImageID="C:\\LINE_IMAGE.jpg";
	img_LIND.ImageID=imgVpath+LINE+".jpg";
	//img_LIND.ImageID="http://dione.dnke.kr/DIONE_UPDOWN_FILE/bojen/images/IM1722_AFT.jpg";

	fn_Search();	
	setTimer(1, 10*1000);
	setTimer(2, 1*1000);
	//setTimer(1, 10*1000);Default
	//setTimer(1, 300*1000);
}

/*
//텍스트 파일(라인정보) 정보 조회
function fn_Search_Line(){	
	var path = "C:\\LineName.txt";

	file.FileName = path;
	file.Open("r"); // Option ( r:read, t:text, b:binary, w:write, a:append )
	LINE = file.Read();
	file.Close();

}
*/
/********************************************************************** 
 * 개 발 자 : 
 * 개발일자 : 2014.07.10
 * 내용설명 : 화면조회
 * 주요변수 : 
 **********************************************************************/ 
function getOBSE01(){
	
	//DNKE 이교대근무자는 QR사용시 익일날짜로 변경후 작업함.
	var p_DAYGU = "";
	var p_sDate = "";
	var p_sTimeHH = "";
	p_sDate = getDate();
	p_sTimeHH = parseInt(substr(p_sDate,8,4));
	if(p_sTimeHH >= 800 && p_sTimeHH <= 2030){
		p_DAYGU="D";
	}else{
		p_DAYGU="N";
	}
	
	if( p_sTimeHH > 2030){
		nowDate = addDate(today(),1);
	}
	//trace(p_sTimeHH+"=="+p_DAYGU+"=="+nowDate);
	http.Sync = true;
	var sKind		= "getOBSE01_1";						
	var sMethodName = "service::psogmlib/selectOBSE01_1.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBSE01_1=ds_OBSE01_1";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";		
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " DATE=" + quote(nowDate);//실적일자
		sArgument += " LINE=" + quote(LINE);//라인코드
		sArgument += " DAYGU=" + quote(p_DAYGU);//주야간구분
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;			
}
 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤 함수들
----------------------------------------------------------------*/

function fn_Search()
{
	getOBSE01();
}
function UserList_OnTimer(obj,nEventID)
{	
	if(nEventID =1){//조회
		fn_Search();
		//trace(getDate());
	}
	if(nEventID =2){//시간
		timeEvent();
	}	
}

function timeEvent(){

var sDate = "";
var sTimeHH = "";
var sTimeMM = "";
var sTimeSS = "";
	sDate = getDate();
	nowDate = substr(sDate,0,8);
	sTimeHH = substr(sDate,8,2);
	sTimeMM = substr(sDate,10,2);
	sTimeSS = substr(sDate,12,2);
		
	st_DATE.Text=substr(getDate(),0,4)+"."+substr(getDate(),4,2)+"."+substr(getDate(),6,2)+".";
	st_TIME.Text=sTimeHH+":"+sTimeMM+":"+sTimeSS;
//alert(sTimeHH+sTimeMM+sTimeSS);
}]]></Script>
</Window>