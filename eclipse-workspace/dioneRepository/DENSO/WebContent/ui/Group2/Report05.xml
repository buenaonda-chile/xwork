<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="592" Id="Report05" Left="8" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="전광판&#32;현황&#32;리포트" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_report">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_daygu">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd></cd>
						<cdnm>[전체]</cdnm>
					</record>
					<record>
						<cd>D</cd>
						<cdnm>주간</cdnm>
					</record>
					<record>
						<cd>N</cd>
						<cdnm>야간</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_COMP"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_VComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_VComCode_COMP"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_runcd">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>R</cd>
						<cdnm>가동</cdnm>
					</record>
					<record>
						<cd>P</cd>
						<cdnm>비가동</cdnm>
					</record>
					<record>
						<cd>S</cd>
						<cdnm>정지</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_daygu2">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>D</cd>
						<cdnm>주간</cdnm>
					</record>
					<record>
						<cd>N</cd>
						<cdnm>야간</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ppmi001mCode"></Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="29" Id="searchBar" Left="1" TabOrder="4" Top="32" Width="1057"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static4" Left="3" TabOrder="4" Top="34" Width="1053"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static1" Left="3" TabOrder="3" Top="34" Width="106"></Static>
		<Shape BKColor="#888888" Bottom="48" Height="5" Id="Shape1" Left="15" LineColor="#dceaf7" Right="20" TabOrder="1" Top="43" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static21" Left="24" Style="static" TabOrder="2" Text="사업부" Top="40" VAlign="Middle" Width="69"></Static>
		<Combo Border="Flat" BorderColor="#888888" CodeColumn="code2" Color="#333333" DataColumn="code_name" Height="21" Id="cb_comp" INDEX="0" InnerDataset="ds_ComCode_PLNT" Left="109" ResetIndex="FIRST" TabOrder="6" Top="35" Width="129"></Combo>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="7" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="7" Top="8" Width="1032"></Static>
		<Ubi Bottom="584" Height="520" Id="Ubi_mediReport" Left="3" Right="1058" Top="64" Width="1055">
			<_PersistData>&#13;&#10;/6y/5PB4/wAAAQAKbQAAd741APjy//7//fL4/PcMDwACBVQAWQBfUABFADD48QH+8C8DMQAyLwABNQH99S8CXgBuSQR0+vn+8C8L&#13;&#10;MgA1agAsOwBrCQRlD28FAfv07vGhAxQGswT+NAIHRABlAGYAH2EAdQBsVwP495gC9vjw8L/78wVTAGgCwgBlVwECA5gC&#13;&#10;</_PersistData>
		</Ubi>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static0" Left="239" TabOrder="23" Top="34" Width="100"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static16" Left="843" TabOrder="12" Top="34" Width="100"></Static>
		<Shape BKColor="#888888" Bottom="48" Height="5" Id="Shape5" Left="856" LineColor="#dceaf7" Right="861" TabOrder="10" Top="43" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static2" Left="865" Style="static" TabOrder="11" Text="로우구분" Top="39" VAlign="Middle" Width="75"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static5" Left="439" TabOrder="15" Top="34" Width="100"></Static>
		<Shape BKColor="#888888" Bottom="48" Height="5" Id="Shape2" Left="451" LineColor="#dceaf7" Right="456" TabOrder="13" Top="43" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static6" Left="461" Style="static" TabOrder="14" Text="공정코드" Top="39" VAlign="Middle" Width="75"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static7" Left="638" TabOrder="18" Top="34" Width="100"></Static>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static8" Left="660" Style="static" TabOrder="17" Text="주야구분" Top="39" VAlign="Middle" Width="75"></Static>
		<Shape BKColor="#888888" Bottom="48" Height="5" Id="Shape3" Left="650" LineColor="#dceaf7" Right="655" TabOrder="16" Top="43" Type="Ellipse" Width="5"></Shape>
		<Combo Border="Flat" BorderColor="SCROLLBAR" CodeColumn="cd" Color="#333333" DataColumn="cdnm" Height="21" Id="cd_daygu" ImeMode="none" INDEX="0" InnerDataset="ds_daygu" Left="740" ResetIndex="FIRST" TabOrder="19" Top="35" Width="90"></Combo>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Height="21" Id="ed_syyyymmdd" Left="341" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="20" Top="36" Width="90"></Calendar>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static3" Left="261" Style="static" TabOrder="21" Text="작업일자" Top="39" VAlign="Middle" Width="75"></Static>
		<Shape BKColor="#888888" Bottom="48" Height="5" Id="Shape0" Left="251" LineColor="#dceaf7" Right="256" TabOrder="22" Top="43" Type="Ellipse" Width="5"></Shape>
		<Edit Border="Flat" BorderColor="#888888" CheckLength="Byte" Height="21" Id="ed_procs" ImeMode="none" Left="540" MaxLength="10" TabOrder="24" Top="36" Width="90"></Edit>
		<Combo Border="Flat" BorderColor="SCROLLBAR" CodeColumn="ROWGB" Color="#333333" DataColumn="ROWNM" Height="21" Id="Combo0" ImeMode="none" INDEX="0" InnerDataset="ds_ppmi001mCode" Left="945" ResetIndex="FIRST" TabOrder="25" Top="35" Width="90"></Combo>
	</Form>
	<Script><![CDATA[
#include "script::lib_script_common.js";
var Lib = G_ds_user.GetColumn(0,"LIB2");
var CigmaLib = G_ds_user.GetColumn(0,"LIB1");

function on_LoadCompleted(obj){	
	getTitle();	
	getComCode();
	//ed_syyyymmdd.value = today();
	//임시	
	ed_syyyymmdd.value = '20091204';
}

function getComCode(){

	http.Sync 	= true;

	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");

	ds_ComCode_PLNT.Filter("code2=='" + G_ds_user.GetColumn(0,"PLANT_CD") +"'");


	http.Sync 	= true;
	var sKind		= "getComCode2";						
	var sMethodName = "service::sample/selectPpmi001MCode.do"; 	
	var sInDataSet  = "";
	var sOutDataSet = "ds_ppmi001mCode=ds_ppmi001mCode";
	var sArgument   = "";
		sArgument   += " LIB=" + quote(Lib);
		sArgument   += " COMPS=" + quote(G_ds_user.GetColumn(0,"PLANT_CD"));

	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");

	ds_ppmi001mCode.InsertRow(0);
	ds_ppmi001mCode.SetColumn(0,"ROWGB","");
	ds_ppmi001mCode.SetColumn(0,"ROWNM","[전체]");
	Combo0.index = 0;	
	http.Sync 	= false;
}

function getReportList(){	
	var sKind		= "getReportList";						
	var sMethodName = "service::report/selectReport05.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             // 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_report=ds_report";    // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";		
	
	sArgument += " LIB=" + quote(Lib);
	sArgument += " COMPS=" + quote(cb_comp.Value);
	sArgument += " ORDAT=" + quote(ed_syyyymmdd.Value);
	sArgument += " PROCS=" + quote(ed_procs.Value);
	sArgument += " DAYGU=" + quote(cd_daygu.Value);
	sArgument += " ROWGB=" + quote(Combo0.Value);	
	
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
}

function loadingReport(){
	Ubi_mediReport.setJrfFileDir(G_baseURL+"/ui/Group2/report/");
	Ubi_mediReport.setJrfFileName("rep5.jrf");
	Ubi_mediReport.SetDataset("ds_report", "ds_report");
	Ubi_mediReport.SetArgument("COMPS", cb_comp.Text);
	Ubi_mediReport.SetArgument("ORDAT", ed_syyyymmdd.Text);
	Ubi_mediReport.Retrieve();
}


function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){
	
		alert(setPopMessage("1002"));
		setMessage("1002");
		
	}else if(svcId=="getReportList"){
		loadingReport();
		// 조회건수가 없을경우
		if(ds_menuList.rowcount <= 0){	
			alert(setPopMessage("1003"));
			setMessage("1003");	
		// 정상 조회
		} else {
			alert(setPopMessage("1004"));
			setMessage("1004");				
		}
	// tran 성공	
	}
}




// 아래 함수는 콩통함수 이므로 모든 화면에 필요

function fn_Search()
{
	getReportList();
}

function fn_Input()
{
	alert(setPopMessage("9999"));
	setMessage("9999");	
}

function fn_Delete()
{	
	alert(setPopMessage("9999"));
	setMessage("9999");	
}

function fn_Save()
{
	alert(setPopMessage("9999"));
	setMessage("9999");	
}

function fn_print()
{
	alert(setPopMessage("9999"));
	setMessage("9999");	
}

function fn_Excel()
{
	alert(setPopMessage("9999"));
	setMessage("9999");	
}

function fn_Help()
{
	
}

]]></Script>
</Window>