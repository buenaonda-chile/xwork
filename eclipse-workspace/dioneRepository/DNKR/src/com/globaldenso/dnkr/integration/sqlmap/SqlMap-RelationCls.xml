<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.globaldenso.dnkr.integration.dao.RelationClsDao">

<!-- 検索結果をMapで受け取る -->
    <resultMap id="RelationCls" type="RelationClsDomain">
        <result property="relationCode" column="CLS_CODE" />
        <result property="useYn" column="CLS_USE" />
        <result property="cmcLangCode" column="CMC_CODE" />
        <result property="relationCode" column="REL_CODE" />
        <result property="rltnCode" column="RLTN_CODE" />
        <result property="relationName" column="REL_NAME" />
    </resultMap>

    <!-- 検索 SQL文（主キー） -->
    <select id="searchByKey" resultMap="RelationCls" parameterType="RelationClsDomain">
        select 
                A.CLS_CODE
              , A.RLTN_CODE
              , A.CLS_USE
              , B.REL_NAME
        from 
                DNKR_RELATION_CLASS A
              , DNKR_RELATION_NM B
        where 
                'SqlMap-RelationCls.searchByKey' = 'SqlMap-RelationCls.searchByKey'
            and A.CLS_CODE = B.REL_CODE
            and A.CLS_CODE = #{relationCode}
        <if test="cmcLangCode != null and cmcLangCode != ''">
            and B.CMC_CODE = #{cmcLangCode}
        </if>
        <if test="cmcLangCode == null or cmcLangCode == ''">
            and B.CMC_CODE = 'en'
       	</if>
    </select>

    <!-- 検索 SQL文（任意条件） -->
    <select id="searchByCondition" resultMap="RelationCls" parameterType="RelationClsDomain">
        select 
                A.CLS_CODE
              , A.RLTN_CODE
              , A.CLS_USE
              , B.REL_NAME
        from 
                DNKR_RELATION_CLASS A
              , DNKR_RELATION_NM B
        where 
                'SqlMap-RelationCls.searchByCondition' = 'SqlMap-RelationCls.searchByCondition'
            and A.CLS_CODE = B.REL_CODE
        <if test="relationCode != null and relationCode != ''">
            and A.CLS_CODE = #{relationCode}
        </if>
        <if test="cmcLangCode != null and cmcLangCode != ''">
            and B.CMC_CODE = #{cmcLangCode}
        </if>
        <if test="useYn != null and useYn != ''">
            and A.CLS_USE = #{useYn}
        </if>
        <if test="relationName != null and relationName != ''">
            and B.REL_NAME Like '%' || #{relationName} || '%'
        </if>
        order by 
                A.CLS_CODE asc
    </select>

    <!-- 検索 SQL文（任意条件、ページング用） -->
    <select id="searchByConditionForPaging" resultMap="RelationCls" parameterType="RelationClsDomain">
        select 
              	A.CLS_CODE
              , A.RLTN_CODE	
              , A.CLS_USE
              , B.REL_NAME
        from (
            select 
	                A.CLS_CODE
	              , A.RLTN_CODE
	              , A.CLS_USE
	              , B.REL_NAME
	        from 
	                DNKR_RELATION_CLASS A
	              , DNKR_RELATION_NM B
	        where 
                    'SqlMap-RelationCls.searchByConditionForPaging' = 'SqlMap-RelationCls.searchByConditionForPaging'
                and A.CLS_CODE = B.REL_CODE
        <if test="relationCode != null and relationCode != ''">
            and A.CLS_CODE = #{relationCode}
        </if>
        <if test="cmclangCode != null and cmclangCode != ''">
            and B.CMC_CODE = #{cmclangCode}
        </if>
        <if test="useYn != null and useYn != ''">
            and A.CLS_USE = #{useYn}
        </if>
        <if test="relationName != null and relationName != ''">
            and B.REL_NAME = #{relationName}
        </if>
            )
        where 
                ROW_NUM between #{rowNumFrom} and #{rowNumTo}
    </select>

    <!-- 検索 SQL文（任意条件 件数取得） -->
    <select id="searchCount" resultType="java.lang.Integer" parameterType="RelationClsDomain">
        select 
                count(rownum) 
        from 
                DNKR_RELATION_CLASS A
              , DNKR_RELATION_NM B
        where 
                'SqlMap-RelationCls.searchCount' = 'SqlMap-RelationCls.searchCount'
            and A.CLS_CODE = B.REL_CODE
        <if test="relationCode != null and relationCode != ''">
            and A.CLS_CODE = #{relationCode}
        </if>
        <if test="cmcLangCode != null and cmcLangCode != ''">
            and B.CMC_CODE = #{cmcLangCode}
        </if>
        <if test="useYn != null and useYn != ''">
            and A.CLS_USE = #{useYn}
        </if>
        <if test="relationName != null and relationName != ''">
            and B.REL_NAME = #{relationName}
        </if>
    </select>

    <!-- 登録 SQL文 -->
    <insert id="createCode" parameterType ="RelationClsDomain">
        insert into DNKR_RELATION_CLASS (
                /* SqlMap-RelationCls.createCode */
            <if test="useYn != null">
                CLS_USE,
            </if>
            <if test="rltnCode != null">
                RLTN_CODE,
            </if>
            <if test="relationCode != null">
                CLS_CODE
            </if>
        ) values (
            <if test="useYn != null">
                #{useYn},
            </if>
            <if test="rltnCode != null">
                #{rltnCode},
            </if>
            <if test="relationCode != null">
                'CLS' || lpad(DNKR_RELATION_CLASS_SEQ.NEXTVAL, 6, '0')
            </if>
        )
    </insert>
    
    <!-- 登録 SQL文 -->
    <insert id="createName" parameterType ="RelationClsDomain">
        insert into DNKR_RELATION_NM (
                /* SqlMap-RelationCls.createName */
            <if test="cmcLangCode != null">
                CMC_CODE,
            </if>
            <if test="relationName != null">
                REL_NAME,
            </if>
            <if test="relationCode != null">
                REL_CODE
            </if>
        ) values (
            <if test="cmcLangCode != null">
                #{cmcLangCode},
            </if>
            <if test="relationName != null">
                #{relationName},
            </if>
             <if test="relationCode != null">
                'CLS' || lpad(DNKR_RELATION_CLASS_SEQ.CURRVAL, 6, '0')
            </if>
        )
    </insert>

	<!-- 更新 SQL文（主キー） -->
    <update id="updateCode" parameterType="RelationClsDomain">
        update 
                DNKR_RELATION_CLASS
        set
            <if test="useYn != null">
                CLS_USE = #{useYn}
            </if>
        where 
                'SqlMap-RelationCls.updateCode' = 'SqlMap-RelationCls.updateCode'
            and CLS_CODE = #{relationCode}
    </update>
    
    <!-- 更新 SQL文（主キー） -->
    <update id="updateName" parameterType="RelationClsDomain">
        update 
                DNKR_RELATION_NM 
        set
            <if test="relationName != null">
                REL_NAME = #{relationName}
            </if>
        where 
                'SqlMap-RelationCls.updateName' = 'SqlMap-RelationCls.updateName'
            and REL_CODE = #{relationCode}
            and CMC_CODE = #{cmcLangCode}
    </update>

    <!-- 削除 SQL文（主キー） -->
    <delete id="deleteCode" parameterType="RelationClsDomain">
        delete from 
                DNKR_RELATION_CLASS
        where 
                'SqlMap-RelationCls.deleteCode' = 'SqlMap-RelationCls.deleteCode'
            and CLS_CODE = #{relationCode}
    </delete>
    
    <!--  -->
    <delete id="deleteName" parameterType="RelationClsDomain">
        delete from 
                DNKR_RELATION_NM
        where 
                'SqlMap-RelationCls.deleteName' = 'SqlMap-RelationCls.deleteName'
        <if test="relationCode != null and relationCode != ''">
            and REL_CODE = #{relationCode}
        </if>
        <if test="cmcLangCode != null and cmcLangCode != ''">
            and CMC_CODE = #{cmcLangCode}
        </if>
    </delete>

</mapper>