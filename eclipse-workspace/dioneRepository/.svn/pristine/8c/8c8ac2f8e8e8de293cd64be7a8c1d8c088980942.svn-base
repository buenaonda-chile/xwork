<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="232" Id="form" Left="8" OnLoadCompleted="fn_OnLoadComPlete" PidAttrib="7" Title="메뉴&#32;비밀번호&#32;변경" TooltipFont="Default,0" Top="8" Ver="1.0" Width="296" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_password2">
				<Contents>
					<colinfo id="USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PASSWORD" size="256" summ="default" type="STRING"/>
					<colinfo id="MENU_PW" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_loginYn"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pwChangeDay"></Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static2" Left="5" TabOrder="28" Top="56" Width="284"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static28" Left="5" TabOrder="32" Top="82" Width="284"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static31" Left="5" TabOrder="36" Top="108" Width="284"></Static>
		<Edit Border="Flat" BorderColor="SCROLLBAR" Height="21" Id="ed_menuPassword2" ImeMode="none" Left="130" Password="TRUE" TabOrder="2" Top="84" Width="155"></Edit>
		<Edit Border="Flat" BorderColor="SCROLLBAR" Height="21" Id="ed_menuPassword3" Left="130" Password="TRUE" TabOrder="3" Top="110" Width="155"></Edit>
		<Edit Border="Flat" BorderColor="SCROLLBAR" Height="21" Id="ed_menuPassword1" Left="130" Password="TRUE" TabOrder="1" Top="58" Width="155"></Edit>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static5" Left="5" TabOrder="24" Top="30" Width="284"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static6" Left="5" TabOrder="20" Top="4" Width="284"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="24" Id="Button0" ImageID="2_btn" Left="124" OnClick="fn_changePw" TabOrder="4" Text="변경" Top="194" Width="53"></Button>
		<Edit Border="Flat" BorderColor="SCROLLBAR" Column="PASSWORD" Enable="FALSE" Height="21" Id="ed_user_id" Left="130" Readonly="TRUE" TabOrder="5" Top="6" Width="155"></Edit>
		<Edit Border="Flat" BorderColor="SCROLLBAR" Column="PASSWORD" Enable="FALSE" Height="21" Id="Edit0" Left="130" Readonly="TRUE" TabOrder="6" Top="32" Width="155"></Edit>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static21" Left="5" TabOrder="12" Top="134" Width="284"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static26" Left="5" TabOrder="16" Top="160" Width="284"></Static>
		<MaskEdit Border="Flat" BorderColor="SCROLLBAR" Color="#333333" Enable="FALSE" Height="21" Id="edt_ldate" Left="130" Mask="@@@@-@@-@@" TabOrder="7" Top="136" Type="STRING" Width="155"></MaskEdit>
		<MaskEdit Border="Flat" BorderColor="SCROLLBAR" Color="#333333" Enable="FALSE" Height="21" Id="edt_ndate" Left="130" Mask="@@@@-@@-@@" TabOrder="8" Top="162" Type="STRING" Width="155"></MaskEdit>
		<Static BKColor="INACTIVECAPTION" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static27" Left="5" TabOrder="11" Top="134" Width="122"></Static>
		<Shape BKColor="#888888" Bottom="149" Height="5" Id="Shape2" Left="18" LineColor="#dceaf7" Right="23" TabOrder="9" Top="144" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static29" Left="28" Style="static" TabOrder="10" Text="최종&#32;변경일자" Top="139" VAlign="Middle" Width="93"></Static>
		<Static BKColor="INACTIVECAPTION" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static30" Left="5" TabOrder="15" Top="160" Width="122"></Static>
		<Shape BKColor="#888888" Bottom="175" Height="5" Id="Shape3" Left="18" LineColor="#dceaf7" Right="23" TabOrder="13" Top="170" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static32" Left="28" Style="static" TabOrder="14" Text="다음&#32;변경일자" Top="165" VAlign="Middle" Width="93"></Static>
		<Static BKColor="INACTIVECAPTION" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static33" Left="5" TabOrder="19" Top="4" Width="122"></Static>
		<Shape BKColor="#888888" Bottom="19" Height="5" Id="Shape4" Left="17" LineColor="#dceaf7" Right="22" TabOrder="17" Top="14" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static34" Left="27" Style="static" TabOrder="18" Text="사용자" Top="9" VAlign="Middle" Width="77"></Static>
		<Static BKColor="INACTIVECAPTION" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static35" Left="5" TabOrder="23" Top="30" Width="122"></Static>
		<Shape BKColor="#888888" Bottom="45" Height="5" Id="Shape5" Left="17" LineColor="#dceaf7" Right="22" TabOrder="21" Top="40" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static36" Left="27" Style="static" TabOrder="22" Text="아이디" Top="35" VAlign="Middle" Width="77"></Static>
		<Static BKColor="INACTIVECAPTION" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static37" Left="5" TabOrder="27" Top="56" Width="122"></Static>
		<Shape BKColor="#888888" Bottom="71" Height="5" Id="Shape6" Left="17" LineColor="#dceaf7" Right="22" TabOrder="25" Top="66" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static38" Left="27" Style="static" TabOrder="26" Text="기존&#32;패스워드" Top="61" VAlign="Middle" Width="93"></Static>
		<Static BKColor="INACTIVECAPTION" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static39" Left="5" TabOrder="31" Top="82" Width="122"></Static>
		<Shape BKColor="#888888" Bottom="97" Height="5" Id="Shape7" Left="17" LineColor="#dceaf7" Right="22" TabOrder="29" Top="92" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static40" Left="27" Style="static" TabOrder="30" Text="신규&#32;패스워드" Top="87" VAlign="Middle" Width="93"></Static>
		<Static BKColor="INACTIVECAPTION" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static41" Left="5" TabOrder="35" Top="108" Width="122"></Static>
		<Shape BKColor="#888888" Bottom="123" Height="5" Id="Shape8" Left="17" LineColor="#dceaf7" Right="22" TabOrder="33" Top="118" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static42" Left="27" Style="static" TabOrder="34" Text="패스워드&#32;확인" Top="113" VAlign="Middle" Width="93"></Static>
	</Form>
	<Script><![CDATA[
#include "script::lib_script_common.js";


function fn_changePw(obj)
{

	if(ed_menuPassword1.Value == ""){
		alert(setPopMessage("2000"));	// 2000 == 비밀번호를 입력하세요.	
		ed_menuPassword1.SetFocus();
		return false ;
	}

	if(ed_menuPassword2.Value == ""){
		alert(setPopMessage("2001"));	// 2001 == 새로운 비밀번호를 입력하세요
		ed_menuPassword2.SetFocus();
		return false ;	
	}	


	if(ed_menuPassword3.Value == ""){
		alert(setPopMessage("2002"));	// 2002 == 비밀번호를 확인하세요
		ed_menuPassword3.SetFocus();
		return false ;	
	}

	if(ed_menuPassword1.Value != G_ds_user.GetColumn(0,"MENU_PW")){
		alert(setPopMessage("2003"));	// 2003 == 기존 비밀번호가 일치하지 않습니다.
		ed_menuPassword1.SetFocus();
		return false ;
	}	

	
	if(length(ed_menuPassword2.Value) < 8){
		alert(setPopMessage("2020"));	// 2001 == 새로운 비밀번호를 입력하세요
		ed_menuPassword2.SetFocus();
		return false ;	
	}		
	
	if(ed_menuPassword2.Value != ed_menuPassword3.Value){
		alert(setPopMessage("2004"));	// 2004 == 새로운 비밀번호가 일치하지 않습니다.
		ed_menuPassword2.Value = "";
		ed_menuPassword3.Value = "";
		ed_menuPassword2.SetFocus();
		return false ;
	}	
	
	ds_password2.AddRow();
	ds_password2.SetColumn(ds_password2.row,"USER_ID",G_ds_user.GetColumn(0,"USER_ID"));
	ds_password2.SetColumn(ds_password2.row,"MENU_PW",ed_menuPassword3.Value);

	
	var sKind		= "setPassWordChang";
	var sMethodName = "service::login/setPassWordChang/change2";
	var sInDataSet  = "ds_password2=ds_password2:U";
	var sOutDataSet = "";
	var sArgument   = "";
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");		

}


function fn_CallBack(sMethodName, ErrorCode, ErrorMSG) {
	if(sMethodName == "setPassWordChang"){
		if(ErrorCode >= 0){
			alert(setPopMessage("2005"));// 2005 == 처리 되었습니다.
			Close();
		}
	}
}


function fn_OnLoadComPlete(obj)
{
	ed_user_id.Value = G_ds_user.GetColumn(0,"USER_NAME");
	Edit0.Value = G_ds_user.GetColumn(0,"USER_ID") ;
	
	http.Sync 		= true;
	var sKind		= "getPassWordChange";		
	var sMethodName = "service::login/getPassWordChange";					
	var sInDataSet  = "";
	var sOutDataSet = "ds_pwChangeDay=ds_pwChangeDay";
	var sArgument   = "";
		sArgument   += " USER_ID=" + quote(G_ds_user.GetColumn(0,"USER_Id"));
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");

	edt_ldate.Value = ds_pwChangeDay.GetColumn(ds_pwChangeDay.row,"PW_DAT");
	edt_ndate.Value = ds_pwChangeDay.GetColumn(ds_pwChangeDay.row,"CHANGE_DAT");		
}
]]></Script>
</Window>