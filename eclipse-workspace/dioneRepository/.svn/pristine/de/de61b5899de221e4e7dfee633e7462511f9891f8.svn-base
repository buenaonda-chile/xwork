<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="UserList" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" OnTimer="UserList_OnTimer" PidAttrib="7" Title="DNKA&#32;사내용&#32;PART&#32;LABEL&#32;발행" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Class">
				<Contents>
					<colinfo id="code" size="256" summ="default" type="STRING"/>
					<colinfo id="code_name" size="256" summ="default" type="STRING"/>
					<record>
						<code>0</code>
						<code_name>전체</code_name>
					</record>
					<record>
						<code>A</code>
						<code_name>(A)최초발행</code_name>
					</record>
					<record>
						<code>B</code>
						<code_name>(B)재발행</code_name>
					</record>
					<record>
						<code>C</code>
						<code_name>(C)이동발행</code_name>
					</record>
					<record>
						<code>D</code>
						<code_name>(D)단수발행</code_name>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FPQC100Q_1"></Dataset>
			<Dataset CanColumnChange="ds_FPQC140Q_4_CanColumnChange" DataSetType="Dataset" Id="ds_FPQC140Q_4"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FPQC140Q_5">
				<Contents>
					<colinfo id="CUSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PROCS" size="256" summ="default" type="STRING"/>
					<colinfo id="PNYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPRTN" size="256" summ="default" type="STRING"/>
					<colinfo id="CPDSC" size="256" summ="default" type="STRING"/>
					<colinfo id="PRCQY" size="256" summ="default" type="STRING"/>
					<colinfo id="REGCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REGNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CARCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CARNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CWHCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="MLTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ITDSC" size="256" summ="default" type="STRING"/>
					<colinfo id="COLOR" size="256" summ="default" type="STRING"/>
					<colinfo id="WKARE" size="256" summ="default" type="STRING"/>
					<colinfo id="MKFAC" size="256" summ="default" type="STRING"/>
					<colinfo id="MKLOC" size="256" summ="default" type="STRING"/>
					<colinfo id="MKCAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CTNNO" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMA" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMB" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMC" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMD" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERME" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMF" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMG" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMH" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMI" size="256" summ="default" type="STRING"/>
					<colinfo id="FRERMJ" size="256" summ="default" type="STRING"/>
					<colinfo id="LOTSZ" size="256" summ="default" type="STRING"/>
					<colinfo id="ORCQY" size="256" summ="default" type="STRING"/>
					<colinfo id="OROQY" size="256" summ="default" type="STRING"/>
					<colinfo id="PRGGU" size="256" summ="default" type="STRING"/>
					<colinfo id="CUSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REP01" size="256" summ="default" type="STRING"/>
					<colinfo id="USNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="MRPSQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTDT" size="256" summ="default" type="STRING"/>
					<colinfo id="PTLCK" size="256" summ="default" type="STRING"/>
					<colinfo id="IDLCK" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="ITC" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTNOL" size="256" summ="default" type="STRING"/>
					<colinfo id="PRODYL" size="256" summ="default" type="STRING"/>
					<colinfo id="CPRTNL" size="256" summ="default" type="STRING"/>
					<colinfo id="CKGUBL" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSQL" size="256" summ="default" type="STRING"/>
					<colinfo id="ISIR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FPQC140Q_737PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Sel">
				<Contents>
					<colinfo id="code" size="256" summ="default" type="STRING"/>
					<colinfo id="code_name" size="256" summ="default" type="STRING"/>
					<record>
						<code>KA</code>
						<code_name>DNKA사내용</code_name>
					</record>
					<record>
						<code>VE</code>
						<code_name>협력업체용</code_name>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="64" Id="searchBar" TabOrder="7" Top="32" Width="1060"></Static>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="2" TabStop="FALSE" Width="1060"></Image>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="4" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="3" Width="24"></File>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static1" Left="4" TabOrder="4" Text="사&#32;&#32;&#32;업&#32;&#32;&#32;부" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="2" Top="8" Width="1032"></Static>
		<Button Height="25" Id="btnQuery" ImageID="btn2_search2" Left="952" OnClick="fn_Search" TabOrder="4" TabStop="FALSE" Text="조회" Top="51" Visible="FALSE" Width="75"></Button>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static11" Left="120" TabOrder="4" Top="34" VAlign="Middle" Width="96"></Static>
		<Combo CodeColumn="code2" DataColumn="code_name" Height="18" Id="ComboBoxPlant" InnerDataset="ds_ComCode_PLNT" Left="124" OnChanged="common_OnChanged" TabOrder="3" Top="38" Width="88"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static5" Left="232" TabOrder="8" Text="생산&#32;지시일" Top="34" VAlign="Middle" Width="116"></Static>
		<Grid AreaSelect="true" AutoFitEndLine="Hide" BindDataset="ds_FPQC140Q_4" BKColor="MENU" BkColor2="LIGHT3D" BkSelColor="lavender" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="576" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="khaki" HeadBorder="Flat" HeadHeight="25" Height="480" Id="grd_main" InputPanel="FALSE" Left="96" LineColor="#888888" MultiSelect="TRUE" Right="1048" TabOrder="1" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="GRAYTEXT" WheelScrollRow="1" Width="952">
			<contents>
				<format id="Default">
					<columns>
						<col width="67"/>
						<col width="61"/>
						<col width="52"/>
						<col width="131"/>
						<col width="74"/>
						<col width="82"/>
						<col width="87"/>
						<col width="90"/>
						<col width="50"/>
						<col width="72"/>
						<col width="104"/>
						<col width="131"/>
						<col width="174"/>
						<col width="131"/>
						<col width="85"/>
						<col width="67"/>
						<col width="63"/>
						<col width="64"/>
						<col width="50"/>
						<col width="64"/>
						<col width="117"/>
						<col width="76"/>
						<col width="102"/>
						<col width="102"/>
						<col width="102"/>
						<col width="102"/>
						<col width="102"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" display="text" text="초도품구분"/>
						<cell bkcolor="#dfdfdf" col="1" color="#002043" display="text" text="업체"/>
						<cell bkcolor="#dfdfdf" col="2" color="#002043" display="text" text="공정"/>
						<cell bkcolor="#dfdfdf" col="3" color="#002043" display="text" text="품번"/>
						<cell bkcolor="#dfdfdf" col="4" color="#002043" display="text" text="생산지시수"/>
						<cell bkcolor="#dfdfdf" col="5" color="#002043" display="text" text="LOT사이즈"/>
						<cell bkcolor="#dfdfdf" col="6" color="#002043" display="text" text="KA일자코드"/>
						<cell bkcolor="#dfdfdf" col="7" color="#002043" display="text" text="업체일자코드"/>
						<cell bkcolor="#dfdfdf" col="8" color="#002043" display="text" text="ALC"/>
						<cell bkcolor="#dfdfdf" col="9" color="#002043" display="text" text="차종코드"/>
						<cell bkcolor="#dfdfdf" col="10" color="#002043" display="text" text="차종명"/>
						<cell bkcolor="#dfdfdf" col="11" color="#002043" display="text" text="업체품번"/>
						<cell bkcolor="#dfdfdf" col="12" color="#002043" display="text" text="업체품명"/>
						<cell bkcolor="#dfdfdf" col="13" color="#002043" display="text" text="품명"/>
						<cell bkcolor="#dfdfdf" col="14" color="#002043" display="text" text="생산지시일"/>
						<cell bkcolor="#dfdfdf" col="15" color="#002043" display="text" text="차륜코드"/>
						<cell bkcolor="#dfdfdf" col="16" color="#002043" display="text" text="납입장소"/>
						<cell bkcolor="#dfdfdf" col="17" color="#002043" display="text" text="발행구분"/>
						<cell bkcolor="#dfdfdf" col="18" color="#002043" display="text" text="업체명"/>
						<cell bkcolor="#dfdfdf" col="19" color="#002043" display="text" text="납품공장"/>
						<cell bkcolor="#dfdfdf" col="20" color="#002043" display="text" text="QR품번"/>
						<cell bkcolor="#dfdfdf" col="21" color="#002043" display="text" text="QR지시일"/>
						<cell bkcolor="#dfdfdf" col="22" color="#002043" display="text" text="QR업체품번"/>
						<cell bkcolor="#dfdfdf" col="23" color="#002043" display="text" text="QR서열코드"/>
						<cell bkcolor="#dfdfdf" col="24" color="#002043" display="text" text="QREO번호"/>
						<cell bkcolor="#dfdfdf" col="25" color="#002043" display="text" text="QR생산라인"/>
						<cell bkcolor="#dfdfdf" col="26" color="#002043" display="text" text="QR구분"/>
					</head>
					<body>
						<cell col="0" colid="ISIR" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="CUSNO" display="normal"/>
						<cell align="center" col="2" colid="PROCS" display="normal"/>
						<cell align="left" col="3" colid="PRTNO" display="normal"/>
						<cell align="right" bkcolor="yellow" col="4" colid="ORCQY" display="number" edit="number"/>
						<cell align="center" col="5" colid="LOTSZ" display="normal"/>
						<cell align="center" col="6" colid="BRDCD" display="normal"/>
						<cell align="center" col="7" colid="MLTCD" display="normal"/>
						<cell align="center" col="8" display="normal"/>
						<cell align="center" col="9" colid="CARCD" display="normal"/>
						<cell align="center" col="10" colid="CARNM" display="normal"/>
						<cell align="left" col="11" colid="CPRTN" display="normal"/>
						<cell align="left" col="12" colid="CPDSC" display="normal"/>
						<cell align="left" col="13" colid="ITDSC" display="normal"/>
						<cell align="center" col="14" colid="PNYMD" display="normal"/>
						<cell align="center" col="15" colid="CWHCD" display="normal"/>
						<cell align="center" col="16" colid="MKLOC" display="normal"/>
						<cell align="center" col="17" colid="PRGGU" display="normal"/>
						<cell align="left" col="18" colid="CUSNM" display="normal"/>
						<cell align="left" col="19" colid="MKFAC" display="normal"/>
						<cell align="left" col="20" colid="PRTNOL" display="normal"/>
						<cell align="center" col="21" colid="PRODYL" display="normal"/>
						<cell align="left" col="22" colid="CPRTNL" display="normal"/>
						<cell align="left" col="23" colid="FRERMH" display="normal"/>
						<cell align="left" col="24" colid="FRERMI" display="normal"/>
						<cell align="left" col="25" colid="ITC" display="normal"/>
						<cell align="left" col="26" colid="FRERMA" display="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static6" Left="348" TabOrder="10" Top="34" VAlign="Middle" Width="96"></Static>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Dateformat="yyyy-MM-dd" FocusIndex="0" Height="18" Id="cal_YMD" Left="352" OnChanged="common_OnChanged" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="11" Top="38" Width="88"></Calendar>
		<Grid AreaSelect="true" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_FPQC100Q_1" BKColor="MENU" BkColor2="LIGHT3D" BkSelColor="lavender" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="576" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" Face3dColor="khaki" HeadBorder="Flat" HeadHeight="25" Height="480" Id="grd_left" InputPanel="FALSE" LineColor="#888888" MinWidth="100" MultiSelect="TRUE" OnCellDBLClick="getFPQC140Q_234" Right="64" TabOrder="12" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="GRAYTEXT" WheelScrollRow="1" Width="64">
			<contents>
				<format id="Default">
					<columns>
						<col width="62"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" display="text" text="공&#32;정"/>
					</head>
					<body>
						<cell align="center" bkcolor='expr:decode(rowlevel,0,&quot;white&quot;,1,&quot;white&quot;,2,&quot;white&quot;,3,&quot;white&quot;)' checklength="Byte" col="0" colid="PROCS" display="normal" limit="1" suppress="1" TrimType="Both" useime="false"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static4" Left="4" TabOrder="13" Text="발&#32;행&#32;구&#32;분" Top="65" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static7" Left="120" TabOrder="14" Top="65" VAlign="Middle" Width="96"></Static>
		<Combo CodeColumn="code" DataColumn="code_name" Enable="FALSE" Height="18" Id="cmb_PRGGU" INDEX="0" InnerDataset="ds_Class" Left="124" OnChanged="common_OnChanged_4" TabOrder="15" Top="69" Width="88"></Combo>
		<Button Height="21" Id="btnPrint" ImageID="sum_print" Left="952" OnClick="fn_print" TabOrder="16" TabStop="FALSE" Text="인쇄" Top="80" Visible="FALSE" Width="72"></Button>
		<Button Height="68" Id="Button1" Left="65" OnClick="getFPQC140Q_234" TabOrder="17" Text="▶" Top="156" Width="28" WordWrap="TRUE"></Button>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="18" Id="Static0" Left="460" TabOrder="18" Text="Printer&#32;Type" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="40" Id="Static2" Left="460" TabOrder="19" Top="52" VAlign="Middle" Width="116"></Static>
		<Checkbox Enable="FALSE" Height="13" Id="cb_Cutting" Left="469" TabOrder="20" Text="Cutting" Top="56" Value="FALSE" Width="99"></Checkbox>
		<Checkbox Enable="FALSE" Height="13" Id="cb_2Dbar" Left="469" TabOrder="21" Text="2D&#32;Barcode" Top="76" Width="99"></Checkbox>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="58" Id="Static9" Left="584" TabOrder="22" Text="Part&#13;&#10;라벨&#13;&#10;형태" Top="34" VAlign="Middle" Width="40"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="58" Id="Static10" Left="624" TabOrder="23" Top="34" VAlign="Middle" Width="140"></Static>
		<Radio Border="None" Height="52" Id="rdoggub" INDEX="0" Left="628" TabOrder="24" Top="36" Width="128">
			<Contents>
				<Layout code="0" height="12" left="10" text="사이즈&#32;30*15mm" top="5" width="120"/>
				<Layout code="3" height="12" left="10" text="사이즈&#32;30*20mm" top="22" width="120"/>
				<Layout code="2" height="12" left="10" text="사이즈&#32;20*15mm" top="39" width="120"/>
			</Contents>
		</Radio>
		<Microsoft Bottom="84" Handshaking="comRTS" Height="33" Id="cmmB570" Left="910" Right="949" RTSEnable="true" Settings="19200,n,8,1" Top="51" Width="39"></Microsoft>
		<Static BKColor="#dfdfdf" Border="Sunken" Height="40" Id="Static12" TabOrder="26" Top="576" Width="1048"></Static>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static13" Left="50" TabOrder="27" Text="인쇄상태" Top="581" Width="84"></Static>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static14" Left="138" TabOrder="28" Text="업&#32;&#32;체" Top="581" Width="84"></Static>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static15" Left="218" TabOrder="29" Text="공&#32;&#32;정" Top="581" Width="116"></Static>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_prstat" Left="50" TabOrder="30" Top="594" Width="87"></Edit>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_CUSNO" Left="146" TabOrder="31" Top="594" Width="63"></Edit>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_PROCS" Left="216" TabOrder="32" Top="592" Width="111"></Edit>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static16" Left="322" TabOrder="33" Text="생산지시수" Top="581" Width="116"></Static>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static17" Left="458" TabOrder="34" Text="품&#32;&#32;번" Top="581" Width="116"></Static>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static18" Left="626" TabOrder="35" Text="업&#32;체&#32;품&#32;&#32;번" Top="581" Width="116"></Static>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static19" Left="780" TabOrder="36" Text="ALC&#32;차종" Top="581" Width="68"></Static>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static20" Left="850" TabOrder="37" Text="인쇄중매수" Top="581" Width="92"></Static>
		<Static Align="Center" Font="Default,9,Bold" Height="12" Id="Static21" Left="922" TabOrder="38" Text="품목최종NO" Top="581" Width="116"></Static>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_ORCQY" Left="338" TabOrder="39" Top="594" Width="79"></Edit>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_PRTNO" Left="426" TabOrder="40" Top="594" Width="167"></Edit>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_CPRTN" Left="602" TabOrder="41" Top="594" Width="167"></Edit>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_MKALC_CARCD" Left="778" TabOrder="42" Top="594" Width="71"></Edit>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_qtying" Left="858" TabOrder="43" Top="594" Width="71"></Edit>
		<Edit Align="CENTER" Enable="FALSE" Height="18" Id="ed_sqn" Left="938" TabOrder="44" Top="594" Width="87"></Edit>
		<Div Border="Flat" Height="128" Id="Div0" Left="344" TabOrder="45" Text="Div0" Top="264" Width="384">
			<Contents>
				<Radio Enable="FALSE" Height="24" Id="rdo_sel" INDEX="0" Left="86" TabOrder="1" Top="38" Width="212">
					<Contents>
						<Layout code="KA" height="12" left="10" text="DNKA사내용" top="4" width="100"/>
						<Layout code="VE" height="12" left="110" text="협력업체용" top="4" width="100"/>
					</Contents>
				</Radio>
				<Button Height="21" Id="btnSel" ImageID="img_select" Left="165" OnClick="Div0_btnSel_OnClick" TabOrder="2" TabStop="FALSE" Text="조회" Top="80" Width="50"></Button>
				<Static Align="Center" Font="Default,9,Bold" Height="13" Id="Static0" Left="88" TabOrder="3" Text="▶&#32;&#32;선택하세요&#32;&#32;◀" Top="18" VAlign="Middle" Width="205"></Static>
			</Contents>
		</Div>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static22" Left="232" TabOrder="46" Text="선&#32;택&#32;구&#32;분" Top="66" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static23" Left="348" TabOrder="47" Top="66" VAlign="Middle" Width="104"></Static>
		<Combo CodeColumn="code" DataColumn="code_name" Height="18" Id="cmb_SEL" INDEX="0" InnerDataset="ds_Sel" Left="352" OnChanged="common_OnChanged_SE" TabOrder="48" Top="70" Width="96"></Combo>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : Jae hb
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : FPQC140Q.xml
 * ● PROGRAM DESCRIPTION  : DNKA 사내용 2DMatrix LABEL 발행
 * ● DATE WRITTEN         : 2015.04.29
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");
var tableSelect = "FPW733PF";  //향후 협력업체용으로 사용할 수 있어서 변수사용
//KE는 FPW730PF KA는 FPW733PF신규생성사용
var ESC1 = binToText(ext_VB_CHR(27)); //binToText    ext_NullToBin
var LF = binToText(ext_VB_CHR(10));
var NUL = binToText(ext_NullToBin(chr(0)));

//var RS = binToText(ext_VB_CHR(30));
//var GS = binToText(ext_VB_CHR(29));
//var EOT = binToText(ext_VB_CHR(04));

//SX라벨프린터 사용시 구분자 값
/*
GS ->  >]
RS ->  >^
EOT ->  >D
> -> >0

일반프린터인경우
GS -> asc(29)
RS -> asc(30)
EOT ->  asc(04)
//안되는 함수들
binToText(ext_VB_CHR(29));
binToText("~029");
chr(30);
*/

//도시바SX5 cutting 기능이 없어 cutting기능 사용안함.

//var ESC1 = (Chr(27)); //27
//var LF = (Chr(10));  //10
//var NUL = (Chr(0));   //0
/*
var ESC1 = &H1B;   //制御文字ESC
var LF = &HA;    //'制御文字LF
var NUL = &H0;   //'制御文字NUL
var SOH = &H1;   //'制御文字SOH
*/

/*
프린터오류코드
//정상출력:0210000
//paperJAM:1110000
//Ribbon에러:2110000
//일시정지:0410000
//프린트OFF후 ON시 발생:0610001
*/
var ForCnt = 0;

var getUserID = G_ds_user.GetColumn(0,"USER_ID");


function on_LoadCompleted(obj){
	getTitle();	
	getDesign();
	gFcOnTopButtonColor("1.4"); //조회,발행 
	getComCode(); //공장구분 선택
	ComboBoxPlant.Enable = false;
	cal_YMD.Enable = false;
	cmb_SEL.Enable = false;
	
	//getUserID="VAN01";
	if(substr(getUserID,0,3)!="VAN"){
		Div0.rdo_sel.Value="KA";
	}else{
		Div0.rdo_sel.Value="VE";
	}
	//alert(timem());
	//trace(substr(getUserID,0,3));
}

function getComCode(){
	var sKind		= "getComCode";						
	var sMethodName = "service::login/getComCodeList"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		sArgument   += " CODE1=" + quote(company);	
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ComboBoxPlant.Value=comps;
	//ComboBoxPlant.Enable = false; 
}

function getDesign(){
	//MainGrid.ToolTipText = setPopMessage("2053");
	grd_left.BkColor = G_ds_design.GetColumn(0,"BkColor");
	grd_left.BkColor2 = G_ds_design.GetColumn(0,"BkColor2");
	grd_left.BkSelColor = G_ds_design.GetColumn(0,"BkSelColor");
	grd_left.Face3dColor = G_ds_design.GetColumn(0,"Face3dColor");
	grd_left.BoldHead = G_ds_design.GetColumn(0,"BoldHead");
	grd_left.HeadHeight = G_ds_design.GetColumn(0,"HeadHeight");
	grd_main.BkColor = G_ds_design.GetColumn(0,"BkColor");
	grd_main.BkColor2 = G_ds_design.GetColumn(0,"BkColor2");
	grd_main.BkSelColor = G_ds_design.GetColumn(0,"BkSelColor");
	grd_main.Face3dColor = G_ds_design.GetColumn(0,"Face3dColor");
	grd_main.BoldHead = G_ds_design.GetColumn(0,"BoldHead");
	grd_main.HeadHeight = G_ds_design.GetColumn(0,"HeadHeight");
	searchBar.Width = G_ds_design.GetColumn(0,"Width");
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	
}

function getFPQC100Q_1(){   //DNKA사내용TAG발행과 같이 사용
	if(length(trim(cal_YMD.Value)) < 8){
		alert(setPopMessage("2528"));  //[[확인] 마감년월을 확인바랍니다.
		setMessage("2528");	
		cal_YMD.SetFocus();
		return;
	}
	//cal_YMD.Value=20150602;

	//DNKA,DNKE공용 사용	
	var sKind		= "getFPQC100Q_1";						
	//var sMethodName = "service::psfaclib/selectFPQC100Q_1.do";     		// 서버에서 호출 될 Method 명
	var sMethodName = "service::barcode/selectFPQC140Q/list1";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var	sOutDataSet = "ds_FPQC100Q_1=ds_FPQC100Q_1";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " PNYMD=" + quote(cal_YMD.Value); //
		sArgument += " TABLE=" + quote(tableSelect);
	//var str = dialog("Common::PGMLOAD_FAC.xml","sKind=" + sKind + " " + "sMethodName=" + sMethodName + " " + "sOutDataSet=" + sOutDataSet + " " + "sArgument=" + sArgument,272,64,"TitleBar=false");
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
}
function getFPQC140Q_234(){
	if(ds_FPQC100Q_1.rowcount <= 0 || ds_FPQC100Q_1.GetRowType(ds_FPQC100Q_1.row) != 'normal') return ;
	var cnt = 0;
	var st_PROCS="(";
	var in_PROCS="";
	var ed_PROCS=")";
	var arrValuePROCS = array(); 

	for(var i=0; i<ds_FPQC100Q_1.RowCount(); i++){
		if(ds_FPQC100Q_1.GetSelect(i) == true){
			arrValuePROCS[cnt] = trim(ds_FPQC100Q_1.GetColumn(i,"PROCS"));
			cnt++;	
		}
	}
	
	if(cnt == 0 ) return ;
	for(var j=0; j<cnt; j++){
		if(j==0){
			in_PROCS="'"+arrValuePROCS[j]+"'";
		}else{
			in_PROCS=in_PROCS+",'"+arrValuePROCS[j]+"'";
		}
	}
	in_PROCS=st_PROCS+in_PROCS+ed_PROCS;
	var sKind		= "getFPQC140Q_234";						
	//var sMethodName = "service::psfaclib/selectFPQC140Q_4.do";     		// 서버에서 호출 될 Method 명
	var sMethodName = "service::barcode/selectFPQC140Q/list4";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var	sOutDataSet = "ds_FPQC140Q_4=ds_FPQC140Q_4";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
		sArgument += " PNYMD=" + quote(cal_YMD.Value); //년월일
		sArgument += " PROCS=" + quote(in_PROCS); //공정코드 multi select
		sArgument += " TABLE=" + quote(tableSelect);
		sArgument += " PRGGU=" + quote(cmb_PRGGU.Value);
	//var str = dialog("Common::PGMLOAD_FAC.xml","sKind=" + sKind + " " + "sMethodName=" + sMethodName + " " + "sOutDataSet=" + sOutDataSet + " " + "sArgument=" + sArgument,272,64,"TitleBar=false");
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
}

function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){
		alert(setPopMessage("1002"));
		setMessage("1002");
		
	}else if(svcId=="getFPQC100Q_1"){
		// 조회건수가 없을경우
		if(ds_FPQC100Q_1.rowcount <= 0){
			alert(setPopMessage("1003"));
			setMessage("1003");	
		}else{
			cmb_PRGGU.Enable = true;
		}
	}else if(svcId=="getFPQC140Q_234"){
		// 조회건수가 없을경우
		if(ds_FPQC140Q_4.rowcount <= 0){
			alert(setPopMessage("1003"));
			setMessage("1003");	
		}else{
			cmb_PRGGU.Enable = false;
		}
	}
}


/********************************************************************** 
 * 내용설명 : validation 체크
 **********************************************************************/  
function validationChk(){

}

/********************************************************************** 
 * 내용설명 : 상위메뉴 변경시 초기화
 **********************************************************************/ 
function common_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_FPQC100Q_1.ClearData();
	ds_FPQC140Q_4.ClearData();
	cmb_PRGGU.Enable = false;
}

function common_OnChanged_1(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_FPQC100Q_1.ClearData();
}

function common_OnChanged_4(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_FPQC140Q_4.ClearData();
}

function common_OnChanged_SE(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "KA"){
		tableSelect = "FPW733PF";
	}else{
		tableSelect = "FPW833PF";
	}
	ds_FPQC100Q_1.ClearData();
	ds_FPQC140Q_4.ClearData();
	cmb_PRGGU.Enable = false;
}
 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Search()
{
	ds_FPQC100Q_1.ClearData();
	ds_FPQC140Q_4.ClearData();
	getFPQC100Q_1();
}

function fn_Input()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Delete()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Save()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fncAxCommOpen()
{
	if(cmmB570.PortOpen == false) {
	     // 하기 mscomm속성을 스크립트로 작성하면 안됨: 원인불명
		//cmmB570.CommPort = 1;
		//cmmB570.Settings = "9600,n,8,1";
		//cmmB570.InputLen = 0;
		//cmmB570.DTREnable = True;
		
		cmmB570.PortOpen = true;
		//alert(cmmB570.PortOpen);
	}
}

function fncAxCommClose()
{       		
	cmmB570.PortOpen = false;
}
function fncOutPut(pStr)
{
	cmmB570.Output = pStr + chr(13) + chr(10);
}

function fn_print()
{
	if(confirm("선택된  PART LABEL 인쇄합니까? ") == false) return;
	
	if(ds_FPQC140Q_4.rowcount <= 0) return ;
	if(!(ds_FPQC140Q_4.GetRowType(ds_FPQC140Q_4.row) == 'normal' || ds_FPQC140Q_4.GetRowType(ds_FPQC140Q_4.row) == 'update')) return ;
	ds_FPQC140Q_5.ClearData();
	for (var row = 0 ; row < ds_FPQC140Q_4.RowCount ; row++ ){   //선택된 것 만 ds_FPQC140Q_5에 ADD
		if(ds_FPQC140Q_4.GetSelect(row) == true){
			ds_FPQC140Q_5.addRow();
			ds_FPQC140Q_5.copyrow(ds_FPQC140Q_5.row,"ds_FPQC140Q_4",row);
		}
	}
	
	if(ds_FPQC140Q_5.rowcount <= 0 ){
		alert("선택후 발행.");
		return;
	}
	
	fncAxCommOpen();
	if(cmmB570.PortOpen == false){
		alert("Serial 통신을위한 COM1 Port오류.");
		return;
	}
	
/*--------------하기명령은 도시바SX5만 해당함으로 주석처리함...	
	//status 요구 커멘드를 송신해 현재의 프린터 상태를 확인-------------------------start
	// cmmB570.Handshaking을 "comRTS"로   cmmB570.RTSEnable을 true로
	cmmB570.Output = ESC1 + "WS" + LF;
	cmmB570.Output = ext_VB_CHR(0);
	var sRcv;
	cmmB570.InputLen = 1;
	
	//sRcv = cmmB570.Input;
	for (var x=0; x < 100; x++){
		sRcv = cmmB570.Input;
		if (sRcv == chr(1)) break;
	}
	//sRcv = cmmB570.Input;
	for (var x=0; x < 100; x++){
		sRcv = cmmB570.Input;
		if (sRcv == chr(2)) break;
	}
	
	cmmB570.InputLen = 11;  //status 7byte+ ETX + EOT + CR + LF
	for (var x=0; x < 100; x++){
		sRcv = cmmB570.Input;
		if (sRcv != "") break;
	}
	var sRtnSts = left(sRcv, 7);
	cmmB570.InputLen = 0;
	if (left(sRtnSts, 2) != "00"){
		alert("프린터 준비가 되지않았습니다");
		return;
	}
	//status 요구 커멘드를 송신해 현재의 프린터 상태를 확인-------------------------end
*/	
	
	
	BarSizePrint();  //LABEL SIZE정보및 LABEL프린터 특성
	
	var jQty = 0;
	var iQty = ds_FPQC140Q_5.RowCount;
	for (var i=0 ; i < iQty ; i++ ){
		FirstPrint(i);     //제일 처음의 한장  금회발행될 정보
		
		prtSTAT(i);
		jQty = toNumber(ds_FPQC140Q_5.GetColumn(i,"ORCQY"));  //발행총매수
		for (var j=0 ; j < jQty ; j++ ){
			
			//프린터 정지기능
			 var printChk = printStatusChk();
			// 프린터 상태 체크
			//DNKA
			/* 일부pc에서 오류발생 -삭제 15.09.16
			if (length(trim(printChk)) == 0){//종료시(2분정도소요)
				if(cb_Cutting.Value){
					BarCutting();
					alert("[알림]프린터종료로 출력이 종료됩니다.");
					return;
			 	 }else{
					alert("[알림]프린터종료로 출력이 종료됩니다.");
					return;
			 	 }
			}
			
			if (printChk == "0610000" || printChk == "0610001"){//프린트OFF후 ON시 발생:0610001
				if(cb_Cutting.Value){
					BarCutting();
					alert("[알림]프린터강제종료로 출력이 종료됩니다.Restar버튼을 눌러주세요.");
					return;
			 	 }else{
					alert("[알림]프린터강제종료로 출력이 종료됩니다.Restar버튼을 눌러주세요.");
					return;
			 	 } 	
			}
			if (printChk == "1110000"|| printChk == "1110001"){//paperJAM:1110000
				if(cb_Cutting.Value){
					BarCutting();
					alert("[알림]프린터 PaperJAM오류로 출력이 종료됩니다.Restar버튼을 눌러주세요.");
					return;
			 	 }else{
					alert("[알림]프린터 PaperJAM오류로 출력이 종료됩니다.Restar버튼을 눌러주세요.");
					return;
			 	 }
			}
			if (printChk == "2110000" || printChk == "2110001"){//Ribbon오류:2110000
				if(cb_Cutting.Value){
					BarCutting();
					alert("[알림]프린터 Ribbon오류로 출력이 종료됩니다.Restar버튼을 눌러주세요.");
					return;
			 	 }else{
					alert("[알림]프린터 Ribbon오류로 출력이 종료됩니다.Restar버튼을 눌러주세요.");
					return;
			 	 }
			}
			if (printChk == "0410000" || printChk == "0410001"){//일시정지:0410000
				while(printChk=="0410001"){
					printChk = printStatusChk();
				
				}
			}
			*/

			if (printChk == "0410000" || printChk == "0410001"){//일시정지:0410000
			 	if(cb_Cutting.Value){
					BarCutting();
					alert("[알림]프린터가 정지되어 출력이 종료됩니다.");
					return;
			 	}else{
					alert("[알림]프린터가 정지되어 출력이 종료됩니다.");
					return;
			 	}
			}
			//END
			//siuFPW737PF("E1",ds_FPQC140Q_5.GetColumn(i,"PRTNOL"),ds_FPQC140Q_5.GetColumn(i,"PNYMD"));   //label 발행번호
			//siuFPW737PF(ComboBoxPlant.Value,ds_FPQC140Q_5.GetColumn(i,"PRTNOL"),ds_FPQC140Q_5.GetColumn(i,"PNYMD"));   //label 발행번호
			siuFPW737PF(ComboBoxPlant.Value,ds_FPQC140Q_5.GetColumn(i,"PRTNO"),ds_FPQC140Q_5.GetColumn(i,"PNYMD"));   //label 발행번호
			var sqn = ds_FPQC140Q_737PF.GetColumn(0,"LSEQN");
			if (toNumber(sqn) > 9999) sqn="1";
			ed_qtying.Text = j; // 인쇄정보 갱신
			ed_sqn.Text = right("0000"+sqn,4);  // 인쇄정보 갱신
			
			BarDataPrint(i,j,sqn);
		}
		if(cb_Cutting.Value) BarCutting();
	}
	ed_prstat.Text = "인쇄완료";
	fncAxCommClose();
}
// 2015-07-02 프린터 상태 체크 Function 추가
function printStatusChk(){
	cmmB570.Output = ESC1 + ("C") + LF;   //BUFFER CLEAR
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "WS" + LF;
	cmmB570.Output = ext_VB_CHR(0);
	var sRcv = "";
	cmmB570.InputLen = 1;
						
	//setSleepTime(10);  //0.01초 Sleep	
	waitTime(10); //0.01초 Sleep	
	//sRcv = cmmB570.Input;
	for (var x=0; x < 100; x++){
		sRcv = cmmB570.Input;
		if (sRcv == chr(1)) break;
	}
	//sRcv = cmmB570.Input;
	for (var x=0; x < 100; x++){
		sRcv = cmmB570.Input;
		if (sRcv == chr(2)) break;
	}
	
	cmmB570.InputLen = 11;  //status 7byte+ ETX + EOT + CR + LF
	for (var x=0; x < 100; x++){
		sRcv = cmmB570.Input;
		if (sRcv != "") break;
	}
	
	var sRtnSts = left(sRcv, 7);
	trace("상태값 : " + sRtnSts);			
	cmmB570.InputLen = 0;
	
	return sRtnSts;
}

function prtSTAT(i)
{
	ed_prstat.Text = "인쇄중";
	ed_PROCS.Text = ds_FPQC140Q_5.GetColumn(i,"PROCS");
	ed_CUSNO.Text = ds_FPQC140Q_5.GetColumn(i,"CUSNO");
	ed_ORCQY.Text = ds_FPQC140Q_5.GetColumn(i,"ORCQY");
	ed_PRTNO.Text = ds_FPQC140Q_5.GetColumn(i,"PRTNO");
	ed_CPRTN.Text = ds_FPQC140Q_5.GetColumn(i,"CPRTN");
	//ed_MKALC_CARCD.Text = ds_FPQC140Q_5.GetColumn(i,"MKALC")+" "+ds_FPQC140Q_5.GetColumn(i,"CARCD");
	ed_MKALC_CARCD.Text = ds_FPQC140Q_5.GetColumn(i,"FRERMH")+" "+ds_FPQC140Q_5.GetColumn(i,"CARCD");
}
function siuFPW737PF(a,b,c)
{
	var comps = a;
	var prtno = b;
	var pnymd = c;
	
	var sKind		= "getFPQC140Q_737PF";						
	//var sMethodName = "service::psfaclib/selectFPQC140Q_737PF.do";     		// 서버에서 호출 될 Method 명
	var sMethodName = "service::barcode/selectFPQC140Q/737PF";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var	sOutDataSet = "ds_FPQC140Q_737PF=ds_FPQC140Q_737PF";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(a); //사업부
		sArgument += " PRTNO=" + quote(b); //품번
		sArgument += " PNYMD=" + quote(c); //년월일
		if (tableSelect=="FPW733PF"){
			sArgument += " TABLE=" + quote("FPW737PF");  // DNKE사내용 part label Seq No   
		}else{
			sArgument += " TABLE=" + quote("FPW837PF");  // 협력업체용(A Part) part label Seq No  
		}
		
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync = false;
}
function BarSizePrint()
{
	var sLabelSize, sLabelFeed, sSizeBuf, sLabelWR, sLabelAX, sLabelAY ;

	cmmB570.Output = ESC1 + "WR" + LF;
	cmmB570.Output = ext_VB_CHR(0);
	//setSleepTime(5000);  // 5초 슬립
	waitTime(3000);//5초 슬립
	switch (rdoggub.Value)
	{
	/*
		case "0" :
		cmmB570.Output = ESC1 + ("D") + ("0150,0500,0130") + LF;
		cmmB570.Output = ext_VB_CHR(0);
		break;
		case "1" :
		cmmB570.Output = ESC1 + ("D") + ("0170,0450,0150") + LF;
		cmmB570.Output = ext_VB_CHR(0);
		break;
		case "2" :
		cmmB570.Output = ESC1 + ("D") + ("0350,0700,0330") + LF;
		cmmB570.Output = ext_VB_CHR(0);
		break;
	*/
	
	// [ESC] Daaaa, bbbb, cccc (, dddd) [LF] [NUL]
	// aaaa: Pitch length of the label or tag bbbb: Effective print width
	// cccc: Effective print length dddd: Backing paper width
		case "0" : //DNKA(30*15)
			cmmB570.Output = ESC1 + ("D") + ("0150,0350,0150") + LF;
			cmmB570.Output = ext_VB_CHR(0);
			break;
/*
		case "1" : //우성(30*20) -  미사용(2017.09.11)
			cmmB570.Output = ESC1 + ("D") + ("0200,0350,0200") + LF;
			cmmB570.Output = ext_VB_CHR(0);
			break;
*/			
		case "2" : //KWB(20*15)
			cmmB570.Output = ESC1 + ("D") + ("0150,0350,0150") + LF;
			cmmB570.Output = ext_VB_CHR(0);
			break;
		case "3" : //DNKA(30*20) - 추가(2017.09.11)
			cmmB570.Output = ESC1 + ("D") + ("0200,0350,0200") + LF;
			cmmB570.Output = ext_VB_CHR(0);
			break;	
		case "99" : //KWB(20*15)
			cmmB570.Output = ESC1 + ("D") + ("0150,0500,0150") + LF;
			cmmB570.Output = ext_VB_CHR(0);
			break;	
		default://최초(45*15)
			cmmB570.Output = ESC1 + ("D") + ("0150,0500,0150") + LF;
			cmmB570.Output = ext_VB_CHR(0);
			break;
	}

	cmmB570.Output = ESC1 + ("AX;") + ("-004,-004,+00") + LF;  //LABEL OR TAG 사이즈 결정
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("AY") + (";+00,0") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("T") + ("21C21") + LF;           //LABEL PRINTER의 특징설정
	cmmB570.Output = ext_VB_CHR(0);
}

function FirstPrint(i)
{
	//setSleepTime(500);  //0.5초 Sleep	
	waitTime(500);///0.5초 Sleep
	cmmB570.Output = ESC1 + ("C") + LF;   //BUFFER CLEAR
	cmmB570.Output = ext_VB_CHR(0);
	switch (rdoggub.Value)
	{
	/*
		case "0" :
		cmmB570.Output = ESC1 + ("PC000;0030,0050,1,15,A,00,B") + LF; //풍성품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC001;0280,0050,1,15,A,00,B") + LF;//작업지시일
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC002;0030,0110,1,15,A,00,B") + LF;//차종명
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC003;0250,0110,1,15,A,00,B") + LF;//공정코드
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC004;0350,0110,1,15,A,00,B") + LF;//득의선
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC005;0420,0050,1,1,A,00,B") + LF;//인쇄매수
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC006;0030,0075,1,1,A,00,B") + LF;//업체품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC007;0280,0075,1,1,A,00,B") + LF;//ID LABEL유무
		cmmB570.Output = ext_VB_CHR(0);
		break;
		case "1" :
		cmmB570.Output = ESC1 + ("PC") + ("000;0085,0050,1,1,G,00,B") + LF; //풍성품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC") + ("001;0260,0070,1,1,G,00,B") + LF; //작업지시일
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC") + ("002;0085,0133,1,15,G,00,B") + LF; //차종명
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC") + ("003;0165,0133,1,15,G,00,B") + LF; //공정코드
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC") + ("004;0270,0133,1,15,G,00,B") + LF; //득의선
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC") + ("005;0265,0030,1,1,G,00,B") + LF; //인쇄매수
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC") + ("006;0085,0090,1,1,G,00,B") + LF; //업체품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC") + ("007;0220,0109,1,1,G,00,B") + LF; //ID LABEL유무
		cmmB570.Output = ext_VB_CHR(0);
		break;
	*/
		case "0" :
		cmmB570.Output = ESC1 + ("PC000;0030,0050,1,1,A,00,B") + LF; //풍성품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC001;0030,0020,1,1,A,00,B") + LF;//작업지시일
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC002;0030,0110,1,1,A,00,B") + LF;//차종명
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC003;0170,0110,1,1,A,00,B") + LF;//공정코드
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC005;0170,0020,1,1,A,00,B") + LF;//인쇄매수
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC006;0030,0080,1,1,A,00,B") + LF;//업체품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC007;0220,0080,1,1,A,00,B") + LF;//초도품 유무
		cmmB570.Output = ext_VB_CHR(0);		
		break;
		case "1" :
		cmmB570.Output = ESC1 + ("PC000;0030,0050,1,1,A,00,B") + LF; //풍성품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC001;0030,0020,1,1,A,00,B") + LF;//작업지시일
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC002;0030,0110,1,1,A,00,B") + LF;//차종명
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC003;0170,0110,1,1,A,00,B") + LF;//공정코드
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC005;0170,0020,1,1,A,00,B") + LF;//인쇄매수
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC006;0030,0080,1,1,A,00,B") + LF;//업체품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC007;0220,0080,1,1,A,00,B") + LF;//초도품 유무
		cmmB570.Output = ext_VB_CHR(0);		
		break;
		case "2" ://위치다름
		cmmB570.Output = ESC1 + ("PC000;0030,0050,1,1,A,00,B") + LF; //풍성품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC001;0030,0020,1,1,A,00,B") + LF;//작업지시일
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC002;0030,0110,1,1,A,00,B") + LF;//차종명
		cmmB570.Output = ext_VB_CHR(0);
		//cmmB570.Output = ESC1 + ("PC003;0170,0110,1,1,A,00,B") + LF;//공정코드
		cmmB570.Output = ESC1 + ("PC003;0140,0110,1,1,A,00,B") + LF;//공정코드
		cmmB570.Output = ext_VB_CHR(0);
		//cmmB570.Output = ESC1 + ("PC005;0170,0020,1,1,A,00,B") + LF;//인쇄매수
		cmmB570.Output = ESC1 + ("PC005;0150,0020,1,1,A,00,B") + LF;//인쇄매수
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC006;0030,0080,1,1,A,00,B") + LF;//업체품번
		cmmB570.Output = ext_VB_CHR(0);
		//cmmB570.Output = ESC1 + ("PC007;0220,0080,1,1,A,00,B") + LF;//초도품 유무
		cmmB570.Output = ESC1 + ("PC007;0190,0080,1,1,A,00,B") + LF;//초도품 유무
		cmmB570.Output = ext_VB_CHR(0);		
		break;
		// 추가 -2017.09.11
		case "3" :
		cmmB570.Output = ESC1 + ("PC000;0030,0050,1,1,A,00,B") + LF; //풍성품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC001;0030,0020,1,1,A,00,B") + LF;//작업지시일
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC002;0030,0110,1,1,A,00,B") + LF;//차종명
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC003;0170,0110,1,1,A,00,B") + LF;//공정코드
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC005;0170,0020,1,1,A,00,B") + LF;//인쇄매수
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC006;0030,0080,1,1,A,00,B") + LF;//업체품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC007;0220,0080,1,1,A,00,B") + LF;//초도품 유무
		cmmB570.Output = ext_VB_CHR(0);		
		break;
		case "99" ://최초(45*15)
		cmmB570.Output = ESC1 + ("PC000;0030,0050,1,1,A,00,B") + LF; //풍성품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC001;0030,0020,1,1,A,00,B") + LF;//작업지시일
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC002;0030,0110,1,1,A,00,B") + LF;//차종명
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC003;0170,0110,1,1,A,00,B") + LF;//공정코드
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC005;0170,0020,1,1,A,00,B") + LF;//인쇄매수
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC006;0030,0080,1,1,A,00,B") + LF;//업체품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC007;0220,0080,1,1,A,00,B") + LF;//초도품 유무
		cmmB570.Output = ext_VB_CHR(0);		
		break;
		default://최초(45*15)
		cmmB570.Output = ESC1 + ("PC000;0030,0050,1,1,A,00,B") + LF; //풍성품번
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC001;0030,0020,1,1,A,00,B") + LF;//작업지시일
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC002;0030,0110,1,1,A,00,B") + LF;//차종명
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC003;0170,0110,1,1,A,00,B") + LF;//공정코드
		cmmB570.Output = ext_VB_CHR(0);
		//cmmB570.Output = ESC1 + ("PC004;0350,0110,1,1,A,00,B") + LF;//득의선
		//cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC005;0170,0020,1,1,A,00,B") + LF;//인쇄매수
		cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC006;0030,0080,1,1,A,00,B") + LF;//업체품번
		cmmB570.Output = ext_VB_CHR(0);
		//cmmB570.Output = ESC1 + ("PC007;0280,0075,1,1,A,00,B") + LF;//ID LABEL유무
		//cmmB570.Output = ext_VB_CHR(0);
		cmmB570.Output = ESC1 + ("PC007;0220,0080,1,1,A,00,B") + LF;//초도품 유무
		cmmB570.Output = ext_VB_CHR(0);	
		break;
	}
	/*
	var tPRTNO = trim(ds_FPQC140Q_5.GetColumn(i,"PRTNO"));
	var tPNYMD = trim(ds_FPQC140Q_5.GetColumn(i,"PNYMD"));
	var tCARNM = trim(ds_FPQC140Q_5.GetColumn(i,"CARNM"));
	var tPROCS = trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"));
	var tCUSNO = trim(ds_FPQC140Q_5.GetColumn(i,"CUSNO"));
	var tORCQY = trim(ds_FPQC140Q_5.GetColumn(i,"ORCQY"));
	var tCPRTN = trim(ds_FPQC140Q_5.GetColumn(i,"CPRTN"));
	var tCKGUBL = trim(ds_FPQC140Q_5.GetColumn(i,"CKGUBL")); ID발행유무

	cmmB570.Output = ESC1 + "RC000;"+tPRTNO + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC001;"+tPNYMD + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC002;"+tCARNM + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC003;"+tPROCS + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC004;"+tCUSNO + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC005;P:"+tORCQY + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC006;"+tCPRTN + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC007;ID LABEL:"+tCKGUBL + LF;	cmmB570.Output = ext_VB_CHR(0);
	*/
	var tPRTNO = trim(ds_FPQC140Q_5.GetColumn(i,"PRTNO"));
	var tPNYMD = trim(ds_FPQC140Q_5.GetColumn(i,"PNYMD"));
	var tCARNM = trim(ds_FPQC140Q_5.GetColumn(i,"CARNM"));
	var tPROCS = trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"));
	var tCUSNO = trim(ds_FPQC140Q_5.GetColumn(i,"CUSNO"));
	var tORCQY = trim(ds_FPQC140Q_5.GetColumn(i,"ORCQY"));
	var tCPRTN = trim(ds_FPQC140Q_5.GetColumn(i,"CPRTN"));
	//var tCKGUBL = trim(ds_FPQC140Q_5.GetColumn(i,"CKGUBL")); ID발행유무
	//var tISIR = trim(ds_FPQC140Q_5.GetColumn(i,"ISIR")); //초도품유무
	var tISIR = iif(trim(ds_FPQC140Q_5.GetColumn(i,"ISIR"))=0, "N","Y"); 
	 
	cmmB570.Output = ESC1 + "RC000;"+tPRTNO + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC001;"+tPNYMD + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC002;"+tCARNM + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC003;"+tPROCS + LF;	cmmB570.Output = ext_VB_CHR(0);
	/*
	if(rdoggub.Value="1"){
		cmmB570.Output = ESC1 + "RC004;"+tCUSNO + LF;	cmmB570.Output = ext_VB_CHR(0);
	}
	*/
	cmmB570.Output = ESC1 + "RC005;P:"+tORCQY + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC006;"+tCPRTN + LF;	cmmB570.Output = ext_VB_CHR(0);
	//cmmB570.Output = ESC1 + "RC007;ID LABEL:"+tCKGUBL + LF;	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "RC007;:"+tISIR + LF;	cmmB570.Output = ext_VB_CHR(0);
		
	cmmB570.Output = ESC1 + ("XS;I,0001,0002C2100") + LF;    //라벨 프린터 발행명령
	cmmB570.Output = ext_VB_CHR(0);
}

function BarDataPrint(i, j, sqn)
{
	//setSleepTime(100);  //0.1초 Sleep	
	cmmB570.InBufferCount = 0;
	cmmB570.OutBufferCount =0;

	//발행SEQ,3자리
	//var qrData2 = right("000"+sqn,3);
	//발행SEQ,4자리
	var qrData2 = right("0000"+sqn,4);
	var CheckLabel;
	if (cb_2Dbar.Value)
		//CheckLabel = "K";  //2D Barcode(Datamatrix)
	switch (rdoggub.Value)
	{
		case "0" :	//30*15
			CheckLabel = "2D";  //2D Barcode(Datamatrix)
			break;
/*	//미사용(2017.09.11)
		case "1" :	//30*20
			CheckLabel = "2D";  //2D Barcode(Datamatrix)
			break;			
*/			
		case "2" :	//20*15
			CheckLabel = "2D1";  //2D Barcode(Datamatrix)
			break;
		case "3" :	//30*20 - 추가(2017.09.11)
			CheckLabel = "2D2";  //2D Barcode(Datamatrix)
			break;			
		case "99" :
			CheckLabel = "K";  //2D Barcode(Datamatrix)
			break;	
		default://최초
			CheckLabel = "K";  //2D Barcode(Datamatrix)
			break;
	}
	var barBuf;
	
	//var a002 = ds_FPQC140Q_5.GetColumn(i,"PRTNO");  // DNKA품번
	//var a005 = ds_FPQC140Q_5.GetColumn(i,"BRDCD");  // KE일자코드
	//var a006 = ds_FPQC140Q_5.GetColumn(i,"MLTCD");  // 업체일자코드
	//var a007 = ds_FPQE140Q_5.GetColumn(i,"MKALC");  // ALC코드
	var a007 = ds_FPQC140Q_5.GetColumn(i,"FRERMH");  // 서열코드
	//var a008 = ds_FPQC140Q_5.GetColumn(i,"CARCD");  // 차종코드
	var a008 = ds_FPQC140Q_5.GetColumn(i,"FRERMI");  // ED번호
	var a010 = ds_FPQC140Q_5.GetColumn(i,"CPRTN");  //업체품번
	//업체품번 '-'제거요청 : 생산관리강근수 2017.04.18
		a010 = replace(ds_FPQC140Q_5.GetColumn(i,"CPRTN"),"-","");	//UI에는 갱신되는 내역이 없음.
	
	var a013 = ds_FPQC140Q_5.GetColumn(i,"PNYMD");  // 계획일자
	var a015 = ds_FPQC140Q_5.GetColumn(i,"COMPS");  // 생산공장
	var a017 = ds_FPQC140Q_5.GetColumn(i,"ITC");  // 생산라인
	var a019 = iif(trim(ds_FPQC140Q_5.GetColumn(i,"ISIR"))=0, "N","Y");  // 초도품구분
	//2015.06.24추가(특이정보 : 업체코드, 덴소품번)
	var a021 = ds_FPQC140Q_5.GetColumn(i,"CUSNO");  // 업체코드
	var a002 = ds_FPQC140Q_5.GetColumn(i,"PRTNOL");  // DNKA품번

	
//trace("서열"+substr(trim(a007)+space(5),0,5));
//trace("생산공장"+substr(trim(a015)+space(2),0,1));
//trace("생산라인"+substr(trim(a017)+space(1),0,1));
	switch (CheckLabel)
	{
		case "2D" :       // KMC JF차종 Datamatrix
			//   XBaa;bbbb,cccc,d,ee,ff,gg,h(,Ciiijjj)(,Jkkllmmmnnn)(=ooo------ooo)|
			//   aa : 바코드 No.  ->00~31
			//   bbbb : 바코드의 기점 X좌표 ->4자리수 고정(0.1 mm단위)
			//   cccc : 바코드의 기점 Y좌표 -> 4자리수 고정(0.1 mm단위)

			barBuf = substr(a007+space(4),0,4);
			cmmB570.Output = ESC1 + ("C") + LF;  cmmB570.Output = ext_VB_CHR(0);//BUFFER CLEAR
			
			//X좌표 왼쪽 여백 1.5MM부분이 X좌표원점임
			//cmmB570.Output = ESC1 + ("XB00;0030,0010,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM
			//cmmB570.Output = ESC1 + ("XB00;0030,0000,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM
			//2016.03.17사이즈변경(모비스인식불가 - 크기변경)
			//cmmB570.Output = ESC1 + ("XB00;0030,0010,Q,20,04,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM
			//2016.08.19사이즈변경(바코드위치 치우침-용지변경)
			cmmB570.Output = ESC1 + ("XB00;0040,0000,Q,20,04,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM

			//하기 출력할 문자값,좌표및 특성결정소
			//cmmB570.Output = ESC1 + "PC000;0140,0055,1,15,E,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			//cmmB570.Output = ESC1 + "PC003;0420,0117,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			// 바코드 사이즈1cm
			//cmmB570.Output = ESC1 + "PC000;0140,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			//cmmB570.Output = ESC1 + "PC002;0140,0080,1,10,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			//2016.03.17사이즈변경(모비스인식불가- 위치변경)
			cmmB570.Output = ESC1 + "PC000;0160,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			cmmB570.Output = ESC1 + "PC002;0160,0080,1,10,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			//cmmB570.Output = ESC1 + "PC003;0070,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			//cmmB570.Output = ESC1 + "PC003;0052,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			//cmmB570.Output = ESC1 + "PC003;0060,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			//2016.03.17사이즈변경(모비스인식불가- 위치변경)
			cmmB570.Output = ESC1 + "PC003;0160,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
		
			var SPT_RS = ">^"; 	// >^= RS
			var SPT_GS = ">]";	// >] = GS
			var SPT_EOT = ">D";	// EOT = EOT
			
			/* DEL2015.11.05
			var barD ="";
			if(length(trim(a008))!=0){
				barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;	
			}else{
				barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M" +trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C" +trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;
			}
			*/
			//2015.11.05수정요청-박주제CJ (값이 없어도 EO, 서열 코드표시)
			var barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;	
			cmmB570.Output = ESC1 + "RB00;"+ barD + LF;  cmmB570.Output = ext_VB_CHR(0); //Datamatrix BARCODE값  
			
			//==============================================================================================================
			//문자값MOVE
			cmmB570.Output = ESC1 + "RC000;"+ a007 + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드->서열코드
			//시리얼번호->업체품번변경 2017.09.07 작업의뢰
			//cmmB570.Output = ESC1 + "RC002;"+ substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4) +qrData2 + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호 - DEL 2017.09.07 
			cmmB570.Output = ESC1 + "RC002;"+ a010 + LF;  cmmB570.Output = ext_VB_CHR(0); // 업체품번(2017.09.07)
			//SEQ
			cmmB570.Output = ESC1 + "RC003;"+ qrData2 + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
				
			//라벨 프린터 발행명령
			cmmB570.Output = ESC1 + ("XS;I,0001,0002C7100") + LF; cmmB570.Output = ext_VB_CHR(0);
			break;
		case "2D1" :       // KMC JF차종 Datamatrix - 협력업체용(20*15)
			barBuf = substr(a007+space(4),0,4);
			cmmB570.Output = ESC1 + ("C") + LF;  cmmB570.Output = ext_VB_CHR(0);//BUFFER CLEAR
			
			//X좌표 왼쪽 여백 1.5MM부분이 X좌표원점임
			//cmmB570.Output = ESC1 + ("XB00;0030,0010,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM
			cmmB570.Output = ESC1 + ("XB00;0030,0000,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM

			//cmmB570.Output = ESC1 + "PC000;0140,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			//PC000 ALC코드 위치수정
			cmmB570.Output = ESC1 + "PC000;0130,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			//PC002시리얼번호삭제
			cmmB570.Output = ESC1 + "PC003;0060,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
		
			var SPT_RS = ">^"; 	// >^= RS
			var SPT_GS = ">]";	// >] = GS
			var SPT_EOT = ">D";	// EOT = EOT
			/* DEL2015.11.05
			var barD ="";
			if(length(trim(a008))!=0){
				barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;	
			}else{
				barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M" +trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C" +trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;
			}
			*/
			//2015.11.05수정요청-박주제CJ (값이 없어도 EO, 서열 코드표시)
			var barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;		
			cmmB570.Output = ESC1 + "RB00;"+ barD + LF;  cmmB570.Output = ext_VB_CHR(0); //Datamatrix BARCODE값  
			
			//==============================================================================================================
			//문자값MOVE
			cmmB570.Output = ESC1 + "RC000;"+ a007 + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드->서열코드
			cmmB570.Output = ESC1 + "RC003;"+ qrData2 + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
				
			//라벨 프린터 발행명령
			cmmB570.Output = ESC1 + ("XS;I,0001,0002C7100") + LF; cmmB570.Output = ext_VB_CHR(0);
			break;
		//사이즈추가(30*20) - 추가 2017.09.11
		case "2D2" :       // KMC JF차종 Datamatrix
			//   XBaa;bbbb,cccc,d,ee,ff,gg,h(,Ciiijjj)(,Jkkllmmmnnn)(=ooo------ooo)|
			//   aa : 바코드 No.  ->00~31
			//   bbbb : 바코드의 기점 X좌표 ->4자리수 고정(0.1 mm단위)
			//   cccc : 바코드의 기점 Y좌표 -> 4자리수 고정(0.1 mm단위)

			barBuf = substr(a007+space(4),0,4);
			cmmB570.Output = ESC1 + ("C") + LF;  cmmB570.Output = ext_VB_CHR(0);//BUFFER CLEAR
			
			//X좌표 왼쪽 여백 1.5MM부분이 X좌표원점임
			//cmmB570.Output = ESC1 + ("XB00;0030,0010,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM
			//2017.09.11 바코드사이즈(1.0->1.5)
			//cmmB570.Output = ESC1 + ("XB00;0030,0000,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM
			cmmB570.Output = ESC1 + ("XB00;0040,0000,Q,20,06,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM

			//하기 출력할 문자값,좌표및 특성결정소
			//cmmB570.Output = ESC1 + "PC000;0160,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			//cmmB570.Output = ESC1 + "PC002;0160,0080,1,10,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			//cmmB570.Output = ESC1 + "PC003;0160,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
						
			cmmB570.Output = ESC1 + "PC000;0210,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			cmmB570.Output = ESC1 + "PC002;0210,0080,1,10,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			cmmB570.Output = ESC1 + "PC003;0210,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
		
			var SPT_RS = ">^"; 	// >^= RS
			var SPT_GS = ">]";	// >] = GS
			var SPT_EOT = ">D";	// EOT = EOT
		
			//2015.11.05수정요청-박주제CJ (값이 없어도 EO, 서열 코드표시)
			var barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;	
			cmmB570.Output = ESC1 + "RB00;"+ barD + LF;  cmmB570.Output = ext_VB_CHR(0); //Datamatrix BARCODE값  
			
			//==============================================================================================================
			//문자값MOVE
			cmmB570.Output = ESC1 + "RC000;"+ a007 + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드->서열코드
			//cmmB570.Output = ESC1 + "RC002;"+ a010 + LF;  cmmB570.Output = ext_VB_CHR(0); // 업체품번(2017.09.07)
			cmmB570.Output = ESC1 + "RC002;"+ substr(a010,0,5) + LF;  cmmB570.Output = ext_VB_CHR(0); // 업체품번 5자릿(2017.09.11)
			cmmB570.Output = ESC1 + "RC003;"+ qrData2 + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
				
			//라벨 프린터 발행명령
			cmmB570.Output = ESC1 + ("XS;I,0001,0002C7100") + LF; cmmB570.Output = ext_VB_CHR(0);
			break;
		case "K" :       // KMC JF차종 Datamatrix
			barBuf = substr(a007+space(4),0,4);
			cmmB570.Output = ESC1 + ("C") + LF;  cmmB570.Output = ext_VB_CHR(0);//BUFFER CLEAR
			
			//X좌표 왼쪽 여백 1.5MM부분이 X좌표원점임
			//cmmB570.Output = ESC1 + ("XB00;0030,0010,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM
			cmmB570.Output = ESC1 + ("XB00;0030,0000,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM

			//하기 출력할 문자값,좌표및 특성결정소
			//cmmB570.Output = ESC1 + "PC000;0140,0055,1,15,E,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			//cmmB570.Output = ESC1 + "PC003;0420,0117,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			// 바코드 사이즈1cm
			cmmB570.Output = ESC1 + "PC000;0140,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			cmmB570.Output = ESC1 + "PC002;0140,0080,1,10,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			//cmmB570.Output = ESC1 + "PC003;0070,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			//cmmB570.Output = ESC1 + "PC003;0052,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			cmmB570.Output = ESC1 + "PC003;0060,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
		
			var SPT_RS = ">^"; 	// >^= RS
			var SPT_GS = ">]";	// >] = GS
			var SPT_EOT = ">D";	// EOT = EOT
			/* DEL2015.11.05
			var barD ="";
			if(length(trim(a008))!=0){
				barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;	
			}else{
				barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M" +trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C" +trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;
			}
			*/
			//2015.11.05수정요청-박주제CJ (값이 없어도 EO, 서열 코드표시)
			var barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;		
			cmmB570.Output = ESC1 + "RB00;"+ barD + LF;  cmmB570.Output = ext_VB_CHR(0); //Datamatrix BARCODE값  
			
			//==============================================================================================================
			//문자값MOVE
			cmmB570.Output = ESC1 + "RC000;"+ a007 + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			cmmB570.Output = ESC1 + "RC002;"+ substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4) +qrData2 + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			cmmB570.Output = ESC1 + "RC003;"+ qrData2 + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
				
			//라벨 프린터 발행명령
			cmmB570.Output = ESC1 + ("XS;I,0001,0002C7100") + LF; cmmB570.Output = ext_VB_CHR(0);
			break;			
		default :
			barBuf = substr(a007+space(4),0,4);
			cmmB570.Output = ESC1 + ("C") + LF;  cmmB570.Output = ext_VB_CHR(0);//BUFFER CLEAR
			
			//X좌표 왼쪽 여백 1.5MM부분이 X좌표원점임
			//cmmB570.Output = ESC1 + ("XB00;0030,0010,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM
			cmmB570.Output = ESC1 + ("XB00;0030,0000,Q,20,03,01,0") + LF; cmmB570.Output = ext_VB_CHR(0); //  Datamatrix  FORMAT,X:5.00MM,Y=1.0MM

			//하기 출력할 문자값,좌표및 특성결정소
			//cmmB570.Output = ESC1 + "PC000;0140,0055,1,15,E,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			//cmmB570.Output = ESC1 + "PC003;0420,0117,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			// 바코드 사이즈1cm
			cmmB570.Output = ESC1 + "PC000;0140,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			cmmB570.Output = ESC1 + "PC002;0140,0080,1,10,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			//cmmB570.Output = ESC1 + "PC003;0070,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			//cmmB570.Output = ESC1 + "PC003;0052,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
			cmmB570.Output = ESC1 + "PC003;0060,0120,05,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
		/*
			//처음코드 아스키전환 후 바코드 사이즈1cm->1.1cm 
			cmmB570.Output = ESC1 + "PC000;0145,0040,1,10,C,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			cmmB570.Output = ESC1 + "PC002;0145,0080,1,10,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			cmmB570.Output = ESC1 + "PC003;0145,0110,1,1,A,00,B" + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ	
		*/
	/*
			//업체코드, 부품번호, 서열코드, EO번호, 제조일자, 교대작업, 생산공장, 생산라인, 재질, 시리얼번호
			var barD = "[)>"+ext_VB_CHR(30)+"06"+ext_VB_CHR(29)+"V"+"P605"+ext_VB_CHR(29)+ "P"+substr(trim(a010)+space(15),0,15) + 
						//ext_VB_CHR(29)+ "S"+substr(trim(a007)+space(5),0,5) + ext_VB_CHR(29)+ "E"+space(8) + 
						ext_VB_CHR(29)+ "S"+substr(trim(a007)+space(5),0,5) + ext_VB_CHR(29)+ "E"+ substr(trim(a008)+space(8),0,8) + 
						ext_VB_CHR(29)+ "T"+substr(trim(a013)+space(6),2,6) + space(1) + substr(trim(a015)+space(2),0,1) +
						substr(trim(a017)+space(1),0,1) + space(1) + substr("A"+space(1),0,1) +
						substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4) +qrData2 + ext_VB_CHR(30)+ext_VB_CHR(4)   ; 
*/
			//업체코드, 부품번호, 서열코드, EO번호, 제조일자, 생산공장, 생산라인, 교대작업, 재질, 시리얼번호, 초도품
			//var barD = "[)>"+ext_VB_CHR(30)+"06"+ext_VB_CHR(29)+"V"+"P605"+ext_VB_CHR(29)+ "P"+substr(trim(a010)+space(15),0,15) + 
/*
			var barD =  ext_VB_CHR(91)+ext_VB_CHR(41)+ext_VB_CHR(62)+
						ext_VB_CHR(30)+"06"+ext_VB_CHR(29)+"V"+"P605"+ext_VB_CHR(29)+ "P"+substr(trim(a010)+space(15),0,15) + 
						//ext_VB_CHR(29)+ "S"+substr(trim(a007)+space(5),0,5) + ext_VB_CHR(29)+ "E"+space(8) + 
						ext_VB_CHR(29)+ "S"+substr(trim(a007)+space(5),0,5) + ext_VB_CHR(29)+ "E"+ substr(trim(a008)+space(8),0,8) + 
						ext_VB_CHR(29)+ "T"+substr(trim(a013)+space(6),2,6) + substr(trim(a015)+space(2),0,1)  +
						substr(trim(a017)+space(1),0,1) + space(1) + space(1)  + substr("A"+space(1),0,1) +
						substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4) +qrData2 +
						ext_VB_CHR(29)+ "M" + substr(trim(a019)+space(1),0,1) +
						//ext_VB_CHR(30)+ext_VB_CHR(4)   ; 
						ext_VB_CHR(29)+ ext_VB_CHR(30)+ext_VB_CHR(4)   ;
*/

			//업체코드, 부품번호, 서열코드, EO번호, 제조일자, 생산공장, 생산라인, 교대작업, 재질, 시리얼번호, 초도품
			//업체코드, DNKA품번
			//var barD =  "[)>"+
	/*		
			var barD =  "[)>0"+
			            ">^"+"06" +
						">]"+"V"+"P605"+
						">]"+ "P"+substr(trim(a010)+space(15),0,15) + 
						//">]"+ "S"+substr(trim(a007)+space(5),0,5) + 
						//">]"+ "E"+ substr(trim(a008)+space(8),0,8) + 
						">]"+ "S"+substr(trim(a007)+space(8),0,8) + 
						">]"+ "E"+ substr(trim(a008)+space(9),0,9) + 
						">]"+ "T"+substr(trim(a013)+space(6),2,6) + substr(trim(a015)+space(2),0,1)  +
						substr(trim(a017)+space(1),0,1) + space(1) + space(1)  + substr("A"+space(1),0,1) +
						substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4) +qrData2 +
						">]"+ "M" + substr(trim(a019)+space(1),0,1) +
						">]"+ "C" + substr(trim(a021)+space(4),0,4) + substr(trim(a002)+space(15),0,15) +
						">]"+ ">^"+ ">D"   ;	
	*/		
			var SPT_RS = ">^"; 	// >^= RS
			var SPT_GS = ">]";	// >] = GS
			var SPT_EOT = ">D";	// EOT = EOT
			
			/* DEL2015.11.05
			var barD ="";
			if(length(trim(a008))!=0){
				barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;	
			}else{
				barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M" +trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C" +trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;
			}
			*/
						
			//수정 2015.11.03
			//=====================================
			/*
			barD = "[)>0"+
					SPT_RS+"06" +
					SPT_GS+"V"+"P605"+
					SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15));
			if(length(trim(a007))!=0){//서열코드
					barD = barD+ SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8));
			}
			if(length(trim(a008))!=0){//EO번호
					barD = barD+ SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9));
			}					
			barD = barD+ 
					SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
					trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
					trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
					SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
					SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
					SPT_GS+ SPT_RS+ SPT_EOT  ;
			*/
			//=====================================
			var barD =  "[)>0"+
			            SPT_RS+"06" +
						SPT_GS+"V"+"P605"+
						SPT_GS+"P"+trim(substr(trim(a010)+space(15),0,15)) + 
						SPT_GS+"S"+trim(substr(trim(a007)+space(8),0,8)) + 
						SPT_GS+"E"+trim(substr(trim(a008)+space(9),0,9)) + 
						SPT_GS+"T"+trim(substr(trim(a013)+space(6),2,6)) + trim(substr(trim(a015)+space(2),0,1))  +
						trim(substr(trim(a017)+space(1),0,1)) + "11" + trim(substr("A"+space(1),0,1)) +
						trim(substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4)) +qrData2 +
						SPT_GS+"M"+trim(substr(trim(a019)+space(1),0,1)) +
						SPT_GS+"C"+trim(substr(trim(a021)+space(4),0,4)) + trim(substr(trim(a002)+space(15),0,15)) +
						SPT_GS+ SPT_RS+ SPT_EOT  ;	
			cmmB570.Output = ESC1 + "RB00;"+ barD + LF;  cmmB570.Output = ext_VB_CHR(0); //Datamatrix BARCODE값  
			
			//==============================================================================================================
			//문자값MOVE
			cmmB570.Output = ESC1 + "RC000;"+ a007 + LF;  cmmB570.Output = ext_VB_CHR(0); // ALC코드
			cmmB570.Output = ESC1 + "RC002;"+ substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4) +qrData2 + LF;  cmmB570.Output = ext_VB_CHR(0); // 시리얼번호
			cmmB570.Output = ESC1 + "RC003;"+ qrData2 + LF;  cmmB570.Output = ext_VB_CHR(0); // SEQ
				
			//라벨 프린터 발행명령
			cmmB570.Output = ESC1 + ("XS;I,0001,0002C7100") + LF; cmmB570.Output = ext_VB_CHR(0);
			break;
	}
}
/*
//test용
function testPrint(i, j, sqn)
{

	//발행SEQ,3자리
	var qrData2 = right("000"+sqn,3);
	//발행SEQ,4자리
	//var qrData2 = right("000"+sqn,4);
	var CheckLabel;
	if (cb_2Dbar.Value)  CheckLabel = "K";  //2D Barcode(Datamatrix)
	var barBuf;
	
	//var a002 = ds_FPQC140Q_5.GetColumn(i,"PRTNO");  // DNKE품번
	//var a005 = ds_FPQC140Q_5.GetColumn(i,"BRDCD");  // KE일자코드
	//var a006 = ds_FPQC140Q_5.GetColumn(i,"MLTCD");  // 업체일자코드
	//var a007 = ds_FPQE140Q_5.GetColumn(i,"MKALC");  // ALC코드
	var a007 = ds_FPQC140Q_5.GetColumn(i,"FRERMH");  // 서열코드
	//var a008 = ds_FPQC140Q_5.GetColumn(i,"CARCD");  // 차종코드
	var a008 = ds_FPQC140Q_5.GetColumn(i,"FRERMI");  // ED번호
	var a010 = ds_FPQC140Q_5.GetColumn(i,"CPRTN");  //업체품번
	var a013 = ds_FPQC140Q_5.GetColumn(i,"PNYMD");  // 계획일자
	var a015 = ds_FPQC140Q_5.GetColumn(i,"COMPS");  // 생산공장
	var a017 = ds_FPQC140Q_5.GetColumn(i,"ITC");  // 생산라인
	var a019 = iif(trim(ds_FPQC140Q_5.GetColumn(i,"ISIR"))=0, "N","Y");  // 초도품구분
	

	switch (CheckLabel)
	{
		case "K" :       // KMC JF차종 Datamatrix
			
			//X좌표 왼쪽 여백 1.5MM부분이 X좌표원점임

			var barD =  "[)>"+
						binToText(ext_VB_CHR(30))+"06" +
						binToText(ext_VB_CHR(29))+"V"+"P605"+
						binToText(ext_VB_CHR(29))+ "P"+substr(trim(a010)+space(15),0,15) + 
						binToText(ext_VB_CHR(29))+ "S"+substr(trim(a007)+space(5),0,5) + 
						binToText(ext_VB_CHR(29))+ "E"+ substr(trim(a008)+space(8),0,8) + 
						binToText(ext_VB_CHR(29))+ "T"+substr(trim(a013)+space(6),2,6) + substr(trim(a015)+space(2),0,1)  +
						substr(trim(a017)+space(1),0,1) + space(1) + space(1)  + substr("A"+space(1),0,1) +
						substr(trim(ds_FPQC140Q_5.GetColumn(i,"PROCS"))+space(4),0,4) +qrData2 +
						binToText(ext_VB_CHR(29))+ "M" + substr(trim(a019)+space(1),0,1) +
						binToText(ext_VB_CHR(29))+ binToText(ext_VB_CHR(30))+ binToText(ext_VB_CHR(4))   ;
				
			Ubi0.setJrfFileDir(G_baseURL+"ui/BARCODE/REPORT/");
			Ubi0.setJrfFileName("2DTEST.jrf");
			Ubi0.SetArgument("barD",barD);
			Ubi0.SetArgument("barD2",a007);
			Ubi0.Retrieve();
			
			//라벨 프린터 발행명령
			break;

		default :
			break;
	}
*/
function BarCutting()
{
	//setSleepTime(500);  //0.5초 Sleep	
	waitTime(500);  //0.5초 Sleep
	
	cmmB570.InBufferCount = 0;
	cmmB570.OutBufferCount =0;
	cmmB570.Output = ESC1 + "C" + LF ;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + "XS;I,0001,0252C6100" + LF;
	///cmmB570.Output = ESC1 + "XS;I,0001,0001C3001" + LF;
	cmmB570.Output = ext_VB_CHR(0);
}

function sampleFirstPrint()
{

	cmmB570.Output = ESC1 + ("C") + LF;   //BUFFER CLEAR
	cmmB570.Output = ext_VB_CHR(0);
	
	cmmB570.Output = ESC1 + ("PC000;0030,0050,1,15,A,00,B") + LF; //풍성품번
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC001;0280,0050,1,15,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC002;0030,0110,1,15,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC003;0250,0110,1,15,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC004;0350,0110,1,15,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC005;0420,0050,1,1,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC006;0030,0075,1,1,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC007;0280,0075,1,1,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	
	cmmB570.Output = ESC1 + ("RC000;11003-055400K") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC001;20150109") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC002;KH STD") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC003;C-31") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC004;1300") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC005;P:1") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC006;94003-3T520") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC007;ID LABEL:1") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	
	cmmB570.Output = ESC1 + ("XS;I,0001,0002C2100") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	
	
	cmmB570.Output = ESC1 + ("C") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("XB00;0070,0010,B,1,02,02,04,04,03,0,0050,+0000000000,0,00") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("XB01;0390,0010,T,L,04,A,0=110030554000615010994003-3T520     1") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	
	cmmB570.Output = ESC1 + ("PC000;0050,0090,1,1,C,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC001;0160,0090,1,15,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC002;0050,0125,1,1,D,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC003;0240,0120,05,05,D,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("PC004;0420,0117,05,1,A,00,B") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	
	cmmB570.Output = ESC1 + ("RB00;0352") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC000;0352") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC001;94003-3T520") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC002;20150109") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC003;11003-055400K") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("RC004;006") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("XS;I,0001,0002C7100") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("C") + LF;
	cmmB570.Output = ext_VB_CHR(0);
	cmmB570.Output = ESC1 + ("XS;I,0001,0252C6100") + LF;
	cmmB570.Output = ext_VB_CHR(0);
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("1.4"); //상단 버튼 활성화 여부 (1.4: 조회,발행)
}

function UserList_OnTimer(obj,nEventID)
{
	ForCnt++;

	if (ForCnt != 5){
		trace("ForCnt ==> " + ForCnt); // 1초 간격으로 이 부분에 로직을 실행합니다.
	} else {
		KillTimer(1);
		alert("End~!!");
	}

}

function ds_FPQC140Q_4_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if( strColumnID == "ORCQY" ){
		if(length(trim(varNewValue)) < 1){
			alert("수량을 확인바랍니다.");
			return false;
		}
		if(toNumber(varNewValue) < 1 || toNumber(varNewValue) > 9999999){
			alert("범위(1~9999999)를 초과하였습니다. 확인바랍니다.");
			return false;
		}
	}
}

function Div0_btnSel_OnClick(obj)
{

	Div0.Visible = false;
	cal_YMD.Value = today();
	cmb_SEL.Value = Div0.rdo_sel.Value;
	ComboBoxPlant.Enable = true;
	cal_YMD.Enable = true;
	cmb_SEL.Enable = true;
	
	if (Div0.rdo_sel.Value == "KA"){
		tableSelect = "FPW733PF";
		
	}else{
		tableSelect = "FPW833PF";
		cmb_SEL.Enable = false;
		ComboBoxPlant.Enable = false;
	}
	//cal_YMD.Value="20150821";
}

function setSleepTime(sleepTime){  
	var sKind		= "setSleepTime";						
	//var sMethodName = "service::pscomlib/setSleepTime.do";     		// 서버에서 호출 될 Method 명
	var sMethodName = "service::barcode/setSleepTime";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var	sOutDataSet = "";    										// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " SLEEPTIME=" + quote(sleepTime);
	//var str = dialog("Common::PGMLOAD_FAC.xml","sKind=" + sKind + " " + "sMethodName=" + sMethodName + " " + "sOutDataSet=" + sOutDataSet + " " + "sArgument=" + sArgument,272,64,"TitleBar=false");
	
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync=false;
}

function waitTime(msecs){
	var start = timem();
	var cur = start;
	//trace(start+"==="+cur);
	while(cur - start < msecs){
		cur = timem();
	}
}

// * CODE39 XB형식
//   XBaa;bbbb,cccc,d,e,ff,gg,hh,ii,jj,k,llll(,mnnnnnnnnnn,p,qq)(,r)
//   aa : 바코드 No.  ->00~31
//   bbbb : 바코드의 기점 X좌표 ->4자리수 고정(0.1 mm단위)
//   cccc : 바코드의 기점 Y좌표 -> 4자리수 고정(0.1 mm단위)
//   d : 바코드 종류
//      ->1 : MSI
//      ->2 : 인타리브드 2 of 5
//      ->3 : CODE39(스탠다드)
//      ->4 : NW7
//      ->B : CODE39(풀 아스키)
//      ->O : 인더스트리얼 2 of 5
//      ->a : Matrix 2 of 5 for NEC
//   e : 체크 디지트의 종류
//      ->1 : 체크 디지트 부가 없음
//      ->2 : 체크 디지트 체크 (CODE39 :모쥬라스43) (MSI:IBM 모쥬라스10) (ITF 모쥬라스10) (인더스트리얼 2of5 모쥬라스체크캐라크타)
//      ->3 : 체크 디지트 자동 부가(1) (CODE39 :모쥬라스43) (MSI:IBM 모쥬라스10) (ITF 모쥬라스10) (인더스트리얼 2of5 모쥬라스체크캐라크타) (Matrix2of5 모쥬라스체크캐라크타)
//      ->4 : 체크 디지트 자동 부가(2) 
//      ->5 : 체크 디지트 자동 부가(2) 
//   ff : 세바폭의 지정   ->01~99 (1 dot 단위)
//   gg : 세스페이스폭의 지정  -> 인더스트리얼 2 of 5의 경우, 엘리먼트간 스페이스의 지정
//   hh : 태바폭의 지정   ->01~99 (1 dot 단위)
//   ii : 태스페이스폭의 지정   ->01~99 (1 dot 단위)   인더스트리얼 2 of 5의 경우 00
//   jj : 캐릭터간 스페이스폭의 지정   ->01~99 (1 dot 단위)  *MSI, ITF의 경우 00
//   k :바코드의 회전 방향  ->0：0о  1：90о  2：180о  3：270о
//   llll : 바코드의 높이   -> 0000~1000 (0.1 mm단위)
//   mnnnnnnnnnn : 인크리먼트(increment)/감소 지정(생략 가능)
//      ->m : 인크리먼트(increment) 하는지 감소 할까의 지정  ＋ : 인크리먼트(increment)   － : 감소
//      ->nnnnnnnnnn: 스킵치
//   p : 바하 숫자 인자의 지정(생략 가능)   -> 0 : 바하 숫자 없음  1 : 바하 숫자 있음
//   qq : 제로 서프레스 하는 자리수(생략 가능)
//   r : 스타트/스톱코드의 부가 지정(생략 가능)



// * QRCODE XB형식
//   XBaa;bbbb,cccc,d,e,ff,g,h(,Mi)(,Kj)(,Jkkllmm)(=nnn---nnn)|
//   aa : 바코드 No.  ->00~31
//   bbbb : 바코드의 기점 X좌표 ->4자리수 고정(0.1 mm단위)
//   cccc : 바코드의 기점 Y좌표 -> 4자리수 고정(0.1 mm단위)
//   d : 코드의 종류  ->T：QR코드(2 차원 코드)
//   e : 잘못 정정 레벨의 지정  ->L：고밀도 레벨  M：표준 레벨  Q：신뢰 레벨  H：고신뢰 레벨
//   ff :1 셀폭의 지정  ->00~99(1 닷 단위)
//   g :모드의 지정  ->M：메뉴얼 모드  A：자동 모드
//   h :바코드의 회전 방향  ->0：0о  1：90о  2：180о  3：270о
//   Mi :모델 지정(생략시 모델 1)  ->i=1：모델 1   2：모델 2
//   Kj :마스크 번호 지정(생략시 자동 설정)   -> j=0~7 ：마스크 번호 0~7   　8 ：마스크 없음
//   Jkkllmm :연결 지정(생략시 연결 없음)  
//       -> kk =01~16：분할한 코드의 몇번째가 될까의 값  
//       -> ll =01~16：분할수의 값   
//       -> mm=00~FF：모든 인자 데이터(분할전의 인자 데이터)를 아르바이트 단위로 EX－OR를 취한 값
//   nnn----nnn:인자하는 데이터열(생략 가능) 최대 2000자리수



//  *datamatrix 데이터 코드(2 차원 코드)의 경우
//   XBaa;bbbb,cccc,d,ee,ff,gg,h(,Ciiijjj)(,Jkkllmmmnnn)(=ooo------ooo)|
//   aa : 바코드 No.  ->00~31
//   bbbb : 바코드의 기점 X좌표 ->4자리수 고정(0.1 mm단위)
//   cccc : 바코드의 기점 Y좌표 -> 4자리수 고정(0.1 mm단위)
//   d : 바코드 종류
//      ->Q : 데이터 코드(2 차원 코드)
//   ee : ECC 타입의 지정    *ECC(Error Correcting Code:에러 수정 부호)
//      -> 00 : ＥＣＣ０
//      -> 01 : ＥＣＣ５０
//      -> 04 : ＥＣＣ５０
//      -> 05 : ＥＣＣ８０
//      -> 06 : ＥＣＣ８０
//      -> 07 : ＥＣＣ８０
//      -> 08 : ＥＣＣ８０
//      -> 09 : ＥＣＣ１００
//      -> 10 : ＥＣＣ１００
//      -> 11 : ＥＣＣ１４０
//      -> 12 : ＥＣＣ１４０
//      -> 13 : ＥＣＣ１４０
//      -> 14 : ＥＣＣ１４０
//      -> 20 : ＥＣＣ２００  
//   ff :1 셀폭의 지정  ->00~99(1 닷 단위)
//   gg : 포맷 ID의 지정
//      -> ECC 타입에서 ECC200를 지정했을 경우, 포맷 ID의 지정은 무시된다.
//   h :바코드의 회전 방향  ->0：0о  1：90о  2：180о  3：270о
//   Ciiijjj : 셀수의 지정(생략시 자동 설정)
//      -> iii　: X방향 셀수　　000~144
//      -> jjj　: Y방향 셀수　　000~144
//      ->ECC의 종류에 의해 셀수의 설정 방법법은 다르다
//      -> 본파라미터 생략시, 셀수는 자동적으로 설정된다.또, X방향, Y방향이라고도 상기표에 기재의 값 이외의 데이터를 지정했을 경우도, 똑같이 셀수는 자동적으로 설정된다.

]]></Script>
</Window>