<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="619" Id="SAMPLE" Left="8" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="업로드" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_main"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="id" size="256" summ="default" type="STRING"/>
					<colinfo id="title" size="256" summ="default" type="STRING"/>
					<colinfo id="text" size="256" summ="default" type="STRING"/>
					<colinfo id="tableNm" size="256" summ="default" type="STRING"/>
					<colinfo id="columnCnt" size="256" summ="default" type="STRING"/>
					<colinfo id="fileType" size="256" summ="default" type="STRING"/>
					<colinfo id="exe" size="256" summ="default" type="STRING"/>
					<record>
						<columnCnt>1</columnCnt>
						<exe>실행</exe>
						<fileType>1</fileType>
						<id>SVHZ454U</id>
						<tableNm>SVH111PF</tableNm>
						<text>매월&#32;기아로&#32;부터&#32;월검수통보서를&#32;받아&#32;풍성환경으로&#32;변환하여&#32;UPLOAD.</text>
						<title>기아월검수통보서&#32;HOST&#32;UPLOAD</title>
					</record>
					<record>
						<columnCnt>1</columnCnt>
						<exe>실행</exe>
						<fileType>3</fileType>
						<id>SVHZ454U</id>
						<tableNm>SVH454PF</tableNm>
						<text>매월&#32;현대로&#32;부터&#32;월검수통보서를&#32;받아&#32;풍성환경으로&#32;변환하여&#32;UPLOAD.</text>
						<title>현대월검수통보서&#32;HOST&#32;UPLOAD</title>
					</record>
					<record>
						<columnCnt>1</columnCnt>
						<exe>실행</exe>
						<fileType>2</fileType>
						<id>SVHZ454U</id>
						<tableNm>SVK904PF</tableNm>
						<text>매일&#32;기아로&#32;부터&#32;주간부품소요계획을&#32;받아&#32;풍성환경으로&#32;변환하여&#32;UPLOAD.</text>
						<title>기아주간부품소요계획&#32;HOST&#32;UPLOAD</title>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="title" size="256" summ="default" type="STRING"/>
					<colinfo id="text" size="256" summ="default" type="STRING"/>
					<colinfo id="tableNm" size="256" summ="default" type="STRING"/>
					<record>
						<tableNm>TABLEA</tableNm>
						<text>현대일일검수통보서&#32;UP</text>
						<title>SVHZ404UCP</title>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="title" size="256" summ="default" type="STRING"/>
					<colinfo id="title2" size="256" summ="default" type="STRING"/>
					<colinfo id="text" size="256" summ="default" type="STRING"/>
					<colinfo id="date" size="256" summ="default" type="STRING"/>
					<colinfo id="tableNm" size="256" summ="default" type="STRING"/>
					<record>
						<date></date>
						<tableNm>TABLEX</tableNm>
						<text>근태이관</text>
						<title>workday</title>
						<title2>근태이관</title2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fileType">
				<Contents>
					<colinfo id="code" size="256" summ="default" type="STRING"/>
					<colinfo id="name" size="256" summ="default" type="STRING"/>
					<record>
						<code>1</code>
						<name>엑셀</name>
					</record>
					<record>
						<code>2</code>
						<name>텍스트</name>
					</record>
					<record>
						<code>3</code>
						<name>CSV</name>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Height="620" Id="Image0" ImageID="pgm_img2" TabOrder="7" Width="1060"></Image>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="#b4b4b4" Bottom="162" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="130" Id="grd_board" InputPanel="FALSE" LineColor="#dfdfdf" MinWidth="100" OnCellClick="onCellCilck" Right="1050" TabOrder="2" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="INACTIVECAPTION" WheelScrollRow="1" Width="1050">
			<contents>
				<format id="Default">
					<columns>
						<col width="197"/>
						<col width="669"/>
						<col width="90"/>
						<col width="90"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" display="text" text="업로드&#32;내역"/>
						<cell bkcolor="#dfdfdf" col="1" color="#002043" display="text" text="설명"/>
						<cell bkcolor="#dfdfdf" col="2" color="#002043" display="text" text="파일형식"/>
						<cell bkcolor="#dfdfdf" col="3" color="#002043" display="text" text="업로드"/>
					</head>
					<body>
						<cell align="left" col="0" colid="title" display="normal"/>
						<cell align="left" col="1" colid="text" combocol="code1" combodataset="ds_mdtp" combotext="code_name" display="normal"/>
						<cell align="center" col="2" colid="fileType" combocol="code" combodataset="ds_fileType" combotext="name" display="combo"/>
						<cell align="center" bkimageid="blue_btn" col="3" colid="exe" display="button" text="실행"/>
					</body>
				</format>
			</contents>
		</Grid>
		<File Bottom="232" Height="24" Id="File" Left="992" Right="1016" TabOrder="17" Top="208" Width="24"></File>
		<FileDialog Bottom="232" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1019" MultiSelect="TRUE" Right="1043" TabOrder="19" Top="208" Type="Save" Width="24"></FileDialog>
		<Grid AutoEnter="TRUE" BindDataset="ds_main" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="#b4b4b4" Bottom="1080" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="25" Height="96" Id="Grid0" InputPanel="FALSE" Left="16" LineColor="#b4b4b4" OnCellClick="onCellCilck" Right="243" ScrollCell="true" TabOrder="1" TabStop="true" Top="984" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="#b4b4b4" WheelScrollRow="1" Width="227">
			<contents>
				<format id="Default"></format>
			</contents>
		</Grid>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="4" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="4" Top="8" Width="1032"></Static>
		<Shape BKColor="#888888" Bottom="46" Height="5" Id="Shape5" Left="820" LineColor="#dceaf7" Right="825" TabOrder="5" Top="41" Type="Ellipse" Width="5"></Shape>
		<Shape BKColor="#888888" Bottom="46" Height="5" Id="Shape1" Left="16" LineColor="#dceaf7" Right="21" TabOrder="6" Top="41" Type="Ellipse" Width="5"></Shape>
		<Shape BKColor="#888888" Bottom="46" Height="5" Id="Shape2" Left="415" LineColor="#dceaf7" Right="420" TabOrder="7" Top="41" Type="Ellipse" Width="5"></Shape>
		<Shape BKColor="#888888" Bottom="46" Height="5" Id="Shape3" Left="614" LineColor="#dceaf7" Right="619" TabOrder="8" Top="41" Type="Ellipse" Width="5"></Shape>
		<Shape BKColor="#888888" Bottom="46" Height="5" Id="Shape0" Left="215" LineColor="#dceaf7" Right="220" TabOrder="9" Top="41" Type="Ellipse" Width="5"></Shape>
	</Form>
	<Script><![CDATA[ /*--------------------------------------------------------------
 * @version               : 1.0 
 * @author                : 황규철
 * @see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : UPLOAD.xml
 * ● PROGRAM DESCRIPTION  : 업로드
 * ● DATE WRITTEN         : 2010.11.26
----------------------------------------------------------------*/
#include "script::lib_script_common.js";

var Lib = G_ds_user.GetColumn(0,"LIB2");

var pgmLib  = "*LIBL";
var param   = "   ";
var exeTime = 1200;

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 화면로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj)
{
	getTitle();
}

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 메인그리드 클릭
 * 주요변수 : 
 **********************************************************************/ 
function onCellCilck(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var tableNm  = ds_list.GetColumn(nRow,"tableNm");
	var yyyymm   = ds_list.GetColumn(nRow,"date");
	var colCnt   = ds_list.GetColumn(nRow,"columnCnt");
	var pgmName  = ds_list.GetColumn(nRow,"id");	
	var fileType  = ds_list.GetColumn(nRow,"fileType");		

	if(nCell == 3)
	{
		if(fileType == "1"){
			uploadExcel();
			saveDataSet(tableNm,pgmName);		
		} else if (fileType == "2") {
			uploadText();
			saveDataSet(tableNm,pgmName);		
		} else {
			uploadCsv(colCnt);
			saveDataSet(tableNm,pgmName);		
		}
	}
}

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 미사용
 * 주요변수 : 
 **********************************************************************/ 
function onCellCilck2(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var tableNm = ds_list2.GetColumn(nRow,"tableNm");
	var yyyymm  = ds_list2.GetColumn(nRow,"date");
	var pgmName  = ds_list.GetColumn(nRow,"id");		
	
	if(nCell == 2)
	{
		uploadText();
		saveDataSet(tableNm,pgmName);
	}
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 엑셀파일 업로드
 * 주요변수 : 
 **********************************************************************/ 
function uploadExcel()
{
	ds_main.DeleteAll();
	FileDialog0.Filter = "ALL File(xls.*)|*.xls";	
	FileDialog0.Type = "OPEN";
	if (!FileDialog0.Open()) {
		alert(setPopMessage("1009"));	// 20110103l-koowgnojeel, 1009 == 파일 선택 창을 여는데 실패하였습니다.
		return;
	}
	var file_name = FileDialog0.FileName;
	var file_path = FileDialog0.FilePath;
	var path = file_path + "\\" + file_name;
	setMessageDirect(path);	
	ext_ExcelImportByIndex(path,0,"ds_main",0);
	Grid0.CreateFormat(); 
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : CSV파일 업로드
 * 주요변수 : 
 **********************************************************************/ 
function uploadCsv(conCnt)
{
	ds_main.DeleteAll();
	FileDialog0.Filter = "ALL File(csv.*)|*.csv";	
	FileDialog0.Type = "OPEN";
	if (!FileDialog0.Open()) {
		alert(setPopMessage("1009"));	// 20110103l-koowgnojeel, 1009 == 파일 선택 창을 여는데 실패하였습니다.
		return;
	}
	var file_name = FileDialog0.FileName;
	var file_path = FileDialog0.FilePath;
	var path = file_path + "\\" + file_name;
	setMessageDirect(path);	
	Ext_Csv2Ds(path,"ds_main",true,setColumn(conCnt));
	Grid0.CreateFormat();
}

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : TEXT파일 업로드
 * 주요변수 : 
 **********************************************************************/ 
function uploadText()
{
	ds_main.DeleteAll();
	FileDialog0.Filter = "ALL File(txt.*)|*.txt";	
	FileDialog0.Type = "OPEN";
	if (!FileDialog0.Open()) {
		alert(setPopMessage("1009"));	// 20110103l-koowgnojeel, 1009 == 파일 선택 창을 여는데 실패하였습니다.
		return;
	}
	var file_name = FileDialog0.FileName;
	var file_path = FileDialog0.FilePath;
	var path = file_path + "\\" + file_name;
	
	setMessageDirect(path);	
	
	var	dataCount = array(-1);
		
	file.FileName = path;
	file.Open("r");
	buff = file.Read();
	file.Close();

	dataCount = Split(buff, "\r\n");

	for(i=0;i<dataCount.Length();i++)
	{
		ds_main.AddColumn("Col01");
		ds_main.AddRow();
		ds_main.SetColumn(i,"Col01",dataCount[i]);
	}	

	Grid0.CreateFormat(); 
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 업로드한 파일 DB로저장
 * 주요변수 : 
 **********************************************************************/ 
function saveDataSet(tableNm,pgmName)
{
	http.Sync = true;
	var sKind		= "SAVE00";						
	var sMethodName = "service::sample/saveUpload.do";
	var sInDataSet  = "ds_main=ds_main";
	var sOutDataSet = "";
	var arg			= " LIB=" + quote(Lib) + " TABLENM=" + quote(tableNm);	

	if(delCallPgm(tableNm) == false) return false;

	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, arg, "callback");	


}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 컬럼 포켓 셋팅
 * 주요변수 : 
 **********************************************************************/ 
function setColumn(cnt)
{
	var returnTxt = "";
	for(i=1;i<=cnt;i++)
	{
		if(i<10)
		{
			if(i == cnt) returnTxt += "Col0" + i;
			else returnTxt += "Col0" + i + ",";
		} else {
			if(i == cnt) returnTxt += "Col" + i;
			else returnTxt += "Col" + i + ",";
		}
	}
	return returnTxt ;
}

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 미사용
 * 주요변수 : 
 **********************************************************************/ 
function onCellCilck3(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var tableNm 	= ds_list3.GetColumn(nRow,"tableNm");
	var yyyymmdd  	= ds_list3.GetColumn(nRow,"date");
	var pgmName  	= ds_list.GetColumn(nRow,"id");	
		
	if(nCell == 3)
	{
		getDataSet(yyyymmdd);
		saveDataSet(tableNm,pgmName);
	}	
}

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 미사용
 * 주요변수 : 
 **********************************************************************/ 
function getDataSet(yyyymmdd)
{
	ds_main.DeleteAll();

	http.Sync 		= true;
	var sKind		= "SEARCH00";						
	var sMethodName = "service::workday/selectWorkDay.do";
	var sInDataSet  = "";
	var sOutDataSet = "ds_main=ds_main";
	var arg			= " LIB=" + quote(Lib) + " YYYYMM=" + quote(yyyymmdd);

	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, arg, "fn_CallBack");	
}

function fn_CallBack(sMethodName, ErrorCode, ErrorMSG) {
	if(ErrorCode != 0)
	{
		returnMSG = ErrorMSG;
	} else {
		returnMSG = "처리되었습니다.                 ";
	}
}




/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 리코트콜 실행
 * 주요변수 : 
 **********************************************************************/ 
function callPgm(tableNm)
{
	if(tableNm == "SVH111PF")
	{
	
		// 화면 잠그기
		var runLock = true;
		
		if(runLock == true) {
			var str = dialog("Group1::POPSVK111PF.xml","",400,190,"TitleBar=false");
			return ;
		}	
	
		WTA_RemoteCall0.RC_SetAttrValue(0,"2984",exeTime);
		
		// 연결 (접속아이피 , 아이디, 비밀번호)	
		var rtn = WTA_RemoteCall0.RC_Connect(callIp,callUser,callPass);
		//접속성공시 
		if(rtn != 0){
			//프로그램 Call (라이브러리명, 프로그램명, 인자값, 크기);

			var rtn2 = WTA_RemoteCall0.RC_RmtPgmCall(pgmLib,"SVHE111CP#",param,pgmSize);
			
			//정상적으로 수행했을 시
			if(rtn2 != 0){
				//리턴 파라메타 값을 출력한다.
				alert("성공=======>" + WTA_RemoteCall0.RC_GetReturnParm(1));
			}else{
				//오류 코드 경고창
				alert("에러 메세지=======>" + WTA_RemoteCall0.bstrErrorMessage);
			}
		//접속실패시
		}else{
			//오류 코드 경고창
			alert("접속 실패 오류=======>" + WTA_RemoteCall0.ulErrorCode);
		}
		//연결종료
		WTA_RemoteCall0.RC_Disconnect();	
	}
	
	if(tableNm == "SVH454PF")
	{
		alert("aaaa");
		// 화면 잠그기
		var runLock = true;
		if(runLock == true) {
			var str = dialog("Group1::POPSVH454PF.xml","",400,190,"TitleBar=false");
			return ;
		}		
	
		WTA_RemoteCall0.RC_SetAttrValue(0,"2984",exeTime);
		
		// 연결 (접속아이피 , 아이디, 비밀번호)	
		var rtn = WTA_RemoteCall0.RC_Connect(callIp,callUser,callPass);
		//접속성공시 
		if(rtn != 0){
			//프로그램 Call (라이브러리명, 프로그램명, 인자값, 크기);
			var rtn2 = WTA_RemoteCall0.RC_RmtPgmCall(pgmLib,"SVHZ454CP#",param,pgmSize);
			
			//정상적으로 수행했을 시
			if(rtn2 != 0){
				//리턴 파라메타 값을 출력한다.
				alert("성공=======>" + WTA_RemoteCall0.RC_GetReturnParm(1));
			}else{
				//오류 코드 경고창
				alert("에러 메세지=======>" + WTA_RemoteCall0.bstrErrorMessage);
			}
		//접속실패시
		}else{
			//오류 코드 경고창
			alert("접속 실패 오류=======>" + WTA_RemoteCall0.ulErrorCode);
		}
		//연결종료
		WTA_RemoteCall0.RC_Disconnect();	
	}	


	if(tableNm == "SVK904PF")
	{
		// 화면 잠그기
		var runLock = true;

		if(runLock == true) {
			var str = dialog("Group1::POPSVK904PF.xml","",400,190,"TitleBar=false");
			return ;
		}

		WTA_RemoteCall0.RC_SetAttrValue(0,"2984",exeTime);
		
		// 연결 (접속아이피 , 아이디, 비밀번호)	
		var rtn = WTA_RemoteCall0.RC_Connect(callIp,callUser,callPass);
		//접속성공시 
		if(rtn != 0){
			//프로그램 Call (라이브러리명, 프로그램명, 인자값, 크기);
			var rtn2 = WTA_RemoteCall0.RC_RmtPgmCall(pgmLib,"SVKE904CP#",param,pgmSize);
			
			//정상적으로 수행했을 시
			if(rtn2 != 0){
				//리턴 파라메타 값을 출력한다.
				alert("성공=======>" + WTA_RemoteCall0.RC_GetReturnParm(1));
			}else{
				//오류 코드 경고창
				alert("에러 메세지=======>" + WTA_RemoteCall0.bstrErrorMessage);
			}
		//접속실패시
		}else{
			//오류 코드 경고창
			alert("접속 실패 오류=======>" + WTA_RemoteCall0.ulErrorCode);
		}
		//연결종료
		WTA_RemoteCall0.RC_Disconnect();
	}	
}

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 리모트콜 사전 실행
 * 주요변수 : 
 **********************************************************************/ 
function delCallPgm(tableNm){

	if(tableNm == "SVH111PF")
	{
		WTA_RemoteCall0.RC_SetAttrValue(0,"2984",exeTime);

		// 연결 (접속아이피 , 아이디, 비밀번호)	
		var rtn = WTA_RemoteCall0.RC_Connect(callIp,callUser,callPass);
		//접속성공시 
		if(rtn != 0){
			//프로그램 Call (라이브러리명, 프로그램명, 인자값, 크기);
			var rtn2 = WTA_RemoteCall0.RC_RmtPgmCall(pgmLib,"SVHE111CD#",param,pgmSize);
			//정상적으로 수행했을 시
			if(rtn2 != 0){
				if (substr(WTA_RemoteCall0.RC_GetReturnParm(1),100,3) == "NB1") {
					alert(setPopMessage(substr(WTA_RemoteCall0.RC_GetReturnParm(1),100,3)));
					WTA_RemoteCall0.RC_Disconnect();
					return false;
				} else {
					//리턴 파라메타 값을 출력한다.				
					alert(setPopMessage("1000000001"));				
				}
			}else{
				//오류 코드 경고창
				alert("에러 메세지=======>" + WTA_RemoteCall0.bstrErrorMessage);
				WTA_RemoteCall0.RC_Disconnect();
				return false;
			}
		//접속실패시
		}else{
			//오류 코드 경고창
			alert("접속 실패 오류=======>" + WTA_RemoteCall0.ulErrorCode);
			WTA_RemoteCall0.RC_Disconnect();
			return false;
		}
		//연결종료
		WTA_RemoteCall0.RC_Disconnect();
	}

	
	if(tableNm == "SVH454PF")
	{
		WTA_RemoteCall0.RC_SetAttrValue(0,"2984",exeTime);

		// 연결 (접속아이피 , 아이디, 비밀번호)	
		var rtn = WTA_RemoteCall0.RC_Connect(callIp,callUser,callPass);
		//접속성공시 
		if(rtn != 0){
			//프로그램 Call (라이브러리명, 프로그램명, 인자값, 크기);
			var rtn2 = WTA_RemoteCall0.RC_RmtPgmCall(pgmLib,"SVHZ454CD#",param,pgmSize);
			//정상적으로 수행했을 시
			if(rtn2 != 0){
				if (substr(WTA_RemoteCall0.RC_GetReturnParm(1),100,3) == "NB1") {
					alert(setPopMessage("1008"));	// 20110103l-koowgnojeel, 1008 == 현재 시스템에 락이 걸렸습니다. 전산관리자에게 문의하세요.
					WTA_RemoteCall0.RC_Disconnect();
					return false;
				} else {
					//리턴 파라메타 값을 출력한다.
					alert(setPopMessage("1001") + "           \n[" + WTA_RemoteCall0.RC_GetReturnParm(1) + "]");	// 20110103l-koowgnojeel, 1001 == 정상적으로 처리가 완료되었습니다.
				}
			}else{
				//오류 코드 경고창
				alert("에러 메세지=======>" + WTA_RemoteCall0.bstrErrorMessage);
				WTA_RemoteCall0.RC_Disconnect();
				return false;
			}
		//접속실패시
		}else{
			//오류 코드 경고창
			alert("접속 실패 오류=======>" + WTA_RemoteCall0.ulErrorCode);
			WTA_RemoteCall0.RC_Disconnect();
			return false;
		}
		//연결종료
		WTA_RemoteCall0.RC_Disconnect();
	}

	if(tableNm == "SVK904PF")
	{
		WTA_RemoteCall0.RC_SetAttrValue(0,"2984",exeTime);

		// 연결 (접속아이피 , 아이디, 비밀번호)	
		var rtn = WTA_RemoteCall0.RC_Connect(callIp,callUser,callPass);
		//접속성공시 
		if(rtn != 0){
			//프로그램 Call (라이브러리명, 프로그램명, 인자값, 크기);
			var rtn2 = WTA_RemoteCall0.RC_RmtPgmCall(pgmLib,"SVKE904CD#",param,pgmSize);
			//정상적으로 수행했을 시
			if(rtn2 != 0){
				if (substr(WTA_RemoteCall0.RC_GetReturnParm(1),100,3) == "NB1") {
					alert(setPopMessage("1008"));	// 20110103l-koowgnojeel, 1008 == 현재 시스템에 락이 걸렸습니다. 전산관리자에게 문의하세요.
					WTA_RemoteCall0.RC_Disconnect();
					return false;
				} else {
					//리턴 파라메타 값을 출력한다.
					alert(setPopMessage("1001") + "           \n[" + WTA_RemoteCall0.RC_GetReturnParm(1) + "]");	// 20110103l-koowgnojeel, 1001 == 정상적으로 처리가 완료되었습니다.
				}
			}else{
				//오류 코드 경고창
				alert("에러 메세지=======>" + WTA_RemoteCall0.bstrErrorMessage);
				WTA_RemoteCall0.RC_Disconnect();
				return false;
			}
		//접속실패시
		}else{
			//오류 코드 경고창
			alert("접속 실패 오류=======>" + WTA_RemoteCall0.ulErrorCode);
			WTA_RemoteCall0.RC_Disconnect();
			return false;
		}
		//연결종료
		WTA_RemoteCall0.RC_Disconnect();	
	}
	
}




/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	if(rtnCd<0){
		alert("실패==============>" + rtnMsg);
	}else{
		callPgm(tableNm);	
	}
}




 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/

function fn_Search()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Input()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Delete()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Save()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_print()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Excel()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function add_class(obj)
{
	alert(setPopMessage("9999"));
	setMessage("9999");

}

]]></Script>
</Window>