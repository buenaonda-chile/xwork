<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="UserList" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="사용자리스트" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_userList" OnRowPosChanged="ds_userList_OnRowPosChanged"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_userList_dummy">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_status">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cdnm" size="256" summ="default" type="STRING"/>
					<record>
						<cd>1</cd>
						<cdnm>사용</cdnm>
					</record>
					<record>
						<cd>2</cd>
						<cdnm>미사용</cdnm>
					</record>
					<record>
						<cd>4</cd>
						<cdnm>차단</cdnm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_COMP"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_VComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_VComCode_COMP"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PWFC"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PWCP"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PWBD"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_menuMrpAuth">
				<Contents></Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="29" Id="searchBar" Left="1" TabOrder="6" Top="32" Width="1057"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static3" Left="356" TabOrder="10" Top="34" Width="106"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static6" Left="822" TabOrder="6" Top="34" Width="106"></Static>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static5" Left="845" Style="static" TabOrder="2" Text="이름" Top="39" VAlign="Middle" Width="69"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static1" Left="592" TabOrder="5" Top="34" Width="100"></Static>
		<Shape BKColor="#888888" Bottom="49" Height="5" Id="Shape3" Left="834" LineColor="#dceaf7" Right="839" TabOrder="1" Top="44" Type="Ellipse" Width="5"></Shape>
		<Shape BKColor="#888888" Bottom="49" Height="5" Id="Shape1" Left="602" LineColor="#dceaf7" Right="607" TabOrder="3" Top="44" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static21" Left="614" Style="static" TabOrder="4" Text="아이디" Top="39" VAlign="Middle" Width="69"></Static>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static2" Left="378" Style="static" TabOrder="9" Text="부서" Top="39" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="49" Height="5" Id="Shape0" Left="368" LineColor="#dceaf7" Right="373" TabOrder="8" Top="44" Type="Ellipse" Width="5"></Shape>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_userList" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="433" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="369" Id="MainGrid" InputPanel="FALSE" LineColor="#888888" MinWidth="100" OnHeadClick="Grid0_OnHeadClick" Right="1058" TabOrder="11" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="#94c1ea" WheelScrollRow="1" Width="1058">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="40"/>
						<col width="50"/>
						<col width="200"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="140"/>
						<col width="50"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" display="text" text="번호"/>
						<cell bkcolor="#dfdfdf" col="1" color="#002043" display="text" text="사업부"/>
						<cell bkcolor="#dfdfdf" col="2" color="#002043" display="text" text="사업장"/>
						<cell bkcolor="#dfdfdf" col="3" color="#002043" display="text" text="부서"/>
						<cell bkcolor="#dfdfdf" col="4" color="#002043" display="text" text="사번"/>
						<cell bkcolor="#dfdfdf" col="5" color="#002043" display="text" text="아이디"/>
						<cell bkcolor="#dfdfdf" col="6" color="#002043" display="text" text="이름"/>
						<cell bkcolor="#dfdfdf" col="7" color="#002043" display="text" text="이메일"/>
						<cell bkcolor="#dfdfdf" col="8" color="#002043" display="text" text="사용유무"/>
					</head>
					<body>
						<cell align="center" col="0" cursor="hand" display="text" expr="row+1"/>
						<cell align="center" col="1" colid="COMPANY" color="#333333" combocol="code1" combodataset="ds_VComCode_COMP" combotext="code_name" display="combo"/>
						<cell align="center" col="2" colid="PLANT_CD" color="#333333" combocol="code2" combodataset="ds_VComCode_PLNT" combotext="code_name" display="combo"/>
						<cell align="left" col="3" colid="TEXT" display="normal"/>
						<cell align="center" col="4" colid="TEL_NO1" display="normal"/>
						<cell align="center" col="5" colid="USER_ID" display="normal"/>
						<cell align="center" col="6" colid="USER_NAME" display="normal"/>
						<cell align="center" col="7" colid="EMAIL_ID" color="#333333" display="normal"/>
						<cell align="center" col="8" colid="STATUS" color="#333333" combocol="CD" combodataset="ds_status" combotext="CDnm" display="combo"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit Border="Flat" BorderColor="#888888" CheckLength="Byte" Height="21" Id="ed_searchUserId" Left="693" MaxLength="10" TabOrder="12" Top="36" Width="126"></Edit>
		<Edit Border="Flat" BorderColor="#888888" CheckLength="Byte" Height="21" Id="ed_searchUserName" Left="929" MaxLength="10" TabOrder="13" Top="36" Width="126"></Edit>
		<Edit Border="Flat" BorderColor="#888888" CheckLength="Byte" Height="21" Id="ed_searchTelNo" Left="463" MaxLength="10" TabOrder="14" Top="36" Width="126"></Edit>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="15" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="15" Top="8" Width="1032"></Static>
		<Combo DataColumn="code_name" Height="22" Id="cb_searchCompany" InnerDataset="ds_VComCode_COMP" Left="94" OnChanged="on_cbSearchCompanyChange" TabOrder="17" Top="35" Width="85"></Combo>
		<Combo DataColumn="code_name" Height="22" Id="cb_searchCodeName" InnerDataset="ds_VComCode_PLNT" Left="270" TabOrder="18" Top="35" Width="85"></Combo>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static44" Left="180" TabOrder="21" Top="34" Width="89"></Static>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static45" Left="202" Style="static" TabOrder="20" Text="사업장" Top="40" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="49" Height="5" Id="Shape17" Left="192" LineColor="#dceaf7" Right="197" TabOrder="19" Top="44" Type="Ellipse" Width="5"></Shape>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static46" Left="4" TabOrder="22" Top="34" Width="89"></Static>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static47" Left="28" Style="static" TabOrder="24" Text="사업부" Top="39" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="49" Height="5" Id="Shape18" Left="18" LineColor="#dceaf7" Right="23" TabOrder="23" Top="44" Type="Ellipse" Width="5"></Shape>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="93" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File0" Left="1032" Right="1056" TabOrder="92" Width="24"></File>
		<Div BKColor="silver" Height="176" Id="displayDiv" TabOrder="25" Text="Div0" Top="440" Width="1058">
			<Contents>
				<Static BKColor="white" Border="Flat" BorderColor="#888888" Height="173" Id="Static26" Left="3" TabOrder="1" Top="1" Width="1054"></Static>
				<Static BKColor="white" Border="Flat" BorderColor="#888888" Height="29" Id="Static7" Left="5" TabOrder="12" Top="59" Width="1049"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static43" Left="797" TabOrder="65" Top="59" Width="106"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static41" Left="280" TabOrder="60" Top="59" Width="106"></Static>
				<Static BKColor="white" Border="Flat" BorderColor="#888888" Height="29" Id="Static8" Left="5" TabOrder="8" Top="31" Width="1049"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static39" Left="797" TabOrder="57" Top="31" Width="106"></Static>
				<Static BKColor="white" Border="Flat" BorderColor="#888888" Height="29" Id="Static16" Left="5" TabOrder="46" Top="3" Width="1049"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static0" Left="541" TabOrder="13" Top="31" Width="106"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static9" Left="541" TabOrder="10" Top="3" Width="106"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static11" Left="5" TabOrder="3" Top="3" Width="106"></Static>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static12" Left="29" Style="static" TabOrder="2" Text="아이디" Top="8" VAlign="Middle" Width="69"></Static>
				<Shape BKColor="#888888" Bottom="20" Height="5" Id="Shape5" Left="17" LineColor="#dceaf7" Right="22" TabOrder="4" Top="15" Type="Ellipse" Width="5"></Shape>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static13" Left="5" TabOrder="5" Top="31" Width="106"></Static>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static14" Left="29" Style="static" TabOrder="6" Text="이름" Top="36" VAlign="Middle" Width="69"></Static>
				<Shape BKColor="#94c1ea" Bottom="48" Height="5" Id="Shape6" Left="17" LineColor="#dceaf7" Right="22" TabOrder="7" Top="43" Type="Ellipse" Width="5"></Shape>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static15" Left="565" Style="static" TabOrder="9" Text="PW/메뉴PW" Top="8" VAlign="Middle" Width="77"></Static>
				<Shape BKColor="#888888" Bottom="20" Height="5" Id="Shape7" Left="553" LineColor="#dceaf7" Right="558" TabOrder="11" Top="15" Type="Ellipse" Width="5"></Shape>
				<Static BKColor="white" Border="Flat" BorderColor="#888888" Height="29" Id="Static17" Left="5" TabOrder="17" Top="99" Width="1049"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static18" Left="541" TabOrder="19" Top="59" Width="106"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static19" Left="5" TabOrder="14" Top="59" Width="106"></Static>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static20" Left="565" Style="static" TabOrder="15" Text="사업부" Top="36" VAlign="Middle" Width="69"></Static>
				<Shape BKColor="#94c1ea" Bottom="48" Height="5" Id="Shape2" Left="553" LineColor="#dceaf7" Right="558" TabOrder="16" Top="43" Type="Ellipse" Width="5"></Shape>
				<Combo BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CodeColumn="code1" Color="#333333" Column="COMPANY" DataColumn="code_name" Height="23" Id="cb_company" INDEX="0" InnerDataset="ds_ComCode_COMP" Left="649" OnChanged="on_compChange" ResetIndex="FIRST" TabOrder="21" Top="33" Width="147"></Combo>
				<Static BKColor="white" Border="Flat" BorderColor="#888888" Height="29" Id="Static23" Left="5" TabOrder="25" Top="87" Width="1049"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static24" Left="541" TabOrder="27" Top="87" Width="106"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static25" Left="5" TabOrder="22" Top="87" Width="106"></Static>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static27" Left="29" Style="static" TabOrder="23" Text="사번" Top="64" VAlign="Middle" Width="69"></Static>
				<Shape BKColor="#94c1ea" Bottom="76" Height="5" Id="Shape10" Left="17" LineColor="#dceaf7" Right="22" TabOrder="24" Top="71" Type="Ellipse" Width="5"></Shape>
				<Shape BKColor="#94c1ea" Bottom="104" Height="5" Id="Shape11" Left="553" LineColor="#dceaf7" Right="558" TabOrder="28" Top="99" Type="Ellipse" Width="5"></Shape>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static28" Left="565" Style="static" TabOrder="26" Text="PW&#32;실패횟수" Top="91" VAlign="Middle" Width="77"></Static>
				<Static BKColor="white" Border="Flat" BorderColor="#888888" Height="29" Id="Static29" Left="5" TabOrder="32" Top="115" Width="1049"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static30" Left="541" TabOrder="34" Top="115" Width="106"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static31" Left="5" TabOrder="29" Top="115" Width="106"></Static>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static32" Left="29" Style="static" TabOrder="30" Text="권한" Top="92" VAlign="Middle" Width="69"></Static>
				<Shape BKColor="#94c1ea" Bottom="104" Height="5" Id="Shape12" Left="17" LineColor="#dceaf7" Right="22" TabOrder="31" Top="99" Type="Ellipse" Width="5"></Shape>
				<Shape BKColor="#94c1ea" Bottom="132" Height="5" Id="Shape13" Left="17" LineColor="#dceaf7" Right="22" TabOrder="35" Top="127" Type="Ellipse" Width="5"></Shape>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static33" Left="29" Style="static" TabOrder="33" Text="이메일" Top="120" VAlign="Middle" Width="69"></Static>
				<Edit BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CheckLength="Byte" Column="USER_ID" Enable="FALSE" Height="23" Id="ed_user_id" ImeMode="keep,english,full" Left="115" MaxLength="10" OnKillFocus="checkid" TabOrder="36" Top="6" UseIME="FALSE" Width="422"></Edit>
				<Edit BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CheckLength="Byte" Column="USER_NAME" Height="23" Id="ed_user_name" Left="115" MaxLength="10" TabOrder="37" Top="34" Width="422"></Edit>
				<Edit BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CheckLength="Byte" Column="PASSWORD" Enable="FALSE" Height="23" Id="ed_password" ImeMode="keep,english,full" Left="649" MaxLength="18" Password="TRUE" TabOrder="38" Top="6" UseIME="FALSE" Width="194"></Edit>
				<Edit BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CheckLength="Byte" Column="TEL_NO1" Height="23" Id="ed_tel_no1" Left="115" TabOrder="39" Top="62" Width="141"></Edit>
				<Edit BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CheckLength="Byte" Column="TEL_NO2" Height="23" Id="ed_tel_no2" Left="387" MaxLength="15" TabOrder="40" Top="62" Width="151"></Edit>
				<Edit BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CheckLength="Byte" Column="EMAIL_ID" Height="23" Id="ed_email_id" Left="115" MaxLength="100" TabOrder="41" Top="118" Width="422"></Edit>
				<Button Height="24" Id="Button0" Left="115" OnClick="auth_View" TabOrder="42" Text="메뉴권한" Top="89" Width="102"></Button>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static22" Left="565" Style="static" TabOrder="18" Text="사용유무" Top="120" VAlign="Middle" Width="69"></Static>
				<Shape BKColor="#94c1ea" Bottom="132" Height="5" Id="Shape9" Left="553" LineColor="#dceaf7" Right="558" TabOrder="20" Top="127" Type="Ellipse" Width="5"></Shape>
				<Shape BKColor="#94c1ea" Bottom="76" Height="5" Id="Shape4" Left="553" LineColor="#dceaf7" Right="558" TabOrder="44" Top="71" Type="Ellipse" Width="5"></Shape>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static10" Left="565" Style="static" TabOrder="43" Text="PW&#32;변경주기" Top="64" VAlign="Middle" Width="77"></Static>
				<Combo BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CodeColumn="code2" Color="#333333" Column="PLANT_CD" DataColumn="code_name" Height="23" Id="cb_plant_cd" ImeMode="none" INDEX="0" InnerDataset="ds_ComCode_PLNT" Left="904" ResetIndex="FIRST" TabOrder="45" Top="33" Width="148"></Combo>
				<Static BKColor="white" Border="Flat" BorderColor="#888888" Height="29" Id="Static34" Left="5" TabOrder="48" Top="143" Width="1049"></Static>
				<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#888888" Height="29" Id="Static36" Left="5" TabOrder="47" Top="143" Width="106"></Static>
				<Shape BKColor="#94c1ea" Bottom="160" Height="5" Id="Shape8" Left="17" LineColor="#dceaf7" Right="22" TabOrder="50" Top="155" Type="Ellipse" Width="5"></Shape>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static37" Left="29" Style="static" TabOrder="49" Text="부서" Top="148" VAlign="Middle" Width="69"></Static>
				<Combo BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CodeColumn="cd" Color="#333333" Column="STATUS" DataColumn="cdnm" Height="23" Id="cb_status" INDEX="0" InnerDataset="ds_status" Left="649" OnChanged="status_change" ResetIndex="FIRST" TabOrder="51" Top="118" Width="403"></Combo>
				<Edit BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CheckLength="Byte" Column="TEXT" Height="23" Id="Edit0" Left="115" MaxLength="100" TabOrder="52" Top="146" Width="935"></Edit>
				<Button Height="24" Id="Button1" Left="221" OnClick="btnAuth_View" TabOrder="53" Text="버튼권한" Top="89" Width="102"></Button>
				<Button Height="24" Id="Button2" Left="327" OnClick="btnFav_View" TabOrder="54" Text="즐겨찾기" Top="89" Width="102"></Button>
				<Edit BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CheckLength="Byte" Column="MENU_PW" Height="23" Id="Edit1" ImeMode="keep,english,full" Left="857" MaxLength="18" Password="TRUE" TabOrder="55" Top="6" UseIME="FALSE" Width="194"></Edit>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static35" Left="846" Style="static" TabOrder="56" Text="/" Top="8" VAlign="Middle" Width="9"></Static>
				<Shape BKColor="#94c1ea" Bottom="48" Height="5" Id="Shape14" Left="809" LineColor="#dceaf7" Right="814" TabOrder="59" Top="43" Type="Ellipse" Width="5"></Shape>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static38" Left="821" Style="static" TabOrder="58" Text="사업장" Top="36" VAlign="Middle" Width="69"></Static>
				<Shape BKColor="#94c1ea" Bottom="76" Height="5" Id="Shape15" Left="289" LineColor="#dceaf7" Right="294" TabOrder="62" Top="71" Type="Ellipse" Width="5"></Shape>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static40" Left="301" Style="static" TabOrder="61" Text="일반전화" Top="64" VAlign="Middle" Width="69"></Static>
				<Combo BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CodeColumn="code1" Color="#333333" Column="PWCP" DataColumn="code_name" Enable="FALSE" Height="23" Id="Combo0" INDEX="0" InnerDataset="ds_ComCode_PWCP" Left="649" ResetIndex="FIRST" TabOrder="63" Top="61" Width="147"></Combo>
				<Combo BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CodeColumn="code1" Color="#333333" Column="PWFC" DataColumn="code_name" Enable="FALSE" Height="23" Id="Combo1" INDEX="0" InnerDataset="ds_ComCode_PWFC" Left="650" ResetIndex="FIRST" TabOrder="64" Top="89" Width="402"></Combo>
				<Shape BKColor="#94c1ea" Bottom="76" Height="5" Id="Shape16" Left="809" LineColor="#dceaf7" Right="814" TabOrder="67" Top="71" Type="Ellipse" Width="5"></Shape>
				<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="20" Id="Static42" Left="821" Style="static" TabOrder="66" Text="PW&#32;변경공지" Top="64" VAlign="Middle" Width="77"></Static>
				<Combo BindDataset="ds_userList" Border="Flat" BorderColor="#888888" CodeColumn="code1" Color="#333333" Column="PWBD" DataColumn="code_name" Enable="FALSE" Height="23" Id="Combo2" ImeMode="none" INDEX="0" InnerDataset="ds_ComCode_PWBD" Left="904" ResetIndex="FIRST" TabOrder="68" Top="61" Width="148"></Combo>
				<Image Cursor="HAND" Height="17" Id="selsabun" ImageID="ic_search" Left="261" OnClick="selsabun_OnClick" Static="FALSE" TabOrder="69" Top="65" Width="15"></Image>
				<Button Height="24" Id="btn_auth" Left="433" OnClick="btn_auth_OnClick" TabOrder="70" Text="그룹권한" Top="89" Width="102"></Button>
			</Contents>
		</Div>
		<Button Height="25" Id="btnQuery" ImageID="btn2_search2" Left="920" OnClick="getUserList" TabOrder="26" Text="조회" Top="64" Visible="FALSE" Width="75"></Button>
		<Button Height="27" Id="Button3" ImageID="sum_save" Left="840" OnClick="fn_Save" TabOrder="27" TabStop="FALSE" Text="Button2" Top="64" Visible="FALSE" Width="72"></Button>
		<Button Height="26" Id="Button0" ImageID="btn2_add2" Left="744" OnClick="fn_Input" TabOrder="28" Text="추가" Top="64" Visible="FALSE" Width="75"></Button>
	</Form>
	<Script><![CDATA[ /*--------------------------------------------------------------
 * @version               : 1.0 
 * @author                : 황규철
 * @see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : UserList.xml
 * ● PROGRAM DESCRIPTION  : 사용자 리스트 관리리
 * ● DATE WRITTEN         : 2010.11.11
----------------------------------------------------------------*/


#include "script::lib_script_common.js";

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 화면 로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj){
	getUserListAll();
	getTitle();	
	getComCode();
	gFcOnTopButtonColor("2.2"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)		
	MainGrid.UserData = MainGrid.Height;
}
/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 공통 코드 조회
 * 주요변수 : 
 **********************************************************************/ 
function getComCode(){

	http.Sync 	= true;
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_COMP=ds_ComCode_COMP";
	var sArgument   = "";
		sArgument   += " CLASS='COMP'";
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	ds_VComCode_COMP.Copy("ds_ComCode_COMP");
	
	ds_VComCode_COMP.InsertRow(0);
	ds_VComCode_COMP.SetColumn(0,"CODE1","");
	ds_VComCode_COMP.SetColumn(0,"CODE_NAME","[전체]");
	cb_searchCompany.index = 0;

	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	ds_VComCode_PLNT.Copy("ds_ComCode_PLNT");
	
	ds_VComCode_PLNT.InsertRow(0);
	ds_VComCode_PLNT.SetColumn(0,"CODE1","");
	ds_VComCode_PLNT.SetColumn(0,"CODE_NAME","[전체]");
	cb_searchCodeName.index = 0;	
	
	
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PWFC=ds_ComCode_PWFC";
	var sArgument   = "";
		sArgument   += " CLASS='PWFC'";
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	

	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PWCP=ds_ComCode_PWCP";
	var sArgument   = "";
		sArgument   += " CLASS='PWCP'";
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PWBD=ds_ComCode_PWBD";
	var sArgument   = "";
		sArgument   += " CLASS='PWBD'";
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");		

}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 화면조회
 * 주요변수 : 
 **********************************************************************/ 
function getUserList(){
	var sKind		= "getUserList";						
	var sMethodName = "service::user/userList.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             // 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_userList=ds_userList";    // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	sArgument += " USER_ID=" + quote(ed_searchUserId.Value);
	sArgument += " USER_NAME=" + quote(ed_searchUserName.Value);
	sArgument += " TEXT=" + quote(ed_searchTelNo.Value);
	
	// 20110111-leejongwook-SEQ#:20101230-001(조회관련) COMPANY & CODE_NAME추가 
	if( cb_searchCompany.index > 0 ){	
		sArgument += " COMPANY=" + quote(ds_VComCode_COMP.GetColumn(cb_searchCompany.index,"CODE1") );
	}
	if( cb_searchCodeName.index > 0 ){
		sArgument += " CODE_NAME=" + quote(cb_searchCodeName.Value);
	}
	sArgument += " STATUS='0'";	
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
}

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 전체 리스트 조회(중복 체크용)
 * 주요변수 : 
 **********************************************************************/ 
function getUserListAll(){
	http.Sync 		= true;
	var sKind		= "getUserList";						
	var sMethodName = "service::user/userListAll.do";     			// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             			// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_userList_dummy=ds_userList_dummy";    // 조회 후 돌려 받을 DataSet 명칭

	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, "", "");
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 화면저장
 * 주요변수 : 
 **********************************************************************/ 
function setUserList(){

	if(!validationChk()) return;
	//start - 기본권한 추가로직 추가
	var sKind		= "getUserMrpAuth";		
	var sMethodName = "service::user/menuMrpAuthDefault.do";  					
	var sInDataSet  = "";
	var sOutDataSet = "ds_menuMrpAuth=ds_menuMrpAuth";
	var sArgument   = "";
		sArgument   += " USER_ID=" + quote(displayDiv.ed_user_id.Text);
		sArgument   += " TOP_MENU=" + quote("('13','14', '15', '16')");//영업/생산/자재
		sArgument   += " COMPS=" + quote(displayDiv.cb_company.Value);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	//end
	var sKind		= "setUserList";						
	var sMethodName = "service::user/userSave.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "ds_userList=ds_userList:U ds_menuMrpAuth=ds_menuMrpAuth";     //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "";    							// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument  += " CREATE_USR=" + quote(G_ds_user.GetColumn(0,"USER_ID"));
		sArgument  += " SUSER_ID=" + quote(displayDiv.ed_user_id.Text);
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : validation 체크
 * 주요변수 : 
 **********************************************************************/ 
function validationChk(){
	for(var i=0; i<ds_userList.rowcount(); i++){
		if(length(trim(ds_userList.GetColumn(i, "USER_ID")))==0){
			alert(setPopMessage("2043"));	// 20110103l-koowgnojeel, 2043 == 아이디를 입력해 주세요.
			ds_userList.row = i;
			return false;
		}
		if(length(trim(ds_userList.GetColumn(i, "USER_NAME")))==0){
			alert(setPopMessage("2044"));	// 20110103l-koowgnojeel, 2044 == 이름을 입력해 주세요.
			ds_userList.row = i;
			return false;
		}
		/*
		if(length(trim(ds_userList.GetColumn(i, "PASSWORD")))==0){
			alert(setPopMessage("2000"));	// 20110103l-koowgnojeel, 2000 == 비밀번호를 입력해 주세요.
			ds_userList.row = i;
			return false;
		}
		*/
		if(length(trim(ds_userList.GetColumn(i, "COMPANY")))==0){
			alert(setPopMessage("2045"));	// 20110103l-koowgnojeel, 2045 == 소속회사를 입력해 주세요.
			ds_userList.row = i;
			return false;
		}
		if(length(trim(ds_userList.GetColumn(i, "PLANT_CD")))==0){
			alert(setPopMessage("2046"));	// 20110103l-koowgnojeel, 2046 == 사업소코드를 입력해 주세요.
			ds_userList.row = i;
			return false;
		}
		/*
		if(length(trim(ds_userList.GetColumn(i, "MENU_PW")))==0){
			trace((ds_userList.GetColumn(i, "MENU_PW")));
			ds_userList.row = i;
			return false;
		}
		*/
	}
	return true;
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 데이터셋 상태 체크
 * 주요변수 : 
 **********************************************************************/ 
function ds_userList_OnRowPosChanged(obj,nOldRow,nRow){
	//로우타입 insert만 ID박스 enable
	if(ds_userList.GetRowType(ds_userList.currow)=="insert"){
		displayDiv.ed_user_id.Enable=true;
	}else{
		displayDiv.ed_user_id.Enable=false;
	}
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 중복 체크
 * 주요변수 : 
 **********************************************************************/ 
function checkid(obj)
{
	for(i=0;i<ds_userList_dummy.rowcount; i++){
		if(ds_userList_dummy.GetColumn(i,"USER_ID") == displayDiv.ed_user_id) {
			alert(setPopMessage("2048"));	// 20110103l-koowgnojeel, 2048 == 사용할 수 없는 아이디입니다.
			ed_user_id.SetFocus();
			return;
		}
	}
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){

		alert(setPopMessage("1002"));
		setMessage("1002");
		
	}else if(svcId=="getUserList"){
		// 조회건수가 없을경우
		if(ds_menuList.rowcount <= 0){
			alert(setPopMessage("1003"));
			setMessage("1003");	
		// 정상 조회
		} else {
			alert(setPopMessage("1004"));
			setMessage("1004");				
		}
	// tran 성공	
	}else if(svcId=="setUserList"){
		alert(setPopMessage("1001"));
		setMessage("1001");
	}	
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 메뉴권한 팝업
 * 주요변수 : 
 **********************************************************************/ 
function auth_View(obj)
{
	if(ds_userList.rowcount <= 0 || ds_userList.GetRowType(ds_userList.row) != 'normal') return ;
	var str = dialog("System::UserAuth.xml","USER_ID=" + ds_userList.GetColumn(ds_userList.row,"USER_ID") ,300,300);
}



/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 버튼권한 팝업
 * 주요변수 : 
 **********************************************************************/ 
function btnAuth_View(obj)
{
	if(ds_userList.rowcount <= 0 || ds_userList.GetRowType(ds_userList.row) != 'normal') return ;
	var str = dialog("System::UserBtnAuth.xml","USER_ID=" + ds_userList.GetColumn(ds_userList.row,"USER_ID") ,300,300);
}


/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-11-26
 * 내용설명 : 즐겨찾기 팝업
 * 주요변수 : 
 **********************************************************************/ 
function btnFav_View(obj)
{
	if(ds_userList.rowcount <= 0 || ds_userList.GetRowType(ds_userList.row) != 'normal') return ;
	var str = dialog("System::UserFavAuth.xml","USER_ID=" + ds_userList.GetColumn(ds_userList.row,"USER_ID") ,300,300);		
}

function on_compChange(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_ComCode_PLNT.Filter("CODE1=='" + cb_company.Value + "'");
}

function on_cbSearchCompanyChange(obj,strCode,strText,nOldIndex,nNewIndex)	// 20110103-leejongwook-SEQ#:20101230-001
{
	if( cb_searchCompany.index != 0 ){
		ds_VComCode_PLNT.Filter("CODE1=='" + cb_searchCompany.Value + "'");
		cb_searchCodeName.index = 0;
	}else{
		ds_VComCode_PLNT.UnFilter();
	}
}

function status_change(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_userList.SetColumn(ds_userList.row,"PW_DAT",today()+ "000000");
}



function Grid0_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) lib_grid_SetGridSort(obj,nCell);
}

/********************************************************************** 
 * 개 발 자 : 황규철 
 * 개발일자 : 2010-12-06
 * 내용설명 : 엑셀파일로 저장
 * 주요변수 : 
 **********************************************************************/ 
function setExcel()
{
	var fName   = "사용자 리스트";
	var arrSheets  =  Array();  

	arrSheets[0]  = "MainGrid|사용자 리스트";
	createExcelSheetS2(FileDialog0, fName ,arrSheets);

}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	getUserList();
}

function fn_Input()
{
	if(checkInsertCount("ds_userList")== false) return;
	ds_userList.AddRow();
	displayDiv.cb_status.Value = '1';
	displayDiv.Combo0.Value = '180';
	displayDiv.Combo2.Value = '10';
	displayDiv.Combo1.Value = '0';
}

function fn_Delete()
{
	ds_userList.DeleteRow(ds_userList.currow);
}

function fn_Save()
{
	setUserList();
}

function fn_print()
{
	alert("fn_print");
}

function fn_Excel()
{
	setExcel();
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("2.2"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}

function selsabun_OnClick(obj,nX,nY)
{	
	if(ds_userList.rowcount <= 0){
		return;
	}
	var str = dialog("System::UserList_pop2.xml","사용자조회",300,300,"TitleBar=false");	
}

function ed_searchUserName_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13){
		fn_Search();
	}
}
/********************************************************************** 
 * 개 발 자 : 제환복 
 * 개발일자 : 2016-03-15
 * 내용설명 : Group별 권한관리
 * 주요변수 : 
 **********************************************************************/ 
function btn_auth_OnClick(obj)
{
	if(ds_userList.rowcount <= 0 || ds_userList.GetRowType(ds_userList.row) != 'normal') return ;
	var str = dialog("System::GroupAuth.xml","USER_ID=" + ds_userList.GetColumn(ds_userList.row,"USER_ID") + " COMPANY=" + ds_userList.GetColumn(ds_userList.row,"COMPANY"),300,300);		
}
]]></Script>
</Window>