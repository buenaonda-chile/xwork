<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="301" Id="UserList" Left="8" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="선택하세요" TooltipFont="Default,0" Top="8" Ver="1.0" Width="449" WorkArea="true">
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="274" Id="searchBar" Left="-3" TabOrder="6" Top="27" Width="452"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static20" Left="227" TabOrder="44" Top="184" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static19" Left="227" TabOrder="41" Top="152" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static16" Left="227" TabOrder="38" Top="264" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static14" Left="3" TabOrder="35" Top="264" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static12" Left="3" TabOrder="32" Top="232" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static10" Left="3" TabOrder="29" Top="184" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static8" Left="3" TabOrder="26" Top="152" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static2" Left="3" TabOrder="20" Top="112" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static4" Left="227" TabOrder="23" Top="112" Width="91"></Static>
		<Static BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Height="25" Id="Static5" Left="3" TabOrder="17" Top="80" Width="91"></Static>
		<Image FillType="STRETCH" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="1" Width="451"></Image>
		<Static Align="Center" Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_info" Left="40" TabOrder="2" Top="8" Width="104"></Static>
		<Static Color="#333333" Font="돋움,9" Height="13" Id="Static0" Left="152" TabOrder="3" Top="8" Width="104"></Static>
		<Shape BKColor="#888888" Bottom="94" Height="5" Id="Shape2" Left="15" LineColor="#dceaf7" Right="20" TabOrder="5" Top="89" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static6" Left="25" Style="static" TabOrder="16" Text="성&#32;&#32;&#32;&#32;&#32;&#32;명" Top="85" VAlign="Middle" Width="69"></Static>
		<Image Cursor="HAND" Height="27" Id="imgSelect" ImageID="btn2_regi2" Left="283" OnClick="imgSelect_OnClick" Static="FALSE" TabOrder="14" Top="70" Width="75"></Image>
		<Image Cursor="HAND" Height="27" Id="imgClose" ImageID="btn2_cancel2" Left="363" OnClick="imgClose_OnClick" Static="FALSE" TabOrder="15" Top="70" Width="75"></Image>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static1" Left="25" Style="static" TabOrder="19" Text="사&#32;&#32;&#32;&#32;&#32;&#32;번" Top="117" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="126" Height="5" Id="Shape0" Left="15" LineColor="#dceaf7" Right="20" TabOrder="18" Top="121" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static3" Left="249" Style="static" TabOrder="22" Text="근무&#32;코드" Top="117" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="126" Height="5" Id="Shape1" Left="239" LineColor="#dceaf7" Right="244" TabOrder="21" Top="121" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static7" Left="24" Style="static" TabOrder="25" Text="시작&#32;시간" Top="157" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="166" Height="5" Id="Shape3" Left="15" LineColor="#dceaf7" Right="20" TabOrder="24" Top="161" Type="Ellipse" Width="5"></Shape>
		<Edit Align="RIGHT" Height="25" Id="ed_WRKTM" Left="98" MaxLength="3" Number="TRUE" TabOrder="9" Top="183" UpperOnly="TRUE" Width="120"></Edit>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static9" Left="24" Style="static" TabOrder="28" Text="작업&#32;시간" Top="189" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="198" Height="5" Id="Shape4" Left="15" LineColor="#dceaf7" Right="20" TabOrder="27" Top="193" Type="Ellipse" Width="5"></Shape>
		<Edit Align="RIGHT" Height="25" Id="ed_SUPDP" Left="96" MaxLength="4" Number="TRUE" OnKillFocus="ed_SUPDP_OnKillFocus" TabOrder="11" Top="232" UpperOnly="TRUE" Width="120"></Edit>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static11" Left="25" Style="static" TabOrder="31" Text="지원&#32;부서" Top="237" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="246" Height="5" Id="Shape5" Left="15" LineColor="#dceaf7" Right="20" TabOrder="30" Top="241" Type="Ellipse" Width="5"></Shape>
		<Edit Align="RIGHT" Height="25" Id="ed_SPJTM" Left="96" MaxLength="3" Number="TRUE" TabOrder="12" Top="264" UpperOnly="TRUE" Width="120"></Edit>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static13" Left="25" Style="static" TabOrder="34" Text="주간&#32;지원" Top="269" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="278" Height="5" Id="Shape6" Left="15" LineColor="#dceaf7" Right="20" TabOrder="33" Top="273" Type="Ellipse" Width="5"></Shape>
		<Edit Align="RIGHT" Height="25" Id="ed_SPYTM" Left="320" MaxLength="3" Number="TRUE" TabOrder="13" Top="264" UpperOnly="TRUE" Width="120"></Edit>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static15" Left="249" Style="static" TabOrder="37" Text="야간지원" Top="269" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="278" Height="5" Id="Shape7" Left="239" LineColor="#dceaf7" Right="244" TabOrder="36" Top="273" Type="Ellipse" Width="5"></Shape>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static17" Left="249" Style="static" TabOrder="40" Text="종료&#32;시간" Top="157" VAlign="Middle" Width="69"></Static>
		<Static Border="None" Color="#333333" Font="굴림,9,Bold" Height="16" Id="Static18" Left="249" Style="static" TabOrder="43" Text="작업&#32;시분" Top="189" VAlign="Middle" Width="69"></Static>
		<Shape BKColor="#888888" Bottom="198" Height="5" Id="Shape8" Left="239" LineColor="#dceaf7" Right="244" TabOrder="42" Top="193" Type="Ellipse" Width="5"></Shape>
		<Shape BKColor="#888888" Bottom="166" Height="5" Id="Shape9" Left="239" LineColor="#dceaf7" Right="244" TabOrder="39" Top="161" Type="Ellipse" Width="5"></Shape>
		<Static Height="14" Id="st_KORNM" Left="103" TabOrder="4" Top="85" Width="110"></Static>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static66" Left="101" TabOrder="45" Top="101" Width="115"></Static>
		<Static Height="14" Id="st_PESABN" Left="103" TabOrder="46" Top="117" Width="110"></Static>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static22" Left="101" TabOrder="47" Top="133" Width="115"></Static>
		<Static Height="14" Id="st_WRKDT" Left="327" TabOrder="48" Top="117" Width="110"></Static>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static24" Left="325" TabOrder="49" Top="133" Width="115"></Static>
		<Static Font="굴림,18,Bold" Height="29" Id="Static25" Left="4" TabOrder="50" Text="생산&#32;일일근태&#32;예외&#32;등록" Top="38" Width="278"></Static>
		<MaskEdit Align="Right" Height="25" Id="ed_STRTM" Left="96" Mask="##:##" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="7" Top="152" Type="STRING" Width="120"></MaskEdit>
		<MaskEdit Align="Right" Height="25" Id="ed_ENDTM" Left="320" Mask="##:##" MaxLength="4" OnKillFocus="timeChk_OnKillFocus" TabOrder="8" Top="152" Type="STRING" Width="120"></MaskEdit>
		<MaskEdit Align="Right" DecimalLen="0" DigitLen="0" Height="25" Id="ed_WRKHM" Left="320" Mask="##:##" MaxLength="4" OnKillFocus="ed_WRKHM_OnKillFocus" TabOrder="10" Top="184" Type="STRING" Width="120"></MaskEdit>
	</Form>
	<Script><![CDATA[ /*--------------------------------------------------------------
 * @version               : 1.0 
 * @author                : 제환복
 * @see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : FHDZ110_POPUP.xml
 * ● PROGRAM DESCRIPTION  : 생산 일일근태 예외 등록
 * ● DATE WRITTEN         : 2013.01.24
----------------------------------------------------------------*/

#include "script::lib_script_common.js";


/********************************************************************** 
 * 개 발 자 : 이상건
 * 내용설명 : 화면 로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj)
{
	st_KORNM.Text=ds_POPUP.GetColumn(ROWNO,"KORNM");
	st_PESABN.Text=ds_POPUP.GetColumn(ROWNO,"PESABN");
	st_WRKDT.Text=ds_POPUP.GetColumn(ROWNO,"WRKCD");
	
	ed_STRTM.Text=lpad(ds_POPUP.GetColumn(ROWNO,"STRTM"),0,4);
	ed_ENDTM.Text=lpad(ds_POPUP.GetColumn(ROWNO,"ENDTM"),0,4);
	ed_WRKTM.Text=ds_POPUP.GetColumn(ROWNO,"WRKTM");
	ed_WRKHM.Text=lpad(ds_POPUP.GetColumn(ROWNO,"WRKHM"),0,4);
	ed_SUPDP.Text=ds_POPUP.GetColumn(ROWNO,"SUPDP");
	ed_SPJTM.Text=ds_POPUP.GetColumn(ROWNO,"SPJTM");
	ed_SPYTM.Text=ds_POPUP.GetColumn(ROWNO,"SPYTM");
}

function imgSelect_OnClick(obj,nX,nY)
{
	var arrReturn  =  Array();
	arrReturn[0]  = ed_STRTM.Value;
	arrReturn[1]  = ed_ENDTM.Value;
	arrReturn[2]  = ed_WRKTM.Text;
	arrReturn[3]  = ed_WRKHM.Value;
	arrReturn[4]  = ed_SUPDP.Text;
	arrReturn[5]  = ed_SPJTM.Text;
	arrReturn[6]  = ed_SPYTM.Text;
	close(arrReturn);
}

function imgClose_OnClick(obj,nX,nY)
{
	Close();
}

//시간chk
function timeChk_OnKillFocus(obj){

	if(length(trim(obj.Value)) != 0){
		var tmpTime = substr(obj.Text,0,2)+ substr(obj.Text,3,2);
		obj.Value = ReplaceToZero(tmpTime);
		var chkTime = trim(obj.Value);
		var hour = chkTime.substr(0,2);
		var min = chkTime.substr(2,2);

		if((hour < 00 || hour > 24) || (min < 00 || min > 60)){
			alert("시간입력오류");
			obj.setfocus();
			obj.Value="";
		}
	}	
}

function ReplaceToZero(value)
{	
	var r=replace(value,"_","0");
	return(r);
}

function ed_SUPDP_OnKillFocus(obj)
{
	if(length(obj.Value) <1){
		ed_SPJTM.Text=0;
		ed_SPYTM.Text=0;
	}
}


function ed_WRKHM_OnKillFocus(obj)
{
	if(length(trim(obj.Value)) != 0){
		var tmpTime = substr(obj.Text,0,2)+ substr(obj.Text,3,2);
		obj.Value = ReplaceToZero(tmpTime);
	}
}
]]></Script>
</Window>