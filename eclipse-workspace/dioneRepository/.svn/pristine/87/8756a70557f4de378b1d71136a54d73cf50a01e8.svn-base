<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="UserList" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="세금계산서TX등록" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Class">
				<Contents>
					<colinfo id="code1" size="256" summ="default" type="STRING"/>
					<colinfo id="code_name" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_SJTZ210_CanRowPosChange" DataSetType="Dataset" Id="ds_SJTZ210" OnColumnChanged="ds_SJTZ210_OnColumnChanged" OnRowPosChanged="ds_SJTZ210_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PYSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PSSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="MKPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PYVND" size="256" summ="default" type="STRING"/>
					<colinfo id="SHPTO" size="256" summ="default" type="STRING"/>
					<colinfo id="STLWH" size="256" summ="default" type="STRING"/>
					<colinfo id="RESON" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXQY" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXCS" size="256" summ="default" type="STRING"/>
					<colinfo id="CURCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SINFO" size="256" summ="default" type="STRING"/>
					<colinfo id="INPDT" size="256" summ="default" type="STRING"/>
					<colinfo id="INPTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CUSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CARCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CARNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_CUSMAS1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_EM000PR"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MST090PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MST050PF"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SJTZ210_TAXDTCHK">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BM008PR"></Dataset>
			<Dataset CanRowPosChange="ds_SJTZ210_CanRowPosChange" DataSetType="Dataset" Id="ds_SJTZ210_SUB" OnColumnChanged="ds_SJTZ210_OnColumnChanged" OnRowPosChanged="ds_SJTZ210_OnRowPosChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SJTZ210_CHK2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SJTZ210_DETAIL"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_EM001PR"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_EM035PR"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SJTZ210_CHECK"></Dataset>
		</Datasets>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoEnterType="Key" AutoFit="TRUE" AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="ds_SJTZ210" BKColor="MENU" BkColor2="LIGHT3D" BkSelColor="lavender" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="513" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" Face3dColor="khaki" HeadBorder="Flat" HeadHeight="25" Height="422" Id="MainGrid" InputPanel="FALSE" LineColor="#888888" MinWidth="100" MultiSelect="TRUE" OnCellClick="MainGrid_OnCellClick" OnHeadClick="MainGrid_OnHeadClick" Right="1058" TabOrder="7" TabStop="true" Top="91" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="GRAYTEXT" WheelScrollRow="1" Width="1058">
			<contents>
				<format id="Default">
					<columns>
						<col width="180"/>
						<col width="180"/>
						<col width="40"/>
						<col width="80"/>
						<col width="40"/>
						<col width="80"/>
						<col width="90"/>
						<col width="120"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" display="text" text="품번"/>
						<cell bkcolor="#dfdfdf" col="1" color="#002043" display="text" text="MAKER품번"/>
						<cell bkcolor="#dfdfdf" col="2" color="#002043" display="text" text="SEQ"/>
						<cell bkcolor="#dfdfdf" col="3" color="#002043" display="text" text="계산서일자"/>
						<cell bkcolor="#dfdfdf" col="4" color="#002043" display="text" text="RS"/>
						<cell bkcolor="#dfdfdf" col="5" color="#002043" display="text" text="수량"/>
						<cell bkcolor="#dfdfdf" col="6" color="#002043" display="text" text="단가"/>
						<cell bkcolor="#dfdfdf" col="7" color="#002043" display="text" text="금액"/>
					</head>
					<body>
						<cell align="left" col="0" colid="PSPNO" display="text" TrimType="Both"/>
						<cell align="left" col="1" colid="MKPNO" display="text" TrimType="Both"/>
						<cell align="center" col="2" colid="PSSEQ" display="number" expr="IIF(PSSEQ=0,&apos;&apos;,PSSEQ)" TrimType="Both"/>
						<cell align="center" col="3" colid="TAXDT" display="date" TrimType="Both"/>
						<cell align="center" col="4" colid="RESON" display="text" TrimType="Both"/>
						<cell align="right" col="5" colid="TAXQY" display="number" TrimType="Both"/>
						<cell align="right" col="6" colid="TAXCS" display="number" TrimType="Both"/>
						<cell align="right" col="7" colid="TAXAM" display="number" TrimType="Both"/>
					</body>
					<summary>
						<cell align="center" col="0" display="text" text="TOTAL"/>
						<cell align="right" col="1" display="text" expr='count+&quot;&#32;건&quot;'/>
						<cell align="right" col="2" colspan="6" display="number" expr='SUM(&quot;TAXAM&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="1" TabStop="FALSE" Width="1060"></Image>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="4" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="3" Width="24"></File>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="1" Top="8" Width="1032"></Static>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="60" Id="searchBar" TabOrder="6" Top="32" Width="1060"></Static>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static1" Left="6" TabOrder="8" Text="사&#32;&#32;&#32;업&#32;&#32;&#32;부" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static10" Left="124" TabOrder="8" Top="34" VAlign="Middle" Width="136"></Static>
		<Combo CodeColumn="code2" DataColumn="code_name" Height="18" Id="ComboBoxPlant" InnerDataset="ds_ComCode_PLNT" Left="128" OnChanged="common_OnChanged" TabOrder="2" Top="37" Width="128"></Combo>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static3" Left="266" TabOrder="11" Text="업&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;체" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static13" Left="528" TabOrder="15" Top="55" Width="220"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static5" Left="384" TabOrder="13" Top="34" VAlign="Middle" Width="398"></Static>
		<Edit AutoSelect="TRUE" Height="21" Id="ed_PYVND" Left="388" MaxLength="8" Number="TRUE" OnChanged="common_OnChanged" OnCharChanged="ed_PYVND_OnCharChanged" OnKillFocus="ed_PYVND_OnKillFocus" TabOrder="3" Top="37" UseIME="FALSE" Width="100"></Edit>
		<Static Height="19" Id="st_PYVND" Left="528" TabOrder="14" Top="36" VAlign="Bottom" Width="216"></Static>
		<Image Cursor="HAND" Height="16" Id="imgMaker" ImageID="ic_search" Left="754" OnClick="imgMaker_OnClick" Static="FALSE" TabOrder="8" TabStop="FALSE" Top="39" Width="14"></Image>
		<Edit AutoSelect="TRUE" Height="21" Id="ed_SHPTO" Left="493" MaxLength="2" Number="TRUE" OnChanged="common_OnChanged" TabOrder="4" Top="37" UseIME="FALSE" Width="32"></Edit>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static0" Left="789" TabOrder="16" Text="계산서&#32;번호" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static12" Left="907" TabOrder="17" Top="34" VAlign="Middle" Width="136"></Static>
		<Edit AutoSelect="TRUE" AutoSkip="TRUE" Height="20" Id="ed_TAXNO" Left="911" MaxLength="10" OnChanged="common_OnChanged" TabOrder="5" Top="37" UpperOnly="TRUE" UseIME="FALSE" Width="128"></Edit>
		<Div Border="Flat" BorderColor="#888888" Height="104" Id="displayDiv" TabOrder="9" Text="Div0" Top="515" Width="1058">
			<Contents>
				<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static1" Left="124" Style="static" TabOrder="10" Top="3" VAlign="Middle" Width="394"></Static>
				<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static0" Left="6" TabOrder="9" Text="풍&#32;성&#32;품&#32;번" Top="2" VAlign="Middle" Width="116"></Static>
				<Edit BindDataset="ds_SJTZ210" Column="PSPNO" Enable="FALSE" Height="20" Id="ed_PSPNO" ImeMode="none" Left="127" MaxLength="15" OnKillFocus="displayDiv_ed_PSPNO_OnKillFocus" TabOrder="1" Top="5" UpperOnly="TRUE" UseIME="FALSE" Width="130"></Edit>
				<Static BindDataset="ds_SJTZ210_DETAIL" Column="CPDSC" Height="14" Id="st_PSPNO" Left="260" TabOrder="12" Top="7" Width="225"></Static>
				<Image Cursor="HAND" Enable="FALSE" Height="17" Id="imgPspno" ImageID="ic_search" Left="490" OnClick="displayDiv_imgPspno_OnClick" Static="FALSE" TabOrder="9" TabStop="FALSE" Top="9" Width="20"></Image>
				<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="st_M3" Left="286" TabOrder="13" Text="이유" Top="73" VAlign="Middle" Width="62"></Static>
				<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static7" Left="349" Style="static" TabOrder="14" Top="73" VAlign="Middle" Width="80"></Static>
				<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="st_M4" Left="438" TabOrder="15" Text="수량" Top="73" VAlign="Middle" Width="62"></Static>
				<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static9" Left="501" Style="static" TabOrder="16" Top="73" VAlign="Middle" Width="136"></Static>
				<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="st_M5" Left="646" TabOrder="17" Text="단가" Top="73" VAlign="Middle" Width="62"></Static>
				<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static11" Left="709" Style="static" TabOrder="18" Top="73" VAlign="Middle" Width="136"></Static>
				<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="st_M6" Left="852" TabOrder="19" Text="금액" Top="73" VAlign="Middle" Width="62"></Static>
				<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static14" Left="915" Style="static" TabOrder="20" Top="73" VAlign="Middle" Width="136"></Static>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static66" Left="256" TabOrder="21" Top="23" Width="230"></Static>
				<MaskEdit BindDataset="ds_SJTZ210" Column="TAXQY" Height="20" Id="ed_TAXQY" Left="504" MaxLength="8" NullValue="0" TabOrder="6" Top="76" Value="MaskEdit0" Width="128"></MaskEdit>
				<MaskEdit BindDataset="ds_SJTZ210" Column="TAXCS" DecimalLen="0" Height="20" Id="ed_TAXCS" Left="712" MaxLength="9" NullValue="0" OnKeyDown="displayDiv_ed_TAXCS_OnKeyDown" TabOrder="7" Top="76" Value="MaskEdit0" Width="128"></MaskEdit>
				<MaskEdit BindDataset="ds_SJTZ210" Column="TAXAM" DecimalLen="0" Enable="FALSE" Height="20" Id="ed_TAXAM" Left="918" MaxLength="15" NullValue="0" TabOrder="8" TabStop="FALSE" Top="76" Value="MaskEdit0" Width="128"></MaskEdit>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static8" Left="965" TabOrder="22" Top="25" Width="80"></Static>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static12" Left="873" TabOrder="23" Top="25" Width="80"></Static>
				<Static Align="Center" Border="None" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static18" Left="12" TabOrder="24" Text="차종:" Top="72" VAlign="Middle" Width="40"></Static>
				<Static BindDataset="ds_SJTZ210" Border="None" BorderColor="#b4b4b4" Color="#333333" Column="CARCD" Font="굴림,9,Bold" Height="26" Id="st_CARCD" Left="56" Style="static" TabOrder="25" Top="72" VAlign="Middle" Width="60"></Static>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static20" Left="56" TabOrder="26" Top="94" Width="60"></Static>
				<Static Align="Center" Border="None" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static21" Left="128" TabOrder="27" Text="차종명:" Top="72" VAlign="Middle" Width="40"></Static>
				<Static BindDataset="ds_SJTZ210" Border="None" BorderColor="#b4b4b4" Color="#333333" Column="CARNM" Font="굴림,9,Bold" Height="26" Id="st_CARNM" Left="180" Style="static" TabOrder="28" Top="74" VAlign="Middle" Width="80"></Static>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static23" Left="180" TabOrder="29" Top="96" Width="80"></Static>
				<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static19" Left="6" TabOrder="30" Text="업&#32;체&#32;품&#32;번" Top="35" VAlign="Middle" Width="116"></Static>
				<Static Height="14" Id="Static22" Left="260" TabOrder="33" Top="39" Width="225"></Static>
				<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static24" Left="124" Style="static" TabOrder="31" Top="35" VAlign="Middle" Width="394"></Static>
				<Static Align="Right" Border="None" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static10" Left="764" TabOrder="34" Text="미청산:" Top="3" VAlign="Middle" Width="60"></Static>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static28" Left="965" TabOrder="37" Top="57" Width="80"></Static>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static29" Left="873" TabOrder="38" Top="57" Width="80"></Static>
				<Static Align="Right" Border="None" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static37" Left="764" TabOrder="39" Text="적용단가:" Top="35" VAlign="Middle" Width="64"></Static>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static4" Left="257" TabOrder="36" Top="55" Width="230"></Static>
				<Image Cursor="HAND" Enable="FALSE" Height="17" Id="imgMkpno" ImageID="ic_search" Left="490" OnClick="displayDiv_imgPspno_OnClick" Static="FALSE" TabOrder="10" TabStop="FALSE" Top="41" Visible="FALSE" Width="20"></Image>
				<Edit BindDataset="ds_SJTZ210" Column="MKPNO" Enable="FALSE" Height="20" Id="ed_MKPNO" ImeMode="none" Left="128" MaxLength="15" OnKillFocus="displayDiv_ed_PSPNO_OnKillFocus" TabOrder="2" Top="37" UpperOnly="TRUE" UseIME="FALSE" Width="130"></Edit>
				<Static BindDataset="ds_SJTZ210_DETAIL" Column="CPDSC" Height="14" Id="st_MKPNO" Left="261" TabOrder="35" Top="37" Width="225"></Static>
				<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static2" Left="526" TabOrder="40" Text="SEQ" Top="3" VAlign="Middle" Width="62"></Static>
				<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static3" Left="589" Style="static" TabOrder="41" Top="3" VAlign="Middle" Width="80"></Static>
				<Static Align="Center" BKColor="#dfdfdf" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static5" Left="526" TabOrder="42" Text="계산서&#32;일자" Top="35" VAlign="Middle" Width="116"></Static>
				<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static13" Left="645" Style="static" TabOrder="43" Top="35" VAlign="Middle" Width="120"></Static>
				<Edit BindDataset="ds_SJTZ210" Column="RESON" Height="20" Id="ed_RESON" ImeMode="none" Left="352" MaxLength="2" Number="TRUE" OnKillFocus="displayDiv_ed_RESON_OnKillFocus" TabOrder="5" Top="76" UpperOnly="TRUE" UseIME="FALSE" Width="72"></Edit>
				<Calendar BindDataset="ds_SJTZ210" Column="TAXDT" Height="20" Id="cmb_TAXDT" Left="650" LeftMargin="10" OnKillFocus="displayDiv_cmb_TAXDT_OnKillFocus" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="4" Top="39" Width="112"></Calendar>
				<Edit BindDataset="ds_SJTZ210" Column="PSSEQ" Height="20" Id="ed_PSSEQ" ImeMode="none" Left="592" MaxLength="1" Number="TRUE" TabOrder="3" Top="6" UpperOnly="TRUE" UseIME="FALSE" Width="72"></Edit>
				<Static Align="Center" BindDataset="ds_SJTZ210_DETAIL" Border="None" BorderColor="#b4b4b4" Color="#333333" Column="REASN" Font="굴림,9,Bold" Height="26" Id="st_REASN" Left="835" Style="static" TabOrder="44" Top="35" VAlign="Middle" Width="30"></Static>
				<Static Border="Flat" BorderColor="SCROLLBAR" Height="2" Id="Static15" Left="837" TabOrder="45" Top="57" Width="30"></Static>
				<MaskEdit Align="Center" BindDataset="ds_SJTZ210_DETAIL" Border="None" Column="EDATM" DisableBKColor="white" DisableColor="black" DisplayComma="FALSE" DisplayMaskchar="-" Enable="FALSE" Font="굴림,9,Bold" Height="21" Id="st_EDATM" Left="873" Mask="####-##-##" MaxLength="8" TabOrder="11" TabStop="FALSE" Top="35" Type="STRING" Width="80"></MaskEdit>
				<MaskEdit Align="Right" BindDataset="ds_SJTZ210_DETAIL" Border="None" Column="PRICE" DecimalLen="0" DisableBKColor="white" DisableColor="black" Enable="FALSE" Font="굴림,9,Bold" Height="20" Id="st_PRICE" Left="964" MaxLength="9" NullValue="0" TabOrder="12" TabStop="FALSE" Top="35" Value="MaskEdit0" Width="80"></MaskEdit>
				<MaskEdit Align="Right" BindDataset="ds_SJTZ210_DETAIL" Border="None" Column="BTXQY" DecimalLen="0" DisableBKColor="white" DisableColor="black" Enable="FALSE" Font="굴림,9,Bold" Height="20" Id="st_BTXQY" Left="873" MaxLength="9" NullValue="0" TabOrder="13" Top="3" Value="MaskEdit0" Width="80"></MaskEdit>
				<MaskEdit Align="Right" BindDataset="ds_SJTZ210_DETAIL" Border="None" Column="BTXAMB" DecimalLen="0" DisableBKColor="white" DisableColor="black" Enable="FALSE" Font="굴림,9,Bold" Height="20" Id="st_BTXAMB" Left="964" MaxLength="9" NullValue="0" TabOrder="14" Top="3" Value="MaskEdit0" Width="80"></MaskEdit>
			</Contents>
		</Div>
		<Button Height="21" Id="btn_Clear" Left="678" OnClick="btn_Clear_OnClick" TabOrder="10" TabStop="FALSE" Text="취소" Top="522" Visible="FALSE" Width="48"></Button>
		<Button Height="25" Id="btnQuery" ImageID="btn2_search2" Left="742" OnClick="fn_Search" TabOrder="11" TabStop="FALSE" Text="조회" Top="63" Visible="FALSE" Width="75"></Button>
		<Button Height="26" Id="Button4" ImageID="btn2_add2" Left="818" OnClick="fn_Input" TabOrder="12" TabStop="FALSE" Text="추가" Top="62" Visible="FALSE" Width="75"></Button>
		<Button Height="27" Id="Button5" ImageID="sum_save" Left="901" OnClick="fn_Save" TabOrder="13" TabStop="FALSE" Text="Button2" Top="63" Visible="FALSE" Width="72"></Button>
		<Button Height="25" Id="Button6" ImageID="btn2_delete2" Left="976" OnClick="fn_Delete" TabOrder="14" TabStop="FALSE" Text="Button1" Top="65" Visible="FALSE" Width="75"></Button>
		<Static Align="Center" BKColor="wheat" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static20" Left="6" TabOrder="25" Text="활&#32;동&#32;CD" Top="62" VAlign="Middle" Width="116"></Static>
		<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static2" Left="125" Style="static" TabOrder="26" Top="62" VAlign="Middle" Width="136"></Static>
		<Edit Align="CENTER" Height="20" Id="ed_Action" ImeMode="english" Left="127" MaxLength="1" OnKeyDown="ed_Action_OnKeyDown" TabOrder="6" Top="65" UpperOnly="TRUE" Width="18"></Edit>
		<Static Height="20" Id="ID03061" Left="147" TabOrder="27" Text="(A:추가/Q:조회)" Top="65" VAlign="Middle" Width="96"></Static>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : jae hb
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : SJTZ210.xml
 * ● PROGRAM DESCRIPTION  : 세금계산서TX 등록
 * ● DATE WRITTEN         : 2012.11.06
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");

function on_LoadCompleted(obj){
	getTitle();	
	getDesign();
	gFcOnTopButtonColor("2.2"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	1.3
	getComCode(); //공장구분 선택
	MainGrid.UserData = MainGrid.Height;
	//ed_PYVND.Text="1100";
	//ed_TAXNO.Text="03-003";
}

function getComCode(){
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		sArgument   += " CODE1=" + quote(company);		
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ComboBoxPlant.Value=comps;
	//ComboBoxPlant.Enable = false; 
}
function getDesign(){
	//MainGrid.ToolTipText = setPopMessage("2053");
	MainGrid.BkColor = G_ds_design.GetColumn(0,"BkColor");
	MainGrid.BkColor2 = G_ds_design.GetColumn(0,"BkColor2");
	MainGrid.BkSelColor = G_ds_design.GetColumn(0,"BkSelColor");
	MainGrid.Face3dColor = G_ds_design.GetColumn(0,"Face3dColor");
	MainGrid.BoldHead = G_ds_design.GetColumn(0,"BoldHead");
	MainGrid.HeadHeight = G_ds_design.GetColumn(0,"HeadHeight");
	MainGrid.Width = G_ds_design.GetColumn(0,"Width");
	searchBar.Width = G_ds_design.GetColumn(0,"Width");
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	
}

function getSJTZ210(){
	
	if(!validationChk()){
		return;
	}
	if(length(ed_SHPTO.Text)==0){
		ed_SHPTO.Text="0";
	}

	//계산서일자 년월CHK생성
	var sKind		= "getSJTZ210_CHK";						
	var sMethodName = "service::pssallib/selectSJTZ210_TAXDTCHK.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_SJTZ210_TAXDTCHK=ds_SJTZ210_TAXDTCHK";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	sArgument += " LIB1=" + quote(Lib1);
	sArgument += " LIB2=" + quote(Lib2);
	sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
	sArgument += " PYVND=" + quote(ed_PYVND.Text); //업체
	sArgument += " SHPTO=" + quote(ed_SHPTO.Text); //SHPTO
	sArgument += " TAXNO=" + quote(ed_TAXNO.Text); //계산서번호
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
/*	
	if(ds_SJTZ210_TAXDTCHK.GetRowCount()<1){
		alert(setPopMessage("1003"));
		setMessage("1003");	
		return;
	}
*/	
	var sKind		= "getSJTZ210";						
	var sMethodName = "service::pssallib/selectSJTZ210.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_SJTZ210=ds_SJTZ210";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	sArgument += "@LIB1=" + quote(Lib1);
	sArgument += "@LIB2=" + quote(Lib2);
	sArgument += "@COMPS=" + quote(ComboBoxPlant.Value); //사업부
	sArgument += "@PYVND=" + quote(ed_PYVND.Text); //회계년도
	sArgument += "@SHPTO=" + quote(ed_SHPTO.Text); //전일월누계금액 쿼리
	sArgument += "@TAXNO=" + quote(ed_TAXNO.Text); //선택년월
	var str = dialog("Common::PGMLOAD_SAL.xml","sKind=" + sKind + " " + "sMethodName=" + sMethodName + " " + "sOutDataSet=" + sOutDataSet + " " + "sArgument=" + sArgument,272,64,"TitleBar=false");
	if (str == 'T'){  //정상조회
		alert(setPopMessage("1004"));
		setMessage("1004");
		MainGrid_OnCellClick("",0,"","","","");
		//MainGrid_OnCellClick();
	}else if (str == 'B'){   //data값이 없을때
		alert(setPopMessage("1003"));
		setMessage("1003");	
	}else if (str == 'E'){   //error발생시
		alert(setPopMessage("1002"));
		setMessage("1002");	
	}
}

/********************************************************************** 
 * 내용설명 : insert, update, delete
 **********************************************************************/ 
function setSJTZ210(){
	if(ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="update" ||ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="insert" ){
		if(!ds_SJTZ210_CanRowPosChange()){
			return;
		}
	} 
	if(length(trim(st_PYVND.Text)) < 1){
		alert(setPopMessage("1502"));  //[확인] 거래처코드 확인바랍니다.
		setMessage("1502");	
		ed_PYVND.SetFocus();
		return;
	}	
	if(length(trim(ed_TAXNO.Text)) < 1){
		alert(setPopMessage("4723"));  //[확인] 계산서번호를 확인바랍니다.
		setMessage("4723");	
		ed_PYVND.SetFocus();
		return;
	}	
	var stlwh="";
	var tchk=getHOUSE();
	if(tchk==0){
		alert(setPopMessage("4033"));//[확인]등록된 창고가 없습니다. 업체를 확인해주세요.
		setMessage("4033");	
		return false;
	}
	stlwh=ds_EM035PR.GetColumn(0,"STLWH");
	
	var sKind		= "setSJTZ210";						
	var sMethodName = "service::pssallib/insertSJTZ210.do";    // 서버에서 호출 될 Method 명
	var sInDataSet  = "ds_SJTZ210=ds_SJTZ210:U";               //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_SJTZ210_CHECK=ds_SJTZ210_CHECK";  	   // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " STLWH=" + quote(stlwh);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	if (ds_SJTZ210_CHECK.GetRowCount() > 0){
		for(var i=0;i<ds_SJTZ210_CHECK.GetRowCount();i++){
			alert("업체품번 : " +ds_SJTZ210_CHECK.GetColumn(i,"MKPNO") + ", 풍성품번 : " +ds_SJTZ210_CHECK.GetColumn(i,"PSPNO") + ", SEQ : " +ds_SJTZ210_CHECK.GetColumn(i,"PSSEQ")+ ", 계산서일자 : " +ds_SJTZ210_CHECK.GetColumn(i,"TAXDT")+ " = " + ds_SJTZ210_CHECK.GetColumn(i,"RTMSG"));
		}
		getSJTZ210();  //error항목이 존재시에는 재조회
	}
	// tran 실패
	if(rtnCd<0){
		alert(setPopMessage("1002"));
		setMessage("1002");
	}else {
		//getSvzE505();  //error항목이 존재시에는 재조회
		alert(setPopMessage("1001"));
		setMessage("1001");
		if(ed_Action.Text == "A") fn_Input();
		displayDiv.ed_PSPNO.SetFocus();
	}	
}
/********************************************************************** 
 * 내용설명 : validation 체크
 **********************************************************************/ 
 
function validationChk(){
	var result = true;
	ed_PYVND.BKColor="white";
	ed_TAXNO.BKColor="white";

	if(length(st_PYVND.Text)==0){
		ed_PYVND.BKColor="paleturquoise";
		alert(setPopMessage("4674"));
		setMessage("4674");	
		result =false;
	}
	else if(length(ed_TAXNO.Text)==0){
		ed_TAXNO.BKColor="paleturquoise";
		alert(setPopMessage("4723")); //[확인] 계산서번호를 확인바랍니다.
		setMessage("4723");	
		result =false;
	}
	return result;
}

/********************************************************************** 
 * 내용설명 : 상위메뉴 변경시 초기화
 **********************************************************************/ 
function common_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_SJTZ210.ClearData();
}

/********************************************************************** 
 * 내용설명 : 엑셀파일로 저장
 **********************************************************************/ 
function setExcel()
{
	var fName   = "세금계산서TX 등록";
	var arrSheets  =  Array();  

	arrSheets[0]  = "MainGrid|세금계산서TX 등록";
	createExcelSheetS2(FileDialog0, fName ,arrSheets);

}
/********************************************************************** 
 * 내용설명 : Sort
 **********************************************************************/ 
function MainGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) lib_grid_SetGridSort(obj,nCell);
}
 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	getSJTZ210();
}
function fn_Input()
{
	if(checkInsertCount("ds_SJTZ210")== false) return;
/*
	if(ds_SJTZ210.rowcount < 1) {
	 	getSJTZ210();
	}
*/
	if(!validationChk()){
		return;
	}
	if(length(ed_SHPTO.Text)==0){
		ed_SHPTO.Text="0";
	}
	if(ds_SJTZ210.rowcount < 1) {
	 	getSJTZ210();
	}
		
		ds_SJTZ210.AddRow();
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"COMPS",ComboBoxPlant.Value);
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"PYVND",ed_PYVND.Text);
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"SHPTO",ed_SHPTO.Text);
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"TAXNO",ed_TAXNO.Text);
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"TAXQY",0);
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"TAXCS",0);
		if(ds_SJTZ210.rowcount==1){
			ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"TAXDT",today());
		}
		else{
			ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"TAXDT",ds_SJTZ210.GetColumn(ds_SJTZ210.currow-1,"TAXDT"));	
		}
		displayDiv.st_BTXQY.Text="";
		displayDiv.st_BTXAMB.Text="";
		displayDiv.st_REASN.Text="";
		displayDiv.st_EDATM.Value="";
		displayDiv.st_PRICE.Text="";		
		displayDiv.st_PSPNO.Text="";		
		displayDiv.st_MKPNO.Text="";
	return true;			
}
function fn_Delete()
{
	if(ds_SJTZ210.rowcount < 1) return;			//삭제가 없으면 건너뛰기		
	ds_SJTZ210.DeleteRow(ds_SJTZ210.currow);	//삭제		
	alert(setPopMessage("1011"));	
	setPopMessage("1011");
}

function fn_Save()
{
	if(ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="update" ||ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="insert" ){
		if(!ds_SJTZ210_CanRowPosChange()){
			return;
		}
	} 
	setSJTZ210();
}

function fn_print()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Excel()
{
	setExcel();
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("2.2"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)
}
//동적쿼리 생성 세금일자를 기준으로 생성
function makeQry(YYMM){
	var mqry1="";
	var mqry2="";
	var varr= array(2);
	
	if( 3< YYMM && YYMM<13){
		for( i=1; i <YYMM-2; i++){
			if(length(mqry1) != 0){
				mqry1 = mqry1 +"+";
				mqry2 = mqry2 +"+";
			}
			mqry1 = mqry1 +"A.CQY"+lpad(i,0,2)+"-A.TQY"+lpad(i,0,2);
			mqry2 = mqry2 +"A.CAM"+lpad(i,0,2)+"-A.TAM"+lpad(i,0,2);
		}
	}
	if( 0< YYMM && YYMM<4) {
		for( i=1; i <YYMM+10; i++){
			if(length(mqry1) != 0){
				mqry1 = mqry1 +"+";
				mqry2 = mqry2 +"+";
			}
			mqry1 = mqry1 +"A.CQY"+lpad(i,0,2)+"-A.TQY"+lpad(i,0,2);
			mqry2 = mqry2 +"A.CAM"+lpad(i,0,2)+"-A.TAM"+lpad(i,0,2);
		}
	}
	varr[0]= mqry1;
	varr[1]= mqry2;	
	return varr;
}
function getHOUSE(){

	var sKind		= "getHOUSE";		
	var sMethodName = "service::pscomlib/selectEM035PR.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_EM035PR=ds_EM035PR";
	var sArgument   = "";
		sArgument  += " LIB1=" + quote(Lib1);
		sArgument  += " CUSNO=" + quote(ed_PYVND.Text);
		sArgument  += " SHPNO=" + quote(ed_SHPTO.Text);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	if(ds_EM035PR.rowcount < 1){
		return 0;	
	}
	else{
		return 1;
	}
}
function ed_PYVND_OnCharChanged(obj,strPreText,strPostText)
{
	st_PYVND.Text = "";
}
//업체확인
function ed_PYVND_OnKillFocus(obj)
{
	if(length(trim(obj.Text)) < 1) return;
	//득의선Check
	http.usewaitcursor = false;
	http.Sync 	= true;
	var sKind		= "getOGMPrtno";		
	var sMethodName = "service::pscomlib/selectCUSMAS1.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_CUSMAS1=ds_CUSMAS1";
	var sArgument   = "";
		sArgument  += " LIB1=" + quote(Lib1);
		sArgument  += " CUSNO=" + quote(ed_PYVND.Text);
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	if (ds_CUSMAS1.GetRowCount() < 1){
		alert(setPopMessage("1502"));
		setMessage("1502");	
		ed_PYVND.SetFocus();
		return;
	}
	st_PYVND.Text=ds_CUSMAS1.GetColumn(0,"CUSNM");
	http.usewaitcursor = true;	
}
//업체확인팝업
function imgMaker_OnClick(obj,nX,nY)
{
	var sTemp=trim(ed_PYVND.Text);
	if (length(trim(ed_PYVND.Text)) == 0) sTemp="zzzzzzzzzz";
	var selectnumber = "B0";
	var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp,584,528);
	if (length(rtn) != 0){
		ed_PYVND.Text = rtn[0];
		st_PYVND.Text = rtn[1];
	}
}

//계산서일자 CHECK
function displayDiv_cmb_TAXDT_OnKillFocus(obj)
{
	if(displayDiv.cmb_TAXDT.Value!=""){
		var sKind		= "getMST090PF";						
		var sMethodName = "service::pscomlib/selectMST090PF.do";     		// 서버에서 호출 될 Method 명
		var sInDataSet  = "";                             				// 자료 저장 시 보낼 DataSet 명칭
		var sOutDataSet = "ds_MST090PF=ds_MST090PF";    				// 조회 후 돌려 받을 DataSet 명칭
		var sArgument   = "";
			sArgument += " LIB2=" + quote(Lib2);
			sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
			sArgument += " PRCDT=" + quote(displayDiv.cmb_TAXDT.Value); //계산서일자
		http.Sync=true;
		Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
		http.Sync=false;
		
		if(ds_MST090PF.GetRowCount() < 1){
			alert(setPopMessage("4724"));//[확인] 계산서일자를 확인바랍니다.
			setPopMessage("4724");
			displayDiv.cmb_TAXDT.Value="";
			displayDiv.cmb_TAXDT.SetFocus();
			return;
		}
		if(length(trim(ds_SJTZ210_TAXDTCHK.GetColumn(0,"TAXDTM")))!=0){
			if(ds_SJTZ210_TAXDTCHK.GetColumn(0,"TAXDTM")!=substr(ds_MST090PF.GetColumn(0,"PRCDT"),0,6)){
				alert(setPopMessage("4725"));//[알림]계산서번호의 계산서년월은 동일해야합니다.
				setPopMessage("4725");
				displayDiv.cmb_TAXDT.Value="";
				displayDiv.cmb_TAXDT.SetFocus();
				return;		
			}
		}
		else{
			ds_SJTZ210_TAXDTCHK.AddColumn("TAXDTM");
			ds_SJTZ210_TAXDTCHK.AddRow();
			ds_SJTZ210_TAXDTCHK.SetColumn(0,"TAXDTM",substr(ds_MST090PF.GetColumn(0,"PRCDT"),0,6));
		}
//trace(ds_SJTZ210_TAXDTCHK.SaveXML());
	//displayDiv.ed_PSPNO.SetFocus();
	}
}
//이유코드 CHECK
function displayDiv_ed_RESON_OnKillFocus(obj){
	if(length(displayDiv.ed_RESON.Text) != 0 ){
		if(length(displayDiv.ed_PSPNO.Text) != 0 ){
			var sKind		= "getMST050PF";						
			var sMethodName = "service::pscomlib/selectMST050PF.do";     		// 서버에서 호출 될 Method 명
			var sInDataSet  = "";                             				// 자료 저장 시 보낼 DataSet 명칭
			var sOutDataSet = "ds_MST050PF=ds_MST050PF";    				// 조회 후 돌려 받을 DataSet 명칭
			var sArgument   = "";
				sArgument += " LIB2=" + quote(Lib2);
				sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //사업부
				sArgument += " GRPCD=" + quote("SJS"); //계산서일자
				sArgument += " MSTCD=" + quote(displayDiv.ed_RESON.Text); //계산서일자
			http.Sync=true;
			Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
			http.Sync=false;
			
			if(ds_MST050PF.GetRowCount() < 1){
				alert(setPopMessage("4726"));//[확인]이유코드를 확인바랍니다.
				setPopMessage("4726");				
				displayDiv.ed_RESON.Text="";
				return;
			}
		}
	}	
}

/****************************************************
 <계산서금액 CHECK >      
 <이유 80= 정　산 +> => <수량과단가모두＋처리 >  
 <이유 81= 환차손 +> => <수량과단가모두＋처리 >  
 <이유 90= 정　산 -> => <수량은－，단가는＋처리 >
 <이유 91= 환차손 -> => <수량은＋，단가는－처리 >
*****************************************************/
function ds_SJTZ210_CanRowPosChange(obj,nOldRow,nRow)
{
	if(ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="update" ||ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="insert" ){
		var pspno=ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"PSPNO");
		var reson=ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"RESON");
		var taxqy=ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"TAXQY");
		var taxcs=ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"TAXCS");
		var taxdt=ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"TAXDT");

		if(length(pspno)!=0){
			if(length(reson)==0){	//일시불
				alert(setPopMessage("4727"));//[알림]이유코드는 (80,81,90,91)만 입력가능합니다.
				setPopMessage("4727");	
				MainGrid_OnCellClick("",ds_SJTZ210.currow,"","","","");
				return false;
			}else{
				if(reson == "80" || reson == "81"){
					if(taxqy <= "0" || taxcs <= "0"){
						alert(setPopMessage("4728"));//[알림]이유코드 80/81은 수량, 단가 (+)만 입력가능합니다.
						setPopMessage("4728");	
						MainGrid_OnCellClick("",ds_SJTZ210.currow,"","","","");
						return false;
					}
				}if(reson == "90"){
					if(taxqy >= "0" || taxcs <= "0"){
						alert(setPopMessage("4729"));//[알림]이유코드 90은 수량(-), 단가 (+)만 입력가능합니다.
						setPopMessage("4729");	
						MainGrid_OnCellClick("",ds_SJTZ210.currow,"","","","");
						return false;
					}
				}if(reson == "91"){
					if(taxqy <= "0" || taxcs >= "0"){
						alert(setPopMessage("4730"));//[알림]이유코드 91은 수량(+), 단가 (-)만 입력가능합니다.
						setPopMessage("4730");	
						MainGrid_OnCellClick("",ds_SJTZ210.currow,"","","","");
						return false;
					}
				}
			}if(length(taxdt)==0){
				alert(setPopMessage("4724"));//[확인] 계산서일자를 확인바랍니다.
				setPopMessage("4724");	
				MainGrid_OnCellClick("",ds_SJTZ210.currow,"","","","");
				return false;
			}		
		}
		if(ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="insert"){
			if(length(pspno)!=0){
				if(length(displayDiv.ed_PSSEQ.Text)==0){
					displayDiv.ed_PSSEQ.Text=0;
				}
				var sKind		= "getSJTZ210_CHK2";		
				var sMethodName = "service::pssallib/selectSJTZ210_CHK2.do";     		// 서버에서 호출 될 Method 명
				var sInDataSet  = "";
				var sOutDataSet = "ds_SJTZ210_CHK2=ds_SJTZ210_CHK2";
				var sArgument   = "";
					sArgument += " LIB2=" + quote(Lib2);
					sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
					sArgument += " PYVND=" + quote(ed_PYVND.Text); 
					sArgument += " SHPTO=" + quote(ed_SHPTO.Text); 
					sArgument += " TAXNO=" + quote(ed_TAXNO.Text); 
					sArgument += " PSPNO=" + quote(displayDiv.ed_PSPNO.Text); 
					sArgument += " MKPNO=" + quote(displayDiv.ed_MKPNO.Text); 
					sArgument += " PSSEQ=" + quote(displayDiv.ed_PSSEQ.Text); 
					sArgument += " TAXDT=" + quote(displayDiv.cmb_TAXDT.Value); 
				http.Sync=true;
				Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
				http.Sync=false;
				if (ds_SJTZ210_CHK2.GetRowCount() > 0){
					alert(setPopMessage("4731"));//[알림]이미등록된 자료입니다. SEQ를 수정하시바랍니다.
					setPopMessage("4731");	
					//btn_Clear_OnClick(obj);
					displayDiv.ed_PSSEQ.Enable=true;
					displayDiv.ed_PSSEQ.SetFocus();
					MainGrid_OnCellClick("",ds_SJTZ210.currow,"","","","");
					return false;
				}
			}	
		}
		return true;
	}	
}

//금액 자동계산
function ds_SJTZ210_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if( strColumnID == "TAXQY" || strColumnID == "TAXCS"){
		if( strColumnID == "TAXQY"){
			if(varNewValue != "" ){
				var taxcs=ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"TAXCS");
				var caltax=	parseInt(varNewValue) * parseInt(taxcs);
				ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"TAXAM",caltax);	
			}
		}
		else {
			if(varNewValue != "" ){
				var taxqy=ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"TAXQY");
				var caltax=	parseInt(varNewValue) * parseInt(taxqy);
				ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"TAXAM",caltax);	
			}
		}
	}	
}

//추가이면 품번, 업체품번, SEQ만 활성화 후 품번 입력후 나머지 활성화
//수정이면 세금계산일, 이유, 수량, 단가 만활성화
function MainGrid_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
//미청산수량,금액 계산
	//회계년도 계산
	if(length(ds_SJTZ210.GetColumn(nRow,"PSPNO"))!=0){
		http.Sync=true;
		var chkYYMM=parseInt(substr(ds_SJTZ210_TAXDTCHK.GetColumn(0,"TAXDTM"),4,2));
		var makdtVal = makeQry(chkYYMM);
		var sChkym=substr(ds_SJTZ210_TAXDTCHK.GetColumn(0,"TAXDTM"),0,4);
		if(substr(ds_SJTZ210_TAXDTCHK.GetColumn(0,"TAXDTM"),4,2) <= '03'){
			sChkym = parseInt(sChkym)-1;
		}
		var sKind		= "getSJTZ210_DETAIL";		
		var sMethodName = "service::pssallib/selectSJTZ210_DETAIL.do";     		// 서버에서 호출 될 Method 명
		var sInDataSet  = "";
		var sOutDataSet = "ds_SJTZ210_DETAIL=ds_SJTZ210_DETAIL";
		var sArgument   = "";
			sArgument += " LIB1=" + quote(Lib1);
			sArgument += " LIB2=" + quote(Lib2);
			sArgument += " COMPS=" + quote(ds_SJTZ210.GetColumn(nRow,"COMPS")); //사업부
			sArgument += " PYVND=" + quote(ds_SJTZ210.GetColumn(nRow,"PYVND")); //업체
			sArgument += " SHPTO=" + quote(ds_SJTZ210.GetColumn(nRow,"SHPTO")); //SHPTO
			sArgument += " PSPNO=" + quote(ds_SJTZ210.GetColumn(nRow,"PSPNO")); //품번
			sArgument += " TAXDT=" + quote(ds_SJTZ210.GetColumn(nRow,"TAXDT")); //품번
			sArgument += " MKQRY1=" + quote(makdtVal[0]); //출고누계수량 SQL
			sArgument += " MKQRY2=" + quote(makdtVal[1]); //출고누계금액 SQL
			sArgument += " CHKYM=" + quote(sChkym); //계산서일자
		Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
		http.Sync=false;
	}
	else{
		displayDiv.st_BTXQY.Text="";
		displayDiv.st_BTXAMB.Text="";
		displayDiv.st_REASN.Text="";
		displayDiv.st_EDATM.Value="";
		displayDiv.st_PRICE.Text="";
	}
/*
	if(ds_SJTZ210.GetRowType(nRow)=="insert" ){
		if(length(displayDiv.ed_PSPNO.Text)!=0){
			return;
		}
		displayDiv.ed_PSPNO.Enable=true;
		displayDiv.ed_PSSEQ.Enable=true;
		displayDiv.ed_MKPNO.Enable=true;
		displayDiv.cmb_TAXDT.Enable=true;
		displayDiv.ed_RESON.Enable=false;
		displayDiv.ed_TAXQY.Enable=false;
		displayDiv.ed_TAXCS.Enable=false;
	}
	else{
		displayDiv.ed_PSPNO.Enable=false;
		displayDiv.ed_PSSEQ.Enable=false;
		displayDiv.ed_MKPNO.Enable=false;
		displayDiv.cmb_TAXDT.Enable=true;
		displayDiv.ed_RESON.Enable=true;
		displayDiv.ed_TAXQY.Enable=true;
		displayDiv.ed_TAXCS.Enable=true;
	}	
*/			
}

function ds_SJTZ210_OnRowPosChanged(obj,nOldRow,nRow)
{
		if(ds_SJTZ210.GetRowType(nRow)=="insert"){
			if(length(displayDiv.ed_PSPNO.Text)!=0){
				displayDiv.ed_PSPNO.Enable=false;
				displayDiv.ed_PSSEQ.Enable=false;
				displayDiv.ed_MKPNO.Enable=false;
				displayDiv.cmb_TAXDT.Enable=true;
				displayDiv.ed_RESON.Enable=true;
				displayDiv.ed_TAXQY.Enable=true;
				displayDiv.ed_TAXCS.Enable=true;
				displayDiv.imgPspno.Enable=false;	
				displayDiv.imgMkpno.Enable=false;		
			}else{
				displayDiv.ed_PSPNO.Enable=true;
				displayDiv.ed_PSSEQ.Enable=true;
				displayDiv.ed_MKPNO.Enable=true;
				displayDiv.cmb_TAXDT.Enable=true;
				displayDiv.ed_RESON.Enable=false;
				displayDiv.ed_TAXQY.Enable=false;
				displayDiv.ed_TAXCS.Enable=false;
				displayDiv.imgPspno.Enable=true;	
				displayDiv.imgMkpno.Enable=true;			
				displayDiv.st_PSPNO.Text="";		
				displayDiv.st_MKPNO.Text="";
			}
		}
		else{
			displayDiv.ed_PSPNO.Enable=false;
			displayDiv.ed_PSSEQ.Enable=false;
			displayDiv.ed_MKPNO.Enable=false;
			displayDiv.cmb_TAXDT.Enable=true;
			displayDiv.ed_RESON.Enable=true;
			displayDiv.ed_TAXQY.Enable=true;
			displayDiv.ed_TAXCS.Enable=true;
			displayDiv.imgPspno.Enable=false;	
			displayDiv.imgMkpno.Enable=false;	

		}			
}

function btn_Clear_OnClick(obj)
{
	if(ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="insert" ){
		displayDiv.ed_PSPNO.Text="";
		displayDiv.st_PSPNO.Text="";
		displayDiv.ed_PSSEQ.Text="";
		displayDiv.ed_MKPNO.Text="";
		displayDiv.st_MKPNO.Text="";
		displayDiv.st_BTXQY.Text="";
		displayDiv.st_BTXAMB.Text="";
		displayDiv.cmb_TAXDT.Text="";
		displayDiv.st_REASN.Text="";
		displayDiv.st_EDATM.Text="";
		displayDiv.st_PRICE.Text="";
		displayDiv.st_CARCD.Text="";
		displayDiv.st_CARNM.Text="";
		displayDiv.ed_RESON.Text="";
		displayDiv.ed_TAXQY.Text="";
		displayDiv.ed_TAXCS.Text="";
		displayDiv.ed_TAXAM.Text="";
		displayDiv.ed_PSPNO.Enable=true;
		displayDiv.ed_PSSEQ.Enable=true;
		displayDiv.ed_MKPNO.Enable=true;
		displayDiv.cmb_TAXDT.Enable=true;
		displayDiv.ed_RESON.Enable=false;
		displayDiv.ed_TAXQY.Enable=false;
		displayDiv.ed_TAXCS.Enable=false;	
		displayDiv.imgPspno.Enable=true;	
		displayDiv.imgMkpno.Enable=true;	
	}
}

//품번팝업
function displayDiv_imgPspno_OnClick(obj,nX,nY)
{
	var sTemp=trim(displayDiv.ed_PSPNO.Text);
	if (length(trim(displayDiv.ed_PSPNO.Text)) == 0) sTemp="zzzzzzzzzz";
	var selectnumber = "A1";
	var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp,584,528);
	if (length(rtn) != 0){
		displayDiv.ed_PSPNO.Text = rtn[0];
		displayDiv.st_PSPNO.Text = rtn[1];
		displayDiv.ed_PSPNO.SetFocus();
	}
}
function displayDiv_ed_PSPNO_OnCharChanged(obj,strPreText,strPostText)
{
	displayDiv.st_PSPNO.Text="";
}
//현재PGM은 BM008이아닌 EM000PR에서 체크함.
function displayDiv_ed_PSPNO_OnKillFocus(obj)
{
	if(length(trim(obj.Text)) < 1) return;
	if(displayDiv.cmb_TAXDT.Value=="") {
		alert(setPopMessage("4724"));//[확인] 계산서일자를 확인바랍니다.
		setPopMessage("4724");	
		displayDiv.cmb_TAXDT.SetFocus();
		return;
	}
	//품번확인
	http.usewaitcursor = false;
	http.Sync 	= true;
	var sKind		= "getSalePrice";		
	var sMethodName = "service::pscomlib/selectEM000PR2.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_EM000PR=ds_EM000PR";
	var sArgument   = "";
		sArgument  += " LIB1=" + quote(Lib1);
		sArgument  += " LIB2=" + quote(Lib2);
		sArgument  += " COMPS=" + quote(ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"COMPS")); //사업부
		sArgument  += " CUSNO=" + quote(ed_PYVND.Text);
		sArgument  += " PRTNO=" + quote(displayDiv.ed_PSPNO.Text);
		sArgument  += " CPRTN=" + quote(displayDiv.ed_MKPNO.Text);
		sArgument  += " TAXDT=" + quote(displayDiv.cmb_TAXDT.Value);
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	if (ds_EM000PR.GetRowCount() < 1){
		alert(setPopMessage("4001"));  //Part Number Cross Ref MA에 미등록된 득의선,품번입니다.
		setMessage("4001");	
		displayDiv.ed_PSPNO.Text="";
		displayDiv.ed_MKPNO.Text="";
		displayDiv.ed_PSPNO.SetFocus();
		return false;
	}
	if (ds_EM000PR.GetRowCount() > 0){
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"CARCD",trim(ds_EM000PR.GetColumn(0,"CARCD")));
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"CARNM",trim(ds_EM000PR.GetColumn(0,"CARNM")));
		displayDiv.ed_PSPNO.Text = trim(ds_EM000PR.GetColumn(0,"PRTNO"));
		displayDiv.st_PSPNO.Text = trim(ds_EM000PR.GetColumn(0,"CPDSC"));//CPDSC
		displayDiv.ed_MKPNO.Text = trim(ds_EM000PR.GetColumn(0,"CPRTN"));
		displayDiv.st_MKPNO.Text = trim(ds_EM000PR.GetColumn(0,"CPDSC"));
		displayDiv.st_CARCD.Text = trim(ds_EM000PR.GetColumn(0,"CARCD"));
		displayDiv.st_CARNM.Text = trim(ds_EM000PR.GetColumn(0,"CARNM"));
		displayDiv.ed_PSPNO.Enable=false;
		displayDiv.ed_MKPNO.Enable=false;
		displayDiv.ed_PSSEQ.Enable=true;
		displayDiv.cmb_TAXDT.Enable=true;
		displayDiv.ed_RESON.Enable=true;
		displayDiv.ed_TAXQY.Enable=true;
		displayDiv.ed_TAXCS.Enable=true;	
	}	
	//단가등록 확인
	var sKind		= "getSalePrice";		
	var sMethodName = "service::pscomlib/selectEM001PR2.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_EM001PR=ds_EM001PR";
	var sArgument   = "";
		sArgument  += " LIB1=" + quote(Lib1);
		sArgument  += " CUSNO=" + quote(ed_PYVND.Text);
		sArgument  += " PRTNO=" + quote(displayDiv.ed_PSPNO.Text);
		sArgument  += " TAXDT=" + quote(displayDiv.cmb_TAXDT.Value);
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	if (ds_EM001PR.GetRowCount() < 1){
		alert(setPopMessage("4001"));  //Part Number Cross Ref MA에 미등록된 득의선,품번입니다.
		setMessage("4001");	
		displayDiv.ed_PSPNO.Text="";
		displayDiv.ed_MKPNO.Text="";
		displayDiv.ed_PSPNO.SetFocus();
		return false;
	}
	if (ds_EM001PR.GetRowCount() > 0){
		ds_SJTZ210.SetColumn(ds_SJTZ210.currow,"CURCD",trim(ds_EM001PR.GetColumn(0,"CURCD")));
	}
	
	var chkYYMM=parseInt(substr(ds_SJTZ210_TAXDTCHK.GetColumn(0,"TAXDTM"),4,2));
	var makdtVal = makeQry(chkYYMM);
	var sChkym=substr(ds_SJTZ210_TAXDTCHK.GetColumn(0,"TAXDTM"),0,4);
	if(substr(ds_SJTZ210_TAXDTCHK.GetColumn(0,"TAXDTM"),4,2) <= '03'){
		sChkym = parseInt(sChkym)-1;
	}
	var sKind		= "getSJTZ210_DETAIL";		
	var sMethodName = "service::pssallib/selectSJTZ210_DETAIL.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";
	var sOutDataSet = "ds_SJTZ210_DETAIL=ds_SJTZ210_DETAIL";
	var sArgument   = "";
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"COMPS")); //사업부
		sArgument += " PYVND=" + quote(ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"PYVND")); //업체
		sArgument += " SHPTO=" + quote(ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"SHPTO")); //SHPTO
		sArgument += " PSPNO=" + quote(ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"PSPNO")); //품번
		sArgument += " TAXDT=" + quote(ds_SJTZ210.GetColumn(ds_SJTZ210.currow,"TAXDT")); //품번
		sArgument += " MKQRY1=" + quote(makdtVal[0]); //출고누계수량 SQL
		sArgument += " MKQRY2=" + quote(makdtVal[1]); //출고누계금액 SQL
		sArgument += " CHKYM=" + quote(sChkym); //계산서일자
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	if(ds_SJTZ210.GetRowType(ds_SJTZ210.currow)=="insert" ){
		displayDiv.ed_TAXCS.Value=ds_SJTZ210_DETAIL.GetColumn(0,"PRICE");
	}
	displayDiv.ed_PSSEQ.SetFocus();
}
function ed_Action_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13){
		switch(obj.text){
			case "A" : fn_Input(); displayDiv.ed_PSPNO.SetFocus(); break;
			case "Q" : fn_Search(); break;
			default : alert(setPopMessage("1003")); setMessage("1003");
		}
	}
}	

function displayDiv_ed_TAXCS_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if(nChar == 13){
		if(confirm("저장하시겠습니까? ") == false) return;
		fn_Save();
	}
}
function getSJT210Detail(){

}
]]></Script>
</Window>