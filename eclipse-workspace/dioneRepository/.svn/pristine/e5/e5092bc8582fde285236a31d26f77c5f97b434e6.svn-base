<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="black" Height="1000" Id="UserList" Left="8" OnFocus="UserList_OnFocus" OnLoadCompleted="on_LoadCompleted" OnTimer="UserList_OnTimer" PidAttrib="7" Title="트럭진척현황" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1900" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_FSAZ160Q_P"></Dataset>
			<Dataset DataSetType="Dataset" Id="Line"></Dataset>
		</Datasets>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1616" Right="1640" TabOrder="25" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1648" Right="1672" TabOrder="24" Width="24"></File>
		<Static Align="Center" Border="None" BorderColor="white" Color="white" Font="맑은&#32;고딕,36,Bold" Height="72" Id="st_TIME" Left="1664" TabOrder="1" Top="16" VAlign="Middle" Width="214"></Static>
		<Static Align="Center" Border="None" BorderColor="white" Color="white" Font="맑은&#32;고딕,36,Bold" Height="72" Id="st_DATE" Left="1360" TabOrder="2" Top="16" VAlign="Middle" Width="264"></Static>
		<Static BKColor="#f9f7e3" Border="Flat" BorderColor="black" Height="232" Id="Static0" Left="24" TabOrder="5" Top="245" Width="1856"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static1" Left="40" TabOrder="3" Text="작업중" Top="261" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" BKColor="black" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static2" Left="408" TabOrder="6" Top="261" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Edit Align="CENTER" BKColor="white" Border="None" BorderColor="black" CheckLength="Byte" DisableBKColor="black" DisableColor="white" Enable="FALSE" Font="맑은&#32;고딕,88,Bold" Height="198" Id="ed_TIMES01" Left="418" Readonly="TRUE" TabOrder="4" Top="262" Width="358"></Edit>
		<Static Align="Center" BKColor="black" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static12" Left="801" TabOrder="7" Top="261" VAlign="Middle" VClip="Top" Width="1063"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO01" Left="808" TabOrder="8" Top="264" VAlign="Middle" VClip="Top" Width="615"></Static>
		<Static BKColor="#f9f7e3" Border="Flat" BorderColor="black" Height="232" Id="Static3" Left="24" TabOrder="11" Top="472" Width="1856"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static4" Left="40" TabOrder="9" Text="NEXT1" Top="488" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" BKColor="black" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static5" Left="408" TabOrder="12" Top="488" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Edit Align="CENTER" BKColor="white" Border="None" BorderColor="black" CheckLength="Byte" DisableBKColor="black" DisableColor="white" Enable="FALSE" Font="맑은&#32;고딕,88,Bold" Height="198" Id="ed_TIMES02" Left="418" Readonly="TRUE" TabOrder="10" Top="489" Width="358"></Edit>
		<Static Align="Center" BKColor="black" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static6" Left="801" TabOrder="13" Top="488" VAlign="Middle" VClip="Top" Width="1063"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO02" Left="808" TabOrder="14" Top="493" VAlign="Middle" VClip="Top" Width="615"></Static>
		<Static BKColor="#f9f7e3" Border="Flat" BorderColor="black" Height="232" Id="Static8" Left="24" TabOrder="17" Top="703" Width="1856"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static9" Left="40" TabOrder="15" Text="NEXT2" Top="719" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" BKColor="black" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static10" Left="408" TabOrder="18" Top="719" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Edit Align="CENTER" BKColor="white" Border="None" BorderColor="black" CheckLength="Byte" DisableBKColor="black" DisableColor="white" Enable="FALSE" Font="맑은&#32;고딕,88,Bold" Height="198" Id="ed_TIMES03" Left="418" Readonly="TRUE" TabOrder="16" Top="720" Width="358"></Edit>
		<Static Align="Center" BKColor="black" Border="Flat" BorderColor="black" Color="black" Font="맑은&#32;고딕,60,Bold" Height="200" Id="Static11" Left="801" TabOrder="19" Top="719" VAlign="Middle" VClip="Top" Width="1063"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO03" Left="808" TabOrder="20" Top="724" VAlign="Middle" VClip="Top" Width="615"></Static>
		<Static BKColor="#f9f7e3" Border="Flat" BorderColor="black" Height="152" Id="Static7" Left="24" TabOrder="22" Top="96" Width="1856"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,60,Bold" Height="120" Id="Static13" Left="40" TabOrder="21" Text="항&#32;목" Top="112" VAlign="Middle" VClip="Top" Width="350"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,60,Bold" Height="120" Id="Static14" Left="408" TabOrder="23" Text="시작시간" Top="112" VAlign="Middle" VClip="Top" Width="376"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,60,Bold" Height="120" Id="Static15" Left="801" TabOrder="24" Text="작업&#32;내용" Top="112" VAlign="Middle" VClip="Top" Width="1063"></Static>
		<Static Border="None" BorderColor="black" Color="yellow" Font="맑은&#32;고딕,60,Bold" Height="88" Id="Static16" Left="32" TabOrder="25" Text="&lt;트럭진척현황&gt;" VAlign="Middle" VClip="Top" Width="800"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO11" Left="1424" TabOrder="26" Top="264" VAlign="Middle" VClip="Top" Width="436"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO12" Left="1424" TabOrder="27" Top="493" VAlign="Middle" VClip="Top" Width="436"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="white" Font="맑은&#32;고딕,55,Bold" Height="95" Id="ed_INFO13" Left="1424" TabOrder="28" Top="724" VAlign="Middle" VClip="Top" Width="436"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="yellow" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO21" Left="1424" TabOrder="29" Top="360" VAlign="Middle" VClip="Top" Width="436"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="yellow" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO22" Left="1424" TabOrder="30" Top="589" VAlign="Middle" VClip="Top" Width="436"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="yellow" Font="맑은&#32;고딕,55,Bold" Height="95" Id="ed_INFO23" Left="1424" TabOrder="31" Top="820" VAlign="Middle" VClip="Top" Width="436"></Static>
		<Static Align="Right" BKColor="black" Border="None" BorderColor="white" Color="white" Font="맑은&#32;고딕,36,Bold" Height="63" Id="st_GATEIF" Left="1520" TabOrder="32" Top="935" VAlign="Middle" Width="359"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="yellow" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO31" Left="808" TabOrder="33" Top="360" VAlign="Middle" VClip="Top" Width="615"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="yellow" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO32" Left="808" TabOrder="34" Top="589" VAlign="Middle" VClip="Top" Width="615"></Static>
		<Static Align="Center" BKColor="black" Border="None" BorderColor="black" Color="yellow" Font="맑은&#32;고딕,55,Bold" Height="94" Id="ed_INFO33" Left="808" TabOrder="35" Top="820" VAlign="Middle" VClip="Top" Width="615"></Static>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : 제환복
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : FSAZ160Q_P.xml
 * ● PROGRAM DESCRIPTION  : 출하진척-트럭진척현황
 * ● DATE WRITTEN         : 2015.12.18
 ----------------------------------------------------------------*/

#include "script::lib_script_common.js";

var Lib1 = G_ds_user.GetColumn(0,"LIB1");    //CIGMA LIBRARY(PERESLIB              PSRESLIB)
var Lib2 = G_ds_user.GetColumn(0,"LIB2");    //MRP LIBRARY(PSEDBLIB                PSCDBLIB)
var Lib3 = G_ds_user.GetColumn(0,"LIB3");    //인사급여 LIBRARY(PSEDBLIB           PSCDBLIB.PSHDBLIB.PSSDBLIB)

var company = G_ds_user.GetColumn(0,"COMPANY"); //PE      PS
var comps = G_ds_user.GetColumn(0,"PLANT_CD"); //E1,      C1.H1.S1

var nowDate=today();
var p_COMPS;
var P_GATE;
var arr = array();

function on_LoadCompleted(obj){
	
	//getTitle();	
	//gFcOnTopButtonColor("1"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)
	//var fnmae=toUpper("LineName");
	var path = "C:\\shipmentInfo.txt";

	file.FileName = path;//파일명은 대소문자구분안함.
	file.Open("r"); // Option ( r:read, t:text, b:binary, w:write, a:append )
	arr = split(file.Read(),"\n");
	p_COMPS = toUpper(trim(arr[0]));
	P_GATE = toUpper(trim(arr[1]));
	if(length(trim(P_GATE))=0){
		alert("[알림]저장된 GATE정보가 없습니다.");
		return;
	}
	file.Close();
	
	if(toUpper(p_COMPS)="E1"){
		Lib1 = "PERESLIB";
		Lib2 = "PSEDBLIB";
		Lib3 = "PSEDBLIB";
	}else if(toUpper(p_COMPS)="C1"){
		Lib1 = "PSRESLIB";
		Lib2 = "PSCDBLIB";
		Lib3 = "PSCDBLIB";
	}else if(toUpper(p_COMPS)="H1"){
		Lib1 = "PSRESLIB";
		Lib2 = "PSCDBLIB";
		Lib3 = "PSHDBLIB";
	}else if(toUpper(p_COMPS)="S1"){
		Lib1 = "PSRESLIB";
		Lib2 = "PSCDBLIB";
		Lib3 = "PSSDBLIB";
	}
	fn_Search();	
	setTimer(1, 60*1000);
	setTimer(2, 1*1000);
	
	
	st_GATEIF.Text=toUpper(p_COMPS)+" "+P_GATE+"번 GATE ";
	//alert(substr(getDate(),8,4));
	//setTimer(1, 10*1000);
	//setTimer(2, 1*1000);
	//setTimer(1, 10*1000);Default
	//setTimer(1, 300*1000);
	//alert(Lib1+Lib2+Lib3);
}


function getFSAZ160Q_P(){
		
	var sKind		= "getFSAZ160Q_P";						
	var sMethodName = "service::shipment/getFSAZ160Q_PList";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                             				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_FSAZ160Q_P=ds_FSAZ160Q_P";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";		
		sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " DATE=" + quote(nowDate);//실적일자
		sArgument += " COMPS=" + quote(toUpper(p_COMPS));
		sArgument += " P_TIME=" + quote(substr(getDate(),8,4));	//시간
		//sArgument += " P_TIME=" + quote(1400);	//시간
		sArgument += " GATCD=" + quote(P_GATE);	//GATE정보
		sArgument += " DAYCD=" +  quote(getDay(today())+1);
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");	
	http.Sync=false;
	
	if(ds_FSAZ160Q_P.rowcount > 0){
	/*
		for(i=0; i<5; i++){
			//'ed_TIMES'+i+'.Text'=substr(lpad(ds_FSAZ160Q_P.GetColumn(i,"TIMES"),"0",4),0,2)+":"+substr(lpad(ds_FSAZ160Q_P.GetColumn(i,"TIMES"),"0",4),2,2);
			//ed_TIMES01.Text=substr(lpad(ds_FSAZ160Q_P.GetColumn(i,"TIMES"),"0",4),0,2)+":"+substr(lpad(ds_FSAZ160Q_P.GetColumn(i,"TIMES"),"0",4),2,2);
			addVariable("ed_TIMES0"+i+".Text",substr(lpad(ds_FSAZ160Q_P.GetColumn(i,"TIMES"),"0",4),0,2)+":"+substr(lpad(ds_FSAZ160Q_P.GetColumn(i,"TIMES"),"0",4),2,2));
		}
	*/
		ed_TIMES01.Text=substr(lpad(ds_FSAZ160Q_P.GetColumn(0,"TIMES"),"0",4),0,2)+":"+substr(lpad(ds_FSAZ160Q_P.GetColumn(0,"TIMES"),"0",4),2,2);
		ed_TIMES02.Text=substr(lpad(ds_FSAZ160Q_P.GetColumn(1,"TIMES"),"0",4),0,2)+":"+substr(lpad(ds_FSAZ160Q_P.GetColumn(1,"TIMES"),"0",4),2,2);
		ed_TIMES03.Text=substr(lpad(ds_FSAZ160Q_P.GetColumn(2,"TIMES"),"0",4),0,2)+":"+substr(lpad(ds_FSAZ160Q_P.GetColumn(2,"TIMES"),"0",4),2,2);

		//ed_INFO01.Text=trim(ds_FSAZ160Q_P.GetColumn(0,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(0,"CHASU")) + "편" + "\n" + ds_FSAZ160Q_P.GetColumn(0,"P_TIME");
		//ed_INFO02.Text=trim(ds_FSAZ160Q_P.GetColumn(1,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(1,"CHASU")) + "편" + "\n" + ds_FSAZ160Q_P.GetColumn(1,"P_TIME");
		//ed_INFO03.Text=trim(ds_FSAZ160Q_P.GetColumn(2,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(2,"CHASU")) + "편" + "\n" + ds_FSAZ160Q_P.GetColumn(2,"P_TIME");
/*
		ed_INFO01.Text=trim(ds_FSAZ160Q_P.GetColumn(0,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(0,"CHASU")) + "편 (" + trim(ds_FSAZ160Q_P.GetColumn(0,"TRUCD")) +")" + "\n" + ds_FSAZ160Q_P.GetColumn(0,"P_TIME") + " " + ds_FSAZ160Q_P.GetColumn(0,"S_TIME");
		ed_INFO02.Text=trim(ds_FSAZ160Q_P.GetColumn(1,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(1,"CHASU")) + "편 (" + trim(ds_FSAZ160Q_P.GetColumn(1,"TRUCD")) +")" + "\n" + ds_FSAZ160Q_P.GetColumn(1,"P_TIME") + " " + ds_FSAZ160Q_P.GetColumn(1,"S_TIME");
		ed_INFO03.Text=trim(ds_FSAZ160Q_P.GetColumn(2,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(2,"CHASU")) + "편 (" + trim(ds_FSAZ160Q_P.GetColumn(2,"TRUCD")) +")" + "\n" + ds_FSAZ160Q_P.GetColumn(2,"P_TIME") + " " + ds_FSAZ160Q_P.GetColumn(2,"S_TIME");
*/
/*
		ed_INFO01.Text=trim(ds_FSAZ160Q_P.GetColumn(0,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(0,"CHASU")) + "편 " + ds_FSAZ160Q_P.GetColumn(0,"TRUCD") + "\n" + ds_FSAZ160Q_P.GetColumn(0,"P_TIME") + " " + ds_FSAZ160Q_P.GetColumn(0,"S_TIME");
		ed_INFO02.Text=trim(ds_FSAZ160Q_P.GetColumn(1,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(1,"CHASU")) + "편 " + ds_FSAZ160Q_P.GetColumn(1,"TRUCD") + "\n" + ds_FSAZ160Q_P.GetColumn(1,"P_TIME") + " " + ds_FSAZ160Q_P.GetColumn(1,"S_TIME");
		ed_INFO03.Text=trim(ds_FSAZ160Q_P.GetColumn(2,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(2,"CHASU")) + "편 " + ds_FSAZ160Q_P.GetColumn(2,"TRUCD") + "\n" + ds_FSAZ160Q_P.GetColumn(2,"P_TIME") + " " + ds_FSAZ160Q_P.GetColumn(2,"S_TIME");
*/
/*	
		ed_INFO01.Text=trim(ds_FSAZ160Q_P.GetColumn(0,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(0,"CHASU")) + "편" + "\n" + ds_FSAZ160Q_P.GetColumn(0,"TRUCD");
		ed_INFO02.Text=trim(ds_FSAZ160Q_P.GetColumn(1,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(1,"CHASU")) + "편" + "\n" + ds_FSAZ160Q_P.GetColumn(1,"TRUCD");
		ed_INFO03.Text=trim(ds_FSAZ160Q_P.GetColumn(2,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(2,"CHASU")) + "편" + "\n" + ds_FSAZ160Q_P.GetColumn(2,"TRUCD");
*/
		ed_INFO01.Text=trim(ds_FSAZ160Q_P.GetColumn(0,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(0,"CHASU")) + "편";
		ed_INFO02.Text=trim(ds_FSAZ160Q_P.GetColumn(1,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(1,"CHASU")) + "편";
		ed_INFO03.Text=trim(ds_FSAZ160Q_P.GetColumn(2,"TRANM")) + " " + trim(ds_FSAZ160Q_P.GetColumn(2,"CHASU")) + "편";
		
		ed_INFO31.Text=iif(length(ds_FSAZ160Q_P.GetColumn(0,"TRUCD"))!=0, "차량" +ds_FSAZ160Q_P.GetColumn(0,"TRUCD"),"");
		ed_INFO32.Text=iif(length(ds_FSAZ160Q_P.GetColumn(1,"TRUCD"))!=0, "차량" +ds_FSAZ160Q_P.GetColumn(1,"TRUCD"),"");
		ed_INFO33.Text=iif(length(ds_FSAZ160Q_P.GetColumn(2,"TRUCD"))!=0, "차량" +ds_FSAZ160Q_P.GetColumn(2,"TRUCD"),"");

/*
		ed_INFO11.Text=ds_FSAZ160Q_P.GetColumn(0,"P_TIME") + "\n" + ds_FSAZ160Q_P.GetColumn(0,"S_TIME");
		ed_INFO12.Text=ds_FSAZ160Q_P.GetColumn(1,"P_TIME") + "\n" + ds_FSAZ160Q_P.GetColumn(1,"S_TIME");
		ed_INFO13.Text=ds_FSAZ160Q_P.GetColumn(2,"P_TIME") + "\n" + ds_FSAZ160Q_P.GetColumn(2,"S_TIME");
*/
		ed_INFO11.Text=ds_FSAZ160Q_P.GetColumn(0,"P_TIME");
		ed_INFO12.Text=ds_FSAZ160Q_P.GetColumn(1,"P_TIME");
		ed_INFO13.Text=ds_FSAZ160Q_P.GetColumn(2,"P_TIME");

		var i21=ds_FSAZ160Q_P.GetColumn(0,"S_TIME");
		var i22=ds_FSAZ160Q_P.GetColumn(1,"S_TIME");
		var i23=ds_FSAZ160Q_P.GetColumn(2,"S_TIME");
		ed_INFO21.Text=iif(right(i21,5)=="00:00",substr(i21,0,6),i21);
		ed_INFO22.Text=iif(right(i22,5)=="00:00",substr(i22,0,6),i22);
		ed_INFO23.Text=iif(right(i23,5)=="00:00",substr(i23,0,6),i23);
		
		//trace(ds_FSAZ160Q_P.SaveXML());

	}
}
 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤 함수들
----------------------------------------------------------------*/
function fn_Search()
{
	//ds_FSAZ160Q_P.ClearData();
	getFSAZ160Q_P();
}
function UserList_OnTimer(obj,nEventID)
{	
	if(nEventID =1){//조회
		fn_Search();
		//trace(getDate());
	}
	if(nEventID =2){//시간
		timeEvent();
	}	
}

function timeEvent(){

var sDate = "";
var sTimeHH = "";
var sTimeMM = "";
var sTimeSS = "";
	sDate = getDate();
	nowDate = substr(sDate,0,8);
	sTimeHH = substr(sDate,8,2);
	sTimeMM = substr(sDate,10,2);
	sTimeSS = substr(sDate,12,2);
		
	st_DATE.Text=substr(getDate(),0,4)+"."+substr(getDate(),4,2)+"."+substr(getDate(),6,2);
	st_TIME.Text=sTimeHH+":"+sTimeMM+":"+sTimeSS;
//alert(sTimeHH+sTimeMM+sTimeSS);
}]]></Script>
</Window>