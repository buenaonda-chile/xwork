<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="UserList" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="대우일소요자료(발주정보)&#32;UP" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_VComCode_PLNT">
				<Contents>
					<colinfo id="CODE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE2>S</CODE2>
						<CODE_NAME>DNKA</CODE_NAME>
					</record>
					<record>
						<CODE2>E</CODE2>
						<CODE_NAME>DNKE</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SVDE354UC_ORG">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="PYVND" size="256" summ="default" type="STRING"/>
					<colinfo id="VANDR" size="256" summ="default" type="STRING"/>
					<colinfo id="D02" size="256" summ="default" type="STRING"/>
					<colinfo id="FACGU" size="256" summ="default" type="STRING"/>
					<colinfo id="NPAJP" size="256" summ="default" type="STRING"/>
					<colinfo id="ITMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D041" size="256" summ="default" type="STRING"/>
					<colinfo id="ITMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BALQY" size="256" summ="default" type="STRING"/>
					<colinfo id="JPNDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPUY" size="256" summ="default" type="STRING"/>
					<colinfo id="D09" size="256" summ="default" type="STRING"/>
					<colinfo id="D09Y" size="256" summ="default" type="STRING"/>
					<colinfo id="D09M" size="256" summ="default" type="STRING"/>
					<colinfo id="D09D" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPDT" size="256" summ="default" type="STRING"/>
					<colinfo id="D10" size="256" summ="default" type="STRING"/>
					<colinfo id="D10H" size="256" summ="default" type="STRING"/>
					<colinfo id="D10M" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPTM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPPS" size="256" summ="default" type="STRING"/>
					<colinfo id="RAKQY" size="256" summ="default" type="STRING"/>
					<colinfo id="RACQY" size="256" summ="default" type="STRING"/>
					<colinfo id="RACTY" size="256" summ="default" type="STRING"/>
					<colinfo id="QLYYN" size="256" summ="default" type="STRING"/>
					<colinfo id="MKCAR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPBN" size="256" summ="default" type="STRING"/>
					<colinfo id="HACHI" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LFTRT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPWK" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPSN" size="256" summ="default" type="STRING"/>
					<colinfo id="QLYTY" size="256" summ="default" type="STRING"/>
					<colinfo id="ETCBK" size="256" summ="default" type="STRING"/>
					<colinfo id="CPRTN" size="256" summ="default" type="STRING"/>
					<colinfo id="PCKCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BALGU" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PSCAR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SVDE354UC">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="PYVND" size="256" summ="default" type="STRING"/>
					<colinfo id="VANDR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACGU" size="256" summ="default" type="STRING"/>
					<colinfo id="NPAJP" size="256" summ="default" type="STRING"/>
					<colinfo id="ITMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ITMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BALQY" size="256" summ="default" type="STRING"/>
					<colinfo id="JPNDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPUY" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPTM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPPS" size="256" summ="default" type="STRING"/>
					<colinfo id="RAKQY" size="256" summ="default" type="STRING"/>
					<colinfo id="RACQY" size="256" summ="default" type="STRING"/>
					<colinfo id="RACTY" size="256" summ="default" type="STRING"/>
					<colinfo id="QLYYN" size="256" summ="default" type="STRING"/>
					<colinfo id="MKCAR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPBN" size="256" summ="default" type="STRING"/>
					<colinfo id="HACHI" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LFTRT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPWK" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPSN" size="256" summ="default" type="STRING"/>
					<colinfo id="QLYTY" size="256" summ="default" type="STRING"/>
					<colinfo id="ETCBK" size="256" summ="default" type="STRING"/>
					<colinfo id="CPRTN" size="256" summ="default" type="STRING"/>
					<colinfo id="PCKCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BALGU" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SVDE354UC_0">
				<Contents>
					<colinfo id="Col01" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SVDE354UC_1">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="PYVND" size="256" summ="default" type="STRING"/>
					<colinfo id="VANDR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACGU" size="256" summ="default" type="STRING"/>
					<colinfo id="ITMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BALQY" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPTM" size="256" summ="default" type="STRING"/>
					<colinfo id="MKCAR" size="256" summ="default" type="STRING"/>
					<colinfo id="BALGU" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PSCAR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SVDE354UC_2">
				<Contents>
					<colinfo id="RTMSG" size="256" summ="default" type="STRING"/>
					<colinfo id="VANDR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACGU" size="256" summ="default" type="STRING"/>
					<colinfo id="NPAJP" size="256" summ="default" type="STRING"/>
					<colinfo id="ITMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ITMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BALQY" size="256" summ="default" type="STRING"/>
					<colinfo id="JPNDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPUY" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPTM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPPS" size="256" summ="default" type="STRING"/>
					<colinfo id="RAKQY" size="256" summ="default" type="STRING"/>
					<colinfo id="RACQY" size="256" summ="default" type="STRING"/>
					<colinfo id="RACTY" size="256" summ="default" type="STRING"/>
					<colinfo id="QLYYN" size="256" summ="default" type="STRING"/>
					<colinfo id="MKCAR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPBN" size="256" summ="default" type="STRING"/>
					<colinfo id="HACHI" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LFTRT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPWK" size="256" summ="default" type="STRING"/>
					<colinfo id="NAPSN" size="256" summ="default" type="STRING"/>
					<colinfo id="QLYTY" size="256" summ="default" type="STRING"/>
					<colinfo id="ETCBK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FILE">
				<Contents>
					<colinfo id="FILENAME" size="256" summ="default" type="STRING"/>
					<record>
						<FILENAME>PPD3.TXT</FILENAME>
					</record>
					<record>
						<FILENAME>PPD4.TXT</FILENAME>
					</record>
					<record>
						<FILENAME>PPB1.TXT</FILENAME>
					</record>
					<record>
						<FILENAME>PPB2.TXT</FILENAME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Border="Flat" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static3" Left="122" Style="static" TabOrder="6" Top="37" VAlign="Middle" Width="136"></Static>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="2" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="2" Top="8" Width="1032"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="25" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="24" Width="24"></File>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="585" Id="searchBar" TabOrder="4" Top="32" Width="1048"></Static>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static6" Left="404" TabOrder="5" Text="사&#32;&#32;&#32;업&#32;&#32;&#32;부" Top="85" VAlign="Middle" Width="116"></Static>
		<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static11" Left="522" Style="static" TabOrder="7" Top="85" VAlign="Middle" Width="136"></Static>
		<Combo CodeColumn="code2" DataColumn="code_name" Enable="FALSE" Height="19" Id="cb_searchCodeName1" InnerDataset="ds_VComCode_PLNT" Left="526" OnChanged="common_OnChanged" TabOrder="1" Top="88" Width="130"></Combo>
		<Image Cursor="HAND" Height="24" Id="imgbtnMagam" ImageID="img_upload" Left="496" OnClick="setSVDE354UC" Static="FALSE" TabOrder="8" Top="128" Width="60"></Image>
		<Static Align="Center" Font="Default,12,Bold" Height="31" Id="Static0" Left="336" TabOrder="9" Text="◆&#32;대우일소요자료(발주정보)&#32;&#32;HOST&#32;UP&#32;◆" Top="40" VAlign="Middle" Width="368"></Static>
		<Static Font="Default,9,Bold" Height="13" Id="Static2" Left="544" TabOrder="11" Text="※&#32;HOST&#32;UP&#32;ERROR&#32;LIST" Top="192" VAlign="Bottom" VClip="Both" Width="200"></Static>
		<Grid BindDataset="ds_SVDE354UC" BkColor2="default" BoldHead="true" Bottom="176" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="128" Id="Grid354UC" InputPanel="FALSE" Left="23" LineColor="default" Right="327" TabOrder="12" TabStop="true" Top="48" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="304"></Grid>
		<Button Height="22" Id="btn_true" ImageID="btn_excel" Left="262" OnClick="btn_true_OnClick" TabOrder="14" Text="Button0" Top="186" Width="51"></Button>
		<Static Font="Default,9,Bold" Height="13" Id="Static1" Left="16" TabOrder="16" Text="※&#32;HOST&#32;UP&#32;정상LIST(중복DATA포함)" Top="192" VAlign="Bottom" VClip="Both" Width="240"></Static>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_SVDE354UC_2" BKColor="MENU" BkColor2="LIGHT3D" BkSelColor="lavender" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="600" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="khaki" HeadBorder="Flat" HeadHeight="25" Height="392" Id="Grid354UC_2T" InputPanel="FALSE" Left="528" LineColor="#888888" MultiSelect="TRUE" Right="1048" TabOrder="18" TabStop="true" Top="208" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="GRAYTEXT" WheelScrollRow="1" Width="520">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="60"/>
						<col width="78"/>
						<col width="70"/>
						<col width="200"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="90"/>
						<col width="60"/>
					</columns>
					<head>
						<cell col="0" display="text" text="ERROR"/>
						<cell col="1" display="text" text="업체코드"/>
						<cell col="2" display="text" text="전표번호"/>
						<cell col="3" display="text" text="부품번호"/>
						<cell col="4" display="text" text="부품명"/>
						<cell col="5" display="text" text="발주수량"/>
						<cell col="6" display="text" text="전표발행일"/>
						<cell col="7" display="text" text="납기요청일"/>
						<cell col="8" display="text" text="납기시각"/>
						<cell col="9" display="text" text="PART&#32;CODE"/>
						<cell col="10" display="text" text="공장구분"/>
					</head>
					<body>
						<cell align="left" col="0" colid="RTMSG" display="text"/>
						<cell align="left" col="1" colid="VANDR" display="text"/>
						<cell align="left" col="2" colid="NPAJP" display="text"/>
						<cell align="left" col="3" colid="ITMNO" display="text"/>
						<cell align="left" col="4" colid="ITMNM" display="text"/>
						<cell align="right" col="5" colid="BALQY" display="number"/>
						<cell align="center" col="6" colid="JPNDT" display="text"/>
						<cell align="center" col="7" colid="NAPDT" display="date"/>
						<cell align="center" col="8" colid="NAPTM" display="text" expr='substr(lpad(NAPTM,&quot;0&quot;,4),0,2)+&quot;:&quot;+substr(lpad(NAPTM,&quot;0&quot;,4),2,2)'/>
						<cell align="left" col="9" colid="PRTCD" display="text"/>
						<cell align="left" col="10" colid="FACGU" display="text"/>
					</body>
					<summary>
						<cell col="0" colspan="11" display="text" expr='&quot;TOTAL&#32;&#32;&#32;&#32;&#32;&#32;&quot;+rowcount()+&quot;건&quot;'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_SVDE354UC_1" BKColor="MENU" BkColor2="LIGHT3D" BkSelColor="lavender" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="600" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="khaki" HeadBorder="Flat" HeadHeight="25" Height="392" Id="Grid354UC_1T" InputPanel="FALSE" Left="1" LineColor="#888888" MultiSelect="TRUE" Right="521" TabOrder="10" TabStop="true" Top="208" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="GRAYTEXT" WheelScrollRow="1" Width="520">
			<contents>
				<format id="Default">
					<columns>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="100"/>
						<col width="100"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="45"/>
					</columns>
					<head>
						<cell col="0" display="text" text="업체코드"/>
						<cell col="1" display="text" text="공장구분"/>
						<cell col="2" display="text" text="업체번호"/>
						<cell col="3" display="text" text="풍성품번"/>
						<cell col="4" display="text" text="부품번호"/>
						<cell col="5" display="text" text="업체자종"/>
						<cell col="6" display="text" text="풍성차종"/>
						<cell col="7" display="text" text="서열코드"/>
						<cell col="8" display="text" text="발주수량"/>
						<cell col="9" display="text" text="납기요청일"/>
						<cell col="10" display="text" text="납기시각"/>
						<cell col="11" display="text" text="발주구분"/>
						<cell col="12" display="text" text="사업부"/>
					</head>
					<body>
						<cell align="left" col="0" colid="VANDR" display="text"/>
						<cell align="left" col="1" colid="FACGU" display="text"/>
						<cell align="left" col="2" colid="PYVND" display="text"/>
						<cell align="left" col="3" colid="PSPNO" display="text"/>
						<cell align="left" col="4" colid="ITMNO" display="text"/>
						<cell align="left" col="5" colid="MKCAR" display="text"/>
						<cell align="left" col="6" colid="PSCAR" display="text"/>
						<cell align="left" col="7" colid="SEQCD" display="text"/>
						<cell align="right" col="8" colid="BALQY" display="number"/>
						<cell align="center" col="9" colid="NAPDT" display="date"/>
						<cell align="center" col="10" colid="NAPTM" display="text" expr='substr(lpad(NAPTM,&quot;0&quot;,4),0,2)+&quot;:&quot;+substr(lpad(NAPTM,&quot;0&quot;,4),2,2)'/>
						<cell align="center" col="11" colid="BALGU" display="text"/>
						<cell align="center" col="12" colid="COMPS" display="text"/>
					</body>
					<summary>
						<cell col="0" colspan="13" display="text" expr='&quot;TOTAL&#32;&#32;&#32;&#32;&#32;&#32;&quot;+rowcount()+&quot;건&quot;'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_SVDE354UC_0" BkColor2="default" BoldHead="true" Bottom="179" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="125" Id="Grid354UC_0" InputPanel="FALSE" Left="706" LineColor="default" Right="1039" TabOrder="17" TabStop="true" Top="54" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="333"></Grid>
		<Div Height="62" Id="div_ing" Left="313" TabOrder="13" Text="Div0" Top="147" Visible="FALSE" Width="455">
			<Contents>
				<Image Height="16" Id="Image0" ImageID="title_ico" Left="110" TabOrder="2" Top="27" Width="17"></Image>
				<Image Height="48" Id="Image3" ImageID="popup_title" Left="31" TabOrder="3" Top="11" Width="400"></Image>
				<Static Font="굴림,12,Bold" Height="24" Id="Static3" Left="136" TabOrder="1" Text="프로그램이&#32;실행중&#32;입니다." Top="27" Width="216"></Static>
			</Contents>
		</Div>
		<Button Height="22" Id="btn_false" ImageID="btn_excel" Left="718" OnClick="btn_false_OnClick" TabOrder="15" Text="Button0" Top="186" Width="51"></Button>
	</Form>
	<Script><![CDATA[ /*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@author                : jae hb
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : SVDE354UC.xml
 * ● PROGRAM DESCRIPTION  : 대우일소요자료(발주정보) UP
 * ● DATE WRITTEN         : 2013.03.15
----------------------------------------------------------------*/


//RPG SVD359PF등록시 MAKCR컬럼의 데이터 없음.MKCAR컬럼인지 확인 필요.
//DIONE에서는 MAKCR->MKCAR로 우선 등록처리함.
#include "script::lib_script_common.js";
#include "script::Grid_Script.js"

var strSeparator = "	";

var Lib1 = G_ds_user.GetColumn(0,"LIB1");
var Lib2 = G_ds_user.GetColumn(0,"LIB2");
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");


/********************************************************************** 
 * 내용설명 : 화면로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj){
	getTitle();	
	getComCode();
	gFcOnTopButtonColor("0"); //상단 버튼 활성화 여부  1:조회,excel                1.1:조회,발행,excel                 1.2:조회     
	                          //                       2.1:조회,추가,삭제,저장     2.2:조회,추가,삭제,저장,excel       2.3:조회,저장,excel
	                          //                       2.4:조회,추가,저장          2.5:저장                            2.6:조회,삭제,저장
	                          //                       2.7:조회,추가,저장,excel 		
	//MainGrid.UserData = MainGrid.Height;
}


/********************************************************************** 
 * 내용설명 : 공통코드 조회
 * 주요변수 : 
 **********************************************************************/ 
function getDesign(){
	
}

function getComCode(){
	if (comps == "E1"){
		cb_searchCodeName1.index = 1;
	}else{
		cb_searchCodeName1.index = 0;
	}
}

/********************************************************************************************************** 
 * 내용설명 : host up
 * 주요변수 : 
 * ERPPC.CSV --> ds_SVDE354UC_0 --> ds_SVDE354UC_1(거래처,품번생성) --> ds_SVDE354UC(집계)--> svh330pf
 *                              --> ds_SVDE354UC_2(error File)
 **********************************************************************************************************/ 
function setSVDE354UC(){


	ds_SVDE354UC_0.DeleteAll();
	ds_SVDE354UC_1.ClearData();
	ds_SVDE354UC_2.ClearData();
	ds_SVDE354UC.ClearData();

	//multi선택인 경우
/*
	//1)파일선택시
	FileDialog0.MultiSelect=true;
	FileDialog0.Filter = "ALL File(txt.*)|*.txt";	
	FileDialog0.Type = "OPEN";
	if (!FileDialog0.Open()) {
		//alert(setPopMessage("1009"));	// 20110103l-koowgnojeel, 1009 == 파일 선택 창을 여는데 실패하였습니다.
		return;
	}
	div_ing.Visible = true;	
	ds_FILE.ClearData();
	var file_name2 = FileDialog0.FileNameList;
	var file_path2 = FileDialog0.FilePath;
	var path2 = "";
	for (i=0; i<length(file_name2); i++){
		if(toUpper(file_name2[i])=="PPD3.TXT" || toUpper(file_name2[i])=="PPD4.TXT" || toUpper(file_name2[i])=="PPB1.TXT" || toUpper(file_name2[i])=="PPB2.TXT"){
		ds_FILE.AddRow();
		ds_FILE.SetColumn(i,"FILEPATH",file_name2[i]);
		path2 = file_path2 + "\\" + file_name2[i];
//해당메소드이용해야하나, Ext_Csv2Ds사용가능하여 Ext_Csv2Ds로 처리함.
//	var	dataCount = array(-1);
//	file.FileName = path2;
//	file.Open("r"); // Option ( r:read, t:text, b:binary, w:write, a:append )
//	buff = file.Read();
//	file.Close();
//	dataCount = Split(buff, "\r\n"); //줄바꿈 : \r\n 탭 : \t
//	
//	for(i=0;i<dataCount.Length();i++) 
//	{
//		ds_SVDE354UC_0.AddRow();
//		ds_SVDE354UC_0.SetColumn(i,"Col01",dataCount[i]);
//	}	
//	Grid354UC_0.CreateFormat();
	
		Ext_Csv2Ds(path2,"ds_SVDE354UC_0",false,"Col01");
		Grid354UC_0.CreateFormat(); 		
		}	
	}
	if(ds_FILE.rowcount < 1){
		alert("선택된 파일이 없습니다.(선택가능파일 : PPD3.TXT, PPD4.TXT,PPB1.TXT,PPB2.TXT)");
		div_ing.Visible = false;
		return;	
	}

*/
	//2)자동등록시
	//SetTimer(1,100);
	div_ing.Visible = true;
	var file_path2 = "C:\\VAN\\DAEWOO";
	var path2 = "";
	for (i=0; i<ds_FILE.rowcount; i++){
		path2 = file_path2 + "\\" + ds_FILE.GetColumn(i,"FILENAME");
		//setMessageDirect(path2);	
/* 
//해당메소드이용해야하나, Ext_Csv2Ds사용가능하여 Ext_Csv2Ds로 처리함.
	var	dataCount = array(-1);
	file.FileName = path2;
	file.Open("r"); // Option ( r:read, t:text, b:binary, w:write, a:append )
	buff = file.Read();
	file.Close();
	dataCount = Split(buff, "\r\n"); //줄바꿈 : \r\n 탭 : \t
	
	for(i=0;i<dataCount.Length();i++) 
	{
		ds_SVDE354UC_0.AddRow();
		ds_SVDE354UC_0.SetColumn(i,"Col01",dataCount[i]);
	}	
	Grid354UC_0.CreateFormat();
*/		
		Ext_Csv2Ds(path2,"ds_SVDE354UC_0",false,"Col01");
		Grid354UC_0.CreateFormat(); 		
	}
	
	for (i=ds_SVDE354UC_0.rowcount; i>=0; i--){
		if(substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),0,4)=="업체코드"){
			ds_SVDE354UC_0.DeleteRow(i);
		}
	}

	var spyvnd=0;
	if (comps == "E1"){
		spyvnd= 1500;
	}else{
		spyvnd= 1150;
	}

	for(i=0;i<ds_SVDE354UC_0.rowcount;i++)
	{
		var getFacgu="";
		var insFacgu="";
		var param1="";
		var param2="";
		var param3="";//발주구분BALGU
		
		ds_SVDE354UC.AddRow();
		ds_SVDE354UC.SetColumn(i,"COMPS",comps);//1.추가 사업부
		ds_SVDE354UC.SetColumn(i,"PYVND",spyvnd);//2.추가 업체

		ds_SVDE354UC.SetColumn(i,"VANDR",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),0,9));

		getFacgu=trim(substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),9,2));//D02
		if(length(getFacgu)==0){
			insFacgu="D4";
		}
		else{
			insFacgu=getFacgu;
		}
		//ds_SVDE354UC.SetColumn(i,"D02",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),9,2));//업로드시 필요없음.
		ds_SVDE354UC.SetColumn(i,"FACGU",insFacgu);//4.추가 공장구분
		
		ds_SVDE354UC.SetColumn(i,"NPAJP",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),11,11));
		//ds_SVDE354UC.SetColumn(i,"ITMNO",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),22,16));
		ds_SVDE354UC.SetColumn(i,"ITMNO",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),22,15));
		//ds_SVDE354UC.SetColumn(i,"D041",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),23,15));//로직
		ds_SVDE354UC.SetColumn(i,"ITMNM",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),38,30));
		ds_SVDE354UC.SetColumn(i,"BALQY",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),68,7));
		ds_SVDE354UC.SetColumn(i,"JPNDT",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),75,10));
		ds_SVDE354UC.SetColumn(i,"NAPUY",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),85,1));

		//ds_SVDE354UC.SetColumn(i,"D09",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),86,10));
		//ds_SVDE354UC.SetColumn(i,"D09Y",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),86,4));
		//ds_SVDE354UC.SetColumn(i,"D09M",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),91,2));
		//ds_SVDE354UC.SetColumn(i,"D09D",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),94,2));
		ds_SVDE354UC.SetColumn(i,"NAPDT",replace(substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),86,10), "-",""));//3.추가 납기요청일날짜

		//ds_SVDE354UC.SetColumn(i,"D10",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),96,5));
		//ds_SVDE354UC.SetColumn(i,"D10H",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),96,2));
		//ds_SVDE354UC.SetColumn(i,"D10M",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),99,2));
		ds_SVDE354UC.SetColumn(i,"NAPTM",replace(substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),96,5), ":",""));//4.추가 납기요청일시간

		ds_SVDE354UC.SetColumn(i,"NAPPS",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),104,2));
		ds_SVDE354UC.SetColumn(i,"RAKQY",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),106,5));
		ds_SVDE354UC.SetColumn(i,"RACQY",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),111,6));
		ds_SVDE354UC.SetColumn(i,"RACTY",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),117,8));
		ds_SVDE354UC.SetColumn(i,"QLYYN",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),125,1));
		ds_SVDE354UC.SetColumn(i,"MKCAR",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),126,3));
		ds_SVDE354UC.SetColumn(i,"EXPBN",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),129,2));
		ds_SVDE354UC.SetColumn(i,"HACHI",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),131,8));
		ds_SVDE354UC.SetColumn(i,"PRTCD",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),139,9));
		ds_SVDE354UC.SetColumn(i,"LFTRT",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),148,1));
		ds_SVDE354UC.SetColumn(i,"NAPWK",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),149,6));
		ds_SVDE354UC.SetColumn(i,"NAPSN",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),155,1));
		ds_SVDE354UC.SetColumn(i,"QLYTY",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),156,1));
		ds_SVDE354UC.SetColumn(i,"ETCBK",substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),157,73));
		
		//로직추가..
		if(getFacgu=="D3" || length(getFacgu)==0){
			param1=substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),23,15);//D041
			param2="1D";		
			param3="1";	
		}
		else if(getFacgu=="B1" || getFacgu=="BN"){
			param1=substr(ds_SVDE354UC_0.GetColumn(i,"Col01"),22,16);//D04(ITMNO)
			param2="0D";		
			param3="";			
		}
	
		ds_SVDE354UC.SetColumn(i,"CPRTN",param1);
		ds_SVDE354UC.SetColumn(i,"PCKCD",param2);
		ds_SVDE354UC.SetColumn(i,"BALGU",param3);
	}

	Grid354UC.CreateFormat();
	
/*
if(ds_SVDE354UC.rowcount<1){
	div_ing.Visible = false;
	alert(setPopMessage("4714"));
	setMessage("4714");
	return;
}
*/

	//최종DATA생성을 위한 자료생성작업(DENSO거래처, DENSO품번 생성)
	http.Sync = true;
	var sKind		= "setSVDE354UC";					
	var sMethodName = "service::pssallib/insertSVDE354UC.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "ds_SVDE354UC=ds_SVDE354UC:A";         		// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_SVDE354UC_1=ds_SVDE354UC_1 ds_SVDE354UC_2=ds_SVDE354UC_2"; 					// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
	sArgument += " LIB1=" + quote(Lib1);
	sArgument += " LIB2=" + quote(Lib2);
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync = false;
	div_ing.Visible = false;
	SetWaitCursor(false);
	
}
/********************************************************************** 
 * 내용설명 : 엑셀파일로 저장
 **********************************************************************/ 
function btn_true_OnClick(obj)
{
	var fName   = "대우일소요자료(발주정보)UP_정상";
	var arrSheets  =  Array();  

	arrSheets[0]  = "Grid354UC_1T|대우일소요자료(발주정보)UP_정상";
	createExcelSheetS2(FileDialog0, fName ,arrSheets);
}

function btn_false_OnClick(obj)
{
	var fName   = "대우일소요자료(발주정보)UP__Error";
	var arrSheets  =  Array();  

	arrSheets[0]  = "Grid354UC_2T|대우일소요자료(발주정보)UP__Error";
	createExcelSheetS2(FileDialog0, fName ,arrSheets);
}
/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){
	// tran 실패
	if(rtnCd<0){
		alert(setPopMessage("1002"));
		setMessage("1002");
	// tran 성공	
	}else if(svcId=="setSVDE354UC"){

		alert(setPopMessage("1001"));
		setMessage("1001");
	}
}

function common_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_SVDE354UC_0.DeleteAll();
	ds_SVDE354UC_1.ClearData();
	ds_SVDE354UC_2.ClearData();
	ds_SVDE354UC.ClearData();
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤 함수들
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Input()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Delete()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Save()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_print()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Excel()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("0"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}
]]></Script>
</Window>