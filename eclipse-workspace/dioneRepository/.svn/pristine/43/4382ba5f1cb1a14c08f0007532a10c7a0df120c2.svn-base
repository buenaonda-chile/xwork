<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="userList" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" OnTimer="userList_OnTimer" PidAttrib="7" Title="보전의뢰관리" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ComCode_PLNT"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ210_CHECK">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ210">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="ERYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ERSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ERTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LINCD" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ERRCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ERRTX" size="256" summ="default" type="STRING"/>
					<colinfo id="REYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RETIM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE1" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE2" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE3" size="256" summ="default" type="STRING"/>
					<colinfo id="MSGFG" size="256" summ="default" type="STRING"/>
					<colinfo id="MSGTM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DETIM" size="256" summ="default" type="STRING"/>
					<colinfo id="MRYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="MRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="MPYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="MPTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="FNYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="FNTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="QAYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="QATIM" size="256" summ="default" type="STRING"/>
					<colinfo id="PLYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="PLTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="HIYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="HITIM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ERRDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MREDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MRPDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FINDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="QADATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PLNDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="HISDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="LINNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MSHNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ERRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="L_STATU" size="256" summ="default" type="STRING"/>
					<colinfo id="M_STATU" size="256" summ="default" type="STRING"/>
					<colinfo id="STPHR" size="256" summ="default" type="STRING"/>
					<colinfo id="JISNO" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER1" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN1" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER2" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER3" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN3" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER4" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN4" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID1" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID2" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID3" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_PRDCD">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_interval">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="value" size="256" summ="default" type="STRING"/>
					<record>
						<cd>10</cd>
						<value>10</value>
					</record>
					<record>
						<cd>20</cd>
						<value>20</value>
					</record>
					<record>
						<cd>30</cd>
						<value>30</value>
					</record>
					<record>
						<cd>40</cd>
						<value>40</value>
					</record>
					<record>
						<cd>50</cd>
						<value>50</value>
					</record>
					<record>
						<cd>60</cd>
						<value>60</value>
					</record>
					<record>
						<cd>0</cd>
						<value>정지</value>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_PRDCD2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_LINCD">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MSHNO">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="LINCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ogm_maxNum"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ220" UseClientLayout="1">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="OSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="LINCD" size="256" summ="default" type="STRING"/>
					<colinfo id="OTEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="OWIDTH" size="256" summ="default" type="STRING"/>
					<colinfo id="OHEIGHT" size="256" summ="default" type="STRING"/>
					<colinfo id="POS_X" size="256" summ="default" type="STRING"/>
					<colinfo id="POS_Y" size="256" summ="default" type="STRING"/>
					<colinfo id="ERYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ERSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ180" UseClientLayout="1">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="OSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ORSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="LINCD" size="256" summ="default" type="STRING"/>
					<colinfo id="OTEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="OWIDTH" size="256" summ="default" type="STRING"/>
					<colinfo id="OHEIGHT" size="256" summ="default" type="STRING"/>
					<colinfo id="POS_X" size="256" summ="default" type="STRING"/>
					<colinfo id="POS_Y" size="256" summ="default" type="STRING"/>
					<colinfo id="TMPOS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ220_CHECK"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_managerYN"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ220_del" UseClientLayout="1">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="OSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="LINCD" size="256" summ="default" type="STRING"/>
					<colinfo id="OTEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="OWIDTH" size="256" summ="default" type="STRING"/>
					<colinfo id="OHEIGHT" size="256" summ="default" type="STRING"/>
					<colinfo id="POS_X" size="256" summ="default" type="STRING"/>
					<colinfo id="POS_Y" size="256" summ="default" type="STRING"/>
					<colinfo id="ERYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ERSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_McntCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_interval2">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="value" size="256" summ="default" type="STRING"/>
					<record>
						<cd>30</cd>
						<value>30초</value>
					</record>
					<record>
						<cd>60</cd>
						<value>1분</value>
					</record>
					<record>
						<cd>180</cd>
						<value>3분</value>
					</record>
					<record>
						<cd>300</cd>
						<value>5분</value>
					</record>
					<record>
						<cd>600</cd>
						<value>10분</value>
					</record>
					<record>
						<cd>1800</cd>
						<value>30분</value>
					</record>
					<record>
						<cd>정지</cd>
						<value>정지</value>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OBMZ190_MCheck"></Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" BorderColor="#b4b4b4" Height="66" Id="searchBar" TabOrder="4" Top="30" Width="1060"></Static>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="1" Width="1060"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="2" Top="8" Width="1032"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="4" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File" Left="1032" Right="1056" TabOrder="3" Width="24"></File>
		<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static1" Left="120" Style="static" TabOrder="2" Top="35" VAlign="Middle" Width="96"></Static>
		<Combo CodeColumn="code2" DataColumn="code_name" Height="19" Id="ComboBoxPlant" INDEX="0" InnerDataset="ds_ComCode_PLNT" Left="124" OnChanged="common_OnChanged" TabOrder="2" Top="38" Width="88"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static4" Left="4" TabOrder="3" Text="사&#32;&#32;&#32;업&#32;&#32;&#32;부" Top="35" VAlign="Middle" Width="116"></Static>
		<Button Height="21" Id="btn_POP" Left="936" OnClick="btn_POP_OnClick" TabOrder="8" Text="보전의뢰수정" Top="66" Width="104"></Button>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static0" Left="339" TabOrder="12" Top="34" VAlign="Middle" Width="96"></Static>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static3" Left="223" TabOrder="11" Text="기&#32;준&#32;일&#32;자" Top="34" VAlign="Middle" Width="116"></Static>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Dateformat="yyyy-MM-dd" FocusIndex="0" Height="18" Id="cmb_ERYMD_FR" Left="343" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="10" Top="38" Value="TODAY" Width="88"></Calendar>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static6" Left="451" TabOrder="14" Top="34" VAlign="Middle" Width="96"></Static>
		<Calendar Border="Flat" BorderColor="SCROLLBAR" Dateformat="yyyy-MM-dd" FocusIndex="0" Height="18" Id="cmb_ERYMD_TO" Left="455" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="13" Top="38" Value="TODAY" Width="88"></Calendar>
		<Static Align="Center" Height="21" Id="Static7" Left="434" TabOrder="15" Text="~" Top="37" VAlign="Middle" Width="18"></Static>
		<Radio Height="27" Id="rdoggub" INDEX="-1" Left="668" TabOrder="16" Top="34" Width="200">
			<Contents>
				<Layout height="15" left="10" text="전체" top="5" width="60"/>
				<Layout code="T" height="15" left="70" text="완료" top="5" width="60"/>
				<Layout code="F" height="15" left="130" text="미완료" top="5" width="60"/>
			</Contents>
		</Radio>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static8" Left="552" TabOrder="17" Text="완&#32;료&#32;여&#32;부" Top="34" VAlign="Middle" Width="116"></Static>
		<Static Border="Flat" BorderColor="#b4b4b4" Color="#333333" Font="굴림,9,Bold" Height="26" Id="Static9" Left="973" Style="static" TabOrder="18" Top="34" VAlign="Middle" Width="67"></Static>
		<Static Align="Center" BKColor="thistle" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static2" Left="873" TabOrder="19" Text="리플레시&#32;타임" Top="34" VAlign="Middle" Width="100"></Static>
		<Combo CodeColumn="cd" DataColumn="value" Height="21" Id="cmb_interval" INDEX="2" InnerDataset="ds_interval2" Left="976" OnChanged="cmb_interval_OnChanged" TabOrder="9" Top="35" Width="56"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static5" Left="4" TabOrder="21" Text="제품명" Top="64" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static10" Left="120" TabOrder="22" Top="64" VAlign="Middle" Width="148"></Static>
		<Combo CodeColumn="CD" DataColumn="CDNM" Height="19" Id="cmb_PRDCD" ImeMode="none" INDEX="0" InnerDataset="ds_PRDCD2" Left="124" OnChanged="cmb_PRDCD_OnChanged" Search="FILTERED" TabOrder="20" Top="68" Width="140"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static11" Left="279" TabOrder="24" Text="LINE명" Top="64" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static12" Left="395" TabOrder="25" Top="64" VAlign="Middle" Width="208"></Static>
		<Combo CodeColumn="CD" DataColumn="CDNM2" Height="19" Id="cmb_LINCD" ImeMode="none" INDEX="0" InnerDataset="ds_LINCD" Left="399" OnChanged="cmb_LINCD_OnChanged" OnClick="cmb_LINCD_OnClick" Search="FILTERED" TabOrder="23" Top="68" UseIME="FALSE" Width="200"></Combo>
		<Static Align="Center" BKColor="lightsalmon" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static13" Left="610" TabOrder="27" Text="설비명" Top="63" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static14" Left="726" TabOrder="28" Top="63" VAlign="Middle" Width="208"></Static>
		<Combo CodeColumn="CD" DataColumn="CDNM2" Height="19" Id="cmb_MSHNO" INDEX="0" InnerDataset="ds_MSHNO" Left="730" OnClick="cmb_MSHNO_OnClick" TabOrder="26" Top="67" Width="200"></Combo>
		<CyHttpFile Height="24" Id="CyHttpFile0" Left="968" Width="24"></CyHttpFile>
		<Static Align="Center" BKColor="lightyellow" Border="Flat" BorderColor="#b4b4b4" Font="Default,9,Bold" Height="26" Id="Static15" Left="816" TabOrder="30" Text="알림표시" Top="3" VAlign="Middle" Width="116"></Static>
		<Static Align="Center" Border="Flat" BorderColor="#b4b4b4" Font="굴림,9,Bold" Height="26" Id="Static16" Left="932" TabOrder="32" Top="3" VAlign="Middle" Width="30"></Static>
		<Checkbox Height="20" Id="chk_POPUP" Left="938" LeftMargin="4" TabOrder="31" Top="6" Value="FALSE" Width="22"></Checkbox>
		<Button Font="Default,9,Bold" Height="28" Id="btn_Stop" Left="709" OnClick="btn_Stop_OnClick" TabOrder="33" Text="새로고침&#32;정지" Top="2" Width="104"></Button>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoEnterType="Key" AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="ds_OBMZ210" BKColor="MENU" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="#888888" Bottom="608" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="khaki" HeadBorder="Flat" HeadHeight="25" Height="513" Id="MainGrid" InputPanel="FALSE" LineColor="#888888" MultiSelect="TRUE" OnCellDBLClick="MainGrid_OnCellDblClick" OnExpandEdit="MainGrid_OnExpandEdit" OnHeadClick="MainGrid_OnHeadClick" Right="1056" RowHeight="25" TabOrder="34" TabStop="FALSE" Top="95" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="GRAYTEXT" WheelScrollRow="1" Width="1056">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="80"/>
						<col width="100"/>
						<col width="150"/>
						<col width="200"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="40"/>
						<col width="40"/>
						<col width="40"/>
					</columns>
					<head>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" colspan="7" display="text" text="기본정보"/>
						<cell bkcolor="#dfdfdf" col="0" color="#002043" display="text" row="1" rowspan="2" text="SEQ"/>
						<cell bkcolor="#dfdfdf" col="1" color="#002043" display="text" row="1" rowspan="2" text="관리번호"/>
						<cell bkcolor="#dfdfdf" col="2" color="#002043" display="text" row="1" rowspan="2" text="제품명"/>
						<cell bkcolor="#dfdfdf" col="3" color="#002043" display="text" row="1" text="라인명"/>
						<cell bkcolor="#dfdfdf" col="3" color="#002043" display="text" row="2" text="에러내용"/>
						<cell bkcolor="#dfdfdf" col="4" color="#002043" display="text" row="1" text="설비명"/>
						<cell bkcolor="#dfdfdf" col="4" color="#002043" display="text" row="2" text="의뢰내용"/>
						<cell bkcolor="#dfdfdf" col="5" color="#002043" display="text" expr='&quot;고장\n발생일시&quot;' row="1" rowspan="2" text="고장발생일시"/>
						<cell bkcolor="#dfdfdf" col="6" color="#002043" display="text" expr='&quot;보전\n의뢰일시&quot;' row="1" rowspan="2" text="보전의뢰일시"/>
						<cell bkcolor="#dfdfdf" col="7" color="#002043" colspan="13" display="text" text="보전진척"/>
						<cell bkcolor="#dfdfdf" col="7" color="#002043" display="text" expr='&quot;의뢰\n접수일시&quot;' row="1" rowspan="2" text="의뢰접수일시"/>
						<cell bkcolor="#dfdfdf" col="8" color="#002043" colspan="4" display="text" row="1" text="인원배치"/>
						<cell bkcolor="#dfdfdf" col="8" color="#002043" display="text" row="2" text="인원배치1"/>
						<cell bkcolor="#dfdfdf" col="9" color="#002043" display="text" row="2" text="인원배치2"/>
						<cell bkcolor="#dfdfdf" col="10" color="#002043" display="text" row="2" text="인원배치3"/>
						<cell bkcolor="#dfdfdf" col="11" color="#002043" display="text" row="2" text="인원배치4"/>
						<cell bkcolor="#dfdfdf" col="12" color="#002043" colspan="2" display="text" row="1" text="부품수배"/>
						<cell bkcolor="#dfdfdf" col="12" color="#002043" display="text" row="2" text="요청"/>
						<cell bkcolor="#dfdfdf" col="13" color="#002043" display="text" row="2" text="완료"/>
						<cell bkcolor="#dfdfdf" col="14" color="#002043" colspan="3" display="text" row="1" text="보전수리"/>
						<cell bkcolor="#dfdfdf" col="14" color="#002043" display="text" row="2" text="보전수리"/>
						<cell bkcolor="#dfdfdf" col="15" color="#002043" display="text" row="2" text="품질확인"/>
						<cell bkcolor="#dfdfdf" col="16" color="#002043" display="text" row="2" text="계획보전"/>
						<cell bkcolor="#dfdfdf" col="17" color="#002043" display="text" expr='&quot;설비\n정지시간&quot;' row="1" rowspan="2" text="설비정지시간"/>
						<cell bkcolor="#dfdfdf" col="18" color="#002043" colspan="2" display="text" row="1" text="수리이력등록여부"/>
						<cell bkcolor="#dfdfdf" col="18" color="#002043" display="text" row="2" text="완료시각"/>
						<cell bkcolor="#dfdfdf" col="19" color="#002043" display="text" row="2" text="지시번호"/>
						<cell bkcolor="#dfdfdf" col="20" color="#002043" colspan="3" display="text" text="첨부"/>
						<cell bkcolor="#dfdfdf" col="20" color="#002043" display="text" row="1" rowspan="2" text="첨부1"/>
						<cell bkcolor="#dfdfdf" col="21" color="#002043" display="text" row="1" rowspan="2" text="첨부2"/>
						<cell bkcolor="#dfdfdf" col="22" color="#002043" display="text" row="1" rowspan="2" text="첨부3"/>
					</head>
					<body>
						<cell align="center" bkcolor='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;))' checklength="Byte" col="0" display="text" expr="row+1" rowspan="2"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="1" colid="MNGNO" color='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,&#32;&quot;black&quot;)' display="normal" font='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;Default,-1,Bold&quot;,&quot;Default,-1&quot;)' limit="2" LimitDec="0" rowspan="2" TrimType="Both" useime="false"/>
						<cell align="left" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="2" colid="PRDCD" color='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,&#32;&quot;black&quot;)' combocol="CD" combodataset="ds_PRDCD" combotext="CDNM" display="combo" font='expr:iif(ACCDATE==&quot;접수대기&quot;,&quot;Default,&#32;11,&#32;Bold&quot;,&quot;&quot;)' LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="left" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="3" colid="LINNM" color='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,&#32;&quot;black&quot;)' display="normal" font='expr:iif(ACCDATE==&quot;접수대기&quot;,&quot;Default,9,Bold&quot;,&quot;&quot;)' limit="8" LimitDec="0" TrimType="Both"/>
						<cell align="left" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="3" colid="ERRNM" color='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,&#32;&quot;black&quot;)' display="normal" font='expr:iif(ACCDATE==&quot;접수대기&quot;,&quot;Default,9,Bold&quot;,&quot;&quot;)' limit="8" LimitDec="0" row="1" TrimType="Both"/>
						<cell align="left" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="4" colid="MSHNM" color='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,&#32;&quot;black&quot;)' display="normal" font='expr:iif(ACCDATE==&quot;접수대기&quot;,&quot;Default,9,Bold&quot;,&quot;&quot;)' limit="8" LimitDec="0" TrimType="Both"/>
						<cell align="left" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="4" colid="ERRTX" color='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,&#32;&quot;black&quot;)' display="normal" font='expr:iif(ACCDATE==&quot;접수대기&quot;,&quot;Default,9,Bold&quot;,&quot;&quot;)' limit="8" LimitDec="0" row="1" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="5" colid="ERRDATE" color='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,&#32;&quot;black&quot;)' display="normal" expr='iif(length(ERRDATE)&#32;&gt;8,&#32;substr(ERRDATE,0,4)+&quot;-&quot;+substr(ERRDATE,4,2)+&quot;-&quot;+substr(ERRDATE,6,2)+&quot;\n&quot;+substr(ERRDATE,8,2)+&quot;:&quot;+substr(ERRDATE,10,2),ERRDATE)' font='expr:iif(ACCDATE==&quot;접수대기&quot;,&quot;Default,9,Bold&quot;,&quot;&quot;)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="6" colid="REQDATE" color='expr:decode(ACCDATE,&quot;접수대기&quot;,&quot;red&quot;,&#32;&quot;black&quot;)' display="normal" expr='iif(length(REQDATE)&#32;&gt;8,&#32;substr(REQDATE,0,4)+&quot;-&quot;+substr(REQDATE,4,2)+&quot;-&quot;+substr(REQDATE,6,2)+&quot;\n&quot;+substr(REQDATE,8,2)+&quot;:&quot;+substr(REQDATE,10,2),REQDATE)' font='expr:iif(ACCDATE==&quot;접수대기&quot;,&quot;Default,9,Bold&quot;,&quot;&quot;)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;iif(ACCDATE&#32;=&#32;&quot;접수대기&quot;,&quot;lightcyan&quot;,&quot;yellow&quot;),&#32;decode(ACCDATE,&quot;접수대기&quot;,&quot;lightcyan&quot;,&quot;white&quot;))' checklength="Byte" col="7" colid="ACCDATE" display="normal" expr='iif(length(ACCDATE)&#32;&gt;8,&#32;substr(ACCDATE,0,4)+&quot;-&quot;+substr(ACCDATE,4,2)+&quot;-&quot;+substr(ACCDATE,6,2)+&quot;\n&quot;+substr(ACCDATE,8,2)+&quot;:&quot;+substr(ACCDATE,10,2),ACCDATE)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;iif(ACCDATE&#32;!=&#32;&quot;접수대기&quot;,iif(DEPDATE&#32;=&#32;&quot;&quot;,&quot;lightcyan&quot;,&quot;yellow&quot;),&quot;yellow&quot;),&#32;iif(ACCDATE&#32;!=&#32;&quot;접수대기&quot;,iif(DEPDATE&#32;=&#32;&quot;&quot;,&quot;lightcyan&quot;,&quot;white&quot;),&quot;white&quot;))' checklength="Byte" col="8" colid="DEPDATE" colspan="4" display="normal" expr='iif(length(DEPDATE)&#32;&gt;8,&#32;substr(DEPDATE,0,4)+&quot;-&quot;+substr(DEPDATE,4,2)+&quot;-&quot;+substr(DEPDATE,6,2)+&quot;\n&quot;+substr(DEPDATE,8,2)+&quot;:&quot;+substr(DEPDATE,10,2),DEPDATE)' limit="8" LimitDec="0" TrimType="Both"/>
						<cell align="center" checklength="Byte" col="8" colid="WORKER1" display="normal" expandimage="exp_del2" expandshow="true" expandsize="22" limit="8" LimitDec="0" row="1" TrimType="Both"/>
						<cell align="center" checklength="Byte" col="9" colid="WORKER2" display="normal" expandimage="exp_del2" expandshow="true" expandsize="22" limit="8" LimitDec="0" row="1" TrimType="Both"/>
						<cell align="center" checklength="Byte" col="10" colid="WORKER3" display="normal" expandimage="exp_del2" expandshow="true" expandsize="22" limit="8" LimitDec="0" row="1" TrimType="Both"/>
						<cell align="center" checklength="Byte" col="11" colid="WORKER4" display="normal" expandimage="exp_del2" expandshow="true" expandsize="22" limit="8" LimitDec="0" row="1" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="12" colid="MREDATE" display="normal" expr='iif(length(MREDATE)&#32;&gt;8,&#32;substr(MREDATE,0,4)+&quot;-&quot;+substr(MREDATE,4,2)+&quot;-&quot;+substr(MREDATE,6,2)+&quot;\n&quot;+substr(MREDATE,8,2)+&quot;:&quot;+substr(MREDATE,10,2),MREDATE)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="13" colid="MRPDATE" display="normal" expr='iif(length(MRPDATE)&#32;&gt;8,&#32;substr(MRPDATE,0,4)+&quot;-&quot;+substr(MRPDATE,4,2)+&quot;-&quot;+substr(MRPDATE,6,2)+&quot;\n&quot;+substr(MRPDATE,8,2)+&quot;:&quot;+substr(MRPDATE,10,2),MRPDATE)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;iif(DEPDATE&#32;!=&#32;&quot;&quot;,iif(FINDATE&#32;=&#32;&quot;미완료&quot;,&quot;lightcyan&quot;,&quot;yellow&quot;),&quot;yellow&quot;),&#32;iif(DEPDATE&#32;!=&#32;&quot;&quot;,iif(FINDATE&#32;=&#32;&quot;미완료&quot;,&quot;lightcyan&quot;,&quot;white&quot;),&quot;white&quot;))' checklength="Byte" col="14" colid="FINDATE" display="normal" expr='iif(length(FINDATE)&#32;&gt;8,&#32;substr(FINDATE,0,4)+&quot;-&quot;+substr(FINDATE,4,2)+&quot;-&quot;+substr(FINDATE,6,2)+&quot;\n&quot;+substr(FINDATE,8,2)+&quot;:&quot;+substr(FINDATE,10,2),FINDATE)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;iif(FINDATE!=&#32;&quot;미완료&quot;,iif(QADATE&#32;=&#32;&quot;미완료&quot;,&quot;lightcyan&quot;,&quot;yellow&quot;),&quot;yellow&quot;),&#32;iif(FINDATE!=&#32;&quot;미완료&quot;,iif(QADATE&#32;=&#32;&quot;미완료&quot;,&quot;lightcyan&quot;,&quot;white&quot;),&quot;white&quot;))' checklength="Byte" col="15" colid="QADATE" display="normal" expr='iif(length(QADATE)&#32;&gt;8,&#32;substr(QADATE,0,4)+&quot;-&quot;+substr(QADATE,4,2)+&quot;-&quot;+substr(QADATE,6,2)+&quot;\n&quot;+substr(QADATE,8,2)+&quot;:&quot;+substr(QADATE,10,2),QADATE)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="16" colid="PLNDATE" display="normal" expr='iif(length(PLNDATE)&#32;&gt;8,&#32;substr(PLNDATE,0,4)+&quot;-&quot;+substr(PLNDATE,4,2)+&quot;-&quot;+substr(PLNDATE,6,2)+&quot;\n&quot;+substr(PLNDATE,8,2)+&quot;:&quot;+substr(PLNDATE,10,2),PLNDATE)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="17" colid="STPHR" display="normal" limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;iif(HISDATE=&#32;&quot;미등록&quot;,&quot;chartreuse&quot;,&quot;yellow&quot;),&#32;decode(HISDATE,&quot;미등록&quot;,&quot;chartreuse&quot;,&quot;white&quot;))' checklength="Byte" col="18" colid="HISDATE" display="normal" expr='iif(length(HISDATE)&#32;&gt;8,&#32;substr(HISDATE,0,4)+&quot;-&quot;+substr(HISDATE,4,2)+&quot;-&quot;+substr(HISDATE,6,2)+&quot;\n&quot;+substr(HISDATE,8,2)+&quot;:&quot;+substr(HISDATE,10,2),HISDATE)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="19" colid="JISNO" display="normal" limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="20" colid="FILE1" display="normal" expr='iif(length(FILE1)!=0,&#32;&quot;○&quot;,&#32;&quot;X&quot;)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="21" colid="FILE2" display="normal" expr='iif(length(FILE2)!=0,&#32;&quot;○&quot;,&#32;&quot;X&quot;)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
						<cell align="center" bkcolor='expr:iif(ds_OBMZ210.row=currow,&#32;&quot;yellow&quot;,&quot;white&quot;)' checklength="Byte" col="22" colid="FILE3" display="normal" expr='iif(length(FILE3)!=0,&#32;&quot;○&quot;,&#32;&quot;X&quot;)' limit="8" LimitDec="0" rowspan="2" TrimType="Both"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Height="25" Id="btnQuery" ImageID="btn2_search2" Left="888" OnClick="fn_Search" TabOrder="7" Text="조회" Top="88" Visible="FALSE" Width="75"></Button>
		<Button Height="21" Id="Button0" Left="816" OnClick="fn_print" TabOrder="29" Text="출력" Top="91" Visible="FALSE" Width="64"></Button>
		<Button Height="25" Id="btnExcel" ImageID="sum_excel" Left="968" OnClick="fn_Excel" TabOrder="35" Text="조회" Top="88" Visible="FALSE" Width="75"></Button>
		<Button Height="26" Id="btn_CLOSE" ImageID="closeBtn" Left="968" OnClick="btn_CLOSE_OnClick" TabOrder="36" Text="닫기" Top="1" Visible="FALSE" Width="74"></Button>
	</Form>
	<Script><![CDATA[/*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@Revision History      :
 * @@author                : 제환복
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : OBMZ210.xml
 * ● PROGRAM DESCRIPTION  : 전라인가동현황-보전의뢰관리
 * ● DATE WRITTEN         : 2017.02.21
 ----------------------------------------------------------------*/
#include "script::lib_script_common.js";
#include "script::Grid_Script.js";
#include "script::spare_common.js";
#include "script::fileupdown.js";

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1"); // cigma library(pereslib,psreslib)
var Lib2 = G_ds_user.GetColumn(0,"LIB2"); // 회사 library(psedblib,pscdblib)
//var Lib2 = "PSDIOLIB"; // 회사 library(psedblib,pscdblib)
var Lib3 = G_ds_user.GetColumn(0,"LIB3"); // 사업부 library(psedblib,pscdblib,pshdblib,pssdblib)
var company = G_ds_user.GetColumn(0,"COMPANY");
var comps = G_ds_user.GetColumn(0,"PLANT_CD");
var imgUPDOWNpath="C:/Program Files/Apache Software Foundation/Tomcat 6.0/webapps/DIONE_UPDOWN_FILE/bojen/";

//var g_userclass="";
var g_userclass=""; //권한등급 Param
var requestMsg="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화) - 2019.05.07
var requestSound="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화) - 2019.10.02
var popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비화성화) - 2019.05.07
//var refreshStopFlag="F";	//리프레쉬Stop (T:활성화, F:비화성화) - 2019.10.21
var lastSelRow=0; //재조회시 마지막으로 처리된 row로 이동

/* 
설비 장애코드
기존: (정상: '0', 장애: 'E', 연락중: 'A' 수리중: 'C' 수배중: 'B' 가동중확인: 'H' 품질확인: 'F')
변경: (정상: '0', 장애: 'E', 연락중: 'A', 접수: 'P', 수리중: 'C' 수배중: 'B' 가동중확인: 'H' 품질확인: 'F') - 2019.10.10
*/
function on_LoadCompleted(obj){
	getTitle();
	getDesign();
	gFcOnTopButtonColor("1"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)

	getComCode();
	//WebBrowser0.Run(); //소리테스트
	//Lib2 = "PSDIOLIB";
	//Lib3 = "PSDIOLIB";
	
	getPRDCD();	//제품명조회
	getPRDCD2();
	getLINCD();
	getMSHNO();
	getLayout();
	
	//Defaut Value
	//setTimer(1, 9999999999999999999999999999999);
	
	//cmb_interval.Value=30;
	//setTimer(1, 30*1000);//조회(30초)
	setTimer(1, 180*1000);	//조회(3분)
	setTimer(2, 5*1000);	//소리알림(5분) -2019.10.03
	setTimer(3, 1*1000); //날짜 변경 체크

	rdoggub.Value="";
	cmb_ERYMD_FR.Value=addDate(cmb_ERYMD_TO.Value,-6);
	
	//모니터링 PGM 연계사용 - 2019.10.29
	if(length(trim(sParam1))!=0){
		//trace("sParam1=="+sParam1+" sParam2=="+sParam2+" sParam3=="+sParam3);
		btn_CLOSE.Visible=true;
		cmb_LINCD.Value = sParam2;
		cmb_ERYMD_FR.Enable=false;	//기준일자FROM
		cmb_ERYMD_TO.Enable=false;	//기준일자TO
		rdoggub.Value="F";	//완료여부(미완료)
		rdoggub.Enable=false;	//완료여부
		chk_POPUP.Enable=false;	//알람표시
		btn_Stop_OnClick();		//리플레시 정지
		cmb_interval.Enable=false;	//리플레시 타임
		
		cmb_PRDCD.Value=sParam2;	//제품코드
		cmb_PRDCD.Enable=false;
		cmb_LINCD.Value=sParam3;	//라인코드
		cmb_LINCD.Enable=false;
		cmb_MSHNO.Enable=false;		//설비코드
	}
	
	getOBMZ210();
	
	managerYN(Lib2, ComboBoxPlant.Value, "3", G_ds_user.GetColumn(0,"USER_ID"));
	g_userclass=trim(ds_managerYN.GetColumn(0,"MAGER")); //관리자권한획득
	//g_userclass="M"; //임시권한적용
	//chk_POPUP=true;
}

function getComCode(){
	
	http.Sync 	= true;
	var sKind		= "getComCode";						
	var sMethodName = "service::login/selectComCode.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ComCode_PLNT=ds_ComCode_PLNT";
	var sArgument   = "";
		sArgument   += " CLASS='PLNT'";
		sArgument   += " CODE1=" + quote(company);		
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	ComboBoxPlant.Value=comps;
	ComboBoxPlant.Enable = false; 	
}

function getDesign(){
	//MainGrid.ToolTipText = setPopMessage("2053");
	MainGrid.BkColor = G_ds_design.GetColumn(0,"BkColor");
	//MainGrid.BkColor2 = G_ds_design.GetColumn(0,"BkColor2");
	//MainGrid.BkSelColor = G_ds_design.GetColumn(0,"BkSelColor");
	MainGrid.Face3dColor = G_ds_design.GetColumn(0,"Face3dColor");
	MainGrid.BoldHead = G_ds_design.GetColumn(0,"BoldHead");
	MainGrid.HeadHeight = G_ds_design.GetColumn(0,"HeadHeight");  //22
	//MainGrid.Width = G_ds_design.GetColumn(0,"Width");            //1048
	//MainGrid.Top = G_ds_design.GetColumn(0,"Top");                //64
	MainGrid.UserData = MainGrid.Height;
	
	searchBar.Width = G_ds_design.GetColumn(0,"Width");           //1048
	searchBar.Top = G_ds_design.GetColumn(0,"SBTop");	          //32
	//searchBar.Height = G_ds_design.GetColumn(0,"SBHeight");	      //29
}
/********************************************************************** 
 * 내용설명 : 제품코드 조회
 **********************************************************************/ 
function getPRDCD(){
	var sKind		= "getPRDCD";						
	var sMethodName = "service::psogmlib/selectMSTCODE.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            			// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_PRDCD=ds_MSTCODE";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //코드
		sArgument += " SQLID=" + "selectMSTCD";	//알람/전라인의 마스터 코드로 사용
		sArgument += " GRPCD=" +  quote("PRD");	//제품코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
}

/********************************************************************** 
 * 내용설명 : 제품코드 조회
 **********************************************************************/ 
function getPRDCD2(){
	var sKind		= "getPRDCD2";						
	var sMethodName = "service::psogmlib/selectMSTCODE.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            			// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_PRDCD2=ds_MSTCODE";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //코드
		sArgument += " SQLID=" + "selectMSTCD";	//알람/전라인의 마스터 코드로 사용
		sArgument += " GRPCD=" +  quote("PRD");	//제품코드
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
	ds_PRDCD2.InsertRow(0);
	ds_PRDCD2.SetColumn(0,"CD","");
	ds_PRDCD2.SetColumn(0,"CDNM","전체");
	ds_PRDCD2.SetColumn(0,"CDNM2","전체");
	cmb_PRDCD.Index=0;
}

/********************************************************************** 
 * 내용설명 : 라인코드 조회
 **********************************************************************/ 
function getLINCD(){
	var sKind		= "getLINCD";						
	var sMethodName = "service::psogmlib/selectMSTCODE.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            			// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_LINCD=ds_MSTCODE";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //코드
		sArgument += " SQLID=" + "selectMSTLINCD_PRD";
		//sArgument += " SQLID=" + "selectMSTLINCD_PRD";
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
	ds_LINCD.InsertRow(0);
	ds_LINCD.SetColumn(0,"CD","");
	ds_LINCD.SetColumn(0,"CDNM","전체");
	ds_LINCD.SetColumn(0,"CDNM2","전체");
	ds_LINCD.SetColumn(0,"PRDCD","");
	cmb_LINCD.Index=0;
}

/********************************************************************** 
 * 내용설명 : 설비명 조회
 **********************************************************************/ 
function getMSHNO(){
	
	var sKind		= "getMSHNO";						
	var sMethodName = "service::psogmlib/selectMSTCODE.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_MSHNO=ds_MSTCODE";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value); //코드
		sArgument += " SQLID=" + "selectMSHNO";
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
	ds_MSHNO.InsertRow(0);
	ds_MSHNO.SetColumn(0,"CD","");
	ds_MSHNO.SetColumn(0,"CDNM","전체");
	ds_MSHNO.SetColumn(0,"CDNM2","전체");
	ds_MSHNO.SetColumn(0,"LINCD","");
	cmb_MSHNO.Index=0;
	
}

/********************************************************************** 
 * 내용설명 : 공장Layout 조회
 **********************************************************************/ 
function getLayout(){
	
	var sKind		= "getOBMZ180";						
	var sMethodName = "service::psogmlib/selectOBMZ180.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBMZ180=ds_OBMZ180";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync = false;
	
}


/********************************************************************** 
 * 내용설명 : 화면 조회 
 **********************************************************************/ 
function getOBMZ210(){
	
	if(!validationChk()){
		return;
	}
	/* 수정 : 2018.04.03
	var sKind		= "getOBMZ210";						
	var sMethodName = "service::psogmlib/selectOBMZ210.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBMZ210=ds_OBMZ210";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += "@LIB2=" + quote(Lib2);
		sArgument += "@COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += "@ERYMD_FR=" + quote(cmb_ERYMD_FR.Value);	//기준일자FR
		sArgument += "@ERYMD_TO=" + quote(cmb_ERYMD_TO.Value);	//기준일자TO
		sArgument += "@CMPT=" + quote(rdoggub.Value);	//완료여부
		sArgument += "@PRDCD=" + quote(cmb_PRDCD.Value);	//제품코드
		sArgument += "@LINCD=" + quote(cmb_LINCD.Value);	//라인코드
		sArgument += "@MSHNO=" + quote(cmb_MSHNO.Value);	//설비코드
	var str = dialog("Common::PGMLOAD_OPG.xml","sKind=" + sKind + " " + "sMethodName=" + sMethodName + " " + "sOutDataSet=" + sOutDataSet + " " + "sArgument=" + sArgument,272,64,"TitleBar=false");	
	http.Sync = false;
	
	if (str == 'T'){  //정상조회
		//alert(setPopMessage("1004"));
		setMessage("1004");	
	}else if (str == 'B'){   //data값이 없을때
		alert(setPopMessage("1003"));
		setMessage("1003");	
	}else if (str == 'E'){   //error발생시
		alert(setPopMessage("1002"));
		setMessage("1002");	
	}
	*/
	var sKind		= "getOBMZ210";						
	var sMethodName = "service::psogmlib/selectOBMZ210.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBMZ210=ds_OBMZ210";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " ERYMD_FR=" + quote(cmb_ERYMD_FR.Value);	//기준일자FR
		sArgument += " ERYMD_TO=" + quote(cmb_ERYMD_TO.Value);	//기준일자TO
		sArgument += " CMPT=" + quote(rdoggub.Value);	//완료여부
		sArgument += " PRDCD=" + quote(cmb_PRDCD.Value);	//제품코드
		sArgument += " LINCD=" + quote(cmb_LINCD.Value);	//라인코드
		sArgument += " MSHNO=" + quote(cmb_MSHNO.Value);	//설비코드
	http.Sync = true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");	
	http.Sync = false;
	
	ds_OBMZ210.rowposition=lastSelRow; //재조회시 마지막으로처리한 row로 이동
}
/********************************************************************** 
 * 내용설명 : insert, update, delete
 **********************************************************************/ 
 function setOBMZ210(){

	var sKind		= "setOBMZ210";						
	var sMethodName = "service::psogmlib/saveOBMZ210.do";    // 서버에서 호출 될 Method 명
	var sInDataSet  = "ds_OBMZ210=ds_OBMZ210:U";               //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBMZ210_CHECK=ds_OBMZ210_CHECK";  	   // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		//sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " USER_ID=" + quote(G_ds_user.GetColumn(0,"USER_ID"));
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync=false;

}
//지시번호생성
 function setOBMZ210_JISNO(){


	var PlantCd="";
	if(substr(ComboBoxPlant.Value,0,1)="E"){
		PlantCd = "PE";
	}else if(substr(ComboBoxPlant.Value,0,1)="C"){
		PlantCd = "PC";
	}else if(substr(ComboBoxPlant.Value,0,1)="H"){
		PlantCd = "PH";
	}else if(substr(ComboBoxPlant.Value,0,1)="S"){
		PlantCd = "PS";
	}
	getogm_maxNum(PlantCd);
	

}
 function setOBJ200PF(){

	var sKind		= "setOBJ200PF";						
	var sMethodName = "service::psogmlib/saveOBMZ200_OBJ200PF.do";     // 서버에서 호출 될 Method 명
	var sInDataSet  = "";               //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "";    							     // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		//sArgument += " LIB2=" + quote("PSDIOLIB");
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " JISNO=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"JISNO"));
		sArgument += " MSHNO=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"MSHNO"));	
		//sArgument += " TIMCD=" + quote("");	//확인필요- 우선제외
		//sArgument += " PRTCD=" + quote("");	//확인필요- 우선제외
			
		//sArgument += " JOBCD=" + quote(""); //제외(21 OR 22 없으면 발생, 의뢰시간 조회안됨.)
		sArgument += " JOBCD=" + quote("21");
		//sArgument += " KDOWN=" + quote(0); //제외
		//sArgument += " PADAT=" + quote(0); //제외
		//sArgument += " PATIM=" + quote(""); //제외
		//sArgument += " URDAT=" + quote(0);	//제외			
		//sArgument += " URTIM=" + quote("");	//제외
		//sArgument += " KSDAT=" + quote(0);	//확인필요
		//sArgument += " KSTIM=" + quote("");	//확인필요
		sArgument += " PADAT=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERYMD"));	//발생일자
		sArgument += " PATIM=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERTIM"));	//발생시간
		sArgument += " URDAT=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"REYMD"));	//의뢰일자
		sArgument += " URTIM=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"RETIM"));	//의뢰시간
	
		sArgument += " KSDAT=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ACYMD"));	//개시일자
		sArgument += " KSTIM=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ACTIM"));	//개시시간
		
		sArgument += " WNDAT=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"QAYMD"));	//완료일자	(20171130추가)
		sArgument += " WNTIM=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"QATIM"));	//완료시간	(20171130추가)
		//sArgument += " STPHR=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"STPHR2"));	//설비정지시간(20190711추가)
				
		//sArgument += " WATHR=" + quote(0);//제외
		//sArgument += " WRKM1=" + quote(0);//제외
		var p_SABUN1, P_SABUN2;
			p_SABUN1 =trim(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"SABUN1"));
			P_SABUN2 =trim(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"SABUN2"));
		if(length(p_SABUN1)=0){
			p_SABUN1=0;
		}
		if(length(P_SABUN2)=0){
			P_SABUN2=0;
		}
		sArgument += " WRKM1=" + quote(p_SABUN1);	//20171130추가
		sArgument += " WRKM2=" + quote(P_SABUN2);	//20171130추가
		//sArgument += " SDPCD=" + quote(""); //확인필요- 우선제외	
		//sArgument += " HYOSN=" + quote("");	//제외
		//sArgument += " CNOTE=" + quote("");	//제외
		//sArgument += " DPTCD=" + quote(""); //확인필요 - 우선제외	
	
		//sArgument += " TIMCD=" + quote(gtimcd);
		//sArgument += " PRTCD=" + quote(gprtcd);
		//sArgument += " SDPCD=" + quote(lblsdpcd.Value);
		//sArgument += " DPTCD=" + quote(lbldptcd.Value);	
		sArgument += " HYOSN=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERRTX"));	//의뢰내용(21091017추가)
		
		//200추가항목
		sArgument += " ADUSR=" + quote(substr(G_ds_user.GetColumn(0,"USER_ID"),1,7));
	//sArgument += " PADAT=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERYMD"));
	//sArgument += " PATIM=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERTIM"));
	//sArgument += " URDAT=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"REYMD"));
	//sArgument += " URTIM=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"RETIM"));
	//sArgument += " KSDAT=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ACYMD"));
	//sArgument += " KSTIM=" + quote(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ACTIM"));
						
	
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : jisno MAX구하기
 **********************************************************************/ 
function getogm_maxNum(p_PlantCd)
{
				
	var sKind		= "getogm_maxNum";						
	var sMethodName = "service::psogmlib/selectOgm_maxNum.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "ds_ogm_maxNum=ds_ogm_maxNum";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		//sArgument += " LIB2=" + quote("PSDIOLIB");
		sArgument += " PLTCD=" + quote(p_PlantCd); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	ds_OBMZ210.SetColumn(ds_OBMZ210.currow,"JISNO", p_PlantCd+(parseInt(trim(ds_ogm_maxNum.GetColumn(0,"autonum")))+1));	
	updateOgm_maxNum(p_PlantCd);
}
//자동체번 테이블에서 max값으로 레코드 저장후 수정된 max값(max+1)을 update해주는 함수
function updateOgm_maxNum(p_PlantCd)
{
	var sKind		= "insert_next_maxvalue";						
	var sMethodName = "service::psogmlib/updateOgm_maxNum.do"; 
	var sInDataSet  = "";
	var sOutDataSet = "";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		//sArgument += " LIB2=" + quote("PSDIOLIB");
		sArgument += " PLTCD=" + quote(p_PlantCd); //사업부
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync=false;
	
}


/********************************************************************** 
 * 내용설명 : 작업자 배치마스터 갱신
 **********************************************************************/ 
 function setOBMZ220(){

	var sKind		= "setOBMZ220";						
	var sMethodName = "service::psogmlib/saveOBMZ200_OBM220PF.do";    // 서버에서 호출 될 Method 명
	var sInDataSet  = "ds_OBMZ220=ds_OBMZ220:U";               //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBMZ220_CHECK=ds_OBMZ220_CHECK";  	   // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		//sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " USER_ID=" + quote(G_ds_user.GetColumn(0,"USER_ID"));
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync=false;

}
/********************************************************************** 
 * 내용설명 : 작업자 배치마스터 갱신
 **********************************************************************/ 
 function setOBMZ220_UPDATE(){

	var sKind		= "setOBMZ220_UPDATE";						
	var sMethodName = "service::psogmlib/saveOBMZ200_OBM220PF.do";    // 서버에서 호출 될 Method 명
	var sInDataSet  = "ds_OBMZ220=ds_OBMZ220:U";               //자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBMZ220_CHECK=ds_OBMZ220_CHECK";  	   // 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		//sArgument += " LIB1=" + quote(Lib1);
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " USER_ID=" + quote(G_ds_user.GetColumn(0,"USER_ID"));
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "callback");
	http.Sync=false;

}


/********************************************************************** 
 * 내용설명 :  설비플래그 변경여부 확인(추가 2019.10.07)
 **********************************************************************/ 
function getOBMZ190_MStatus(stu_Lincd,stu_Mshno){

	var sKind		= "getOBMZ190_MStatus";						
	var sMethodName = "service::psogmlib/selectOBMZ190_MStatus.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_OBMZ190_MCheck=ds_OBMZ190_MCheck";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " LINCD=" + quote(stu_Lincd);
		sArgument += " MSHNO=" + quote(stu_Mshno);
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
	
	return ds_OBMZ190_MCheck.GetColumn(0,"STATU");
}

/*
* function명 : 설비상태변경
* function 주요값 : 설비의 상태
*					(정상: '0', 장애: 'E', 연락중: 'A' 수리중: 'C' 수배중: 'B' 가동중확인: 'H' 품질확인: 'F')
*/
//설비장애 코드 갱신-추가 수정할것 2017.5.22
function setMStatus(m_Row, Status){

	var sKind		= "setMStatus";						
	var sMethodName = "service::psogmlib/saveOBMZ200_MStatus.do";
	var sInDataSet  = "";
	var sOutDataSet = "";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " M_STATU=" + quote(Status);
		sArgument += " LINCD=" + quote(ds_OBMZ210.GetColumn(m_Row,"LINCD"));
		sArgument += " MSHNO=" + quote(ds_OBMZ210.GetColumn(m_Row,"MSHNO"));
		sArgument += " ERRTM_M=" + quote(ds_OBMZ210.GetColumn(m_Row,"ERTIM"));
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/*
* function명 : 라인의 상태변경
* function 주요값 : 라인의 상태(정상: '0', 대기 : 'D' OR 'R', 장애 : 'E')
*/
//라인상태
function setLStatus(m_Row){

	var sKind		= "setLStatus";						
	var sMethodName = "service::psogmlib/saveOBMZ200_LStatus.do";
	var sInDataSet  = "";
	var sOutDataSet = "";
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " STATU=" + quote("0");
		sArgument += " LINCD=" + quote(ds_OBMZ210.GetColumn(m_Row,"LINCD"));
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}

/********************************************************************** 
 * 내용설명 : 설비장애 건수 카운트
 **********************************************************************/ 
function getOBMZ1210_MStatus(p_LINCD)
{
				
	var sKind		= "getOBMZ1210_MStatus";						
	var sMethodName = "service::psogmlib/selectOBMZ190_MStatus.do";     		// 서버에서 호출 될 Method 명
	var sInDataSet  = "";                            				// 자료 저장 시 보낼 DataSet 명칭
	var sOutDataSet = "ds_McntCheck=ds_OBMZ190_MCheck";    				// 조회 후 돌려 받을 DataSet 명칭
	var sArgument   = "";
		sArgument += " LIB2=" + quote(Lib2);
		sArgument += " LIB3=" + quote(Lib3);
		sArgument += " COMPS=" + quote(ComboBoxPlant.Value);
		sArgument += " LINCD=" + quote(p_LINCD);
		//sArgument += " MSHNO=" + quote("");	//미사용
		sArgument += " STATU=" + quote("0");
	http.Sync=true;
	Transaction(sKind, sMethodName, sInDataSet, sOutDataSet, sArgument, "");
	http.Sync=false;
}
/********************************************************************** 
 * 내용설명 : Transaction 리턴후 실행 함수
 * 주요변수 : 
 * 			- sMethodName	Transaction 고유 ID
 * 			- ErrorCode 	에러코드
 * 			- ErrorMSG 		에러 메세지
 **********************************************************************/ 
function callback(svcId, rtnCd, rtnMsg){

	if(svcId=="insert_next_maxvalue"){
		// tran 실패
		if(rtnCd<0){
			alert(setPopMessage("1002"));
			setMessage("1002");
		}else{
			//trace("insert_next_maxvalue");
			setOBJ200PF();
			setOBMZ210();
		}
	}
	if(svcId=="setOBMZ220"){
		// tran 실패
		if(rtnCd<0){
			alert(setPopMessage("1002"));
			setMessage("1002");
		}else{
			//trace("setOBMZ220");
			setOBMZ210();
		}
		requestMsg="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
		requestSound="F";	//작업의뢰 접수 알림소리 활성화여부 (T:활성화, F:비화성화)
		popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
	}
	if(svcId=="setOBMZ220_UPDATE"){
		// tran 실패
		if(rtnCd<0){
			alert(setPopMessage("1002"));
			setMessage("1002");
		}else{
			//trace("setOBMZ220");
			lastSelRow = ds_OBMZ210.currow; //재조회시 마지막으로처리한 row로 이동
			//trace("lastSelRow=="+lastSelRow);
			getOBMZ210();
		}
		requestMsg="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
		requestSound="F";	//작업의뢰 접수 알림소리 활성화여부 (T:활성화, F:비화성화)
		popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
	}
	if(svcId=="setOBMZ210"){
	// tran 실패
		if (ds_OBMZ210_CHECK.GetRowCount() > 0){
			for(var i=0;i<ds_OBMZ210_CHECK.GetRowCount();i++){
				alert("보전의뢰관리 : " +ds_OBMZ210_CHECK.GetColumn(i,"EQUCD") + " = " + ds_OBMZ210_CHECK.GetColumn(i,"RTMSG"));
			}
			requestMsg="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
			requestSound="F";	//작업의뢰 접수 알림소리 활성화여부 (T:활성화, F:비화성화)
			popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
			
			lastSelRow = ds_OBMZ210.currow; //재조회시 마지막으로처리한 row로 이동
			getOBMZ210();  //error항목이 존재시에는 재조회
			return;
		}	
		// tran 실패
		if(rtnCd<0){
			alert(setPopMessage("1002"));
			setMessage("1002");
		}else{
			//alert(setPopMessage("1001"));
			setMessage("1001");	
			lastSelRow = ds_OBMZ210.currow; //재조회시 마지막으로처리한 row로 이동
			getOBMZ210();
		}
		requestMsg="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
		requestSound="F";	//작업의뢰 접수 알림소리 활성화여부 (T:활성화, F:비화성화)
		popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
	}
	if(svcId=="getOBMZ210"){
			// tran 실패
		if(rtnCd<0){
			alert(setPopMessage("1002"));
			setMessage("1002");
			requestMsg="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
			requestSound="F";	//작업의뢰 접수 알림소리 활성화여부 (T:활성화, F:비화성화)
			popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
		}else {
			setMessage("1004");	
			//접수대기 알림처리 STart
			if(chk_POPUP.Value==1){
				if(g_userclass="M"){	//보전관리자만 해당 메뉴 사용가능
					if(popupOpenFlag="F"){	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비화성화) - 2019.05.07
						if(requestMsg="F"){	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
						sendingMessage(); //신규구현 - 2019.05.07
						}
					}
				}
			}//END
		} 
	}
}

/********************************************************************** 
 * 내용설명 : validation 체크
 **********************************************************************/ 
function validationChk(){
	var result = true;
	cmb_ERYMD_FR.BKColor="white";
	cmb_ERYMD_TO.BKColor="white";
		

	if(cmb_ERYMD_FR.Value == ""){
		cmb_ERYMD_FR.BKColor="paleturquoise";
		alert(setPopMessage("4715"));//[알림]기준일자를 입력하세요.
		setMessage("4715");
		result = false;
	}else if(cmb_ERYMD_TO.Value == ""){
		cmb_ERYMD_TO.BKColor="paleturquoise";
		alert(setPopMessage("4715"));//[알림]기준일자를 입력하세요.
		setMessage("4715");
		result = false;
	}else if(cmb_ERYMD_FR.Value > cmb_ERYMD_TO.Value){
		cmb_ERYMD_FR.BKColor="paleturquoise";
		alert(setPopMessage("4715"));//[알림]기준일자를 확인하세요.
		setMessage("4715");
		result = false;
	}
	return result;
}
/********************************************************************** 
 * 내용설명 : 엑셀파일로 저장
 **********************************************************************/ 
function setExcel()
{
	var fName   = "보전의뢰관리";
	var arrSheets  =  Array();  

	arrSheets[0]  = "MainGrid|보전의뢰관리";
	createExcelSheetS2(FileDialog0, fName ,arrSheets);
}

/********************************************************************** 
 * 내용설명 : Sort
 **********************************************************************/ 
function MainGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) lib_grid_SetGridSort(obj,nCell);
}

function common_OnChanged(obj,strText)
{
	ds_OBMZ210.ClearData();
}

 /*--------------------------------------------------------------
 * 아래 함수는 콩통함수 이므로 모든 화면에 필요
 * 함수명 변경 불가
 * 버튼 컨트롤
----------------------------------------------------------------*/
function fn_Favorite()
{
	alert("fn_Favorite");
}

function fn_Search()
{
	getOBMZ210();
}

function fn_Input()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Delete()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_Save()
{
	//setOBMZ210();
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function fn_print()
{
	//alert(setPopMessage("9999"));
	//setMessage("9999");
	//dialog("psogmlib::OBMZ200_POP.xml","p_ROW="+ds_OBMZ210.currow+" "+"p_AFLAG="+"PRINT"+" ",300,300,"TitleBar=false");	
	
	//2019.05.07
	popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
	var openPop =dialog("psogmlib::OBMZ200_POP.xml","p_ROW="+ds_OBMZ210.currow+" "+"p_AFLAG="+"PRINT"+" ",300,300,"TitleBar=false");	
	if(openPop=false){
		popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
	}
}

function fn_Excel()
{
	setExcel();
}

function fn_Help()
{
	alert(setPopMessage("9999"));
	setMessage("9999");
}

function menu_OnFocus(obj)
{
	gFcOnTopButtonColor("1"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)	
}

function btn_POP_OnClick(obj)
{
	//dialog("psogmlib::OBMZ200_POP.xml","p_ROW="+ds_OBMZ210.currow+" "+"p_AFLAG="+"MOD"+" ",300,300,"TitleBar=false");	
	popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
	//trace(popupOpenFlag);
	var openPop =dialog("psogmlib::OBMZ200_POP.xml","p_ROW="+ds_OBMZ210.currow+" "+"p_AFLAG="+"MOD"+" ",300,300,"TitleBar=false");
	if(openPop=false){
		popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
	}
	//trace("btn_POP_OnClick : " +openPop+"====" +popupOpenFlag);
}

function userList_OnTimer(obj,nEventID)
{
	//fn_Search();
	if(nEventID=1){
		if(popupOpenFlag="F"){ //팝업창이 없을 때문 리프레쉬를 함.
			//trace(popupOpenFlag);
			fn_Search();
		}
	}else if(nEventID=2){//소리알람
		if(requestSound="T"){
			//Play("C:\\Windows\\Media\\Windows 경고 메시지.wav"); //로컬사운드만 재생가능
			Play("C:\\Windows\\Media\\Windows Exclamation.wav"); //로컬사운드만 재생가능
		}
	}else if(nEventID=3){//날짜 자동변경
		timeEvent();
	}
}

function cmb_interval_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
/*
	if (nNewIndex = 0) {
		setTimer(1, 10*1000);
	} else if (nNewIndex = 1) {
		setTimer(1, 20*1000);
	} else if (nNewIndex = 2) {
		setTimer(1, 30*1000);
	} else if (nNewIndex = 3) {
		setTimer(1, 40*1000);
	} else if (nNewIndex = 4) {
		setTimer(1, 50*1000);
	} else if (nNewIndex = 5) {
		setTimer(1, 60*1000);
	} else if (nNewIndex = 6) {
		setTimer(1, 9999999999999999999999999999999);
	}
*/
	if (nNewIndex = 0) {
		setTimer(1, 30*1000);
	} else if (nNewIndex = 1) {
		setTimer(1, 60*1000);
	} else if (nNewIndex = 2) {
		setTimer(1, 180*1000);
	} else if (nNewIndex = 3) {
		setTimer(1, 300*1000);
	} else if (nNewIndex = 4) {
		setTimer(1, 600*1000);
	} else if (nNewIndex = 5) {
		setTimer(1, 1800*1000);
	} else if (nNewIndex = 6) {
		setTimer(1, 9999999999999999999999999999999);
	}
}

function MainGrid_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
//alert(nCell);
	if(nCell=6){
		//dialog("psogmlib::OBMZ200_POP.xml","p_ROW="+ds_OBMZ210.currow+" "+"p_AFLAG="+"MOD"+" ",300,300,"TitleBar=false");
		popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
		var openPop = dialog("psogmlib::OBMZ200_POP.xml","p_ROW="+ds_OBMZ210.currow+" "+"p_AFLAG="+"MOD"+" ",300,300,"TitleBar=false");
		if(openPop=false){
			popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
		}
		//trace("nCell=6 : " +openPop+"====" +popupOpenFlag);	
	}
	if(nCell=9 || nCell=10 || nCell=15 || nCell=16 || nCell=19 || nCell=21){
		if(g_userclass="M"){	//보전관리자만 해당 메뉴 사용가능
//trace(nCell);
			if(nCell=9){	//의뢰접수일시
				if(ds_OBMZ210.GetColumn(nRow, "ACCDATE")="접수대기"){
					if(confirm("[알림]의뢰접수 작업을 처리하시겠습니까?")){
//trace("OK");
						//현재설비상태 최신여부체크 - 2019.10.07
						var realStatus = getOBMZ190_MStatus(trim(ds_OBMZ210.GetColumn(nRow,"LINCD")), trim(ds_OBMZ210.GetColumn(nRow,"MSHNO")));	//DB설비상태 조회
						if(ds_OBMZ210.GetColumn(nRow,"M_STATU") != realStatus){
							alert("[알림]현재 설비상태가 최신상태가 아닙니다. 재조회후 처리하세요.");
							//alert("현재:"+ds_OBMZ210.GetColumn(nRow,"M_STATU") +"==DB"+ realStatus);
							return;
						}else{
							ds_OBMZ210.SetColumn(nRow,"ACYMD",today());
							ds_OBMZ210.SetColumn(nRow,"ACTIM", substr(getDate(),8,4));
							setMStatus(nRow, "P");	//2019.10.10추가
							setOBMZ210();
							//setOBMZ210_JISNO();의뢰접수시에서 제조품질확인시 생성하는것으로 변경(2017.11.29)
						}
					}
				}		
			}
			if(nCell=10){	//인원배치일시
				if(ds_OBMZ210.GetColumn(nRow, "DEPDATE")="" && ds_OBMZ210.GetColumn(nRow, "ACCDATE")!="접수대기" && ds_OBMZ210.GetColumn(nRow, "QADATE")="미완료"){
					if(confirm("[알림]인원배치 작업을 처리하시겠습니까?")){
						//현재설비상태 최신여부체크 - 2019.10.07
						var realStatus = getOBMZ190_MStatus(trim(ds_OBMZ210.GetColumn(nRow,"LINCD")), trim(ds_OBMZ210.GetColumn(nRow,"MSHNO")));	//DB설비상태 조회
						if(ds_OBMZ210.GetColumn(nRow,"M_STATU") != realStatus){
							alert("[알림]현재 설비상태가 최신상태가 아닙니다. 재조회후 처리하세요.");
							//alert("현재:"+ds_OBMZ210.GetColumn(nRow,"M_STATU") +"==DB"+ realStatus);
							return;
						}else{
							popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화
							var sTemp="zzzzzzzzzz";
							var selectnumber = "Q";
								var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp+ " " + "P_COMPS=" + ComboBoxPlant.Value,584,528);
							
							if (length(rtn) != 0){
								var p_Row=ds_OBMZ180.FindRow("LINCD",ds_OBMZ210.GetColumn(nRow,"LINCD"));
								
								//trace(p_Row);
								ds_OBMZ220.ClearData();//초기화
								
								ds_OBMZ220.AddRow();
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"COMPS",ComboBoxPlant.Value);	//사업부
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OBJID","WRK_");	//오브젝트ID
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OTYPE","W");	//오브젝트타입
								//ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OSEQ",ComboBoxPlant.Value);	//오브젝트 SEQ
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"LINCD",ds_OBMZ210.GetColumn(nRow,"LINCD"));	//라인코드
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OTEXT",rtn[2]);	//작업자코드
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OWIDTH",40);	//넓이
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OHEIGHT",28);	//높이
								//ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",parseInt(ds_OBMZ180.GetColumn(p_Row,"POS_X"))-5);
								
								if(length(trim(ds_OBMZ180.GetColumn(p_Row,"POS_X")))!=0){
									ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",ds_OBMZ180.GetColumn(p_Row,"POS_X"));
								}else{
									ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",0);
								}
								if(length(trim(ds_OBMZ180.GetColumn(p_Row,"POS_Y")))!=0){
									ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_Y",ds_OBMZ180.GetColumn(p_Row,"POS_Y"));
								}else{
									ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_Y",0);
								}
								
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"ERYMD",ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERYMD"));
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"ERSEQ",ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERSEQ"));
								ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"SABUN",rtn[0]);
								
								//trace(ds_OBMZ220.SaveXML());
								ds_OBMZ210.SetColumn(nRow,"WORKER1", rtn[1]);
								ds_OBMZ210.SetColumn(nRow,"DEYMD",today());
								ds_OBMZ210.SetColumn(nRow,"DETIM", substr(getDate(),8,4));
									
								/*	 아래로직오류시 테스트
								if(rtn=false){
									popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
								}
								*/
								//설비 장애코드 변경로직 필요 -삭제 2018.03.28
								//setMStatus(ds_OBMZ210.currow, "C");
								//설비 장애코드 변경시 완료처리된 이후 인원배치시에는 플래그 변경이 없음.
								if(ds_OBMZ210.GetColumn(nRow, "FINDATE")=="미완료" && ds_OBMZ210.GetColumn(nRow, "QADATE")=="미완료"){
									setMStatus(ds_OBMZ210.currow, "C");
									setOBMZ220();
								}else{
									setOBMZ220();
								}
								if(rtn=false){
									popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
								}
							}
							//trace("nCell=10 : " +rtn+"====" +popupOpenFlag);
						}
					}
				}
			}
			if(nCell=15){	//부품수배(요청)
				if(ds_OBMZ210.GetColumn(nRow, "MREDATE")=""){
					if(confirm("[알림]부품수배(요청) 작업을 처리하시겠습니까?")){
						//설비 장애코드 변경로직 필요
						if(ds_OBMZ210.GetColumn(nRow, "FINDATE")=="미완료" && ds_OBMZ210.GetColumn(nRow, "QADATE")=="미완료"){
							//현재설비상태 최신여부체크 - 2019.10.07
							var realStatus = getOBMZ190_MStatus(trim(ds_OBMZ210.GetColumn(nRow,"LINCD")), trim(ds_OBMZ210.GetColumn(nRow,"MSHNO")));	//DB설비상태 조회
							if(ds_OBMZ210.GetColumn(nRow,"M_STATU") != realStatus){
								alert("[알림]현재 설비상태가 최신상태가 아닙니다. 재조회후 처리하세요.");
								//alert("현재:"+ds_OBMZ210.GetColumn(nRow,"M_STATU") +"==DB"+ realStatus);
								return;
							}else{
								ds_OBMZ210.SetColumn(nRow,"MRYMD",today());
								ds_OBMZ210.SetColumn(nRow,"MRTIM", substr(getDate(),8,4));
								setMStatus(nRow, "B");
								setOBMZ210();
							//setMStatus(ds_OBMZ210.currow, "B"); //2019.09.23 수정
							}
						}
					}
				}
			}
			if(nCell=16){	//부품수배(완료)
				if(ds_OBMZ210.GetColumn(nRow, "MRPDATE")=""){
					if(confirm("[알림]부품수배(완료) 작업을 처리하시겠습니까?")){
						//설비 장애코드 변경로직 필요
						if(ds_OBMZ210.GetColumn(nRow, "FINDATE")=="미완료" && ds_OBMZ210.GetColumn(nRow, "QADATE")=="미완료"){
							//현재설비상태 최신여부체크 - 2019.10.07
							var realStatus = getOBMZ190_MStatus(trim(ds_OBMZ210.GetColumn(nRow,"LINCD")), trim(ds_OBMZ210.GetColumn(nRow,"MSHNO")));	//DB설비상태 조회
							if(ds_OBMZ210.GetColumn(nRow,"M_STATU") != realStatus){
								//alert("[알림]현재 설비상태가 최신상태가 아닙니다. 재조회후 처리하세요.");
								alert("현재:"+ds_OBMZ210.GetColumn(nRow,"M_STATU") +"==DB"+ realStatus);
								return;
							}else{
								ds_OBMZ210.SetColumn(nRow,"MPYMD",today());
								ds_OBMZ210.SetColumn(nRow,"MPTIM", substr(getDate(),8,4));
								setMStatus(nRow, "C");
								setOBMZ210();
								//setMStatus(ds_OBMZ210.currow, "C"); //2019.09.23 수정
							}
						}
					}
				}
			}
			if(nCell=19){	//계획보전
				if(ds_OBMZ210.GetColumn(nRow, "PLNDATE")=""){
					if(confirm("[알림]계획보전 작업을 처리하시겠습니까?")){
						ds_OBMZ210.SetColumn(nRow,"PLYMD",today());
						ds_OBMZ210.SetColumn(nRow,"PLTIM", substr(getDate(),8,4));
						setOBMZ210();
					}
				}
			}if(nCell=21){	//수리이력등록여부
				if(ds_OBMZ210.GetColumn(nRow, "HISDATE")="미등록"){
					if(length(trim(ds_OBMZ210.GetColumn(nRow, "JISNO"))) !=0){
						if(confirm("[알림]수리이력등록여부 작업을 처리하시겠습니까?")){
							ds_OBMZ210.SetColumn(nRow,"HIYMD",today());
							ds_OBMZ210.SetColumn(nRow,"HITIM", substr(getDate(),8,4));
							setOBMZ210();
						}
					}else{
						alert("[알림]수리이력등록여부의 지시번호생성후 처리가 가능합니다.");
					}
				}
			}
		}else{
			alert("[알림]관리자만 입력가능합니다.");		
		}
	}
	if(nCell=11){ //작업자배치1
		//해당없음.
		/*
		if(ds_OBMZ210.GetColumn(nRow, "QADATE")="미완료"){
			if(length(trim(ds_OBMZ210.GetColumn(nRow,"WORKER1")))=0){
				var sTemp="zzzzzzzzzz";
				var selectnumber = "Q";
				var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp+ " " + "P_COMPS=" + ComboBoxPlant.Value,584,528);
				if (length(rtn) != 0){
					wrkUpdate("1", nRow, rtn[0], rtn[1], rtn[2]);
				}			
			}
		}
		*/
		//수정 2019.10.16
		if(ds_OBMZ210.GetColumn(nRow, "DEPDATE")!=""){
			if(ds_OBMZ210.GetColumn(nRow, "QADATE")="미완료"){
				if(length(trim(ds_OBMZ210.GetColumn(nRow,"WORKER1")))=0){
					var sTemp="zzzzzzzzzz";
					var selectnumber = "Q";
					popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여
					var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp+ " " + "P_COMPS=" + ComboBoxPlant.Value,584,528);
					if(rtn=false){
						popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
					}
					if(length(rtn) != 0){
						wrkUpdate("1", nRow, rtn[0], rtn[1], rtn[2]);
					}
				}
			}
		}
	}
	if(nCell=12){ //작업자배치2
		if(length(trim(ds_OBMZ210.GetColumn(nRow,"WORKER1")))!=0){
			//alert(nCell);
			popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
			var sTemp="zzzzzzzzzz";
			var selectnumber = "Q";
			var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp+ " " + "P_COMPS=" + ComboBoxPlant.Value,584,528);
			if(rtn=false){
				popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
			}
			if(length(rtn) != 0){
				wrkUpdate(2, nRow, rtn[0], rtn[1], rtn[2]);
				/*
				var p_Row=ds_OBMZ180.FindRow("LINCD",ds_OBMZ210.GetColumn(nRow,"LINCD"));
				trace(p_Row);
				ds_OBMZ220.ClearData();//초기화
								
				ds_OBMZ220.AddRow();
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"COMPS",ComboBoxPlant.Value);	//사업부
				if(ds_OBMZ210.GetColumn(nRow,"OBJID2")!=""){
					ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OBJID",ds_OBMZ210.GetColumn(nRow,"OBJID2"));	//오브젝트ID
				}else{
					ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OBJID","WRK_");	//오브젝트ID
				}
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OTYPE","W");	//오브젝트타입
				//ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OSEQ",ComboBoxPlant.Value);	//오브젝트 SEQ
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"LINCD",ds_OBMZ210.GetColumn(nRow,"LINCD"));	//라인코드
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OTEXT",rtn[2]);	//작업자코드
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OWIDTH",40);	//넓이
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OHEIGHT",28);	//높이
				//ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",parseInt(ds_OBMZ180.GetColumn(p_Row,"POS_X"))-5);
					
				if(length(trim(ds_OBMZ180.GetColumn(p_Row,"POS_X")))!=0){
					ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",ds_OBMZ180.GetColumn(p_Row,"POS_X"));
				}else{
					ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",0);
				}
				if(length(trim(ds_OBMZ180.GetColumn(p_Row,"POS_Y")))!=0){
					ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_Y",ds_OBMZ180.GetColumn(p_Row,"POS_Y"));
				}else{
					ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_Y",0);
					}
							
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"ERYMD",ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERYMD"));
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"ERSEQ",ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERSEQ"));
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"SABUN",rtn[0]);
				trace(ds_OBMZ220.SaveXML());
				ds_OBMZ210.SetColumn(nRow,"WORKER2", rtn[1]);
				setOBMZ220_UPDATE();
				*/
			}
			//trace("nCell=12 : " +rtn+"====" +popupOpenFlag);
		}
	}
	if(nCell=13){ //작업자배치3
		if(length(trim(ds_OBMZ210.GetColumn(nRow,"WORKER2")))!=0){
			popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
			var sTemp="zzzzzzzzzz";
			var selectnumber = "Q";
			var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp+ " " + "P_COMPS=" + ComboBoxPlant.Value,584,528);
			if(rtn=false){
				popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
			}
			if(length(rtn) != 0){
				wrkUpdate("3", nRow, rtn[0], rtn[1], rtn[2]);
			}
		}
	}
	if(nCell=14){ //작업자배치4
		if(length(trim(ds_OBMZ210.GetColumn(nRow,"WORKER3")))!=0){
			popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
			var sTemp="zzzzzzzzzz";
			var selectnumber = "Q";
			var rtn = dialog("Common::commonPopup.xml","SEL=" + selectnumber + " " + "CODE=" + sTemp+ " " + "P_COMPS=" + ComboBoxPlant.Value,584,528);
			if(rtn=false){
				popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
			}
			if(length(rtn) != 0){
				wrkUpdate("4", nRow, rtn[0], rtn[1], rtn[2]);
			}
		}
	}
	
	
	if(nCell=17){
		if(g_userclass="M"){	//보전관리자만 해당 메뉴 사용가능
			if(ds_OBMZ210.GetColumn(nRow, "DEPDATE")!="" && ds_OBMZ210.GetColumn(nRow, "FINDATE")="미완료"){
				if(confirm("[알림]보전수리완료 처리하시겠습니까?")){
				/*
					ds_OBMZ210.SetColumn(nRow,"FNYMD",today());
					ds_OBMZ210.SetColumn(nRow,"FNTIM", substr(getDate(),8,4));
					//설비 장애코드 변경로직 필요
					setMStatus(ds_OBMZ210.currow, "F");
					setOBMZ210();	
				*/
					//현재설비상태 최신여부체크 - 2019.10.07
					var realStatus = getOBMZ190_MStatus(trim(ds_OBMZ210.GetColumn(nRow,"LINCD")), trim(ds_OBMZ210.GetColumn(nRow,"MSHNO")));	//DB설비상태 조회
					if(ds_OBMZ210.GetColumn(nRow,"M_STATU") != realStatus){
						alert("[알림]현재 설비상태가 최신상태가 아닙니다. 재조회후 처리하세요.");
						//alert("현재:"+ds_OBMZ210.GetColumn(nRow,"M_STATU") +"==DB"+ realStatus);
						return;
					}else{
						ds_OBMZ210.SetColumn(nRow,"FNYMD",today());
						ds_OBMZ210.SetColumn(nRow,"FNTIM", substr(getDate(),8,4));
						setMStatus(ds_OBMZ210.currow, "F");
						setOBMZ210();
					}
				}
			}		
		}else{
			alert("[알림]현장 PC에서만 입력가능합니다.");		
		}
	}
	if(nCell=18){
		if(g_userclass="M"){	//보전관리자만 해당 메뉴 사용가능
			if(ds_OBMZ210.GetColumn(nRow, "FINDATE")!="미완료" && ds_OBMZ210.GetColumn(nRow, "QADATE")="미완료"){
			//if(ds_OBMZ210.GetColumn(nRow, "FINDATE")!=""){
				if(confirm("[알림]품질확인완료 처리하시겠습니까?")){
					/*
					ds_OBMZ210.SetColumn(nRow,"QAYMD",today());
					ds_OBMZ210.SetColumn(nRow,"QATIM", substr(getDate(),8,4));
					//설비 장애코드 변경로직 필요
					setMStatus(ds_OBMZ210.currow, "0");
					*/			
					//라인설비 상태플래그 변경
					/* 삭제 2018.03.28
					var finish="";
					var fLineCd="";
					var cLineCd=ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"LINCD");
					var c_cnt=0;
					for(i=0; i<ds_OBMZ210.rowcount; i++){
						fLineCd= ds_OBMZ210.GetColumn(i,"LINCD");
						finish = ds_OBMZ210.GetColumn(i,"QADATE");
						trace(cLineCd+"=="+fLineCd+"=="+finish);
						if(cLineCd=fLineCd && finish="미완료"){
							c_cnt++;
						}
					}
					//trace(c_cnt);
					if(c_cnt=1){
						setLStatus(ds_OBMZ210.currow);
					}
					setOBMZ210();	
					//setOBMZ210_JISNO();	//품질확인 완료시 지시번호생성
					*/
					/*
					// 추가 2018.03.28
					getOBMZ1210_MStatus(ds_OBMZ210.GetColumn(nRow,"LINCD"));
					if(ds_McntCheck.rowcount=0){
						setLStatus(ds_OBMZ210.currow);
					}
					setOBMZ210();	
					//setOBMZ210_JISNO();	//품질확인 완료시 지시번호생성					
					*/
					//현재설비상태 최신여부체크 - 2019.10.07
					var realStatus = getOBMZ190_MStatus(trim(ds_OBMZ210.GetColumn(nRow,"LINCD")), trim(ds_OBMZ210.GetColumn(nRow,"MSHNO")));	//DB설비상태 조회
					if(ds_OBMZ210.GetColumn(nRow,"M_STATU") != realStatus){
						alert("[알림]현재 설비상태가 최신상태가 아닙니다. 재조회후 처리하세요.");
						return;
					}else{
						if(length(trim(ds_OBMZ210.GetColumn(nRow,"WORKER1")))=0){
							alert("[알림]작업자 등록후 품질확인바랍니다.");
							return;
						}
						ds_OBMZ210.SetColumn(nRow,"QAYMD",today());
						ds_OBMZ210.SetColumn(nRow,"QATIM", substr(getDate(),8,4));
						setMStatus(ds_OBMZ210.currow, "0");
						// 추가 2018.03.28
						getOBMZ1210_MStatus(ds_OBMZ210.GetColumn(nRow,"LINCD"));
						if(ds_McntCheck.rowcount=0){
							setLStatus(ds_OBMZ210.currow);
						}
						setOBMZ210();
					}
				}
			}		
		}else{
			alert("[알림]현장 PC에서만 입력가능합니다.");		
		}
	}
	if(nCell=22){	//수리이력등록여부(지시번호)
		if(g_userclass="M"){	//보전관리자만 해당 메뉴 사용가능
			if(length(trim(ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"JISNO")))!=0){
				var p_JISNO=ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"JISNO");
				if(length(trim(p_JISNO))!=0){
					//새창으로 열기
					/*
					//2019.05.02 삭제(뉴디오네에서 사용불가)
					var sOrgnUrl = "psogmlib::ogm203U.xml";	
					var paramFlag= array(2);
					paramFlag[0]=p_JISNO;
			
					global.FrameBottom.fcOpenMDI1(sOrgnUrl, paramFlag, "[팝업]이력편집"); 
					bottomSet();
					*/
					//2019.05.02 수정(뉴디오네용)
					//var sOrgnUrl = "psogmlib::ogm203D.xml";
					//dialog(sOrgnUrl,"compsValue="+ComboBoxPlant.Value+" "+"jisno1="+p_JISNO+" ",300,300,"TitleBar=false");
					var sOrgnUrl = "psogmlib::ogm203U.xml";
					popupOpenFlag="T";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
					var openPop = dialog(sOrgnUrl,"sParam1="+p_JISNO+" ",300,300,"TitleBar=false");
					if(openPop=false){
						popupOpenFlag="F";	//작업의뢰 및 설비이력등록팝업시 접수알림 비활성화여부 (T:활성화, F:비활성화) 
					}
				}
			}else{
				//trace(length(trim(ds_OBMZ210.GetColumn(nRow, "QADATE"))));
				if(ds_OBMZ210.GetColumn(nRow, "QADATE")!="미완료" && length(trim(ds_OBMZ210.GetColumn(nRow, "QADATE"))) > 3){
					if(ds_OBMZ210.GetColumn(nRow, "ACCDATE")!="자체처리"){
						setOBMZ210_JISNO();	//품질확인 완료시 지시번호생성
					}else{
						alert("[알림]자체처리인 경우 생성이 불가능합니다.");
					}
				}else{
					alert("[알림]품질확인 완료후 생성가능합니다.");
				}
			}
		}
	}
	
	if(nCell=23 || nCell=24 || nCell=25){
		if(g_userclass="M"){	//보전관리자만 해당 메뉴 사용가능
			var p_FName="";
			if(nCell=23){	//첨부1
				if(length(ds_OBMZ210.GetColumn(nRow, "FILE1"))!=0){
					p_FName = ds_OBMZ210.GetColumn(nRow, "FILE1");
					file_Download(p_FName);
				}
			}
			if(nCell=24){	//첨부2
				if(length(ds_OBMZ210.GetColumn(nRow, "FILE2"))!=0){
					p_FName = ds_OBMZ210.GetColumn(nRow, "FILE2");
					file_Download(p_FName);
				}
			}
			if(nCell=25){	//첨부3
				if(length(ds_OBMZ210.GetColumn(nRow, "FILE3"))!=0){
					p_FName = ds_OBMZ210.GetColumn(nRow, "FILE3");
					file_Download(p_FName);
				}
			}
		}
	}
	
}

function cmb_PRDCD_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
/*
	cmb_LINCD_OnClick();
	cmb_LINCD.SetFocus();
	cmb_LINCD.Index=0;
*/	
	cmb_LINCD_OnClick();
	cmb_LINCD.Index=0;
	
	cmb_MSHNO_OnClick();
	cmb_MSHNO.Index=0;
	
	if(cmb_PRDCD.Value != ""){
		cmb_LINCD.SetFocus();
	} 
}

function cmb_LINCD_OnClick(obj)
{
/* 수정 : 2019.10.02
	if(cmb_PRDCD.Value == ""){
		//ds_LINCD.SetColumn(0,"PRDCD","");	//전체를 강제로 넣어줌
		//ds_LINCD.UnFilter();
		ds_LINCD.Filter("PRDCD=='" + cmb_PRDCD.Value + "'" );
	} else {
		ds_LINCD.SetColumn(0,"PRDCD",cmb_PRDCD.Value);	//전체를 강제로 넣어줌
		ds_LINCD.Filter("PRDCD=='" + cmb_PRDCD.Value + "'" );
	}
*/
	if(cmb_PRDCD.Value == ""){
		ds_LINCD.UnFilter();
		ds_LINCD.Filter("PRDCD==''" );
	} else {
		ds_LINCD.Filter("PRDCD=='" + cmb_PRDCD.Value + "'||PRDCD==''" );
	}
}

function cmb_LINCD_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cmb_MSHNO_OnClick();
	cmb_MSHNO.SetFocus();
	cmb_MSHNO.Index=0;
}

function cmb_MSHNO_OnClick(obj)
{
/* 수정 : 2019.10.02
	if(cmb_LINCD.Value == ""){
		//ds_MSHNO.SetColumn(0,"LINCD","");	//전체를 강제로 넣어줌
		//ds_MSHNO.UnFilter();
		ds_MSHNO.Filter("LINCD=='" + cmb_LINCD.Value + "'" );
	} else {
		ds_MSHNO.SetColumn(0,"LINCD",cmb_LINCD.Value);	//전체를 강제로 넣어줌
		ds_MSHNO.Filter("LINCD=='" + cmb_LINCD.Value + "'" );
	}
*/	
	if(cmb_LINCD.Value == ""){
		ds_MSHNO.UnFilter();
		ds_MSHNO.Filter("LINCD==''" );
	} else {
		ds_MSHNO.Filter("LINCD=='" + cmb_LINCD.Value + "'||LINCD==''");
	}	
}

function file_Download(obj)
{
	var gImgPath ="Maintenance/";
	//다운로드 받을 파일명을 취득하여 변수에 설정(클릭한 로우의 파일)
	var fName=obj;

	var str_param ="";
	if(ComboBoxPlant.Value =="E1"){
		 gImgPath += "KE/";
	}else if(ComboBoxPlant.Value =="C1"){
		  gImgPath += "KAC/";
	}else if(ComboBoxPlant.Value =="H1"){
		 gImgPath += "KAH/";
	}else if(ComboBoxPlant.Value =="S1"){
		 gImgPath += "KAC/";
	}
	
	var str_param =fName;
	//다운로드 받을 파일이 저장되어있는 서버 경로와 파일명
	var str_param_server = imgUPDOWNpath + gImgPath + str_param;
	//-----------  다이얼로그창  설정------------------
 	FileDialog0.Filter = "ALL File(.*)|*.*";	
   //다이얼로그창에 다운받을 파일명 설정
	FileDialog0.FileName= str_param;
    //다이얼로그창에 다운받을 기본경로 설정
	FileDialog0.FilePath= "C:\\";
	//다이얼로그창 버튼 SAVE로 설정
	FileDialog0.Type = "SAVE";
	//확장자가 없을 때 기본 확장자 설정
	FileDialog0.AppendExtDefault = "TRUE";

	//다이얼로그 생성(확인 버튼 클릭시 true, 취소버튼을 클릭시 false 반환)
	//확인 버튼 클릭시만 처리 계속
	if(FileDialog0.Open()){
		//다운로드 받을 경로(로컬)
		//var str_param_full = "C:/download/" + Dataset1.getColumn(nRow,"filename"); //다이얼로그창 미사용시(고정폴더)
		var str_param_full = FileDialog0.FilePath + "\\" + FileDialog0.FileName;
		//스크립트 파일의 함수 호출 
		var file_size = CyHttpFile0.GetFileSizeLocal(str_param_server);
		var ret = gfn_FileRead(CyHttpFile0, str_param_full, str_param_server, file_size, 1, "prog_bar", "");		
		//호출함수 리턴값 처리
		if ( ret[0] == "FAIL" ){
			alert(ret[1]);
		}else{
			alert("[알림]파일이 정상적으로 PC에 저장되었습니다.");
		}
	}
}

//추가 작업자 배치 스크립트
function wrkUpdate(idNo, sRow, p_wrk0, p_wrk1, p_wrk2){
	var p_Row=ds_OBMZ180.FindRow("LINCD",ds_OBMZ210.GetColumn(sRow,"LINCD"));
		ds_OBMZ220.ClearData();//초기화
						
		ds_OBMZ220.AddRow();
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"COMPS",ComboBoxPlant.Value);	//사업부
//trace("=="+ds_OBMZ210.GetColumn(sRow,"OBJID"+idNo)+"==");
		if(ds_OBMZ210.GetColumn(sRow,"OBJID"+idNo)!=""){
			ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OBJID",ds_OBMZ210.GetColumn(sRow,"OBJID"+idNo));	//오브젝트ID
		}else{
			ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OBJID","WRK_");	//오브젝트ID
		}
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OTYPE","W");	//오브젝트타입
		//ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OSEQ",ComboBoxPlant.Value);	//오브젝트 SEQ
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"LINCD",ds_OBMZ210.GetColumn(sRow,"LINCD"));	//라인코드
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OTEXT",p_wrk2);	//작업자코드
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OWIDTH",40);	//넓이
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"OHEIGHT",28);	//높이
		//ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",parseInt(ds_OBMZ180.GetColumn(p_Row,"POS_X"))-5);
			
		if(length(trim(ds_OBMZ180.GetColumn(p_Row,"POS_X")))!=0){
			ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",ds_OBMZ180.GetColumn(p_Row,"POS_X"));
			//다른작업자가 있는경우 위치를 이동시킴
			if(length(trim(ds_OBMZ210.GetColumn(sRow,"WORKER"+(parseInt(idNo)-1))))!=0){
				ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",parseInt(ds_OBMZ180.GetColumn(p_Row,"POS_X"))+((parseInt(idNo)-1)*30));
			}
		}else{
			ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_X",0);
		}
		if(length(trim(ds_OBMZ180.GetColumn(p_Row,"POS_Y")))!=0){
			ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_Y",ds_OBMZ180.GetColumn(p_Row,"POS_Y"));
		}else{
			ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"POS_Y",0);
			}
					
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"ERYMD",ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERYMD"));
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"ERSEQ",ds_OBMZ210.GetColumn(ds_OBMZ210.currow,"ERSEQ"));
		ds_OBMZ220.SetColumn(ds_OBMZ220.currow,"SABUN",p_wrk0);
//trace(ds_OBMZ220.SaveXML());
		ds_OBMZ210.SetColumn(sRow,"WORKER"+idNo, p_wrk1);
		setOBMZ220_UPDATE();
}

//작업자 삭제
function MainGrid_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell=11 || nCell=12 || nCell=13 || nCell=14){
		//alert(nCell);
		if(ds_OBMZ210.GetColumn(nRow, "QADATE")!="미완료"){	//2019.10.02 추가
			alert("[알림]품질확인 완료후에는 작업자 삭제가 불가능합니다.");
			return;
		}
	//trace(trim(ds_OBMZ210.GetColumn(nRow,"WORKER"+substr(nCell,1,2))));
		if(length(trim(ds_OBMZ210.GetColumn(nRow,"WORKER"+substr(nCell,1,2))))!=0){
			ds_OBMZ220.ClearData();//초기화			
			
			//temp dataset에 자료생성 후 삭제 처리
			ds_OBMZ220_del.ClearData();//초기화			
			ds_OBMZ220_del.AddRow();
			
			ds_OBMZ220_del.SetColumn(ds_OBMZ220_del.currow,"COMPS",ComboBoxPlant.Value);	//사업부
			ds_OBMZ220_del.SetColumn(ds_OBMZ220_del.currow,"OBJID",ds_OBMZ210.GetColumn(nRow,"OBJID"+substr(nCell,1,2)));	//오브젝트ID
			ds_OBMZ220_del.SetColumn(ds_OBMZ220_del.currow,"ERYMD",ds_OBMZ210.GetColumn(nRow,"ERYMD"));
			ds_OBMZ220_del.SetColumn(ds_OBMZ220_del.currow,"ERSEQ",ds_OBMZ210.GetColumn(nRow,"ERSEQ"));
			
			ds_OBMZ220.Copy(ds_OBMZ220_del);
			ds_OBMZ220.DeleteRow(ds_OBMZ220.currow);
			//trace(ds_OBMZ220.SaveXML());
			setOBMZ220_UPDATE();

			//alert(nCell);
		}
	}
}

//의뢰접수 메세지 발생
function sendingMessage(){
	requestMsg="T";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
	for(i=0; i< ds_OBMZ210.rowcount; i++){
		if(trim(ds_OBMZ210.GetColumn(i,"ACCDATE"))=="접수대기" && ds_OBMZ210.GetColumn(i, "QADATE")="미완료"){
			requestSound="T";	//작업의뢰 접수 알림소리 활성화여부 (T:활성화, F:비화성화)
			var p_MNGNO=trim(ds_OBMZ210.GetColumn(i,"MNGNO"));
			//var p_ERYMD=trim(ds_OBMZ210.GetColumn(i,"ERYMD"));
			//var p_ERSEQ=trim(ds_OBMZ210.GetColumn(i,"ERSEQ"));
			//dialog("psogmlib::OBMZ210_MSG.xml","p_ROW="+i+" "+"p_MNGNO="+p_MNGNO+" "+"p_ERYMD="+p_ERYMD+" "+"p_ERSEQ="+p_ERSEQ+" ",300,300,"TitleBar=false");			
			if(confirm("[알림]"+p_MNGNO+"보전의뢰가 접수되었습니다.\n 접수처리를 하시겠습니까?") == true) {
				//trace("접수처리");
				//ds_OBMZ210.SetColumn(i,"ACYMD",today());
				//ds_OBMZ210.SetColumn(i,"ACTIM", substr(getDate(),8,4));
				//setOBMZ210();
				//현재설비상태 최신여부체크 - 2019.10.07
				var realStatus = getOBMZ190_MStatus(trim(ds_OBMZ210.GetColumn(i,"LINCD")), trim(ds_OBMZ210.GetColumn(i,"MSHNO")));	//DB설비상태 조회
				if(ds_OBMZ210.GetColumn(i,"M_STATU") != realStatus){
					alert("[알림]현재 설비상태가 최신상태가 아닙니다. 재조회후 처리하세요.");
					requestMsg="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
					requestSound="F";	//작업의뢰 접수 알림소리 활성화여부 (T:활성화, F:비화성화)
					return;
				}else{
					ds_OBMZ210.SetColumn(i,"ACYMD",today());
					ds_OBMZ210.SetColumn(i,"ACTIM", substr(getDate(),8,4));
					setMStatus(i, "P");	//2019.10.10추가
					setOBMZ210();
				}
			}
		}
	}
	requestMsg="F";	//작업의뢰 접수 알림 활성화여부 (T:활성화, F:비화성화)
	requestSound="F";	//작업의뢰 접수 알림소리 활성화여부 (T:활성화, F:비화성화)
	//trace("sendingMessage() : requestMsg=="+requestMsg+":  requestSound=="+requestSound);
}

//날짜, 시간표시
function timeEvent(){

var getNowDate = "";
var sDateYMD = "";
var sTimeHMS = "";
	getNowDate = getDate();
	sDateYMD = substr(getNowDate,0,8);
	sTimeHMS = substr(getNowDate,8,6);
	
	if(sTimeHMS = "000000" ){//00시00분00초가 되면 날짜 재셋팅.
		cmb_ERYMD_TO.Value= today();
		cmb_ERYMD_FR.Value=addDate(cmb_ERYMD_TO.Value,-6);
		fn_Search();
	}
}

function btn_Stop_OnClick(obj)
{
	cmb_interval.Index=6;
	setTimer(1, 9999999999999999999999999999999);
}

function btn_CLOSE_OnClick(obj)
{
	close();
}
]]></Script>
</Window>