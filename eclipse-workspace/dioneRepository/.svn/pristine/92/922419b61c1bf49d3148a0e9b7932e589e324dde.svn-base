<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="UserList" Left="8" OnFocus="menu_OnFocus" OnLoadCompleted="on_LoadCompleted" PidAttrib="7" Title="DNKA&#32;사내용&#32;TAG&#32;발행" TooltipFont="Default,0" Top="8" Ver="1.0" Width="1062" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_FPQC009QRSSSS"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_LOAD"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FPQC009QR">
				<Contents>
					<colinfo id="COMPS" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_GUB" size="256" summ="default" type="STRING"/>
					<colinfo id="D_PNM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_ITC" size="256" summ="default" type="STRING"/>
					<colinfo id="D_SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="D_PNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_LIN" size="256" summ="default" type="STRING"/>
					<colinfo id="D_SUQ" size="256" summ="default" type="STRING"/>
					<colinfo id="KABANSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="QRDATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image FillType="STRETCH" Font="돋움,9,Bold" Height="28" Id="titleBar" ImageID="main_tit_bak" Left="-2" TabOrder="1" Width="1061"></Image>
		<Static Color="#333333" Font="돋움,9,Bold" Height="13" Id="title_text" Left="16" TabOrder="1" Top="8" Width="1032"></Static>
		<FileDialog AppendExtDefault="TRUE" Bottom="24" FileNameList="|" Filter="ALL&#32;File(xls.*)|*.xls" Height="24" Id="FileDialog0" Left="1000" Right="1024" TabOrder="5" Type="Save" Width="24"></FileDialog>
		<File Bottom="24" Height="24" Id="File0" Left="1032" Right="1056" TabOrder="4" Width="24"></File>
		<Ubi Bottom="600" Height="574" Id="Ubi0" Right="1048" Top="26" Width="1048">
			<_PersistData>&#13;&#10;/6yTdP4L/wAAAQBQbAAAd1M7APjy//7//fL4/PcMDwACBVQAWQBfUABFADD48QH+8C8DMQAyLwABNQH99S8CXgBuSQR0+vn+8C8L&#13;&#10;MgA1agAsOwBrCQRlD28FAfv07vGhAxQGswT+NAIHRABlAGYAH2EAdQBsVwP48pkB7Pn71wTwv/r0BVMAxWjCAGVXAQID+fUDdF+t&#13;&#10;vLm0zNQHFPr0cwIwLwD+9AExAA==&#13;&#10;</_PersistData>
		</Ubi>
	</Form>
	<Script><![CDATA[ /*--------------------------------------------------------------
 * @@version               : 1.0 
 * @@author                : LEE S K
 * @@see
 * ● SYSTEM NAME          : DIONE
 * ● PROGRAM NO.          : FPQC009QR.xml
 * ● PROGRAM DESCRIPTION  : DNKA 간판 발행
 * ● DATE WRITTEN         : 2014.06.06
----------------------------------------------------------------*/

#include "script::lib_script_common.js";
#include "script::Grid_Script.js"

var strSeparator = "	";
var Lib1 = G_ds_user.GetColumn(0,"LIB1");
var Lib2 = G_ds_user.GetColumn(0,"LIB2");
var company = G_ds_user.GetColumn(0,"COMPANY");

var nowDate = today();

/********************************************************************** 
 * 내용설명 : 화면로드
 * 주요변수 : 
 **********************************************************************/ 
function on_LoadCompleted(obj){
	getTitle();	
	//getDesign();	
	//gFcOnTopButtonColor("1"); //상단 버튼 활성화 여부 (기본:0,조회:1,변경:2)
	ds_FPQC009QR.ClearData();
	getFPQC009QR();
}


/********************************************************************** 
 * 내용설명 : 공통코드 조회
 * 주요변수 : 
 **********************************************************************/ 
function getDesign(){
	//MainGrid.ToolTipText = setPopMessage("2053");
	MainGrid.BkColor = G_ds_design.GetColumn(0,"BkColor");
	MainGrid.BkColor2 = G_ds_design.GetColumn(0,"BkColor2");
	MainGrid.BkSelColor = G_ds_design.GetColumn(0,"BkSelColor");
	MainGrid.Face3dColor = G_ds_design.GetColumn(0,"Face3dColor");
	MainGrid.BoldHead = G_ds_design.GetColumn(0,"BoldHead");
	MainGrid.HeadHeight = G_ds_design.GetColumn(0,"HeadHeight");
	MainGrid.Width = G_ds_design.GetColumn(0,"Width");
	//MainGrid.Top = G_ds_design.GetColumn(0,"Top");
}

/********************************************************************** 
 * 내용설명 : 화면조회
 * 주요변수 : 
 **********************************************************************/ 
function getFPQC009QR(){
	ds_LOAD.LoadXML(ds_SEL);
	/* qr data setting  (기본값)*/
	var qrdata_01 =  "DISC506002000001";   //header
	var qrdata_02 =  "009";                //유상수리구분
	var qrdata_03 =  "10002";              // 간판종류 구분코드(100)  자리수(02)
	var qrdata_04 =  "10125";              // 득의선품번 구분코드(101) 자리수(25)
	var qrdata_05 =  "10415";              //  ka품번  구분코드(104)  자리수(15)
	var qrdata_06 =  "11207";              // 수용수 구분코드(112)  자리수(07)
	var qrdata_07 =  "12305";              // 공정코드 구분코드(123)  자리수(05)
	var qrdata_08 =  "15308";              // 입고예정일 구분코드(153)  자리수(08)
	var qrdata_09 =  "15408";              // bucket번호 구분코드(154)  자리수(08)
	var qrdata_10 =  "15509";              // ordwer번호 구분코드(155)  자리수(09)
	var qrdata_11 =  "15207";              // seq 구분코드(152)  자리수(07)
	var qrdata_12 =  "21";
	
	var j=0;
	j=toNumber(K_FROM_S);  //간판번호 
	
	for(var i=0; i<ds_LOAD.rowcount;i++){
		var oem_t = ds_LOAD.GetColumn(i,"Q_OEM");
		var pno_t = ds_LOAD.GetColumn(i,"Q_PNO");
		var suq_t = ds_LOAD.GetColumn(i,"Q_SUQ");
		var pcd_t = ds_LOAD.GetColumn(i,"Q_PCD");
		var ymd_t = ds_LOAD.GetColumn(i,"Q_YMD");
		var buc_t = ds_LOAD.GetColumn(i,"Q_BUC");
		var or1_t = ds_LOAD.GetColumn(i,"Q_OR1");
		var or2_t = ds_LOAD.GetColumn(i,"Q_OR2");
		var or3_t = ds_LOAD.GetColumn(i,"Q_OR3");
		var seq_t = ds_LOAD.GetColumn(i,"Q_SEQ");
		
		ds_FPQC009QR.AddRow();
		ds_FPQC009QR.SetColumn(i,"COMPS",ds_LOAD.GetColumn(i,"COMPS"));
		ds_FPQC009QR.SetColumn(i,"PSPNO",ds_LOAD.GetColumn(i,"PSPNO"));
		ds_FPQC009QR.SetColumn(i,"D_GUB",ds_LOAD.GetColumn(i,"D_GUB"));
		ds_FPQC009QR.SetColumn(i,"D_PNM",ds_LOAD.GetColumn(i,"D_PNM"));
		ds_FPQC009QR.SetColumn(i,"D_ITC",ds_LOAD.GetColumn(i,"D_ITC"));
		ds_FPQC009QR.SetColumn(i,"D_SPC",ds_LOAD.GetColumn(i,"D_SPC"));
		ds_FPQC009QR.SetColumn(i,"D_PNO",ds_LOAD.GetColumn(i,"D_PNO"));
		ds_FPQC009QR.SetColumn(i,"D_LIN",ds_LOAD.GetColumn(i,"D_LIN"));
		ds_FPQC009QR.SetColumn(i,"D_SUQ",ds_LOAD.GetColumn(i,"D_SUQ"));
		
		ds_FPQC009QR.SetColumn(i,"KABANSEQ",right("0000"+j,4));
		
		var qrdata_13 = left(oem_t+space(25),25);   // oem품번
		var qrdata_14 = left(pno_t+space(15),15);   // KA품번
		var qrdata_15 = right("0000000"+suq_t,07);  // 수용수
		var qrdata_16 = left(pcd_t+space(05),05);   // 공정코드
		var qrdata_17 = left(ymd_t+space(08),08);   // 입고예정일
		var qrdata_18 = right(qrdata_17,4)+substr(qrdata_17,2,2) + "00"; //bucket번호   //left(buc_t+space(25),25);
		var qrdata_19 = right("00"+or1_t,02);   //left(or1_t+space(25),25);
		var qrdata_20 = right("0000"+or1_t,04);
		var qrdata_21 = right("000"+or1_t,03);
		var qrdata_22 = "9"+right("000000"+j,06);
		var qrdata_00 = qrdata_01+qrdata_02+qrdata_03+qrdata_04+qrdata_05+qrdata_06+qrdata_07+qrdata_08+qrdata_09+qrdata_10+
			qrdata_11+qrdata_12+qrdata_13+qrdata_14+qrdata_15+qrdata_16+qrdata_17+qrdata_18+qrdata_19+qrdata_20+qrdata_21+
			qrdata_22;
		ds_FPQC009QR.SetColumn(i,"QRDATA",qrdata_00);
		j=j+1;
	}
	Ubi0.setJrfFileDir(G_baseURL+"ui/BARCODE/REPORT/");
	Ubi0.setJrfFileName("FPQC009QR.jrf");
	Ubi0.SetDataset("ds_FPQC009QR", "ds_FPQC009QR");   
	
	Ubi0.Retrieve();
}

function Ubi0_PrintEnd(obj)
{
	alert(Ubi0.getPrintStatus() + "-    -" +Ubi0.getTotalPage()+ "-    -"+Ubi0.getCurrPage()); 
	//getPrintStatus()  ==  0 :정상       1:실패          0보다작으면 취소
}
]]></Script>
</Window>