<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.denso.mapper.ShipmentMapper">

	<select id="selectFSAZ100List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COMPS, GATCD, TRIM(GATNM) AS GATNM, USETF
		FROM
			${LIB2}.FSA100PF
		WHERE
			COMPS = #{COMPS}
			<!--
			AND USETF='1'
			-->
			<if test="!@org.springframework.util.StringUtils@isEmpty(USETF)">AND USETF=#{USETF}</if>
		ORDER BY COMPS, GATCD
	</select>
	<select id="selectFSAZ100Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			${LIB2}.FSA100PF
		WHERE
			COMPS=#{COMPS} AND GATCD=${GATCD}
	</select>
	<insert id="insertFSAZ100List" parameterType="java.util.HashMap">
		INSERT INTO ${LIB2}.FSA100PF (COMPS, GATCD, GATNM, USETF)
		VALUES (#{COMPS}, ${GATCD}, #{GATNM}, #{USETF})
	</insert>
	<update id="updateFSAZ100List" parameterType="java.util.HashMap">
		UPDATE ${LIB2}.FSA100PF
		SET GATNM=#{GATNM},
			USETF=#{USETF}
		WHERE COMPS=#{COMPS} AND GATCD=${GATCD}
	</update>
	<delete id="deleteFSAZ100List" parameterType="java.util.HashMap">
		DELETE FROM ${LIB2}.FSA100PF
		WHERE COMPS=#{COMPS} AND GATCD=${GATCD}
	</delete>
	<select id="selectFSAZ110List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COMPS, <!-- TRACD -->DIGITS(TRACD) AS TRACD, TRIM(TRANM) AS TRANM, TRIM(TRANM2) AS TRANM2, USETF
		FROM
			${LIB2}.FSA110PF
		WHERE
			COMPS = #{COMPS}
			<if test="!@org.springframework.util.StringUtils@isEmpty(USETF)">AND USETF=#{USETF}</if>
		ORDER BY COMPS, TRACD
	</select>
	<select id="selectFSAZ110Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			${LIB2}.FSA110PF
		WHERE
			COMPS=#{COMPS} AND TRACD=${TRACD}
	</select>
	<insert id="insertFSAZ110List" parameterType="java.util.HashMap">
		INSERT INTO ${LIB2}.FSA110PF (COMPS, TRACD, TRANM, TRANM2, USETF)
		VALUES (#{COMPS}, ${TRACD}, #{TRANM}, #{TRANM2}, #{USETF})
	</insert>
	<update id="updateFSAZ110List" parameterType="java.util.HashMap">
		UPDATE ${LIB2}.FSA110PF
		SET TRANM=#{TRANM},
			TRANM2=#{TRANM2},
			USETF=#{USETF}
		WHERE COMPS=#{COMPS} AND TRACD=${TRACD}
	</update>
	<delete id="deleteFSAZ110List" parameterType="java.util.HashMap">
		DELETE FROM ${LIB2}.FSA110PF
		WHERE COMPS=#{COMPS} AND TRACD=${TRACD}
	</delete>
	<select id="selectFSAZ120List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COMPS, TRIM(TRUCD) AS TRUCD, TRIM(TRUTN) AS TRUTN, STATU, LOCAT, TRIM(TRMAN) AS TRMAN
		FROM
			${LIB2}.FSA120PF
		WHERE
			COMPS = #{COMPS}
		ORDER BY COMPS, TRUCD
	</select>
	<select id="selectFSAZ120Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			${LIB2}.FSA120PF
		WHERE
			COMPS=#{COMPS} AND TRUCD=#{TRUCD}
	</select>
	<insert id="insertFSAZ120List" parameterType="java.util.HashMap">
		INSERT INTO ${LIB2}.FSA120PF (COMPS, TRUCD, TRUTN, STATU, LOCAT)
		VALUES (#{COMPS}, #{TRUCD}, ${TRUTN}, #{STATU}, #{LOCAT}, #{TRMAN})
	</insert>
	<update id="updateFSAZ120List" parameterType="java.util.HashMap">
		UPDATE ${LIB2}.FSA120PF
		SET TRUTN=${TRUTN},
			STATU=#{STATU},
			LOCAT=#{LOCAT},
			TRMAN=#{TRMAN}
		WHERE COMPS=#{COMPS} AND TRUCD=#{TRUCD}
	</update>
	<delete id="deleteFSAZ120List" parameterType="java.util.HashMap">
		DELETE FROM ${LIB2}.FSA120PF
		WHERE COMPS=#{COMPS} AND TRUCD=#{TRUCD}
	</delete>
	
	<select id="selectFSAZ130List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
		<!-- 
			COMPS, STYMD, GATCD, TRACD, DAYCD, CHASU, TIMES, TIMEE, INPDT, INPTM, INPMN
		 -->
			COMPS, STYMD, GATCD, <!-- TRACD -->DIGITS(TRACD) AS TRACD,
			MAX(CASE WHEN DAYCD='1' AND CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY11S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY11E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY12S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY12E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY13S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY13E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY14S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY14E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY15S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY15E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY16S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY16E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY17S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY17E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY18S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY18E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY19S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY19E,
			MAX(CASE WHEN DAYCD='1' AND CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY110S,
			MAX(CASE WHEN DAYCD='1' AND CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY110E,
						
			MAX(CASE WHEN DAYCD='2' AND CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY21S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY21E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY22S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY22E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY23S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY23E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY24S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY24E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY25S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY25E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY26S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY26E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY27S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY27E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY28S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY28E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY29S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY29E,
			MAX(CASE WHEN DAYCD='2' AND CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY210S,
			MAX(CASE WHEN DAYCD='2' AND CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY210E,
						
			MAX(CASE WHEN DAYCD='3' AND CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY31S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY31E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY32S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY32E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY33S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY33E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY34S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY34E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY35S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY35E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY36S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY36E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY37S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY37E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY38S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY38E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY39S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY39E,
			MAX(CASE WHEN DAYCD='3' AND CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY310S,
			MAX(CASE WHEN DAYCD='3' AND CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY310E,
						
			MAX(CASE WHEN DAYCD='4' AND CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY41S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY41E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY42S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY42E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY43S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY43E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY44S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY44E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY45S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY45E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY46S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY46E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY47S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY47E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY48S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY48E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY49S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY49E,
			MAX(CASE WHEN DAYCD='4' AND CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY410S,
			MAX(CASE WHEN DAYCD='4' AND CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY410E,
						
			MAX(CASE WHEN DAYCD='5' AND CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY51S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY51E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY52S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY52E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY53S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY53E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY54S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY54E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY55S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY55E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY56S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY56E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY57S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY57E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY58S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY58E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY59S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY59E,
			MAX(CASE WHEN DAYCD='5' AND CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY510S,
			MAX(CASE WHEN DAYCD='5' AND CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY510E,
						
			MAX(CASE WHEN DAYCD='6' AND CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY61S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY61E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY62S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY62E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY63S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY63E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY64S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY64E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY65S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY65E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY66S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY66E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY67S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY67E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY68S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY68E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY69S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY69E,
			MAX(CASE WHEN DAYCD='6' AND CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY610S,
			MAX(CASE WHEN DAYCD='6' AND CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY610E,
						
			MAX(CASE WHEN DAYCD='7' AND CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY71S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY71E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY72S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY72E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY73S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY73E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY74S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY74E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY75S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY75E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY76S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY76E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY77S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY77E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY78S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY78E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY79S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY79E,
			MAX(CASE WHEN DAYCD='7' AND CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS DAY710S,
			MAX(CASE WHEN DAYCD='7' AND CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS DAY710E
		FROM
			${LIB2}.FSA130PF
		WHERE
			COMPS = #{COMPS}
			AND GATCD = ${GATCD}
			AND STYMD=(SELECT MAX(STYMD) AS STYMD
						FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=${GATCD})
			AND TRACD IN(SELECT TRACD FROM ${LIB2}.FSA110PF WHERE COMPS = #{COMPS} AND USETF='1')
		GROUP BY COMPS, STYMD, GATCD, TRACD
		ORDER BY COMPS, STYMD, GATCD, TRACD
		<!-- 
		ORDER BY COMPS, STYMD, GATCD, TRACD, DAYCD, CHASU
		 -->
	</select>
	<select id="selectFSAZ130ListAll" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			*
		FROM
			${LIB2}.FSA130PF
		WHERE
			COMPS=#{COMPS} AND STYMD >=${STYMD} AND GATCD=${GATCD}
	</select>
	<select id="selectFSAZ130Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			${LIB2}.FSA130PF
		WHERE
			COMPS=#{COMPS} AND STYMD=${STYMD} AND GATCD=${GATCD} AND TRACD=${TRACD}
			AND DAYCD=#{DAYCD} AND CHASU=${CHASU}
	</select>
	<insert id="insertFSAZ130List" parameterType="java.util.HashMap">
		INSERT INTO ${LIB2}.FSA130PF (COMPS, STYMD, GATCD, TRACD, DAYCD, CHASU, TIMES, TIMEE, INPDT, INPTM, INPMN)
		VALUES (#{COMPS}, ${STYMD}, ${GATCD}, ${TRACD}, #{DAYCD}, ${CHASU}, ${TIMES}, ${TIMEE}, 
				REPLACE(CHAR(DATE(current date), ISO), '-', ''), REPLACE(CHAR(time(current time), ISO), '.', ''), #{INPMN})
	</insert>
	<update id="updateFSAZ130List" parameterType="java.util.HashMap">
		UPDATE ${LIB2}.FSA130PF
		SET TIMES=${TIMES},
			TIMEE=${TIMEE},
			INPDT=REPLACE(CHAR(DATE(current date), ISO), '-', ''),
			INPTM=REPLACE(CHAR(time(current time), ISO), '.', ''),
			INPMN=#{INPMN}
		WHERE COMPS=#{COMPS} AND STYMD=${STYMD} AND GATCD=${GATCD} AND TRACD=${TRACD} AND DAYCD=#{DAYCD} AND CHASU=${CHASU}
	</update>
	<delete id="deleteFSAZ130List" parameterType="java.util.HashMap">
		DELETE FROM ${LIB2}.FSA130PF
		WHERE COMPS=#{COMPS} AND STYMD=${STYMD} AND GATCD=${GATCD} AND TRACD=${TRACD} AND DAYCD=#{DAYCD} AND CHASU=${CHASU}
	</delete>
	<!-- 
	<delete id="deleteFSAZ130ListAll" parameterType="java.util.HashMap">
		DELETE FROM ${LIB2}.FSA130PF
		WHERE COMPS=#{COMPS} AND STYMD='${STYMD}' AND GATCD='${GATCD}' AND TRACD='${TRACD}'
	</delete>
	 -->
	<select id="selectFSAZ140List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT 
		A.COMPS, A.STYMD, A.GATCD, <!-- A.TRACD -->DIGITS(A.TRACD) AS TRACD, A.DAYCD,
		A.CHA11S, A.CHA11E, A.CHA21S, A.CHA21E, A.CHA31S, A.CHA31E, A.CHA41S, A.CHA41E, A.CHA51S, A.CHA51E,
		A.CHA61S, A.CHA61E, A.CHA71S, A.CHA71E, A.CHA81S, A.CHA81E, A.CHA91S, A.CHA91E, A.CHA101S, A.CHA101E,
		TRIM(COALESCE(CHAR(B.WKYMD),'')) AS WKYMD,
		<!--
		TRIM(COALESCE(B.CHA12S,' ')) AS CHA12S, TRIM(COALESCE(B.CHA12E,' ')) AS CHA12E, B.TRUCD1,
		TRIM(COALESCE(B.CHA22S,' ')) AS CHA22S, TRIM(COALESCE(B.CHA22E,' ')) AS CHA22E, B.TRUCD2,
		TRIM(COALESCE(B.CHA32S,' ')) AS CHA32S, TRIM(COALESCE(B.CHA32E,' ')) AS CHA32E, B.TRUCD3,
		TRIM(COALESCE(B.CHA42S,' ')) AS CHA42S, TRIM(COALESCE(B.CHA42E,' ')) AS CHA42E, B.TRUCD4,
		TRIM(COALESCE(B.CHA52S,' ')) AS CHA52S, TRIM(COALESCE(B.CHA52E,' ')) AS CHA52E, B.TRUCD5
		 -->
		 <!-- 
		TRIM(COALESCE(B.CHA12S,'')) AS CHA12S, TRIM(COALESCE(B.CHA12E,'')) AS CHA12E, B.TRUCD1,
		TRIM(COALESCE(B.CHA22S,'')) AS CHA22S, TRIM(COALESCE(B.CHA22E,'')) AS CHA22E, B.TRUCD2,
		TRIM(COALESCE(B.CHA32S,'')) AS CHA32S, TRIM(COALESCE(B.CHA32E,'')) AS CHA32E, B.TRUCD3,
		TRIM(COALESCE(B.CHA42S,'')) AS CHA42S, TRIM(COALESCE(B.CHA42E,'')) AS CHA42E, B.TRUCD4,
		TRIM(COALESCE(B.CHA52S,'')) AS CHA52S, TRIM(COALESCE(B.CHA52E,'')) AS CHA52E, B.TRUCD5,
		
		TRIM(COALESCE(B.CHA62S,'')) AS CHA62S, TRIM(COALESCE(B.CHA62E,'')) AS CHA62E, B.TRUCD6,
		TRIM(COALESCE(B.CHA72S,'')) AS CHA72S, TRIM(COALESCE(B.CHA72E,'')) AS CHA72E, B.TRUCD7,
		TRIM(COALESCE(B.CHA82S,'')) AS CHA82S, TRIM(COALESCE(B.CHA82E,'')) AS CHA82E, B.TRUCD8,
		TRIM(COALESCE(B.CHA92S,'')) AS CHA92S, TRIM(COALESCE(B.CHA92E,'')) AS CHA92E, B.TRUCD9,
		TRIM(COALESCE(B.CHA102S,'')) AS CHA102S, TRIM(COALESCE(B.CHA102E,'')) AS CHA102E, B.TRUCD10
		 -->
		TRIM(COALESCE(B.CHA12S,'')) AS CHA12S, TRIM(COALESCE(B.CHA12E,'')) AS CHA12E, TRIM(COALESCE(B.TRUCD1,'')) AS TRUCD1,
		TRIM(COALESCE(B.CHA22S,'')) AS CHA22S, TRIM(COALESCE(B.CHA22E,'')) AS CHA22E, TRIM(COALESCE(B.TRUCD2,'')) AS TRUCD2,
		TRIM(COALESCE(B.CHA32S,'')) AS CHA32S, TRIM(COALESCE(B.CHA32E,'')) AS CHA32E, TRIM(COALESCE(B.TRUCD3,'')) AS TRUCD3,
		TRIM(COALESCE(B.CHA42S,'')) AS CHA42S, TRIM(COALESCE(B.CHA42E,'')) AS CHA42E, TRIM(COALESCE(B.TRUCD4,'')) AS TRUCD4,
		TRIM(COALESCE(B.CHA52S,'')) AS CHA52S, TRIM(COALESCE(B.CHA52E,'')) AS CHA52E, TRIM(COALESCE(B.TRUCD5,'')) AS TRUCD5,
		
		TRIM(COALESCE(B.CHA62S,'')) AS CHA62S, TRIM(COALESCE(B.CHA62E,'')) AS CHA62E, TRIM(COALESCE(B.TRUCD6,'')) AS TRUCD6,
		TRIM(COALESCE(B.CHA72S,'')) AS CHA72S, TRIM(COALESCE(B.CHA72E,'')) AS CHA72E, TRIM(COALESCE(B.TRUCD7,'')) AS TRUCD7,
		TRIM(COALESCE(B.CHA82S,'')) AS CHA82S, TRIM(COALESCE(B.CHA82E,'')) AS CHA82E, TRIM(COALESCE(B.TRUCD8,'')) AS TRUCD8,
		TRIM(COALESCE(B.CHA92S,'')) AS CHA92S, TRIM(COALESCE(B.CHA92E,'')) AS CHA92E, TRIM(COALESCE(B.TRUCD9,'')) AS TRUCD9,
		TRIM(COALESCE(B.CHA102S,'')) AS CHA102S, TRIM(COALESCE(B.CHA102E,'')) AS CHA102E, TRIM(COALESCE(B.TRUCD10,'')) AS TRUCD10
	FROM(
		SELECT
			A.COMPS, A.STYMD, A.GATCD, A.TRACD, A.DAYCD,
			MAX(CASE WHEN CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA11S,
			MAX(CASE WHEN CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA11E,
			MAX(CASE WHEN CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA21S,
			MAX(CASE WHEN CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA21E,
			MAX(CASE WHEN CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA31S,
			MAX(CASE WHEN CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA31E,
			MAX(CASE WHEN CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA41S,
			MAX(CASE WHEN CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA41E,
			MAX(CASE WHEN CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA51S,
			MAX(CASE WHEN CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA51E,
			
			MAX(CASE WHEN CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA61S,
			MAX(CASE WHEN CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA61E,
			MAX(CASE WHEN CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA71S,
			MAX(CASE WHEN CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA71E,
			MAX(CASE WHEN CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA81S,
			MAX(CASE WHEN CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA81E,
			MAX(CASE WHEN CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA91S,
			MAX(CASE WHEN CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA91E,
			MAX(CASE WHEN CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA101S,
			MAX(CASE WHEN CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA101E
		FROM ${LIB2}.FSA130PF A
		WHERE
			A.COMPS=#{COMPS}
			AND A.GATCD=${GATCD}
			AND DAYCD=#{DAYCD}
			AND A.STYMD=(SELECT MAX(STYMD) AS STYMD
						FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=${GATCD} AND DAYCD=#{DAYCD})
			AND A.TRACD IN(SELECT TRACD FROM ${LIB2}.FSA110PF WHERE COMPS = #{COMPS} AND USETF='1')
		GROUP BY A.COMPS, A.STYMD, A.GATCD, A.TRACD, A.DAYCD) A
	LEFT OUTER JOIN (
		SELECT
			Z.COMPS, Z.WKYMD, Z.GATCD, Z.TRACD,
			MAX(CASE WHEN Z.CHASU='1' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA12S,
			MAX(CASE WHEN Z.CHASU='1' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA12E,
			MAX(CASE WHEN Z.CHASU='1' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD1,
			MAX(CASE WHEN Z.CHASU='2' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA22S,
			MAX(CASE WHEN Z.CHASU='2' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA22E,
			MAX(CASE WHEN Z.CHASU='2' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD2,
			MAX(CASE WHEN Z.CHASU='3' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA32S,
			MAX(CASE WHEN Z.CHASU='3' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA32E,
			MAX(CASE WHEN Z.CHASU='3' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD3,
			MAX(CASE WHEN Z.CHASU='4' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA42S,
			MAX(CASE WHEN Z.CHASU='4' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA42E,
			MAX(CASE WHEN Z.CHASU='4' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD4,
			MAX(CASE WHEN Z.CHASU='5' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA52S,
			MAX(CASE WHEN Z.CHASU='5' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA52E,
			MAX(CASE WHEN Z.CHASU='5' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD5,

			MAX(CASE WHEN Z.CHASU='6' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA62S,
			MAX(CASE WHEN Z.CHASU='6' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA62E,
			MAX(CASE WHEN Z.CHASU='6' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD6,
			MAX(CASE WHEN Z.CHASU='7' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA72S,
			MAX(CASE WHEN Z.CHASU='7' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA72E,
			MAX(CASE WHEN Z.CHASU='7' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD7,
			MAX(CASE WHEN Z.CHASU='8' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA82S,
			MAX(CASE WHEN Z.CHASU='8' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA82E,
			MAX(CASE WHEN Z.CHASU='8' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD8,
			MAX(CASE WHEN Z.CHASU='9' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA92S,
			MAX(CASE WHEN Z.CHASU='9' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA92E,
			MAX(CASE WHEN Z.CHASU='9' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD9,
			MAX(CASE WHEN Z.CHASU='10' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA102S,
			MAX(CASE WHEN Z.CHASU='10' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA102E,
			MAX(CASE WHEN Z.CHASU='10' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD10
		FROM ${LIB2}.FSA140PF Z
		WHERE
			Z.COMPS=#{COMPS}
			AND Z.GATCD=${GATCD}
			AND Z.WKYMD=${WKYMD}
		GROUP BY Z.COMPS, Z.WKYMD, Z.GATCD, Z.TRACD
		) B ON A.COMPS=B.COMPS AND A.GATCD=B.GATCD AND A.TRACD=B.TRACD
	ORDER BY A.COMPS, A.STYMD, A.GATCD, A.TRACD, A.DAYCD
	</select>
	<select id="selectFSAZ140Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			${LIB2}.FSA140PF
		WHERE
			COMPS=#{COMPS} AND WKYMD=${WKYMD} AND GATCD=${GATCD} AND TRACD=${TRACD} AND CHASU=${CHASU}
	</select>
	<insert id="insertFSAZ140List" parameterType="java.util.HashMap">
		<!-- FINISH_TIME=>ENDTM 확인필요 -->
		INSERT INTO ${LIB2}.FSA140PF (COMPS, WKYMD, GATCD, TRACD, CHASU, FTIMS, FTIME, ENDTM, TRUCD, INPDT, INPTM, INPMN)
		VALUES (#{COMPS}, ${WKYMD}, ${GATCD}, ${TRACD}, ${CHASU}, ${FTIMS}, ${FTIME}, ${FTIMS}, #{TRUCD},
				REPLACE(CHAR(DATE(current date), ISO), '-', ''), REPLACE(CHAR(time(current time), ISO), '.', ''), #{INPMN})
	</insert>
	<update id="updateFSAZ140List" parameterType="java.util.HashMap">
		UPDATE ${LIB2}.FSA140PF
		SET TRUCD=#{TRUCD},
			FTIMS=${FTIMS},
			FTIME=${FTIME},
			INPDT=REPLACE(CHAR(DATE(current date), ISO), '-', ''),
			INPTM=REPLACE(CHAR(time(current time), ISO), '.', ''),
			INPMN=#{INPMN}
		WHERE COMPS=#{COMPS} AND WKYMD=${WKYMD} AND GATCD=${GATCD} AND TRACD=${TRACD} AND CHASU=${CHASU}
	</update>
	<delete id="deleteFSAZ140List" parameterType="java.util.HashMap">
		DELETE FROM ${LIB2}.FSA140PF
		WHERE COMPS=#{COMPS} AND WKYMD=${WKYMD} AND GATCD=${GATCD} AND TRACD=${TRACD} AND CHASU=${CHASU}
	</delete>
	<select id="selectFSAZ150List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
		<!-- 
			A.TRKNO, A.CUSNO, A.SHPNO, A.SHPDT, A.PRFLG,
			B.TRKNO, B.CUSNO, B.SHPNO, B.PRTNO, B.DUEDT, B.CORNO, B.CPRTN, B.SHPQY
		 -->
			A.TRKNO, A.CUSNO, A.SHPDT, A.PRFLG,
			TRIM(B.PRTNO) AS PRTNO, B.SHPQY, TRIM(C.ITDSC) AS ITDSC,
			<!-- 
			D.GATCD, DIGITS(D.TRACD) AS TRACD, D.CHASU,
			 -->
			TRIM(COALESCE(D.GATCD,0)) AS GATCD, COALESCE(D.TRACD,0) AS TRACD, COALESCE(D.CHASU, 0) AS CHASU,
			COALESCE(E.TIMES,0) AS TIMES, COALESCE(E.TIMEE,0) AS TIMEE, COALESCE(F.FTIMS,0) AS FTIMS, COALESCE(F.FTIME,0) AS FTIME,
			B.SHPNO, B.DUEDT, B.CORNO, B.CPRTN
		FROM
			${LIB1}.ED004PR A
			LEFT OUTER JOIN ${LIB1}.ED005PR B ON A.TRKNO=B.TRKNO
			LEFT OUTER JOIN ${LIB1}.BM008PR C ON B.PRTNO=C.ITNBR
			LEFT OUTER JOIN ${LIB2}.FSA150PF D ON D.COMPS=#{COMPS} AND A.SHPDT=D.SHPDT 
				AND B.TRKNO=D.TRKNO AND B.CUSNO=D.CUSNO AND B.SHPNO=D.SHPNO AND B.PRTNO=D.PRTNO
				AND B.DUEDT=D.DUEDT AND B.CORNO=D.CORNO AND B.CPRTN=D.CPRTN
			LEFT OUTER JOIN ${LIB2}.FSA130PF E ON E.COMPS=#{COMPS} AND D.GATCD=E.GATCD
				AND D.TRACD=E.TRACD	AND D.CHASU=E.CHASU AND E.DAYCD=#{DAYCD}
				AND E.STYMD=(SELECT MAX(STYMD) AS STYMD
							FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=D.GATCD AND TRACD=D.TRACD)
			LEFT OUTER JOIN ${LIB2}.FSA140PF F ON F.COMPS=#{COMPS} AND D.GATCD=F.GATCD AND D.TRACD=F.TRACD
				AND D.CHASU=F.CHASU AND A.SHPDT=F.WKYMD
		WHERE
			A.PRFLG !=4
			AND A.SHPDT=${SHPDT}
			AND C.PACKC=#{COMPS}
			<!-- 
			AND C.PACKC=#{COMPS}
			 -->
		ORDER BY A.TRKNO
	</select>	

	<select id="selectFSAZ150ListView" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT 
		A.COMPS, A.STYMD, A.GATCD, A.TRACD, A.DAYCD, A.CHASU, A.TIMES, A.TIMEE, B.FTIMS, B.FTIME
	FROM
		${LIB2}.FSA130PF A
		LEFT OUTER JOIN ${LIB2}.FSA140PF B ON A.COMPS=B.COMPS AND A.GATCD=B.GATCD AND A.TRACD=B.TRACD
			 AND A.CHASU=B.CHASU AND B.WKYMD=${SHPDT}
	WHERE
		A.COMPS=#{COMPS}
		AND A.GATCD=${GATCD}
		AND A.TRACD=${TRACD}
		AND A.CHASU=${CHASU}
		AND A.DAYCD=#{DAYCD}
		AND A.STYMD=(SELECT MAX(STYMD) AS STYMD
					FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=${GATCD} AND TRACD=${TRACD})
	</select>
	<select id="selectFSAZ150Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			${LIB2}.FSA150PF
		WHERE
			COMPS=#{COMPS} AND SHPDT=${SHPDT} AND TRKNO=${TRKNO} AND CUSNO=${CUSNO} AND SHPNO=${SHPNO}
			AND PRTNO=#{PRTNO} AND DUEDT=${DUEDT} AND CORNO=#{CORNO} AND CPRTN=#{CPRTN}
	</select>
	<insert id="insertFSAZ150List" parameterType="java.util.HashMap">
		<!-- FINISH_TIME=>ENDTM 확인필요 -->
		INSERT INTO ${LIB2}.FSA150PF (COMPS, SHPDT, TRKNO, CUSNO, SHPNO, PRTNO, DUEDT, 
			CORNO, CPRTN, SHPQY, GATCD, TRACD, CHASU, TRAGB, INPDT, INPTM, INPMN)	
		VALUES (#{COMPS}, ${SHPDT}, ${TRKNO}, ${CUSNO}, ${SHPNO}, #{PRTNO}, ${DUEDT}, 
			#{CORNO},  #{CPRTN}, ${SHPQY}, ${GATCD}, ${TRACD}, ${CHASU}, #{TRAGB},
				REPLACE(CHAR(DATE(current date), ISO), '-', ''), REPLACE(CHAR(time(current time), ISO), '.', ''), #{INPMN})
	</insert>
	<update id="updateFSAZ150List" parameterType="java.util.HashMap">
		UPDATE ${LIB2}.FSA150PF
		SET GATCD=${GATCD},
			TRACD=${TRACD},
			CHASU=${CHASU},
			INPDT=REPLACE(CHAR(DATE(current date), ISO), '-', ''),
			INPTM=REPLACE(CHAR(time(current time), ISO), '.', ''),
			INPMN=#{INPMN}
		WHERE
			COMPS=#{COMPS} AND SHPDT=${SHPDT} AND TRKNO=${TRKNO} AND CUSNO=${CUSNO} AND SHPNO=${SHPNO}
			AND PRTNO=#{PRTNO} AND DUEDT=${DUEDT} AND CORNO=#{CORNO} AND CPRTN=#{CPRTN}
	</update>
	<delete id="deleteFSAZ150List" parameterType="java.util.HashMap">
		DELETE FROM ${LIB2}.FSA150PF
		WHERE
			COMPS=#{COMPS} AND SHPDT=${SHPDT} AND TRKNO=${TRKNO} AND CUSNO=${CUSNO} AND SHPNO=${SHPNO}
			AND PRTNO=#{PRTNO} AND DUEDT=${DUEDT} AND CORNO=#{CORNO} AND CPRTN=#{CPRTN}
	</delete>
	<select id="selectFSAZ151List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT
		A.TRKNO, A.CUSNO, A.SHPDT, A.PRFLG,
		TRIM(B.PRTNO) AS PRTNO, B.SHPQY, TRIM(C.ITDSC) AS ITDSC,
		TRIM(COALESCE(D.GATCD,0)) AS GATCD, COALESCE(D.TRACD,0) AS TRACD, COALESCE(D.CHASU, 0) AS CHASU,
		COALESCE(E.TIMES,0) AS TIMES, COALESCE(E.TIMEE,0) AS TIMEE, COALESCE(F.FTIMS,0) AS FTIMS, COALESCE(F.FTIME,0) AS FTIME,
		B.SHPNO, B.DUEDT, B.CORNO, B.CPRTN
	FROM
		${LIB1}.HD066PR A
		LEFT OUTER JOIN ${LIB1}.HD067PR B ON A.TRKNO=B.TRKNO
		LEFT OUTER JOIN ${LIB1}.BM008PR C ON B.PRTNO=C.ITNBR
		LEFT OUTER JOIN ${LIB2}.FSA150PF D ON D.COMPS=#{COMPS} AND A.SHPDT=D.SHPDT 
			AND B.TRKNO=D.TRKNO AND B.CUSNO=D.CUSNO AND B.SHPNO=D.SHPNO AND B.PRTNO=D.PRTNO
			AND B.DUEDT=D.DUEDT AND B.CORNO=D.CORNO AND B.CPRTN=D.CPRTN
		LEFT OUTER JOIN ${LIB2}.FSA130PF E ON E.COMPS=#{COMPS} AND D.GATCD=E.GATCD
			AND D.TRACD=E.TRACD	AND D.CHASU=E.CHASU AND E.DAYCD=#{DAYCD}
			AND E.STYMD=(SELECT MAX(STYMD) AS STYMD
						FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=D.GATCD AND TRACD=D.TRACD)
		LEFT OUTER JOIN ${LIB2}.FSA140PF F ON F.COMPS=#{COMPS} AND D.GATCD=F.GATCD AND D.TRACD=F.TRACD
			AND D.CHASU=F.CHASU AND A.SHPDT=F.WKYMD
	WHERE
		A.PRFLG !=4
		AND A.SHPDT=${SHPDT}
		AND C.PACKC=#{COMPS}
	ORDER BY A.TRKNO
	</select>
	<select id="selectFSAZ160QList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT 
		A.COMPS, A.STYMD, A.GATCD, DIGITS(A.TRACD) AS TRACD, A.DAYCD,
		<!-- 
		A.CHA11S, A.CHA11E, TRIM(COALESCE(B.CHA12S,'')) AS CHA12S, TRIM(COALESCE(B.CHA12E,'')) AS CHA12E, B.TRUCD1, B.TRUTN1,
		A.CHA21S, A.CHA21E, TRIM(COALESCE(B.CHA22S,'')) AS CHA22S, TRIM(COALESCE(B.CHA22E,'')) AS CHA22E, B.TRUCD2, B.TRUTN2,
		A.CHA31S, A.CHA31E, TRIM(COALESCE(B.CHA32S,'')) AS CHA32S, TRIM(COALESCE(B.CHA32E,'')) AS CHA32E, B.TRUCD3, B.TRUTN3,
		A.CHA41S, A.CHA41E, TRIM(COALESCE(B.CHA42S,'')) AS CHA42S, TRIM(COALESCE(B.CHA42E,'')) AS CHA42E, B.TRUCD4, B.TRUTN4,
		A.CHA51S, A.CHA51E, TRIM(COALESCE(B.CHA52S,'')) AS CHA52S, TRIM(COALESCE(B.CHA52E,'')) AS CHA52E, B.TRUCD5, B.TRUTN5,
		A.CHA61S, A.CHA61E, TRIM(COALESCE(B.CHA62S,'')) AS CHA62S, TRIM(COALESCE(B.CHA62E,'')) AS CHA62E, B.TRUCD6, B.TRUTN6,
		A.CHA71S, A.CHA71E, TRIM(COALESCE(B.CHA72S,'')) AS CHA72S, TRIM(COALESCE(B.CHA72E,'')) AS CHA72E, B.TRUCD7, B.TRUTN7,
		A.CHA81S, A.CHA81E, TRIM(COALESCE(B.CHA82S,'')) AS CHA82S, TRIM(COALESCE(B.CHA82E,'')) AS CHA82E, B.TRUCD8, B.TRUTN8,
		A.CHA91S, A.CHA91E, TRIM(COALESCE(B.CHA92S,'')) AS CHA92S, TRIM(COALESCE(B.CHA92E,'')) AS CHA92E, B.TRUCD9, B.TRUTN9,
		A.CHA101S, A.CHA101E, TRIM(COALESCE(B.CHA102S,'')) AS CHA102S, TRIM(COALESCE(B.CHA102E,'')) AS CHA102E, B.TRUCD10, B.TRUTN10
		-->
		A.CHA11S, A.CHA11E, TRIM(COALESCE(B.CHA12S,'')) AS CHA12S, TRIM(COALESCE(B.CHA12E,'')) AS CHA12E, B.TRUCD1 ||' '|| B.TRUTN1||'T' AS TRUCD1,
		A.CHA21S, A.CHA21E, TRIM(COALESCE(B.CHA22S,'')) AS CHA22S, TRIM(COALESCE(B.CHA22E,'')) AS CHA22E, B.TRUCD2 ||' '|| B.TRUTN2||'T' AS TRUCD2,
		A.CHA31S, A.CHA31E, TRIM(COALESCE(B.CHA32S,'')) AS CHA32S, TRIM(COALESCE(B.CHA32E,'')) AS CHA32E, B.TRUCD3 ||' '|| B.TRUTN3||'T' AS TRUCD3,
		A.CHA41S, A.CHA41E, TRIM(COALESCE(B.CHA42S,'')) AS CHA42S, TRIM(COALESCE(B.CHA42E,'')) AS CHA42E, B.TRUCD4 ||' '|| B.TRUTN4||'T' AS TRUCD4,
		A.CHA51S, A.CHA51E, TRIM(COALESCE(B.CHA52S,'')) AS CHA52S, TRIM(COALESCE(B.CHA52E,'')) AS CHA52E, B.TRUCD5 ||' '|| B.TRUTN5||'T' AS TRUCD5,
		A.CHA61S, A.CHA61E, TRIM(COALESCE(B.CHA62S,'')) AS CHA62S, TRIM(COALESCE(B.CHA62E,'')) AS CHA62E, B.TRUCD6 ||' '|| B.TRUTN6||'T' AS TRUCD6,
		A.CHA71S, A.CHA71E, TRIM(COALESCE(B.CHA72S,'')) AS CHA72S, TRIM(COALESCE(B.CHA72E,'')) AS CHA72E, B.TRUCD7 ||' '|| B.TRUTN7||'T' AS TRUCD7,
		A.CHA81S, A.CHA81E, TRIM(COALESCE(B.CHA82S,'')) AS CHA82S, TRIM(COALESCE(B.CHA82E,'')) AS CHA82E, B.TRUCD8 ||' '|| B.TRUTN8||'T' AS TRUCD8,
		A.CHA91S, A.CHA91E, TRIM(COALESCE(B.CHA92S,'')) AS CHA92S, TRIM(COALESCE(B.CHA92E,'')) AS CHA92E, B.TRUCD9 ||' '|| B.TRUTN9||'T' AS TRUCD9,
		A.CHA101S, A.CHA101E, TRIM(COALESCE(B.CHA102S,'')) AS CHA102S, TRIM(COALESCE(B.CHA102E,'')) AS CHA102E, B.TRUCD10 ||' '|| B.TRUTN10 AS TRUCD10
	FROM(
		SELECT
			A.COMPS, A.STYMD, A.GATCD, A.TRACD, A.DAYCD,
			MAX(CASE WHEN CHASU='1' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA11S,
			MAX(CASE WHEN CHASU='1' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA11E,
			MAX(CASE WHEN CHASU='2' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA21S,
			MAX(CASE WHEN CHASU='2' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA21E,
			MAX(CASE WHEN CHASU='3' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA31S,
			MAX(CASE WHEN CHASU='3' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA31E,
			MAX(CASE WHEN CHASU='4' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA41S,
			MAX(CASE WHEN CHASU='4' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA41E,
			MAX(CASE WHEN CHASU='5' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA51S,
			MAX(CASE WHEN CHASU='5' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA51E,
			
			MAX(CASE WHEN CHASU='6' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA61S,
			MAX(CASE WHEN CHASU='6' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA61E,
			MAX(CASE WHEN CHASU='7' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA71S,
			MAX(CASE WHEN CHASU='7' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA71E,
			MAX(CASE WHEN CHASU='8' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA81S,
			MAX(CASE WHEN CHASU='8' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA81E,
			MAX(CASE WHEN CHASU='9' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA91S,
			MAX(CASE WHEN CHASU='9' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA91E,
			MAX(CASE WHEN CHASU='10' THEN TRIM(CHAR(TIMES)) ELSE '' END) AS CHA101S,
			MAX(CASE WHEN CHASU='10' THEN TRIM(CHAR(TIMEE)) ELSE '' END) AS CHA101E
		FROM ${LIB2}.FSA130PF A
		WHERE
			A.COMPS=#{COMPS}
			AND A.GATCD=${GATCD}
			AND DAYCD=#{DAYCD}
			AND A.STYMD=(SELECT MAX(STYMD) AS STYMD
						FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=${GATCD} AND DAYCD=#{DAYCD})
			AND A.TRACD IN(SELECT TRACD FROM ${LIB2}.FSA110PF WHERE COMPS = #{COMPS} AND USETF='1')
		GROUP BY A.COMPS, A.STYMD, A.GATCD, A.TRACD, A.DAYCD) A
	LEFT OUTER JOIN (
		SELECT
			Z.COMPS, Z.WKYMD, Z.GATCD, Z.TRACD,
			MAX(CASE WHEN Z.CHASU='1' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA12S,
			MAX(CASE WHEN Z.CHASU='1' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA12E,
			MAX(CASE WHEN Z.CHASU='1' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD1,
			MAX(CASE WHEN Z.CHASU='1' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN1,
			MAX(CASE WHEN Z.CHASU='2' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA22S,
			MAX(CASE WHEN Z.CHASU='2' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA22E,
			MAX(CASE WHEN Z.CHASU='2' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD2,
			MAX(CASE WHEN Z.CHASU='2' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN2,			
			MAX(CASE WHEN Z.CHASU='3' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA32S,
			MAX(CASE WHEN Z.CHASU='3' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA32E,
			MAX(CASE WHEN Z.CHASU='3' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD3,
			MAX(CASE WHEN Z.CHASU='3' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN3,
			MAX(CASE WHEN Z.CHASU='4' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA42S,
			MAX(CASE WHEN Z.CHASU='4' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA42E,
			MAX(CASE WHEN Z.CHASU='4' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD4,
			MAX(CASE WHEN Z.CHASU='4' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN4,
			MAX(CASE WHEN Z.CHASU='5' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA52S,
			MAX(CASE WHEN Z.CHASU='5' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA52E,
			MAX(CASE WHEN Z.CHASU='5' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD5,
			MAX(CASE WHEN Z.CHASU='5' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN5,

			MAX(CASE WHEN Z.CHASU='6' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA62S,
			MAX(CASE WHEN Z.CHASU='6' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA62E,
			MAX(CASE WHEN Z.CHASU='6' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD6,
			MAX(CASE WHEN Z.CHASU='6' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN6,
			MAX(CASE WHEN Z.CHASU='7' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA72S,
			MAX(CASE WHEN Z.CHASU='7' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA72E,
			MAX(CASE WHEN Z.CHASU='7' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD7,
			MAX(CASE WHEN Z.CHASU='7' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN7,
			MAX(CASE WHEN Z.CHASU='8' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA82S,
			MAX(CASE WHEN Z.CHASU='8' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA82E,
			MAX(CASE WHEN Z.CHASU='8' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD8,
			MAX(CASE WHEN Z.CHASU='8' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN8,
			MAX(CASE WHEN Z.CHASU='9' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA92S,
			MAX(CASE WHEN Z.CHASU='9' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA92E,
			MAX(CASE WHEN Z.CHASU='9' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD9,
			MAX(CASE WHEN Z.CHASU='9' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN9,
			MAX(CASE WHEN Z.CHASU='10' THEN TRIM(CHAR(Z.FTIMS)) ELSE '' END) AS CHA102S,
			MAX(CASE WHEN Z.CHASU='10' THEN TRIM(CHAR(Z.FTIME)) ELSE '' END) AS CHA102E,
			MAX(CASE WHEN Z.CHASU='10' THEN TRIM(CHAR(Z.TRUCD)) ELSE NULL END) AS TRUCD10,
			MAX(CASE WHEN Z.CHASU='10' THEN TRIM(CHAR(Y.TRUTN)) ELSE NULL END) AS TRUTN10
		FROM ${LIB2}.FSA140PF Z
		LEFT OUTER JOIN ${LIB2}.FSA120PF Y ON Z.TRUCD=Y.TRUCD
		WHERE
			Z.GATCD=${GATCD}
			AND Z.WKYMD=${WKYMD}
		GROUP BY Z.COMPS, Z.WKYMD, Z.GATCD, Z.TRACD
		) B ON A.COMPS=B.COMPS AND A.GATCD=B.GATCD AND A.TRACD=B.TRACD
	ORDER BY A.COMPS, A.STYMD, A.GATCD, A.TRACD, A.DAYCD
	</select>
	<select id="selectFSAZ160Q_PList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT 
		A.COMPS, A.STYMD, A.GATCD, A.TRACD, TRIM(C.TRANM) AS TRANM, A.DAYCD, A.CHASU, A.TIMES, A.TIMEE,
		SUBSTR(REPEAT('0', 4-LENGTH(TRIM(CHAR(A.TIMES)))) || A.TIMES,1,2) || ':'||
		SUBSTR(REPEAT('0', 4-LENGTH(TRIM(CHAR(A.TIMES)))) || A.TIMES,3,2) || '~'||
		SUBSTR(REPEAT('0', 4-LENGTH(TRIM(CHAR(A.TIMEE)))) || A.TIMEE,1,2) || ':'||
		SUBSTR(REPEAT('0', 4-LENGTH(TRIM(CHAR(A.TIMEE)))) || A.TIMEE,3,2) AS P_TIME,
		<!-- B.TRUCD,-->
		CASE WHEN LENGTH(TRIM(B.TRUCD))!=0 THEN TRIM(B.TRUCD) || ' ' || TRIM(Y.TRMAN) ELSE '' END AS TRUCD,
		B.FTIMS, B.FTIME,		
		COALESCE(SUBSTR(REPEAT('0', 4-LENGTH(TRIM(CHAR(B.FTIMS)))) || B.FTIMS,1,2) || ':'||
		SUBSTR(REPEAT('0', 4-LENGTH(TRIM(CHAR(B.FTIMS)))) || B.FTIMS,3,2) || '~'||
		SUBSTR(REPEAT('0', 4-LENGTH(TRIM(CHAR(B.FTIME)))) || B.FTIME,1,2) || ':'||
		SUBSTR(REPEAT('0', 4-LENGTH(TRIM(CHAR(B.FTIME)))) || B.FTIME,3,2),'') AS S_TIME
	FROM
		${LIB2}.FSA130PF A
		LEFT OUTER JOIN ${LIB2}.FSA140PF B ON A.COMPS=B.COMPS AND A.GATCD=B.GATCD AND A.TRACD=B.TRACD AND A.CHASU=B.CHASU AND B.WKYMD=${DATE}
		<!-- 		
		LEFT OUTER JOIN ${LIB2}.FSA140PF B ON A.COMPS=B.COMPS AND A.GATCD=B.GATCD AND A.TRACD=B.TRACD AND A.CHASU=B.CHASU AND B.WKYMD=20151216
		 -->
		LEFT OUTER JOIN ${LIB2}.FSA110PF C ON A.COMPS=C.COMPS AND A.TRACD=C.TRACD
		LEFT OUTER JOIN (SELECT * FROM ${LIB2}.FSA120PF WHERE COMPS=#{COMPS}) Y ON B.TRUCD=Y.TRUCD
	WHERE
		A.COMPS=#{COMPS}
		AND A.GATCD=${GATCD}
		AND A.DAYCD=#{DAYCD}
		<!-- 
		AND A.DAYCD='4'
		 --> 		
 		<!-- 계획시작시간기준
 		AND A.TIMES>=${P_TIME}
 		-->
 		<!-- 
 		AND A.TIMEE>=${P_TIME}
 		-->
 		<if test="!@org.springframework.util.StringUtils@isEmpty(P_TIME)"> AND A.TIMEE>=${P_TIME} </if>
		AND A.STYMD=(SELECT MAX(STYMD) AS STYMD
					FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=${GATCD})
	ORDER BY TIMES
	</select>	
	<select id="selectSC008PRList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT 
			*
		FROM 
			${LIB1}.SC008PR 
			<if test="!@org.springframework.util.StringUtils@isEmpty(DTANO)"> WHERE DTANO = #{DTANO} </if>
	</select>
<!-- DEL 2016.03.22	
	<select id="selectFSAZ170QList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT
		A.COMPS, A.WKYMD, DIGITS(A.TRACD) AS TRACD, TRIM(B.TRANM) AS TRANM,
		A.GATCD, TRIM(G.GATNM) AS GATNM, A.CHASU, A.FTIMS, A.FTIME, 
		C.TRKNO, C.CUSNO, C.PRTNO,
		TRIM(D.ITDSC) AS ITDSC, D.ITCLS, TRIM(E.MSTRM) AS MSTRM, TRIM(E.MSTSM) AS MSTSM,
		F.SHPQY, F.SHDQY, COALESCE(H.MOHTQ1,0) AS MOHTQ1, COALESCE(I.MOHTQ2,0) AS MOHTQ2,
		COALESCE(H.MOHTQ1,0)+COALESCE(I.MOHTQ2,0) AS MOH_TOT, COALESCE(J.SM0QY,0) AS SM0QY,
		DECIMAL(COALESCE(J.SM0QY,0)/K.WKDAY) AS DAYSM, K.WKDAY,
		CASE WHEN DECIMAL(COALESCE(J.SM0QY,0)/K.WKDAY) != 0 THEN
		(COALESCE(H.MOHTQ1,0)+COALESCE(I.MOHTQ2,0))/(DECIMAL(COALESCE(J.SM0QY,0)/K.WKDAY)) 
		ELSE COALESCE(H.MOHTQ1,0)+COALESCE(I.MOHTQ2,0) END AS STDAY
	FROM
		${LIB2}.FSA140PF A
		LEFT OUTER JOIN ${LIB2}.FSA110PF B ON A.COMPS=B.COMPS AND A.TRACD=B.TRACD	
		LEFT OUTER JOIN (
			SELECT A.COMPS, A.SHPDT, A.TRKNO, A.CUSNO, A.PRTNO, A.GATCD, A.TRACD, A.CHASU
			FROM ${LIB2}.FSA150PF A
			WHERE A.COMPS=#{COMPS} AND A.SHPDT=#{SHPDT}
			GROUP BY A.COMPS, A.SHPDT, A.TRKNO, A.CUSNO, A.PRTNO, A.GATCD, A.TRACD, A.CHASU
		) C ON A.WKYMD=C.SHPDT AND A.GATCD=C.GATCD AND A.TRACD=C.TRACD AND A.CHASU=C.CHASU
		LEFT OUTER JOIN ${LIB1}.BM008PR D ON C.PRTNO=D.ITNBR
		LEFT OUTER JOIN ${LIB2}.MST050PF E ON A.COMPS=E.COMPS AND E.GRPCD='PRD' AND SUBSTR(D.ITCLS,1,1)=E.MSTCD
		LEFT OUTER JOIN (
			SELECT TRKNO, CUSNO, PRTNO, SUM(SHPQY) AS SHPQY,  SUM(SHDQY) AS SHDQY FROM ${LIB1}.ED005PR
			GROUP BY TRKNO, CUSNO, PRTNO)
		F ON C.TRKNO=F.TRKNO AND C.CUSNO=F.CUSNO AND C.PRTNO=F.PRTNO
		LEFT OUTER JOIN ${LIB2}.FSA100PF G ON A.COMPS=G.COMPS AND A.GATCD=G.GATCD
		LEFT OUTER JOIN (
			SELECT ITNBR, HOUSE, SUM(MOHTQ) AS MOHTQ1 FROM ${LIB1}.HM000PR
			WHERE HOUSE=#{HOUSE1}
			GROUP BY ITNBR, HOUSE
		) H ON C.PRTNO=H.ITNBR
		LEFT OUTER JOIN (
			SELECT ITNBR, HOUSE, SUM(MOHTQ) AS MOHTQ2 FROM ${LIB1}.HM000PR
			WHERE HOUSE IN ${HOUSE2}
			GROUP BY ITNBR, HOUSE
		) I ON C.PRTNO=I.ITNBR
		//!
			LEFT OUTER JOIN (
			SELECT 
			A.COMPS, A.PLNYM, A.PYVND, A.PSPNO, A.SM0QY
			FROM ${LIB2}.SPM110PF A
			WHERE
			A.COMPS=#{COMPS} AND A.PLNYM=${PLNYM}
		) J ON A.COMPS=J.COMPS AND C.CUSNO=J.PYVND AND C.PRTNO=J.PSPNO
		 //
		LEFT OUTER JOIN (
			SELECT 
			A.PLTCD, A.PLNYM, A.PYVND, A.PSPNO, A.SM0QY
			FROM ${LIB2}.SPM110PF A
			WHERE
			A.PLTCD= #{COMPS} AND A.PLNYM=${PLNYM} 
		) J ON A.COMPS=J.PLTCD AND C.CUSNO=J.PYVND AND C.PRTNO=J.PSPNO
		LEFT OUTER JOIN (
			SELECT 
			A.WKDAY, A.MPPDT
			FROM ${LIB1}.SC003PR A
			WHERE 
			A.PRMNO=#{PRMNO}
			AND A.YRMON=${PLNYM}
		) K ON 1=1
	WHERE
		A.COMPS=#{COMPS}
		AND A.WKYMD=#{SHPDT}
	</select>
 -->	
	<select id="selectFSAZ170QList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT
		A.COMPS, A.SHPDT, DIGITS(A.TRACD) AS TRACD, TRIM(B.TRANM) AS TRANM,
		A.GATCD, 
		TRIM(G.GATNM) AS GATNM, A.CHASU, C.TIMES, C.TIMEE,
		A.TRKNO, A.CUSNO, A.PRTNO,
		TRIM(D.ITDSC) AS ITDSC, D.ITCLS, TRIM(E.MSTRM) AS MSTRM, TRIM(E.MSTSM) AS MSTSM,
		<!-- F.SHPQY, F.SHDQY,                 2016-11-09 CHANGE -->
		CASE WHEN A.TRAGB='O' THEN F.SHPQY <!-- OEM출하 -->
		     WHEN A.TRAGB='M' THEN F1.SHPQY <!-- 이동품 -->
		     ELSE 0 END SHPQY,
		CASE WHEN A.TRAGB='O' THEN F.SHDQY <!-- OEM출하 -->
		     WHEN A.TRAGB='M' THEN F1.SHDQY <!-- 이동품 -->
		     ELSE 0 END SHDQY, 
		COALESCE(H.MOHTQ1,0) AS MOHTQ1, COALESCE(I.MOHTQ2,0) AS MOHTQ2,
		COALESCE(H.MOHTQ1,0)+COALESCE(I.MOHTQ2,0) AS MOH_TOT, COALESCE(J.SM0QY,0) AS SM0QY,
		DECIMAL(COALESCE(J.SM0QY,0)/K.WKDAY) AS DAYSM, K.WKDAY,
		CASE WHEN DECIMAL(COALESCE(J.SM0QY,0)/K.WKDAY) != 0 THEN
		(COALESCE(H.MOHTQ1,0)+COALESCE(I.MOHTQ2,0))/(DECIMAL(COALESCE(J.SM0QY,0)/K.WKDAY)) 
		ELSE COALESCE(H.MOHTQ1,0)+COALESCE(I.MOHTQ2,0) END AS STDAY
	FROM
		(SELECT A.COMPS, A.SHPDT, A.TRKNO, A.CUSNO, A.PRTNO, A.GATCD, A.TRACD, A.CHASU, A.TRAGB
			FROM ${LIB2}.FSA150PF A
			WHERE A.COMPS=#{COMPS} AND A.SHPDT=#{SHPDT}
			GROUP BY A.COMPS, A.SHPDT, A.TRKNO, A.CUSNO, A.PRTNO, A.GATCD, A.TRACD, A.CHASU, A.TRAGB
		) A
		LEFT OUTER JOIN ${LIB2}.FSA110PF B ON A.COMPS=B.COMPS AND A.TRACD=B.TRACD
		LEFT OUTER JOIN ${LIB2}.FSA130PF C ON A.COMPS=C.COMPS AND A.GATCD=C.GATCD
			AND A.TRACD=C.TRACD	AND A.CHASU=C.CHASU AND C.DAYCD=#{DAYCD}
			AND C.STYMD=(SELECT MAX(STYMD) AS STYMD
			FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=C.GATCD AND TRACD=C.TRACD AND STYMD <![CDATA[<=]]> ${SHPDT} )
		LEFT OUTER JOIN ${LIB1}.BM008PR D ON A.PRTNO=D.ITNBR
		LEFT OUTER JOIN ${LIB2}.MST050PF E ON A.COMPS=E.COMPS AND E.GRPCD='PRD' AND SUBSTR(D.ITCLS,1,1)=E.MSTCD
		LEFT OUTER JOIN (
			SELECT TRKNO, CUSNO, PRTNO, SUM(SHPQY) AS SHPQY,  SUM(SHDQY) AS SHDQY FROM ${LIB1}.ED005PR
			GROUP BY TRKNO, CUSNO, PRTNO)
		F ON A.TRKNO=F.TRKNO AND A.CUSNO=F.CUSNO AND A.PRTNO=F.PRTNO
		LEFT OUTER JOIN (
			SELECT TRKNO, CUSNO, PRTNO, SUM(SHPQY) AS SHPQY,  SUM(SHDQY) AS SHDQY FROM ${LIB1}.HD067PR
			GROUP BY TRKNO, CUSNO, PRTNO)
		F1 ON A.TRKNO=F1.TRKNO AND A.CUSNO=F1.CUSNO AND A.PRTNO=F1.PRTNO   <!-- 2016-11-09 INSERT -->
		LEFT OUTER JOIN ${LIB2}.FSA100PF G ON A.COMPS=G.COMPS AND A.GATCD=G.GATCD
		LEFT OUTER JOIN (
			SELECT ITNBR, HOUSE, SUM(MOHTQ) AS MOHTQ1 FROM ${LIB1}.HM000PR
			WHERE HOUSE=#{HOUSE1}
			GROUP BY ITNBR, HOUSE
		) H ON A.PRTNO=H.ITNBR
		LEFT OUTER JOIN (
			SELECT ITNBR, HOUSE, SUM(MOHTQ) AS MOHTQ2 FROM ${LIB1}.HM000PR
			WHERE HOUSE IN ${HOUSE2}
			GROUP BY ITNBR, HOUSE
		) I ON A.PRTNO=I.ITNBR
		LEFT OUTER JOIN (
			SELECT 
			A.PLTCD, A.PLNYM, A.PYVND, A.PSPNO, A.SM0QY
			FROM ${LIB2}.SPM110PF A
			WHERE
			A.PLTCD= #{COMPS} AND A.PLNYM=${PLNYM} 
		) J ON A.COMPS=J.PLTCD AND A.CUSNO=J.PYVND AND A.PRTNO=J.PSPNO
		LEFT OUTER JOIN (
			SELECT 
			A.WKDAY, A.MPPDT
			FROM ${LIB1}.SC003PR A
			WHERE 
			A.PRMNO=#{PRMNO}
			AND A.YRMON=${PLNYM}
		) K ON 1=1
	<if test="!@org.springframework.util.StringUtils@isEmpty(P_TIME)"> WHERE C.TIMEE>=${P_TIME} </if>
	ORDER BY C.TIMES, A.CHASU, A.PRTNO
	</select>
	<select id="selectFSAZ180QList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			A.COMPS, A.SHPDT, A.TRKNO, A.CUSNO, A.SHPNO, A.PRTNO, A.DUEDT, A.CORNO, A.CPRTN, A.SHPQY, A.GATCD, A.TRACD, A.CHASU,
			TRIM(B.ITDSC) AS ITDSC,
			C.TIMES, C.TIMEE, COALESCE(CHAR(D.FTIMS),'') AS FTIMS, COALESCE(CHAR(D.FTIME),'') AS FTIME
<!-- 			0 AS TIMES, 0 AS TIMEE, 0 AS FTIMS, 0 AS FTIME
 -->
 		FROM
			${LIB2}.FSA150PF A
			LEFT OUTER JOIN ${LIB1}.BM008PR B ON A.PRTNO=B.ITNBR
			<!-- 이력조회이기때문에 계획날짜는 조회일자보다 작은것중에 큰거 -->
			LEFT OUTER JOIN ${LIB2}.FSA130PF C ON A.COMPS=C.COMPS AND A.GATCD=C.GATCD
				AND A.TRACD=C.TRACD	AND A.CHASU=C.CHASU AND C.DAYCD=#{DAYCD}
				AND C.STYMD=(SELECT MAX(STYMD) AS STYMD
							FROM ${LIB2}.FSA130PF WHERE COMPS=#{COMPS} AND GATCD=C.GATCD AND TRACD=C.TRACD AND STYMD <![CDATA[<=]]> ${SHPDT} )
			LEFT OUTER JOIN ${LIB2}.FSA140PF D ON A.COMPS=D.COMPS AND A.GATCD=D.GATCD AND A.TRACD=D.TRACD
				AND A.CHASU=D.CHASU AND A.SHPDT=D.WKYMD
		WHERE
			A.COMPS=#{COMPS} AND A.SHPDT=${SHPDT}
		ORDER BY A.TRKNO
	</select>

</mapper>