<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.denso.mapper.BudgetMapper">

	<select id="selectMIZZXXXList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			*
		FROM
			PSZDBLIB.${PFFILE}
		<if test="WHERE != ''"> 
		WHERE ${WHERE}
		</if>
		<if test="ORDERBY != ''">
		ORDER BY ${ORDERBY}
		</if>	
	</select>
	
	<select id="selectMST650PFList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			*
		FROM
			${LIB9}.MST650PF
		<where>
			DPCOMP=#{COMPS}
			<if test="COMPS != 'E1'">
			AND DPEDSW='T'
			</if>
			<if test="DPTCD != null">
			AND DPCODE = #{DPTCD}
			</if>
		</where>	
	</select>
		
	<select id="selectCategoryList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			DISTINCT SUBSTR(CATNO,2,2) CD , TRIM(CATNM1) CDNM
		FROM
			PSZDBLIB.MIZ220PF
	</select>
	
	<select id="selectMIZZ220List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			TRIM(CATNO) AS CATNO,TRIM(CATNM1) AS CATNM1,TRIM(CATNM2) AS CATNM2,TRIM(CATNM3) AS CATNM3,
			MAGGB,MATGB,PERGB,SEQNO,CFRDT,CTODT,
			TRIM(SPACE1) AS SPACE1,TRIM(SPACE2) AS SPACE2,TRIM(SPACE3) AS SPACE3,
			SUBSTR(CATNO,2,2) GCD	
		FROM
			PSZDBLIB.MIZ220PF
		<if test="CATNO != null">
		WHERE
			CATNO=#{CATNO}
		</if>
		ORDER BY
			CATNO
	</select>
	<select id="selectMIZZ220Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			PSZDBLIB.MIZ220PF
		WHERE
			CATNO=#{CATNO}
	</select>
	<insert id="insertMIZZ220List" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ220PF
		VALUES (#{CATNO}, #{CATNM1}, #{CATNM2}, #{CATNM3}, #{MAGGB}, #{MATGB}, #{PERGB}, #{SEQNO}, ${CFRDT}, ${CTODT},
		        '','','', #{BIIGO} )
	</insert>
	<update id="updateMIZZ220List" parameterType="java.util.HashMap">
		UPDATE PSZDBLIB.MIZ220PF
		SET CATNM1=#{CATNM1},
			CATNM2=#{CATNM2},
			CATNM3=#{CATNM3},
			MAGGB=#{MAGGB},
			MATGB=#{MATGB},
			PERGB=#{PERGB},
			SEQNO=#{SEQNO},
			CFRDT=${CFRDT},
			CTODT=${CTODT},
			BIIGO=#{BIIGO}
		WHERE CATNO=#{CATNO}
	</update>
	
	<select id="selectMIZZ221List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			VNDNR,TRIM(VNDNM) AS VNDNM,TRIM(R2214) AS R2214
		FROM
			PSZDBLIB.MIZ221PF
		<if test="VNDNR != null">
		WHERE
			VNDNR >= '${VNDNR}'
		</if>
		ORDER BY
			VNDNR
	</select>
	<select id="selectMIZZ221Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			PSZDBLIB.MIZ221PF
		WHERE
			VNDNR=#{VNDNR}
	</select>
	<insert id="insertMIZZ221List" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ221PF
		VALUES (#{VNDNR}, #{VNDNM},'','','', #{R2214})
	</insert>
	<update id="updateMIZZ221List" parameterType="java.util.HashMap">
		UPDATE PSZDBLIB.MIZ221PF
		SET VNDNM=#{VNDNM},
			R2214=#{R2214}
		WHERE VNDNR=#{VNDNR}
	</update>
	
	<select id="selectMIZZ222List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			A.GRCOM,TRIM(A.CATNO) AS CATNO,TRIM(A.CMOBJ) AS CMOBJ,TRIM(A.CMSUB) AS CMSUB,TRIM(A.CMMCU) AS CMMCU,TRIM(A.R2224) AS R2224,SUBSTR(A.CATNO,2,2) GCD,
			E.GMDL01,B.CATNM1,B.CATNM2,B.CATNM3
		FROM
			PSZDBLIB.MIZ222PF A
			LEFT OUTER JOIN PSZDBLIB.MIZ220PF B ON A.CATNO=B.CATNO
			LEFT OUTER JOIN (SELECT * FROM ${LIB99}.F0901 WHERE GMMCU='   MODEL ALL' AND GMOBJ BETWEEN '90000' AND '99999')E ON A.CMOBJ=E.GMOBJ AND A.CMSUB=E.GMSUB
		WHERE
			GRCOM=#{GRCOM} 
		<if test="CATNO != null">
			AND CATNO=#{CATNO}
		</if>
		ORDER BY
			CATNO
	</select>
	<select id="selectMIZZ222Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			PSZDBLIB.MIZ222PF
		WHERE
			GRCOM=#{GRCOM} AND CATNO=#{CATNO}
	</select>
	<insert id="insertMIZZ222List" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ222PF
		VALUES (#{GRCOM}, #{CATNO}, #{CMOBJ}, #{CMSUB}, #{CMMCU},'','','', #{R2224})
	</insert>
	<update id="updateMIZZ222List" parameterType="java.util.HashMap">
		UPDATE PSZDBLIB.MIZ222PF
		SET CMOBJ=#{CMOBJ},CMSUB=#{CMSUB},CMMCU=#{CMMCU},R2224=#{R2224}
		WHERE GRCOM=#{GRCOM} AND CATNO=#{CATNO}
	</update>
	<select id="selectMIZZ222_KYList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			GMDL01
		FROM
			${LIB99}.F0901 
		WHERE
			GMMCU='   MODEL ALL' 
			AND GMOBJ BETWEEN '90000' AND '99999'
			AND GMOBJ='${CMOBJ}' AND GMSUB='${CMSUB}'
	</select>
	
	<select id="selectMIZZ230List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			*
		FROM
			PSZDBLIB.MIZ230PF
		WHERE
			COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{CATGB}
	</select>
	
	<insert id="insertMIZZ230List" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ230PF VALUES(#{COMPS},${CATYY},#{CATGB},REPLACE(CHAR(DATE(current date), ISO), '-', ''),#{USERID},'','','')
	</insert>
	
	<insert id="insertMIZZ229UCList" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ229PF
		SELECT
			COMPS,${CATYY},'${CATGB}',CATNO,DPTCD,VNDNR,COMPE,NEWIT,
			0,0,0,0,0,0,0,0,0,0,0,0,0,0,
			REPLACE(CHAR(DATE(current date), ISO), '-', ''),'${USERID}','',''
		FROM
			PSZDBLIB.MIZ239PF
		<where> 
			<if test="COMPS != ''"> COMPS='${COMPS}'</if> 
			AND CATYY=${CATGB_YYYY}
			AND CATGB='${CATGB_TARGET}' 
			AND DPTCD='${DPTCD}'
		</where>
	</insert>
	<insert id="insertMIZZ229UC_P1_List" parameterType="java.util.HashMap">
	
	INSERT INTO PSZDBLIB.MIZ229PF
	SELECT
		'${COMPS}',${CATYY},'${CATGB}',A.CATNO,'${DPTCD}', <!-- 'S1',2016,'P1',A.CATNO,'2204',  -->
		CASE WHEN B.VNDNR IS NULL THEN C.VNDNR ELSE B.VNDNR END,
		CASE WHEN B.COMPE IS NULL THEN C.COMPE ELSE B.COMPE END,
		CASE WHEN B.NEWIT IS NULL THEN C.NEWIT ELSE B.NEWIT END,
		CASE WHEN B.CATQY IS NULL THEN C.CATQY ELSE B.CATQY END,
		A.AMT04T+A.AMT05T+A.AMT06T+A.AMT07T+A.AMT08T+A.AMT09T+A.AMT10T+A.AMT11T+A.AMT12T+A.AMT01T+A.AMT02T+A.AMT03T,
		A.AMT04T,A.AMT05T,A.AMT06T,A.AMT07T,A.AMT08T,A.AMT09T,A.AMT10T,A.AMT11T,A.AMT12T,A.AMT01T,A.AMT02T,A.AMT03T,
		REPLACE(CHAR(DATE(current date), ISO), '-', ''),'${USERID}','','TRANSMIT'
	FROM
		(
		SELECT
			CATNO,
			SUM(CASE WHEN X.GB='A0' THEN AMT04 ELSE 0 END) AMT04T,
			SUM(CASE WHEN X.GB='A0' THEN AMT05 ELSE 0 END) AMT05T,
			SUM(CASE WHEN X.GB='A0' THEN AMT06 ELSE 0 END) AMT06T,
			SUM(CASE WHEN X.GB='A0' THEN AMT07 ELSE 0 END) AMT07T,
			SUM(CASE WHEN X.GB='A0' THEN AMT08 ELSE 0 END) AMT08T,
			SUM(CASE WHEN X.GB='A0' THEN AMT09 ELSE 0 END) AMT09T, 
			SUM(CASE WHEN X.GB='P0' THEN AMT10 ELSE 0 END) AMT10T,
			SUM(CASE WHEN X.GB='P0' THEN AMT11 ELSE 0 END) AMT11T,
			SUM(CASE WHEN X.GB='P0' THEN AMT12 ELSE 0 END) AMT12T,
			SUM(CASE WHEN X.GB='P0' THEN AMT01 ELSE 0 END) AMT01T,
			SUM(CASE WHEN X.GB='P0' THEN AMT02 ELSE 0 END) AMT02T,
			SUM(CASE WHEN X.GB='P0' THEN AMT03 ELSE 0 END) AMT03T
		FROM 
			(SELECT 'A0' GB,A.* FROM PSZDBLIB.MIZ239PF A WHERE COMPS='${COMPS}' AND CATYY=${CATGB_YYYY} AND CATGB='A0' AND DPTCD='${DPTCD}'
			UNION ALL
			SELECT 'P0' GB,A.* FROM PSZDBLIB.MIZ239PF A WHERE COMPS='${COMPS}' AND CATYY=${CATGB_YYYY} AND CATGB='P0' AND DPTCD='${DPTCD}'
			)X
		GROUP BY 
			X.CATNO
		)A
		LEFT OUTER JOIN (SELECT * FROM PSZDBLIB.MIZ239PF WHERE COMPS='${COMPS}' AND CATYY=${CATGB_YYYY} AND CATGB='A0' AND DPTCD='${DPTCD}') B ON A.CATNO=B.CATNO
		LEFT OUTER JOIN (SELECT * FROM PSZDBLIB.MIZ239PF WHERE COMPS='${COMPS}' AND CATYY=${CATGB_YYYY} AND CATGB='P0' AND DPTCD='${DPTCD}') C ON A.CATNO=C.CATNO
	ORDER BY
		A.CATNO
<!-- 	
		INSERT INTO PSZDBLIB.MIZ229PF
		SELECT
			COMPS,${CATYY},'${CATGB}',CATNO,DPTCD,VNDNR,COMPE,NEWIT,
			CATQY,AMT04+AMT05+AMT06+AMT07+AMT08+AMT09,
			AMT04,AMT05,AMT06,AMT07,AMT08,AMT09,0,0,0,0,0,0,
			REPLACE(CHAR(DATE(current date), ISO), '-', ''),'${USERID}','',''
		FROM
			PSZDBLIB.MIZ239PF
		<where> 
			<if test="COMPS != ''"> COMPS='${COMPS}'</if> 
			AND CATYY=${CATGB_YYYY}
			AND CATGB='${CATGB_TARGET}' 
			AND DPTCD='${DPTCD}'
		</where>
 -->
	</insert>
	<delete id="deleteMIZZ229UPList" parameterType="java.util.HashMap">
		DELETE FROM PSZDBLIB.MIZ229PF
		<where> <if test="COMPS != ''"> COMPS=#{COMPS}</if> AND CATYY=${CATYY} AND CATGB=#{CATGB} AND DPTCD=#{DPTCD}</where>
	</delete>
	<insert id="insertMIZZ229UPList" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ229PF
		VALUES (#{COMPS},${CATYY},#{CATGB},#{CATNO},#{DPTCD},
				#{VNDNR},${COMPE},#{NEWIT},${CATQY},${CATAM},
				${AMT04},${AMT05},${AMT06},${AMT07},${AMT08},${AMT09},
				${AMT10},${AMT11},${AMT12},${AMT01},${AMT02},${AMT03},
				REPLACE(CHAR(DATE(current date), ISO), '-', ''),#{USERID},'',#{R2294})
	</insert>
	
	<select id="selectMIZZ229List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			A.COMPS,A.CATYY,A.CATGB,TRIM(A.CATNO) AS CATNO,TRIM(B.CATNM1) AS CATNM1,TRIM(B.CATNM2) AS CATNM2,TRIM(B.CATNM3) AS CATNM3,
			A.VNDNR,C.VNDNM,A.COMPE,A.NEWIT,
			A.CATQY,A.CATAM,A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03,
			TRIM(A.R2294) AS R2294	
		FROM
			PSZDBLIB.MIZ229PF A,PSZDBLIB.MIZ220PF B,PSZDBLIB.MIZ221PF C
		WHERE
			A.COMPS=#{COMPS} AND A.CATYY=${CATYY} AND A.CATGB=#{CATGB} AND A.DPTCD=#{DPTCD}
			AND A.CATNO=B.CATNO AND A.VNDNR=C.VNDNR
		ORDER BY
			CATNO
	</select>
	<select id="selectMIZZ229Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			PSZDBLIB.MIZ229PF
		WHERE
			COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{CATGB} AND CATNO=#{CATNO} AND DPTCD=#{DPTCD}
	</select>
	<insert id="insertMIZZ229List" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ229PF
		VALUES (#{COMPS},${CATYY},#{CATGB},#{CATNO},#{DPTCD},#{VNDNR},${COMPE},#{NEWIT},${CATQY},${CATAM},
				${AMT04},${AMT05},${AMT06},${AMT07},${AMT08},${AMT09},
				${AMT10},${AMT11},${AMT12},${AMT01},${AMT02},${AMT03},
				'','','',#{R2294})
	</insert>
	<update id="updateMIZZ229List" parameterType="java.util.HashMap">
		UPDATE PSZDBLIB.MIZ229PF
		SET VNDNR=#{VNDNR},
			COMPE=${COMPE},
			NEWIT=#{NEWIT},
			CATQY=${CATQY},
			CATAM=${CATAM},
			AMT04=${AMT04},
			AMT05=${AMT05},
			AMT06=${AMT06},
			AMT07=${AMT07},
			AMT08=${AMT08},
			AMT09=${AMT09},
			AMT10=${AMT10},
			AMT11=${AMT11},
			AMT12=${AMT12},
			AMT01=${AMT01},
			AMT02=${AMT02},
			AMT03=${AMT03},
			R2294=#{R2294}
		WHERE COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{CATGB} AND CATNO=#{CATNO} AND DPTCD=#{DPTCD}
	</update>
	<delete id="deleteMIZZ229List" parameterType="java.util.HashMap">
		DELETE FROM PSZDBLIB.MIZ229PF
		WHERE COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{CATGB} AND CATNO=#{CATNO} AND DPTCD=#{DPTCD}
	</delete>
	
	<select id="selectMIZZ229UList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			X.CATGR,X.CATNM1,COALESCE(Y.TARPE,0) TARPE, 
			SUM(X.CATAM) CATAM,
			SUM(CASE WHEN X.MAGGB='Y' THEN X.CATAM ELSE 0 END) CATAM_Y
			<!-- SUM(CASE WHEN X.CATAM_T != 0 THEN (X.CATAM*(100-COALESCE(Y.TARPE,0)))/100 ELSE 0 END) CATAM_TAR   -->
		FROM
			(SELECT
				SUBSTR(A.CATNO,1,3) CATGR, B.CATNM1,A.CATAM,B.MAGGB
			FROM
				PSZDBLIB.MIZ229PF A,PSZDBLIB.MIZ220PF B
			<where>
				<if test="COMPS != ''">
				A.COMPS=#{COMPS}
				</if> 
				AND A.CATYY=${CATYY} 
				AND A.CATGB=#{CATGB}
				AND A.CATNO=B.CATNO
			</where>
			) X
			LEFT OUTER JOIN 
			(SELECT CATGR,TARPE FROM PSZDBLIB.MIZ225PF 
				<where> 
				<if test="COMPS != ''"> COMPS=#{COMPS}</if> 
				<if test="COMPS == ''"> COMPS='E1'</if>
				AND CATYY=${CATYY} 
				AND CATGB=#{CATGB_TARGET} 
				</where>) Y
			ON X.CATGR=Y.CATGR
		GROUP BY X.CATGR,X.CATNM1,COALESCE(Y.TARPE,0)
		ORDER BY X.CATGR
	</select>
	<delete id="deleteMIZZ229U225List" parameterType="java.util.HashMap">
		DELETE FROM PSZDBLIB.MIZ225PF
		<where> <if test="COMPS != ''"> COMPS=#{COMPS}</if> AND CATYY=${CATYY} AND CATGB=#{CATGB_TARGET} </where>
	</delete>	
	<delete id="deleteMIZZ229U229List" parameterType="java.util.HashMap">
		DELETE FROM PSZDBLIB.MIZ229PF
		<where> <if test="COMPS != ''"> COMPS=#{COMPS}</if> AND CATYY=${CATYY} AND CATGB=#{CATGB_TARGET} </where>
	</delete>	
	<insert id="insertMIZZ229U225List" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ225PF
		VALUES (#{COMPS},${CATYY},#{CATGB_TARGET},#{CATGR},${TARPE},'','','','')
	</insert>
	<insert id="insertMIZZ229U229List" parameterType="java.util.HashMap">
	INSERT INTO PSZDBLIB.MIZ229PF 
		(SELECT 
			A.COMPS,A.CATYY,
			'PA',
			A.CATNO,
			A.DPTCD,
			A.VNDNR,
			A.COMPE,
			A.NEWIT,
			A.CATQY,
			CASE WHEN C.MAGGB = 'Y' THEN
				DECIMAL(A.AMT04*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT05*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT06*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT07*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT08*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT09*(100-COALESCE(B.TARPE,0))/100)+
				DECIMAL(A.AMT10*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT11*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT12*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT01*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT02*(100-COALESCE(B.TARPE,0))/100)+DECIMAL(A.AMT03*(100-COALESCE(B.TARPE,0))/100)
			ELSE 
				A.AMT04+A.AMT05+A.AMT06+A.AMT07+A.AMT08+A.AMT09+A.AMT10+A.AMT11+A.AMT12+A.AMT01+A.AMT02+A.AMT03 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT04*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT04 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT05*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT05 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT06*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT06 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT07*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT07 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT08*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT08 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT09*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT09 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT10*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT10 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT11*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT11 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT12*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT12 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT01*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT01 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT02*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT02 END,
			CASE WHEN C.MAGGB = 'Y' THEN DECIMAL(A.AMT03*(100-COALESCE(B.TARPE,0))/100) ELSE A.AMT03 END,
			CASE WHEN C.MAGGB = 'Y' THEN TRIM(CHAR(B.TARPE))||'%toP0' ELSE 'N' END,
			A.R2292,
			A.R2293,
			A.R2294
		FROM 
			PSZDBLIB.MIZ229PF A 
			LEFT OUTER JOIN 
			(SELECT * FROM PSZDBLIB.MIZ225PF 
				<where>
				<choose>
				  <when test="COMPS == ''"> COMPS='E1'</when>
				  <when test="COMPS != ''"> COMPS=#{COMPS}</when>
				</choose> 
				AND CATYY=${CATYY} AND CATGB=#{CATGB_TARGET}</where>) B ON SUBSTR(A.CATNO,1,3) = B.CATGR
			LEFT OUTER JOIN PSZDBLIB.MIZ220PF C ON A.CATNO = C.CATNO 
		<where> 
			<if test="COMPS != ''">A.COMPS=#{COMPS}</if> 
			AND A.CATYY=${CATYY} AND A.CATGB=#{CATGB_SOURCE}
		</where>
		)
	</insert>
	
	<select id="selectMIZZ229CList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			X.CATGR,X.CATNM1,
			SUM(X.CATAM) CATAM,
			SUM(CASE WHEN X.MAGGB='Y' THEN X.CATAM ELSE 0 END) CATAM_Y
		FROM
			(SELECT
				SUBSTR(A.CATNO,1,3) CATGR, B.CATNM1,A.CATAM,B.MAGGB
			FROM
				PSZDBLIB.MIZ229PF A,PSZDBLIB.MIZ220PF B
			<where>
				<if test="COMPS != ''">
				A.COMPS=#{COMPS}
				</if> 
				AND A.CATYY=${CATYY} 
				AND A.CATGB=#{CATGB}
				AND A.CATNO=B.CATNO
			</where>
			) X
		GROUP BY X.CATGR,X.CATNM1
		ORDER BY X.CATGR
	</select>
	<insert id="insertMIZZ229CList" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ239PF
			(SELECT * FROM PSZDBLIB.MIZ229PF
			<where>
				<if test="COMPS != ''">
				COMPS=#{COMPS}
				</if> 
				AND CATYY=${CATYY} 
				AND CATGB=#{CATGB}
			</where>)
	</insert>
	
	<!-- MIZZ239.xml -->
	<select id="selectMIZZ239List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			A.COMPS,A.CATYY,A.CATGB,TRIM(A.CATNO) AS CATNO,TRIM(B.CATNM1) AS CATNM1,TRIM(B.CATNM2) AS CATNM2,TRIM(B.CATNM3) AS CATNM3,
			A.VNDNR,C.VNDNM,A.COMPE,A.NEWIT,
			A.CATQY,A.CATAM,A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03,
			TRIM(A.R2394) AS R2394,
			D.VNDNR P0_VNDNR,'' P0_VNDNM,D.COMPE P0_COMPE,D.NEWIT P0_NEWIT,D.CATQY P0_CATQY,
			D.CATAM P0_CATAM,D.AMT04 P0_AMT04,D.AMT05 P0_AMT05,D.AMT06 P0_AMT06,D.AMT07 P0_AMT07,D.AMT08 P0_AMT08,D.AMT09 P0_AMT09,
			D.AMT10 P0_AMT10,D.AMT11 P0_AMT11,D.AMT12 P0_AMT12,D.AMT01 P0_AMT01,D.AMT02 P0_AMT02,D.AMT03 P0_AMT03,
			TRIM(D.R2394) AS P0_R2394	
		FROM
			PSZDBLIB.MIZ239PF A,PSZDBLIB.MIZ220PF B,PSZDBLIB.MIZ221PF C
			LEFT OUTER JOIN (SELECT * FROM PSZDBLIB.MIZ239PF WHERE COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{T_CATGB} AND DPTCD=#{DPTCD}) D ON A.CATNO=D.CATNO
		WHERE
			A.COMPS=#{COMPS} AND A.CATYY=${CATYY} AND A.CATGB=#{CATGB} AND A.DPTCD=#{DPTCD}
			AND A.CATNO=B.CATNO AND A.VNDNR=C.VNDNR
		ORDER BY
			CATNO
	</select>
	<select id="selectMIZZ239Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			PSZDBLIB.MIZ239PF
		WHERE
			COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{CATGB} AND CATNO=#{CATNO} AND DPTCD=#{DPTCD}
	</select>
	<insert id="insertMIZZ239List" parameterType="java.util.HashMap">
		INSERT INTO PSZDBLIB.MIZ239PF
		VALUES (#{COMPS},${CATYY},#{CATGB},#{CATNO},#{DPTCD},#{VNDNR},${COMPE},#{NEWIT},${CATQY},${CATAM},
				${AMT04},${AMT05},${AMT06},${AMT07},${AMT08},${AMT09},
				${AMT10},${AMT11},${AMT12},${AMT01},${AMT02},${AMT03},
				REPLACE(CHAR(DATE(current date), ISO), '-', ''),'${USERID}','',#{R2394})
	</insert>
	<update id="updateMIZZ239List" parameterType="java.util.HashMap">
		UPDATE PSZDBLIB.MIZ239PF
		SET VNDNR=#{VNDNR},
			COMPE=${COMPE},
			NEWIT=#{NEWIT},
			CATQY=${CATQY},
			CATAM=${CATAM},
			AMT04=${AMT04},
			AMT05=${AMT05},
			AMT06=${AMT06},
			AMT07=${AMT07},
			AMT08=${AMT08},
			AMT09=${AMT09},
			AMT10=${AMT10},
			AMT11=${AMT11},
			AMT12=${AMT12},
			AMT01=${AMT01},
			AMT02=${AMT02},
			AMT03=${AMT03},
			R2394=#{R2394},
			R2391=REPLACE(CHAR(DATE(current date), ISO), '-', ''),
			R2392='${USERID}'
		WHERE COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{CATGB} AND CATNO=#{CATNO} AND DPTCD=#{DPTCD}
	</update>
	<delete id="deleteMIZZ239List" parameterType="java.util.HashMap">
		DELETE FROM PSZDBLIB.MIZ239PF
		WHERE COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{CATGB} AND CATNO=#{CATNO} AND DPTCD=#{DPTCD}
	</delete>
	<select id="selectMIZZ239_occList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT * FROM PSZDBLIB.MIZ239PF WHERE COMPS=#{COMPS} AND CATYY=${CATYY} AND CATGB=#{CATGB} AND CATNO=#{CATNO} AND DPTCD=#{DPTCD}
	</select>
	
	<select id="selectMIZZ229Q1List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		<!-- 
		SELECT
			A.COMPS,A.CATYY,A.CATGB,
			TRIM(A.CATNO) AS CATNO,TRIM(B.CATNM1) AS CATNM1,TRIM(B.CATNM2) AS CATNM2,TRIM(B.CATNM3) AS CATNM3,
			A.DPTCD,
			COALESCE(D.CATQY,0) CATQYB,COALESCE(D.CATAM,0) CATAMB,
			A.CATQY,A.CATAM,
			A.CATQY-COALESCE(D.CATQY,0) CHAQY,
			CASE WHEN COALESCE(D.CATQY,0)=0 AND A.CATQY != 0 
				THEN A.CATAM 
				ELSE CASE WHEN COALESCE(D.CATAM,0) != 0 THEN (A.CATQY-D.CATQY)*(COALESCE(D.CATAM,0)/COALESCE(D.CATQY,0)) ELSE 0 END
			END CHAAM,
			A.VNDNR,C.VNDNM,
			A.COMPE,A.NEWIT,A.R2294
		FROM
			PSZDBLIB.MIZ229PF A,PSZDBLIB.MIZ220PF B,PSZDBLIB.MIZ221PF C
			LEFT OUTER JOIN 
			(SELECT * FROM PSZDBLIB.MIZ229PF WHERE CATYY=${CATYY} AND CATGB='P1') D ON A.COMPS=D.COMPS AND A.CATNO=D.CATNO
		<where>
			<if test="COMPS != ''">	A.COMPS=#{COMPS} </if> 
			AND A.CATYY=${CATYY} 
			AND A.CATGB=#{CATGB}
			<if test="DPTCD != ''"> AND A.DPTCD=#{DPTCD} </if> 
			AND A.CATNO=B.CATNO AND A.VNDNR=C.VNDNR
		</where>
		ORDER BY
			A.COMPS,A.DPTCD,A.CATNO
		 -->
		SELECT
			R.COMPS,TRIM(R.CATNO) AS CATNO,R.DPTCD,
			TRIM(Y.CATNM1) AS CATNM1,TRIM(Y.CATNM2) AS CATNM2,TRIM(Y.CATNM3) AS CATNM3,
			R.CATQY,R.CATAM,R.CATQYB,R.CATAMB,R.CATQYBB,R.CATAMBB,
			R.AMT04,R.AMT05,R.AMT06,R.AMT07,R.AMT08,R.AMT09,R.AMT10,R.AMT11,R.AMT12,R.AMT01,R.AMT02,R.AMT03,
			R.AMT04B,R.AMT05B,R.AMT06B,R.AMT07B,R.AMT08B,R.AMT09B,R.AMT10B,R.AMT11B,R.AMT12B,R.AMT01B,R.AMT02B,R.AMT03B,
			R.AMT04BB,R.AMT05BB,R.AMT06BB,R.AMT07BB,R.AMT08BB,R.AMT09BB,R.AMT10BB,R.AMT11BB,R.AMT12BB,R.AMT01BB,R.AMT02BB,R.AMT03BB,
			R.CATQY-R.CATQYB CHAQY,
			R.CATQY_1,R.CATAM_1,
			<!--  CASE WHEN R.CATQYB=0 AND R.CATQY != 0 
				THEN R.CATAM 
				ELSE CASE WHEN R.CATAMB != 0 THEN (R.CATQY-R.CATQYB)*(R.CATAMB/R.CATQYB) ELSE 0 END
			END CHAAM--> 0 as CHAAM,
			X.VNDNR,TRIM(Z.VNDNM) VNDNM,X.COMPE,X.NEWIT,TRIM(X.R2294) R2294,
			Z1.CMOBJ,Z1.CMSUB,Z2.GMDL01
		FROM
			(
			SELECT
				A.COMPS,A.CATNO,A.DPTCD,
				SUM(CASE WHEN YYYY='YY' THEN A.CATQY ELSE 0 END) CATQY,
				SUM(CASE WHEN YYYY='YY' THEN A.CATAM ELSE 0 END) CATAM,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT04 ELSE 0 END) AMT04,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT05 ELSE 0 END) AMT05,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT06 ELSE 0 END) AMT06,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT07 ELSE 0 END) AMT07,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT08 ELSE 0 END) AMT08,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT09 ELSE 0 END) AMT09,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT10 ELSE 0 END) AMT10,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT11 ELSE 0 END) AMT11,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT12 ELSE 0 END) AMT12,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT01 ELSE 0 END) AMT01,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT02 ELSE 0 END) AMT02,
				SUM(CASE WHEN YYYY='YY' THEN A.AMT03 ELSE 0 END) AMT03,
				SUM(CASE WHEN YYYY='BYY' THEN A.CATQY ELSE 0 END) CATQYB,
				SUM(CASE WHEN YYYY='BYY' THEN A.CATAM ELSE 0 END) CATAMB,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT04 ELSE 0 END) AMT04B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT05 ELSE 0 END) AMT05B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT06 ELSE 0 END) AMT06B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT07 ELSE 0 END) AMT07B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT08 ELSE 0 END) AMT08B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT09 ELSE 0 END) AMT09B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT10 ELSE 0 END) AMT10B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT11 ELSE 0 END) AMT11B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT12 ELSE 0 END) AMT12B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT01 ELSE 0 END) AMT01B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT02 ELSE 0 END) AMT02B,
				SUM(CASE WHEN YYYY='BYY' THEN A.AMT03 ELSE 0 END) AMT03B,
				SUM(CASE WHEN YYYY='BBYY' THEN A.CATQY ELSE 0 END) CATQYBB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.CATAM ELSE 0 END) CATAMBB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT04 ELSE 0 END) AMT04BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT05 ELSE 0 END) AMT05BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT06 ELSE 0 END) AMT06BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT07 ELSE 0 END) AMT07BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT08 ELSE 0 END) AMT08BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT09 ELSE 0 END) AMT09BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT10 ELSE 0 END) AMT10BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT11 ELSE 0 END) AMT11BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT12 ELSE 0 END) AMT12BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT01 ELSE 0 END) AMT01BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT02 ELSE 0 END) AMT02BB,
				SUM(CASE WHEN YYYY='BBYY' THEN A.AMT03 ELSE 0 END) AMT03BB,
				SUM(CASE WHEN YYYY='YY-1' THEN A.CATQY ELSE 0 END) CATQY_1,
				SUM(CASE WHEN YYYY='YY-1' THEN A.CATAM ELSE 0 END) CATAM_1
			FROM
				(SELECT 'YY' AS YYYY,A.COMPS,A.CATYY,A.CATNO,A.DPTCD,A.CATQY,A.CATAM,A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03
				FROM PSZDBLIB.MIZ229PF A <!-- 경비TX : 년도=작업년, 구분=상반기(P0)하반기(P1) -->
				<where> A.COMPS='${COMPS}' AND A.CATYY=${CATYY} AND A.CATGB='${CATGB}' <if test="DPTCD != ''"> AND A.DPTCD='${DPTCD}' </if> </where>
				UNION ALL
				SELECT 'BYY' AS YYYY,A.COMPS,A.CATYY,A.CATNO,A.DPTCD,A.CATQY,A.CATAM,A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03
				FROM PSZDBLIB.MIZ239PF A <!-- 경비실적 : [상반기선택시 년도=작업년-1,  구분=A0]    [하반기선택시 년도=작업년,  구분=P0] -->
				<where> A.COMPS='${COMPS}' AND A.CATYY=${CATGB_YYYY} AND A.CATGB='${CATGB_TARGET}' <if test="DPTCD != ''"> AND A.DPTCD='${DPTCD}' </if> </where>
				UNION ALL
				SELECT 'BBYY' AS YYYY,A.COMPS,A.CATYY,A.CATNO,A.DPTCD,A.CATQY,A.CATAM,A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03
				FROM PSZDBLIB.MIZ239PF A <!-- 경비확정계획[상반기선택시 년도=작업년-1,  구분=P1]    [하반기선택시 년도=작업년,  구분=P1] -->
				<where> A.COMPS='${COMPS}' AND A.CATYY=${CATGB_YYYY} AND A.CATGB='P1' <if test="DPTCD != ''"> AND A.DPTCD='${DPTCD}' </if> </where>
				UNION ALL
				SELECT 'YY-1' AS YYYY,A.COMPS,A.CATYY,A.CATNO,A.DPTCD,A.CATQY,A.CATAM,A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03
				FROM PSZDBLIB.MIZ229PF A <!-- 경비확정계획[상반기선택시 년도=작업년-1,  구분=P0]    [하반기선택시 년도=작업년,  구분=P1] -->
				<where> A.COMPS='${COMPS}' AND A.CATYY=${CATGB_YYYY} AND A.CATGB='P0' <if test="DPTCD != ''"> AND A.DPTCD='${DPTCD}' </if> </where>
				) A
			GROUP BY
				A.COMPS,A.CATNO,A.DPTCD
			) R
			LEFT OUTER JOIN
			(SELECT * FROM PSZDBLIB.MIZ229PF WHERE COMPS='${COMPS}' AND CATYY=${CATYY} AND CATGB='${CATGB}') X ON R.CATNO=X.CATNO AND R.DPTCD=X.DPTCD
			LEFT OUTER JOIN PSZDBLIB.MIZ220PF Y ON R.CATNO=Y.CATNO
			LEFT OUTER JOIN PSZDBLIB.MIZ221PF Z ON X.VNDNR=Z.VNDNR
			LEFT OUTER JOIN (SELECT * FROM PSZDBLIB.MIZ222PF WHERE GRCOM='${GRCOM}') Z1 ON R.CATNO=Z1.CATNO
			LEFT OUTER JOIN (SELECT * FROM ${LIB99}.F0901 WHERE GMMCU='   MODEL ALL' AND GMOBJ BETWEEN '90000' AND '99999')Z2 ON Z1.CMOBJ=Z2.GMOBJ AND Z1.CMSUB=Z2.GMSUB
		ORDER BY Z1.CMOBJ,Z1.CMSUB,R.CATNO
	</select>
	
	<select id="selectMIZZ229Q2List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT
		A.COMPS,A.CATYY,A.CATGB,A.DPTCD,
		Z.CMOBJ,Z.CMSUB,E.GMDL01,
		TRIM(A.CATNO) AS CATNO,TRIM(B.CATNM1) AS CATNM1,TRIM(B.CATNM2) AS CATNM2,TRIM(B.CATNM3) AS CATNM3,
		A.VNDNR,C.VNDNM,A.COMPE,A.NEWIT,
		A.CATQY,A.CATAM,A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03,
		TRIM(A.R2294) AS R2294	
	FROM
		PSZDBLIB.MIZ229PF A 
		LEFT OUTER JOIN (SELECT * FROM PSZDBLIB.MIZ222PF WHERE GRCOM=#{GRCOM}) Z ON A.CATNO=Z.CATNO
		LEFT OUTER JOIN (SELECT * FROM ${LIB99}.F0901 WHERE GMMCU='   MODEL ALL' AND GMOBJ BETWEEN '90000' AND '99999')E ON Z.CMOBJ=E.GMOBJ AND Z.CMSUB=E.GMSUB
		,PSZDBLIB.MIZ220PF B,PSZDBLIB.MIZ221PF C
	<where>
		<if test="COMPS != ''">	A.COMPS=#{COMPS} </if> 
		AND A.CATYY=${CATYY} AND A.CATGB=#{CATGB} 
		<if test="DPTCD != ''"> AND A.DPTCD=#{DPTCD} </if>
		AND A.CATNO=B.CATNO 
		AND A.VNDNR=C.VNDNR
	</where>
	ORDER BY
		A.COMPS,A.DPTCD,Z.CMOBJ,Z.CMSUB,A.CATNO
	</select>
	
	<select id="selectMIZZ239Q1List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT
		X.CMOBJ,X.CMSUB,TRIM(Z.GMDL01) GMDL01,X.COMPS,X.CATYY,X.CATNO,
		TRIM(Y.CATNM1) AS CATNM1,TRIM(Y.CATNM2) AS CATNM2,TRIM(Y.CATNM3) AS CATNM3,
		SUM(X.AMT04) AMT04,SUM(X.AMT05) AMT05,SUM(X.AMT06) AMT06,SUM(X.AMT07) AMT07,SUM(X.AMT08) AMT08,SUM(X.AMT09) AMT09,
		SUM(X.AMT10) AMT10,SUM(X.AMT11) AMT11,SUM(X.AMT12) AMT12,SUM(X.AMT01) AMT01,SUM(X.AMT02) AMT02,SUM(X.AMT03) AMT03,
		SUM(X.P0_AMT04) P0_AMT04,SUM(X.P0_AMT05) P0_AMT05,SUM(X.P0_AMT06) P0_AMT06,SUM(X.P0_AMT07) P0_AMT07,SUM(X.P0_AMT08) P0_AMT08,SUM(X.P0_AMT09) P0_AMT09,
		SUM(X.P0_AMT10) P0_AMT10,SUM(X.P0_AMT11) P0_AMT11,SUM(X.P0_AMT12) P0_AMT12,SUM(X.P0_AMT01) P0_AMT01,SUM(X.P0_AMT02) P0_AMT02,SUM(X.P0_AMT03) P0_AMT03
	FROM
		(
		SELECT
			E.CMOBJ,E.CMSUB,A.COMPS,A.CATYY,TRIM(A.CATNO) AS CATNO,
			A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03,
			0 P0_AMT04,0 P0_AMT05,0 P0_AMT06,0 P0_AMT07,0 P0_AMT08,0 P0_AMT09,0 P0_AMT10,0 P0_AMT11,0 P0_AMT12,0 P0_AMT01,0 P0_AMT02,0 P0_AMT03
		FROM
			PSZDBLIB.MIZ239PF A LEFT OUTER JOIN (SELECT * FROM PSZDBLIB.MIZ222PF WHERE GRCOM=#{GRCOM}) E ON A.CATNO=E.CATNO
		WHERE
			A.COMPS=#{COMPS} AND A.CATYY=${CATYY} AND A.CATGB='A0' AND A.DPTCD=#{DPTCD}
		UNION ALL
		SELECT
			E.CMOBJ,E.CMSUB,A.COMPS,A.CATYY,TRIM(A.CATNO) AS CATNO,
			0 AMT04,0 AMT05,0 AMT06,0 AMT07,0 AMT08,0 AMT09,0 AMT10,0 AMT11,0 AMT12,0 AMT01,0 AMT02,0 AMT03,
			A.AMT04 P0_AMT04,A.AMT05 P0_AMT05,A.AMT06 P0_AMT06,A.AMT07 P0_AMT07,A.AMT08 P0_AMT08,
			A.AMT09 P0_AMT09,A.AMT10 P0_AMT10,A.AMT11 P0_AMT11,A.AMT12 P0_AMT12,A.AMT01 P0_AMT01,A.AMT02 P0_AMT02,A.AMT03 P0_AMT03
		FROM
			PSZDBLIB.MIZ239PF A LEFT OUTER JOIN (SELECT * FROM PSZDBLIB.MIZ222PF WHERE GRCOM=#{GRCOM}) E ON A.CATNO=E.CATNO
		WHERE
			A.COMPS=#{COMPS} AND A.CATYY=${CATYY} AND A.CATGB=#{CATGB} AND A.DPTCD=#{DPTCD}
		) X 
		LEFT OUTER JOIN PSZDBLIB.MIZ220PF Y ON X.CATNO=Y.CATNO 
		LEFT OUTER JOIN (SELECT * FROM ${LIB99}.F0901 WHERE GMMCU='   MODEL ALL' AND GMOBJ BETWEEN '90000' AND '99999')Z ON X.CMOBJ=Z.GMOBJ AND X.CMSUB=Z.GMSUB
	GROUP BY
		X.CMOBJ,X.CMSUB,Z.GMDL01,X.COMPS,X.CATYY,X.CATNO,Y.CATNM1,Y.CATNM2,Y.CATNM3
	ORDER BY
		X.CMOBJ,X.CMSUB,X.COMPS,X.CATYY,X.CATNO	
	</select>
	
	<select id="selectMIZZ239Q2List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	SELECT
		A.COMPS,A.CATYY,A.CATGB,A.DPTCD,
		Z.CMOBJ,Z.CMSUB,E.GMDL01,
		TRIM(A.CATNO) AS CATNO,TRIM(B.CATNM1) AS CATNM1,TRIM(B.CATNM2) AS CATNM2,TRIM(B.CATNM3) AS CATNM3,
		A.VNDNR,C.VNDNM,A.COMPE,A.NEWIT,
		A.CATQY,A.CATAM,A.AMT04,A.AMT05,A.AMT06,A.AMT07,A.AMT08,A.AMT09,A.AMT10,A.AMT11,A.AMT12,A.AMT01,A.AMT02,A.AMT03,
		TRIM(A.R2394) AS R2394	
	FROM
		PSZDBLIB.MIZ239PF A 
		LEFT OUTER JOIN (SELECT * FROM PSZDBLIB.MIZ222PF WHERE GRCOM=#{GRCOM}) Z ON A.CATNO=Z.CATNO
		LEFT OUTER JOIN (SELECT * FROM ${LIB99}.F0901 WHERE GMMCU='   MODEL ALL' AND GMOBJ BETWEEN '90000' AND '99999')E ON Z.CMOBJ=E.GMOBJ AND Z.CMSUB=E.GMSUB
		,PSZDBLIB.MIZ220PF B,PSZDBLIB.MIZ221PF C
	<where>
		<if test="COMPS != ''">	A.COMPS=#{COMPS} </if> 
		AND A.CATYY=${CATYY} AND A.CATGB=#{CATGB} 
		<if test="DPTCD != ''"> AND A.DPTCD=#{DPTCD} </if>
		AND A.CATNO=B.CATNO 
		AND A.VNDNR=C.VNDNR
	</where>
	ORDER BY
		A.COMPS,A.DPTCD,Z.CMOBJ,Z.CMSUB,A.CATNO
	</select>
	
	
	
	
	
	
	<select id="selectFSAZ100List" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COMPS, GATCD, TRIM(GATNM) AS GATNM, USETF
		FROM
			${LIB2}.FSA100PF
		WHERE
			COMPS = #{COMPS}
			<!--
			AND USETF='1'
			-->
			<if test="!@org.springframework.util.StringUtils@isEmpty(USETF)">AND USETF=#{USETF}</if>
		ORDER BY COMPS, GATCD
	</select>
	<select id="selectFSAZ100Check" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(*) AS CNT 
		FROM
			${LIB2}.FSA100PF
		WHERE
			COMPS=#{COMPS} AND GATCD=${GATCD}
	</select>
	<insert id="insertFSAZ100List" parameterType="java.util.HashMap">
		INSERT INTO ${LIB2}.FSA100PF (COMPS, GATCD, GATNM, USETF)
		VALUES (#{COMPS}, ${GATCD}, #{GATNM}, #{USETF})
	</insert>
	<update id="updateFSAZ100List" parameterType="java.util.HashMap">
		UPDATE ${LIB2}.FSA100PF
		SET GATNM=#{GATNM},
			USETF=#{USETF}
		WHERE COMPS=#{COMPS} AND GATCD=${GATCD}
	</update>
	<delete id="deleteFSAZ100List" parameterType="java.util.HashMap">
		DELETE FROM ${LIB2}.FSA100PF
		WHERE COMPS=#{COMPS} AND GATCD=${GATCD}
	</delete>

</mapper>