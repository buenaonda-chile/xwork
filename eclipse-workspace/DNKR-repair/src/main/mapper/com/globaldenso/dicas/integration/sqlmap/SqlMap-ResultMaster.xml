<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.globaldenso.dicas.business.dao.ResultMasterDao">

  <resultMap id="codeMap" type="com.globaldenso.dicas.business.dto.ResultMasterDto">
		<id property="id" column="ID" javaType="java.lang.Long" />
		<result property="vinno" column="VINNO" javaType="java.lang.String" />
		<result property="manageNo" column="MANAGE_NO" javaType="java.lang.String" />
		<result property="serviceDegree" column="SERVICE_DEGREE" javaType="java.lang.Long" />
		<result property="resultDegree" column="RESULT_DEGREE" javaType="java.lang.Long" />
		<result property="actionType" column="ACTION_TYPE" javaType="java.lang.String" />
		<result property="callCenterApproval" column="CALL_CENTER_APPROVAL" javaType="java.lang.Long" />
		<result property="repairDate" column="REPAIR_DATE" javaType="java.lang.String" />
		<result property="roNo" column="RO_NO" javaType="java.lang.String" />
		<result property="roConfirmDate" column="RO_CONFIRM_DATE" javaType="java.lang.String" />
		<result property="roSpecialFeature" column="RO_SPECIAL_FEATURE" javaType="java.lang.String" />
		<result property="lotNo" column="LOT_NO" javaType="java.lang.String" />
		<result property="hmcPartNo" column="HMC_PART_NO" javaType="java.lang.String" />
		<result property="replacePartNo" column="REPLACE_PART_NO" javaType="java.lang.String" />
		<result property="replacePartNm" column="REPLACE_PART_NM" javaType="java.lang.String" />
		<result property="replacePartCnt" column="REPLACE_PART_CNT" javaType="java.lang.Long" />
		<result property="usage" column="USAGE" javaType="java.lang.String" />
		<result property="otherMate" column="OTHER_MATE" javaType="java.lang.String" />
		<result property="recallType" column="RECALL_TYPE" javaType="java.lang.String" />
		<result property="recallReqDate" column="RECALL_REQ_DATE" javaType="java.lang.String" />
		<result property="receiveDate" column="RECEIVE_DATE" javaType="java.lang.String" />
		<result property="qualityInfoNo" column="QUALITY_INFO_NO" javaType="java.lang.String" />
		<result property="localInfoNo" column="LOCAL_INFO_NO" javaType="java.lang.String" />
		<result property="gqnetIssueDate" column="GQNET_ISSUE_DATE" javaType="java.lang.String" />
		<result property="gqnetIssueNm" column="GQNET_ISSUE_NM" javaType="java.lang.String" />
		<result property="waybillNo" column="WAYBILL_NO" javaType="java.lang.String" />
		<result property="qirIssueYn" column="QIR_ISSUE_YN" javaType="java.lang.String" />
		<result property="fieldWorkNm" column="FIELD_WORK_NM" javaType="java.lang.String" />
		<result property="fieldWorkDate" column="FIELD_WORK_DATE" javaType="java.sql.Date" />
		<result property="fieldWorkCont" column="FIELD_WORK_CONT" javaType="java.lang.String" />
		<result property="fieldWorkResult" column="FIELD_WORK_RESULT" javaType="java.lang.String" />
		<result property="fieldWorkDetail" column="FIELD_WORK_DETAIL" javaType="java.lang.String" />
		<result property="dnResearchResult" column="DN_RESEARCH_RESULT" javaType="java.lang.String" />
		<result property="dnResearchDetail" column="DN_RESEARCH_DETAIL" javaType="java.lang.String" />
		<result property="finalResearchResult" column="FINAL_RESEARCH_RESULT" javaType="java.lang.String" />
		<result property="finalResearchDetail" column="FINAL_RESEARCH_DETAIL" javaType="java.lang.String" />
		<result property="commentCont" column="COMMENT_CONT" javaType="java.lang.String" />
		<result property="autoinsert" column="AUTOINSERT" javaType="java.sql.Date" />
		<result property="manageCate2" column="MANAGE_CATE_2" javaType="java.lang.String" />
		<result property="submission" column="SUBMISSION" javaType="java.lang.String" />
		<result property="approval" column="APPROVAL" javaType="java.lang.String" />
		<result property="reject" column="REJECT" javaType="java.lang.String" />
		<result property="regUserId" column="REG_USER_ID" javaType="java.lang.String" />
		<result property="regDate" column="REG_DATE" javaType="java.sql.Date" />
		<result property="updUserId" column="UPD_USER_ID" javaType="java.lang.String" />
		<result property="updDate" column="UPD_DATE" javaType="java.sql.Date" />
		<result property="garageCd" column="GARAGE_CD" javaType="java.lang.String" />
		<result property="matDiv" column="MAT_DIV" javaType="java.lang.String" />
		<result property="partAmt" column="PART_AMT" javaType="java.lang.Long" />
		<result property="partMagin" column="PART_MAGIN" javaType="java.lang.Long" />
		<result property="labor" column="LABOR" javaType="java.lang.Long" />
		<result property="hRate" column="H_RATE" javaType="java.lang.Long" />
		<result property="km100InRate" column="KM100_IN_RATE" javaType="java.lang.Long" />
		<result property="km100OutRate" column="KM100_OUT_RATE" javaType="java.lang.Long" />
		<result property="dist" column="DIST" javaType="java.lang.Long" />
		<result property="travelAmt" column="TRAVEL_AMT" javaType="java.lang.Long" />
		<result property="taxAmt" column="TAX_AMT" javaType="java.lang.Long" />
		<result property="repairAmtTot" column="REPAIR_AMT_TOT" javaType="java.lang.Long" />
		<result property="partAmtTot" column="PART_AMT_TOT" javaType="java.lang.Long" />
		<result property="etcAmtTot" column="ETC_AMT_TOT" javaType="java.lang.Long" />
		<result property="partMarginCulcu" column="PART_MARGIN_CULCU" javaType="java.lang.Long" />
		<result property="totalAmt" column="TOTAL_AMT" javaType="java.lang.Long" />
		<result property="enginNo" column="ENGIN_NO" javaType="java.lang.String" />
		<result property="removeNo" column="REMOVE_NO" javaType="java.lang.String" />
		<result property="gqnetNo" column="GQNET_NO" javaType="java.lang.String" />
		<result property="qualityProblemNm" column="QUALITY_PROBLEM_NM" javaType="java.lang.String" />
		<result property="rgstrId" column="RGSTR_ID" javaType="java.lang.Long" />
		<result property="rgstDt" column="RGST_DT" javaType="java.time.LocalDateTime" />
		<result property="updtrId" column="UPDTR_ID" javaType="java.lang.Long" />
		<result property="updtDt" column="UPDT_DT" javaType="java.time.LocalDateTime" />
        <result property="partsCost" column="PARTS_COST" javaType="java.lang.Long" />
        <result property="margin" column="MARGIN" javaType="java.lang.Long" />
        <result property="workHour" column="WORK_HOUR" javaType="java.lang.Double" />
	  	<result property="atchmnflId" column="ATCHMNFL_ID" javaType="java.lang.Long" />
	  	<result property="reprYn" column="REPR_YN" javaType="java.lang.String" />
  	    <result property="partVal" column="PART_VAL" javaType="java.lang.Long" />
	    <result property="laborVal" column="LABOR_VAL" javaType="java.lang.Long" />
	    <result property="etcVal" column="ETC_VAL" javaType="java.lang.Long" />
	    <result property="totalVal" column="TOTAL_VAL" javaType="java.lang.Long" />
  </resultMap>

  <resultMap id="codeMap2" type="com.globaldenso.dicas.business.dto.ResultMasterDto">
		<id property="id" column="ID" javaType="java.lang.Long" />
		<result property="vinno" column="VINNO" javaType="java.lang.String" />
		<result property="manageNo" column="MANAGE_NO" javaType="java.lang.String" />
		<result property="masterId" column="MASTER_ID" javaType="java.lang.String" />
		<result property="totalAmt" column="TOTAL_AMT" javaType="java.lang.Long" />
	    <result property="totalAmts" column="TOTAL_AMTS" javaType="java.lang.String" />
		<result property="approvalNo" column="APPROVAL_NO" javaType="java.lang.String" />
		<result property="receiptDate" column="RECEIPT_DATE1" javaType="java.lang.String" />
		<result property="researchDate" column="RESEARCH_DATE" javaType="java.lang.String" />
		<result property="resultDate" column="RESULT_DATE" javaType="java.lang.String" />
		<result property="officeNm" column="OFFICE_NM" javaType="java.lang.String" />
		<result property="sdNm" column="SD_NM" javaType="java.lang.String" />
		<result property="inquiry" column="INQUIRY" javaType="java.lang.String" />
		<result property="inquiryGubun" column="INQUIRY_GUBUN" javaType="java.lang.String" />
		<result property="exchangeNm" column="EXCHANGE_NM" javaType="java.lang.String" />
		<result property="hmcPartNo" column="HMC_PART_NO" javaType="java.lang.String" />
		<result property="replacePartNm" column="REPLACE_PART_NM" javaType="java.lang.String" />
		<result property="approvalStatus" column="APPROVAL_STATUS" javaType="java.lang.String" />
	    <result property="labor" column="LABOR" javaType="java.lang.Long" />
	    <result property="repairAmtTot" column="REPAIR_AMT_TOT" javaType="java.lang.Long" />
	    <result property="dist" column="DIST" javaType="java.lang.Long" />
	    <result property="travelAmt" column="TRAVEL_AMT" javaType="java.lang.Long" />
	    <result property="partAmtTot" column="PART_AMT_TOT" javaType="java.lang.Long" />
	    <result property="taxAmt" column="TAX_AMT" javaType="java.lang.Long" />
	  	<result property="reprYn" column="REPR_YN" javaType="java.lang.String" />
	    <result property="partVal" column="PART_VAL" javaType="java.lang.Long" />
	    <result property="laborVal" column="LABOR_VAL" javaType="java.lang.Long" />
	    <result property="etcVal" column="ETC_VAL" javaType="java.lang.Long" />
	    <result property="totalVal" column="TOTAL_VAL" javaType="java.lang.Long" />
	    <result property="partMarginCulcu" column="PART_MARGIN_CULCU" javaType="java.lang.Long" />
		<result property="receiveUser" column="RECEIPT_NM2" javaType="java.lang.String" />
		<result property="requestUser" column="REQUEST_USER" javaType="java.lang.String" />
		<result property="qualityIndex" column="QUALITY_INDEX" javaType="java.lang.String" />
		<result property="useMonth" column="USE_MONTH" javaType="java.lang.String" />
  </resultMap>

  <resultMap id="codeMap3" type="com.globaldenso.dicas.business.dto.ResultMasterDto">
        <id property="id" column="ID" javaType="java.lang.Long" />
        <result property="vinno" column="VINNO" javaType="java.lang.String" />
        <result property="manageNo" column="MANAGE_NO" javaType="java.lang.String" />
        <result property="masterId" column="MASTER_ID" javaType="java.lang.String" />
        <result property="totalAmt" column="TOTAL_AMT" javaType="java.lang.Long" />
        <result property="totalAmts" column="TOTAL_AMTS" javaType="java.lang.String" />
        <result property="approvalNo" column="APPROVAL_NO" javaType="java.lang.String" />
        <result property="receiptDate" column="RECEIPT_DATE" javaType="java.lang.String" />
        <result property="researchDate" column="RESEARCH_DATE" javaType="java.lang.String" />
        <result property="resultDate" column="RESULT_DATE" javaType="java.lang.String" />
        <result property="officeNm" column="OFFICE_NM" javaType="java.lang.String" />
        <result property="sdNm" column="SD_NM" javaType="java.lang.String" />
        <result property="inquiry" column="INQUIRY" javaType="java.lang.String" />
        <result property="inquiryGubun" column="INQUIRY_GUBUN" javaType="java.lang.String" />
        <result property="exchangeNm" column="EXCHANGE_NM" javaType="java.lang.String" />
        <result property="hmcPartNo" column="HMC_PART_NO" javaType="java.lang.String" />
        <result property="replacePartNm" column="REPLACE_PART_NM" javaType="java.lang.String" />
        <result property="approvalStatus" column="APPROVAL_STATUS" javaType="java.lang.String" />
        <result property="labor" column="LABOR" javaType="java.lang.Long" />
        <result property="repairAmtTot" column="REPAIR_AMT_TOT" javaType="java.lang.Long" />
        <result property="dist" column="DIST" javaType="java.lang.Long" />
        <result property="travelAmt" column="TRAVEL_AMT" javaType="java.lang.Long" />
        <result property="partAmtTot" column="PART_AMT_TOT" javaType="java.lang.Long" />
        <result property="taxAmt" column="TAX_AMT" javaType="java.lang.Long" />
        <result property="reprYn" column="REPR_YN" javaType="java.lang.String" />
        <result property="partVal" column="PART_VAL" javaType="java.lang.Long" />
        <result property="laborVal" column="LABOR_VAL" javaType="java.lang.Long" />
        <result property="etcVal" column="ETC_VAL" javaType="java.lang.Long" />
        <result property="totalVal" column="TOTAL_VAL" javaType="java.lang.Long" />
        <result property="partMarginCulcu" column="PART_MARGIN_CULCU" javaType="java.lang.Long" />
        <result property="receiveUser" column="RECEIPT_NM2" javaType="java.lang.String" />
        <result property="requestUser" column="REQUEST_USER" javaType="java.lang.String" />
        <result property="qualityIndex" column="QUALITY_INDEX" javaType="java.lang.String" />
        <result property="useMonth" column="USE_MONTH" javaType="java.lang.String" />
    </resultMap>

  <sql id="select_00">
		SELECT  A.ID

               , E.RO_NO
               , E.RECALL_REQ_DATE
               , E.GQNET_ISSUE_DATE
               , E.REPAIR_DATE
               , E.ENGIN_NO
               , E.RECEIVE_DATE
               , E.REMOVE_NO
               , E.RO_CONFIRM_DATE
               , E.ACTION_TYPE
               , E.MAT_DIV
               , E.CALL_CENTER_APPROVAL
               , E.GQNET_NO
               , E.FIELD_WORK_RESULT
               , E.FINAL_RESEARCH_RESULT
               , E.QUALITY_PROBLEM_NM
               , E.TRAVEL_AMT
               , E.TOTAL_AMT
               , E.PART_AMT_TOT
               , E.LABOR
               , E.ETC_AMT_TOT
               , E.RO_SPECIAL_FEATURE

		,	  	NVL(A.APPROVAL_NO,'-') AS APPROVAL_NO
		,	  	TO_CHAR(A.RECEIPT_DATE,'YYYYMMDD') AS RECEIPT_DATE
		,	 	NVL(TO_CHAR(B.RESEARCH_DATE,'YYYYMMDD' ),'-') AS RESEARCH_DATE
		,       NVL(TO_CHAR(E.REG_DATE,'YYYYMMDD' ),'-') AS RESULT_DATE
		,       C.OFFICE_NM
		,       C.OFFICE_NM AS SD_NM
		,	    A.INQUIRY
		,	    A.INQUIRY_GUBUN
		,       F.EXCHANGE_NM
		,       E.HMC_PART_NO
		,       NVL(REGEXP_REPLACE( REVERSE(REGEXP_REPLACE( REVERSE (TO_CHAR(E.TOTAL_AMT)), '([0-9]{3})','\1,')),'^,',''),0) AS TOTAL_AMTS
		,       CASE WHEN (NVL(E.SUBMISSION,'0') = '1' AND NVL(E.APPROVAL,'0') = '0' AND NVL(E.REJECT,'0') = '0')       THEN 'SUBMISSION'
						   WHEN (NVL(E.SUBMISSION,'0') = '1' AND NVL(E.APPROVAL,'0') = '1' AND NVL(E.REJECT,'0') = '0') THEN 'APPROVAL'
						   WHEN (NVL(E.SUBMISSION,'0') = '1' AND NVL(E.APPROVAL,'0') = '0' AND NVL(E.REJECT,'0') = '1') THEN 'REJECT'
						   ELSE 'NOT SUBMITTED'
			END AS APPROVAL_STATUS
		,       E.SUBMISSION
		,       E.APPROVAL
		,       E.REJECT
		,	  	A.VINNO
		,	  	A.MANAGE_NO
		,	  	A.MASTER_ID
		,       E.REPR_YN
		FROM   	TB_DC_SERVICE_MASTER  A -- 서비스
		,		TB_DC_RESEARCH_MASTER B -- 조사
		,		TB_BA_OFFICE_MASTER   C -- 정비소
		,		TB_DC_VEHICLE_MSATER  D -- 차량
		,		TB_DC_RESULT_MASTER   E -- 결과
		,		TB_BA_EXCHANGE_PART_NUMBER F -- 문의품
		,	    TB_DC_CONSULTING G      -- 상담
		WHERE   A.MANAGE_NO 	  = B.MANAGE_NO(+)
		AND	    A.OFFICE_CODE     = C.OFFICE_CD
		AND     A.MASTER_ID       = D.MASTER_ID(+)
		AND     A.MANAGE_NO       = E.MANAGE_NO
		AND     E.RESULT_DEGREE   = 1
		AND     F.HMC             = E.HMC_PART_NO
		AND     F.MAKER           = D.MAKER
		AND     F.EXHAUST_REG     = D.EXHAUST_REG
		AND     F.ENGINE_TYPE     = D.ENGINE_TYPE
		AND     E.VINNO 		  = G.VINNO
		AND	    E.MANAGE_NO 	  = G.MANAGE_NO
		AND	    E.RESULT_DEGREE   = G.CONSULTING_DEGREE
		AND	    G.SD_APPOINT IS NOT NULL
  </sql>

  <sql id="select_01">

	SELECT * FROM
    (SELECT
		ID
		,VINNO
		,MANAGE_NO
		,SERVICE_DEGREE
		,RESULT_DEGREE
		, RO_NO
       , TO_CHAR(RECALL_REQ_DATE,'yyyy-MM-dd') AS RECALL_REQ_DATE
       , TO_CHAR(GQNET_ISSUE_DATE,'yyyy-MM-dd') AS GQNET_ISSUE_DATE
       , TO_CHAR(REPAIR_DATE,'yyyy-MM-dd') AS REPAIR_DATE
       , ENGIN_NO
       , TO_CHAR(RECEIVE_DATE,'yyyy-MM-dd') AS RECEIVE_DATE
       , REMOVE_NO
       , TO_CHAR(RO_CONFIRM_DATE,'yyyy-MM-dd') AS RO_CONFIRM_DATE
       , APPROVAL
       , MAT_DIV
       , CALL_CENTER_APPROVAL
       , GQNET_NO
       , FIELD_WORK_RESULT
       , FINAL_RESEARCH_RESULT
       , QUALITY_PROBLEM_NM
       , TRAVEL_AMT
       , TOTAL_AMT
       , PART_AMT_TOT
       , LABOR
       , ETC_AMT_TOT
		,HMC_PART_NO
	   ,REPLACE_PART_NM
	   ,REPLACE_PART_CNT
	   ,REPLACE_PART_NO
       , RO_SPECIAL_FEATURE
       , DIST
       ,(SELECT SD_APPOINT FROM TB_DC_CONSULTING WHERE MANAGE_NO = A.MANAGE_NO AND ROWNUM=1) AS SD_APPOINT
       ,RECALL_TYPE
       ,REPR_YN
       ,DN_RESEARCH_RESULT
       ,ACTION_TYPE
       ,PART_VAL
		,LABOR_VAL
		,ETC_VAL
		,TOTAL_VAL
		,REJECT
		,SUBMISSION

    FROM TB_DC_RESULT_MASTER A
    )

  </sql>

  <sql id="select_02">

    SELECT
		A.ID
		,A.VINNO
		,A.MANAGE_NO
		,A.SERVICE_DEGREE
		,A.RESULT_DEGREE
       , A.RO_NO
       , TO_CHAR(A.RECALL_REQ_DATE,'yyyy-MM-dd') AS RECALL_REQ_DATE
       , TO_CHAR(A.GQNET_ISSUE_DATE,'yyyy-MM-dd') AS GQNET_ISSUE_DATE
       , TO_CHAR(A.REPAIR_DATE,'yyyy-MM-dd') AS REPAIR_DATE
       , A.ENGIN_NO
       , TO_CHAR(A.RECEIVE_DATE,'yyyy-MM-dd') AS RECEIVE_DATE
       , A.REMOVE_NO
       , TO_CHAR(A.RO_CONFIRM_DATE,'yyyy-MM-dd') AS RO_CONFIRM_DATE
       , A.APPROVAL
       , A.MAT_DIV
       , A.CALL_CENTER_APPROVAL
       , A.GQNET_NO
       , A.FIELD_WORK_RESULT
       , A.FINAL_RESEARCH_RESULT
       , A.QUALITY_PROBLEM_NM
       , A.TRAVEL_AMT
       , A.TOTAL_AMT
       , A.PART_AMT_TOT
       , A.LABOR
       , A.ETC_AMT_TOT
	   , A.HMC_PART_NO
	   , A.REPLACE_PART_NM
	   , A.REPLACE_PART_CNT
       , A.RO_SPECIAL_FEATURE
       , C.PARTS_COST
       , C.MARGIN
       , C.WORK_HOUR
       , A.REPR_YN
       , A.ACTION_TYPE
       ,A.PART_VAL
		,A.LABOR_VAL
		,A.ETC_VAL
		,A.TOTAL_VAL
    FROM TB_DC_RESULT_MASTER A,
    TB_DC_VEHICLE_MSATER B,
    TB_BA_EXCHANGE_PART_NUMBER C
    where
    A.VINNO = B.MASTER_ID(+)
    AND B.MAKER = C.MAKER(+)
    AND B.EXHAUST_REG = C.EXHAUST_REG(+)
    AND B.ENGINE_TYPE = C.ENGINE_TYPE(+)
    AND A.HMC_PART_NO = C.HMC
	AND A.REPLACE_PART_NM = C.EXCHANGE_NM

    </sql>

	<sql id="select_03">
		SELECT A.*
		FROM   VW_RESULT_MST A
	</sql>

	<sql id="select_04">
		SELECT A.*
		    , TO_CHAR(A.RECEIPT_DATE,'yyyyMMdd') AS RECEIPT_DATE1
			,(SELECT FST_NM FROM TB_CM_USER WHERE ACCT_ID = A.RECEIVE_USER AND ROWNUM = 1) AS RECEIPT_NM2
		 	,( <![CDATA[ select
						  CASE WHEN A.RECEIPT_DATE - B.SALE_DATE <= 90 THEN 'CS'
							   WHEN A.RECEIPT_DATE - B.SALE_DATE >= 271 AND A.RECEIPT_DATE - B.SALE_DATE <= 365 THEN 'RS'
							   WHEN A.RECEIPT_DATE - B.SALE_DATE >= 0 AND A.RECEIPT_DATE - B.SALE_DATE <= 365 THEN 'RS1'
							   ELSE '' END
						 from
						  TB_DC_VEHICLE_MSATER B
					     where
						  A.MASTER_ID = B.MASTER_ID AND ROWNUM = 1 ]]> ) AS QUALITY_INDEX
			 			  ,( select ROUND((A.RECEIPT_DATE - B.SALE_DATE) / 30)
							from
							TB_DC_VEHICLE_MSATER B
							where
							A.MASTER_ID = B.MASTER_ID AND ROWNUM = 1) AS USE_MONTH
		FROM   VW_RESULT_MST A
	</sql>

    <sql id="select_05">
        SELECT A.*
        FROM   VW_RESULT_MST A
        WHERE A.APPROVAL_STATUS != 'APPROVAL'
    </sql>


  <sql id="where_01">
	  <if test="criteria.manageNo != null and criteria.manageNo != ''">
		  AND MANAGE_NO = #{criteria.manageNo}
	  </if>
	  <if test="criteria.sdAppoint != null and criteria.sdAppoint != ''">
		  AND SD_APPOINT = #{criteria.sdAppoint}
	  </if>
  </sql>

	<sql id="where_02">
		<if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
			AND REPLACE(A.RESULT_DATE,'-','')  &gt;=  #{criteria.searchResultDateFr}
		</if>
		<if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
			AND REPLACE(A.RESULT_DATE,'-','')  &lt;=  #{criteria.searchResultDateTo}
		</if>

		<if test="criteria.researchDate != null and criteria.researchDate != ''">
			AND REPLACE(A.RESEARCH_DATE,'-','')  =  #{criteria.researchDate}
		</if>

		<if test="criteria.SearchResearchDateFr != null and criteria.SearchResearchDateFr != ''">
			AND REPLACE(A.RESEARCH_DATE,'-','')  &gt;=  #{criteria.searchResearchDateFr}
		</if>
		<if test="criteria.SearchResearchDateTo != null and criteria.SearchResearchDateTo != ''">
			AND REPLACE(A.RESEARCH_DATE,'-','')  &lt;=  #{criteria.searchResearchDateTo}
		</if>

		<if test="criteria.sdNm != null and criteria.sdNm != ''">
			AND A.SD_NM LIKE '%'||#{criteria.sdNm}||'%'
		</if>
		<if test="criteria.vinno != null and criteria.vinno != ''">
			AND A.VINNO = UPPER(#{criteria.vinno})
		</if>
		<if test="criteria.approvalStatus != null and criteria.approvalStatus != ''">
			AND A.APPROVAL_STATUS = #{criteria.approvalStatus}
		</if>
		<if test="criteria.sdAppoint != null and criteria.sdAppoint != ''">
			AND A.SD_APPOINT = #{criteria.sdAppoint}
		</if>

		<if test="criteria.searchReceiptDateFr != null and criteria.searchReceiptDateFr != ''">
			AND REPLACE(A.RECEIPT_DATE,'-','')  &gt;=  #{criteria.searchReceiptDateFr}
		</if>
		<if test="criteria.searchReceiptDateTo != null and criteria.searchReceiptDateTo != ''">
			AND REPLACE(A.RECEIPT_DATE,'-','')  &lt;=  #{criteria.searchReceiptDateTo}
		</if>

	</sql>

  <!-- ?? SQL?????? -->
  <select id="searchByKey" resultMap="codeMap" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    SELECT *
    FROM (
    <include refid="select_01"/>
    ) AA
    WHERE AA.ID = #{id}

  </select>

  <select id="searchByCondition" resultMap="codeMap" parameterType="Map">

    SELECT *
    FROM (
         SELECT ROWNUM AS RN, A.*
          FROM (
          <include refid="select_01" />
          ) A
		  <where>
			  <include refid="where_01"/>
		  </where>
          ORDER BY A.RESULT_DEGREE
     ) AA

    <if test="pageable != null">
      WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
    </if>
    ORDER BY RESULT_DEGREE, RN

  </select>

  <select id="searchListByCondition" resultMap="codeMap3" parameterType="Map">
	  SELECT *
	  FROM (
		  SELECT ROWNUM AS RN, A.*
		  FROM (
		    <include refid="select_03" />
	  		ORDER BY RESULT_DATE DESC
		  ) A
		  <where>
			  <include refid="where_02"/>
		  </where>
	  ) AA

	  <if test="pageable != null">
		  WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
	  </if>

  </select>

  <select id="searchListByCondition2" resultMap="codeMap3" parameterType="Map">
	  SELECT *
	  FROM (
		  SELECT ROWNUM AS RN, A.*
		  FROM (
		    <include refid="select_05" />
	  		ORDER BY RESULT_DATE DESC
		  ) A
		  <where>
			  <include refid="where_02"/>
		  </where>
	  ) AA

	  <if test="pageable != null">
		  WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
	  </if>

  </select>

	<select id="searchListByConditionDownload" resultMap="codeMap3" parameterType="Map">
		SELECT *
		FROM (
		SELECT ROWNUM AS RN, A.*
		FROM (
		<include refid="select_03" />
		ORDER BY RESULT_DATE DESC
		) A
		<where>
			<include refid="where_02"/>
		</where>
		) AA
 	</select>

   <select id="searchCount" resultType="int" parameterType="Map">

    SELECT COUNT(ID) AS CNT
    FROM (
	   SELECT A.*
	   FROM (
	   <include refid="select_01" />
	   ) A
	   <where>
		   <include refid="where_01"/>
	   </where>
     ) AA

  </select>

  <select id="searchListByCount" resultType="int" parameterType="Map">

	  SELECT COUNT(ID) AS CNT
	  FROM (
	  SELECT A.*
	  FROM (
	  		<include refid="select_03" />
	  ) A
	  <where>
		  <include refid="where_02"/>
	  </where>
	  ) AA
  </select>

  <select id="searchListByCount2" resultType="int" parameterType="Map">

	  SELECT COUNT(ID) AS CNT
	  FROM (
	  SELECT A.*
	  FROM (
	  		<include refid="select_05" />
	  ) A
	  <where>
		  <include refid="where_02"/>
	  </where>
	  ) AA
  </select>

	<select id="searchMainListByCondition" resultMap="codeMap2" >
	WITH TEST1 AS
(
 SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
 UNION ALL
 SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
 UNION ALL
 SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
)
SELECT * FROM TEST1

	</select>

	<select id="searchMainListByUser" resultMap="codeMap2" >
WITH TEST1 AS
(
 SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
 UNION ALL
 SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
 UNION ALL
 SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
)
SELECT * FROM TEST1
	</select>

  <insert id="create" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    INSERT INTO TB_DC_RESULT_MASTER (
		ID
		,VINNO
		,MANAGE_NO
		,SERVICE_DEGREE
		,RESULT_DEGREE
		,ACTION_TYPE
		,CALL_CENTER_APPROVAL
		,REPAIR_DATE
		,RO_NO
		,RO_CONFIRM_DATE
		,RO_SPECIAL_FEATURE
		,LOT_NO
		,HMC_PART_NO
		,REPLACE_PART_NO
		,REPLACE_PART_NM
		,REPLACE_PART_CNT
		,USAGE
		,OTHER_MATE
		,RECALL_TYPE
		,RECALL_REQ_DATE
		,RECEIVE_DATE
		,QUALITY_INFO_NO
		,LOCAL_INFO_NO
		,GQNET_ISSUE_DATE
		,GQNET_ISSUE_NM
		,WAYBILL_NO
		,QIR_ISSUE_YN
		,FIELD_WORK_NM
		,FIELD_WORK_DATE
		,FIELD_WORK_CONT
		,FIELD_WORK_RESULT
		,FIELD_WORK_DETAIL
		,DN_RESEARCH_RESULT
		,DN_RESEARCH_DETAIL
		,FINAL_RESEARCH_RESULT
		,FINAL_RESEARCH_DETAIL
		,COMMENT_CONT
		,AUTOINSERT
		,MANAGE_CATE_2
		,SUBMISSION
		,APPROVAL
		,REJECT
		,REG_USER_ID
		,REG_DATE
		,UPD_USER_ID
		,UPD_DATE
		,GARAGE_CD
		,MAT_DIV
		,PART_AMT
		,PART_MAGIN
		,LABOR
		,H_RATE
		,KM100_IN_RATE
		,KM100_OUT_RATE
		,DIST
		,TRAVEL_AMT
		,TAX_AMT
		,REPAIR_AMT_TOT
		,PART_AMT_TOT
		,ETC_AMT_TOT
		,PART_MARGIN_CULCU
		,TOTAL_AMT
		,ENGIN_NO
		,REMOVE_NO
		,GQNET_NO
		,QUALITY_PROBLEM_NM
		,RGSTR_ID
		,RGST_DT
		,UPDTR_ID
		,UPDT_DT
	    ,REPR_YN
	    ,PART_VAL
	    ,LABOR_VAL
	    ,ETC_VAL
	    ,TOTAL_VAL
    ) VALUES (
		#{id}
		,UPPER(#{vinno})
		,#{manageNo}
		,#{serviceDegree}
        ,(SELECT DECODE(COUNT(*), 0,  1, MAX(RESULT_DEGREE) + 1)
            FROM TB_DC_RESULT_MASTER
           WHERE MANAGE_NO = #{manageNo})
		,#{actionType}
		,#{callCenterApproval}
		,TO_DATE(#{repairDate},'yyyy-MM-dd')
		,UPPER(#{roNo})
		,TO_DATE(#{roConfirmDate},'yyyy-MM-dd')
		,#{roSpecialFeature}
		,#{lotNo}
		,#{hmcPartNo}
		,#{replacePartNo}
		,#{replacePartNm}
		,#{replacePartCnt}
		,#{usage}
		,#{otherMate}
		,#{recallType}
		,TO_DATE(#{recallReqDate},'yyyy-MM-dd')
		,TO_DATE(#{receiveDate},'yyyy-MM-dd')
		,#{qualityInfoNo}
		,#{localInfoNo}
		,TO_DATE(#{gqnetIssueDate},'yyyy-MM-dd')
		,#{gqnetIssueNm}
		,#{waybillNo}
		,#{qirIssueYn}
		,#{fieldWorkNm}
		,#{fieldWorkDate}
		,#{fieldWorkCont}
		,#{fieldWorkResult}
		,#{fieldWorkDetail}
		,#{dnResearchResult}
		,#{dnResearchDetail}
		,#{finalResearchResult}
		,#{finalResearchDetail}
		,#{commentCont}
		,#{autoinsert}
		,#{manageCate2}
		,#{submission}
		,#{approval}
		,#{reject}
		,#{regUserId}
		,sysdate
		,#{updUserId}
		,#{updDate}
		,#{garageCd}
		,#{matDiv}
		,#{partAmt}
		,#{partMagin}
		,#{labor}
		,#{hRate}
		,#{km100InRate}
		,#{km100OutRate}
		,#{dist}
		,#{travelAmt}
		,#{taxAmt}
		,#{repairAmtTot}
		,#{partAmtTot}
		,#{etcAmtTot}
		,#{partMarginCulcu}
		,#{totalAmt}
		,UPPER(#{enginNo})
		,#{removeNo}
		,UPPER(#{gqnetNo})
		,#{qualityProblemNm}
		,#{rgstrId}
		,#{rgstDt}
		,#{updtrId}
		,#{updtDt}
	    ,#{reprYn}
  	    ,#{partVal}
	    ,#{laborVal}
	    ,#{etcVal}
	    ,#{totalVal}
    )

    <selectKey resultType="long" keyProperty="id" order="BEFORE">
      SELECT SEQ_TB_DC_RESULT_MASTER.NEXTVAL FROM DUAL
    </selectKey>

  </insert>

  <update id="update" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    UPDATE TB_DC_RESULT_MASTER SET
		VINNO = UPPER(#{vinno})
		,MANAGE_NO = #{manageNo}
		,SERVICE_DEGREE = DECODE(#{serviceDegree}, NULL, 1, #{serviceDegree})
		,RESULT_DEGREE = DECODE(#{resultDegree}, NULL, 1, #{resultDegree})
		,ACTION_TYPE = #{actionType}
		,CALL_CENTER_APPROVAL = #{callCenterApproval}
		,REPAIR_DATE = TO_DATE(#{repairDate},'yyyy-MM-dd')
		,RO_NO = UPPER(#{roNo})
		,RO_CONFIRM_DATE = TO_DATE(#{roConfirmDate},'yyyy-MM-dd')
		,RO_SPECIAL_FEATURE = #{roSpecialFeature}
		,LOT_NO = #{lotNo}
		,HMC_PART_NO = #{hmcPartNo}
		,REPLACE_PART_NO = #{replacePartNo}
		,REPLACE_PART_NM = #{replacePartNm}
		,REPLACE_PART_CNT = #{replacePartCnt}
		,USAGE = #{usage}
		,OTHER_MATE = #{otherMate}
		,RECALL_TYPE = #{recallType}
		,RECALL_REQ_DATE = TO_DATE(#{recallReqDate},'yyyy-MM-dd')
		,RECEIVE_DATE = TO_DATE(#{receiveDate},'yyyy-MM-dd')
		,QUALITY_INFO_NO = #{qualityInfoNo}
		,LOCAL_INFO_NO = #{localInfoNo}
		,GQNET_ISSUE_DATE = TO_DATE(#{gqnetIssueDate},'yyyy-MM-dd')
		,GQNET_ISSUE_NM = #{gqnetIssueNm}
		,WAYBILL_NO = #{waybillNo}
		,QIR_ISSUE_YN = #{qirIssueYn}
		,FIELD_WORK_NM = #{fieldWorkNm}
		,FIELD_WORK_DATE = #{fieldWorkDate}
		,FIELD_WORK_CONT = #{fieldWorkCont}
		,FIELD_WORK_RESULT = #{fieldWorkResult}
		,FIELD_WORK_DETAIL = #{fieldWorkDetail}
		,DN_RESEARCH_RESULT = #{dnResearchResult}
		,DN_RESEARCH_DETAIL = #{dnResearchDetail}
		,FINAL_RESEARCH_RESULT = #{finalResearchResult}
		,FINAL_RESEARCH_DETAIL = #{finalResearchDetail}
		,COMMENT_CONT = #{commentCont}
		,AUTOINSERT = #{autoinsert}
		,MANAGE_CATE_2 = #{manageCate2}
		,SUBMISSION = #{submission}
		,APPROVAL = #{approval}
		,REJECT = #{reject}
		,REG_USER_ID = #{regUserId}
		,REG_DATE = #{regDate}
		,UPD_USER_ID = #{updUserId}
		,UPD_DATE = #{updDate}
		,GARAGE_CD = #{garageCd}
		,MAT_DIV = #{matDiv}
		,PART_AMT = #{partAmt}
		,PART_MAGIN = #{partMagin}
		,LABOR = #{labor}
		,H_RATE = #{hRate}
		,KM100_IN_RATE = #{km100InRate}
		,KM100_OUT_RATE = #{km100OutRate}
		,DIST = #{dist}
		,TRAVEL_AMT = #{travelAmt}
		,TAX_AMT = #{taxAmt}
		,REPAIR_AMT_TOT = #{repairAmtTot}
		,PART_AMT_TOT = #{partAmtTot}
		,ETC_AMT_TOT = #{etcAmtTot}
		,PART_MARGIN_CULCU = #{partMarginCulcu}
		,TOTAL_AMT = #{totalAmt}
		,ENGIN_NO = UPPER(#{enginNo})
		,REMOVE_NO = #{removeNo}
		,GQNET_NO = UPPER(#{gqnetNo})
		,QUALITY_PROBLEM_NM = #{qualityProblemNm}
		,UPDTR_ID = #{updtrId}
		,UPDT_DT = #{updtDt}
		,REPR_YN = #{reprYn}
		,PART_VAL = #{partVal}
		,LABOR_VAL = #{laborVal}
		,ETC_VAL = #{etcVal}
		,TOTAL_VAL = #{totalVal}

    WHERE ID = #{id}

  </update>

    <update id="updateManageNo" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    UPDATE TB_DC_RESULT_MASTER SET

           RO_NO                     = UPPER(#{roNo})
         , RECALL_REQ_DATE = TO_DATE(#{recallReqDate},'yyyy-MM-dd')
         , GQNET_ISSUE_DATE = TO_DATE(#{gqnetIssueDate},'yyyy-MM-dd')
         , REPAIR_DATE = TO_DATE(#{repairDate},'yyyy-MM-dd')
         , ENGIN_NO                  = UPPER(#{enginNo})
         , RECEIVE_DATE = TO_DATE(#{receiveDate},'yyyy-MM-dd')
         , REMOVE_NO                 = #{removeNo}
         , RO_CONFIRM_DATE = TO_DATE(#{roConfirmDate},'yyyy-MM-dd')
         , DN_RESEARCH_RESULT        = #{dnResearchResult}
         , MAT_DIV                   = #{matDiv}
         , CALL_CENTER_APPROVAL      = #{callCenterApproval}
         , GQNET_NO                  = UPPER(#{gqnetNo})
         , FIELD_WORK_RESULT         = #{fieldWorkResult}
         , FINAL_RESEARCH_RESULT     = #{finalResearchResult}
         , QUALITY_PROBLEM_NM        = #{qualityProblemNm}
         , TRAVEL_AMT                = #{travelAmt}
         , TOTAL_AMT                 = #{totalAmt}
         , PART_AMT_TOT              = #{partAmtTot}
         , LABOR                     = #{labor}
         , ETC_AMT_TOT               = #{etcAmtTot}
         , RECALL_TYPE               = #{recallType}
         , REPR_YN 					 = #{reprYn}
         , ACTION_TYPE               = #{actionType}
		 ,PART_VAL = #{partVal}
		 ,LABOR_VAL = #{laborVal}
		 ,ETC_VAL = #{etcVal}
		 ,TOTAL_VAL = #{totalVal}
		,UPDTR_ID = #{updtrId}
		,UPDT_DT = #{updtDt}
    WHERE MANAGE_NO = #{manageNo}

  </update>

    <update id="gridUpdate" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    UPDATE TB_DC_RESULT_MASTER SET
		 HMC_PART_NO = #{hmcPartNo}
		,REPLACE_PART_NM = #{replacePartNm}
		,REPLACE_PART_CNT = #{replacePartCnt}
		,REPR_YN = #{reprYn}

		,UPDTR_ID = #{updtrId}
		,UPDT_DT = #{updtDt}

    WHERE ID = #{id}

  </update>

  <delete id="delete" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    DELETE FROM TB_DC_RESULT_MASTER
    WHERE ID = #{id}

  </delete>

	<delete id="deleteManageNo" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    DELETE FROM TB_DC_RESULT_MASTER
    WHERE MANAGE_NO = #{manageNo}

  </delete>

	<update id="update2" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    UPDATE TB_DC_RESULT_MASTER SET
		LABOR = #{labor}
		,DIST = #{dist}
		,TRAVEL_AMT = #{travelAmt}
		,REPAIR_AMT_TOT = #{repairAmtTot}
		,PART_MARGIN_CULCU = #{partMarginCulcu}
		,TOTAL_AMT = #{totalAmt}
		,TAX_AMT = #{taxAmt}
		,ETC_AMT_TOT = #{etcAmtTot}
		,PART_AMT_TOT = #{partAmtTot}
		,UPDTR_ID = #{updtrId}
		,UPDT_DT = #{updtDt}

    WHERE MANAGE_NO = #{manageNo}

  </update>

    <select id="searchByCondition2" resultMap="codeMap" parameterType="Map">

        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_02" />
        ) A
        <where>
            <include refid="where_01"/>
        </where>
        ORDER BY A.RESULT_DEGREE
        ) AA

        <if test="pageable != null">
            WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
        </if>
        ORDER BY RESULT_DEGREE, RN

    </select>

    <select id="searchCount2" resultType="int" parameterType="Map">

        SELECT COUNT(ID) AS CNT
        FROM (
        SELECT A.*
        FROM (
        <include refid="select_02" />
        ) A
        <where>
            <include refid="where_01"/>
        </where>
        ) AA

    </select>

	<update id="update3" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    UPDATE TB_DC_RESULT_MASTER SET
		SUBMISSION = #{submission}
		,APPROVAL = #{approval}
		,REJECT = #{reject}
    WHERE MANAGE_NO = #{manageNo}

  </update>

	<update id="update4" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    UPDATE TB_DC_RESULT_MASTER SET
		SUBMISSION = '1'
		,APPROVAL = '0'
		,REJECT = '0'
    WHERE MANAGE_NO = #{manageNo}

  </update>

  <update id="update5" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    UPDATE TB_DC_RESULT_MASTER SET
         RO_SPECIAL_FEATURE = #{roSpecialFeature}
		,UPDTR_ID = #{updtrId}
		,UPDT_DT = #{updtDt}
    WHERE MANAGE_NO = #{manageNo}

  </update>
	<update id="mobileUpdate" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

  	UPDATE TB_DC_RESULT_MASTER SET
		   RO_NO                     = UPPER(#{roNo})
		 , RECALL_REQ_DATE           = #{recallReqDate}
		 , GQNET_ISSUE_DATE          = #{gqnetIssueDate}
		 , REPAIR_DATE               = #{repairDate}
		 , ENGIN_NO                  = UPPER(#{enginNo})
		 , RECEIVE_DATE              = #{receiveDate}
		 , REMOVE_NO                 = #{removeNo}
		 , RO_CONFIRM_DATE           = #{roConfirmDate}
		 , DN_RESEARCH_RESULT        = #{dnResearchResult}
		 , MAT_DIV                   = #{matDiv}
		 , CALL_CENTER_APPROVAL      = #{callCenterApproval}
		 , GQNET_NO                  = UPPER(#{gqnetNo})
		 , FIELD_WORK_RESULT         = #{fieldWorkResult}
		 , FINAL_RESEARCH_RESULT     = #{finalResearchResult}
		 , QUALITY_PROBLEM_NM        = #{qualityProblemNm}
		 , TRAVEL_AMT                = #{travelAmt}
		 , TOTAL_AMT                 = #{totalAmt}
		 , PART_AMT_TOT              = #{partAmtTot}
		 , LABOR                     = #{labor}
		 , RECALL_TYPE               = #{recallType}
		 , REPR_YN 					 = #{reprYn}
		 , ACTION_TYPE               = #{actionType}
		 , PART_VAL 			 	 = #{partVal}
		 , LABOR_VAL 			 	 = #{laborVal}
		 , ETC_VAL 					 = #{etcVal}
		 , TOTAL_VAL 				 = #{totalVal}
		 , UPDTR_ID 				 = #{updtrId}
		 , UPDT_DT 					 = #{updtDt}
		 , HMC_PART_NO 				 = #{hmcPartNo}
		 , REPLACE_PART_NM 			 = #{replacePartNm}
		 , REPLACE_PART_CNT 		 = #{replacePartCnt}
	WHERE ID = #{id}

  </update>


	<select id="searchCountByKey" resultType="int" parameterType="Map">

		SELECT COUNT(*) AS CNT
		FROM TB_DC_COMM_RESULT_ATCHMNFL
		WHERE ID = (SELECT MIN(ID)
		               FROM TB_DC_RESULT_MASTER
		               WHERE MANAGE_NO = #{manageNo}
		             )
		AND ATCHMNFL_ID = #{atchmnflId}

	</select>
	<insert id="fileCreate" parameterType="com.globaldenso.dicas.business.domain.ResultMasterDomain">

    INSERT INTO TB_DC_COMM_RESULT_ATCHMNFL (
      ID,
      ATCHMNFL_ID
    ) VALUES (
      (SELECT MIN(ID)
		 FROM TB_DC_RESULT_MASTER
		WHERE MANAGE_NO = #{manageNo}
	   ),
      #{atchmnflId}
    )

  </insert>

	<select id="selectMstInfo" resultMap="codeMap" parameterType="Map">

		SELECT
			DISTINCT
				MANAGE_NO, VINNO
		FROM TB_DC_SERVICE_MASTER
		WHERE 1=1
		  AND MANAGE_NO =  #{criteria.manageNo}

	</select>

</mapper>
