<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.globaldenso.dicas.business.dao.ClaimVehicleDao">

    <resultMap id="rsMap" type="com.globaldenso.dicas.business.dto.ClaimVehicleDto">
        <result property="div" column="DIV" javaType="java.lang.String" />
        <result property="receiptDate" column="RECEIPT_DATE" javaType="java.lang.String" />
        <result property="callStatus" column="CALL_STATUS" javaType="java.lang.String" />
        <result property="csrs" column="CSRS" javaType="java.lang.String" />
        <result property="officeCode" column="OFFICE_CODE" javaType="java.lang.String" />
        <result property="officeCodeNm" column="OFFICE_CODE_NM" javaType="java.lang.String" />
        <result property="officeNm" column="OFFICE_NM" javaType="java.lang.String" />
        <result property="officeCity" column="OFFICE_CITY" javaType="java.lang.String" />
        <result property="consultingExp" column="CONSULTING_EXP" javaType="java.lang.String" />
        <result property="vinno" column="VINNO" javaType="java.lang.String" />
        <result property="maker" column="MAKER" javaType="java.lang.String" />
        <result property="makerNm" column="MAKER_NM" javaType="java.lang.String" />
        <result property="engineType" column="ENGINE_TYPE" javaType="java.lang.String" />
        <result property="engineTypeNm" column="ENGINE_TYPE_NM" javaType="java.lang.String" />
        <result property="exhaustReg" column="EXHAUST_REG" javaType="java.lang.String" />
        <result property="exhaustRegNm" column="EXHAUST_REG_NM" javaType="java.lang.String" />
        <result property="model" column="MODEL" javaType="java.lang.String" />
        <result property="modelNm" column="MODEL_NM" javaType="java.lang.String" />
        <result property="mainCategory" column="MAIN_CATEGORY" javaType="java.lang.String" />
        <result property="mainCategoryNm" column="MAIN_CATEGORY_NM" javaType="java.lang.String" />
        <result property="replacePartNo" column="REPLACE_PART_NO" javaType="java.lang.String" />
        <result property="replacePartNm" column="REPLACE_PART_NM" javaType="java.lang.String" />
        <result property="hmcPartNo" column="HMC_PART_NO" javaType="java.lang.String" />
        <result property="recallReqDate" column="RECALL_REQ_DATE" javaType="java.lang.String" />
        <result property="stausCode" column="STATUS_CODE" javaType="java.lang.String" />
        <result property="status" column="STATUS" javaType="java.lang.String" />
        <result property="partGroup" column="PART_GROUP" javaType="java.lang.String" />
        <result property="tireStd" column="TIRE_STD" javaType="java.lang.String" />
        <result property="inquiryGubun" column="INQUIRY_GUBUN" javaType="java.lang.String" />
        <result property="qualityProblemNm" column="QUALITY_PROBLEM_NM" javaType="java.lang.String" />
        <result property="saleCountry" column="SALE_COUNTRY" javaType="java.lang.String" />
        <result property="roNo" column="RO_NO" javaType="java.lang.String" />
        <result property="gqnetNo" column="GQNET_NO" javaType="java.lang.String" />
        <result property="mileage" column="MILEAGE" javaType="java.lang.Long" />
        <result property="masterId" column="MASTER_ID" javaType="java.lang.String" />
        <result property="prodDate" column="PROD_DATE" javaType="java.lang.String" />
        <result property="saleDate" column="SALE_DATE" javaType="java.lang.String" />
        <result property="manageNo" column="MANAGE_NO" javaType="java.lang.String" />
        <result property="remark" column="REMARK" javaType="java.lang.String" />
    </resultMap>

    <resultMap id="rsMap2" type="com.globaldenso.dicas.business.dto.ClaimVehicleDto">
        <result property="div" column="DIV" javaType="java.lang.String" />
        <result property="tireStd" column="TIRE_STD" javaType="java.lang.String" />
        <result property="tireStdNm" column="TIRE_STD_NM" javaType="java.lang.String" />
        <result property="vinno" column="VINNO" javaType="java.lang.String" />
        <result property="maker" column="MAKER" javaType="java.lang.String" />
        <result property="makerNm" column="MAKER_NM" javaType="java.lang.String" />
        <result property="remark" column="REMARK" javaType="java.lang.String" />
        <result property="exhaustReg" column="EXHAUST_REG" javaType="java.lang.String" />
        <result property="exhaustRegNm" column="EXHAUST_REG_NM" javaType="java.lang.String" />
        <result property="engineType" column="ENGINE_TYPE" javaType="java.lang.String" />
        <result property="engineTypeNm" column="ENGINE_TYPE_NM" javaType="java.lang.String" />
        <result property="prodDate" column="PROD_DATE" javaType="java.lang.String" />
        <result property="saleDate" column="SALE_DATE" javaType="java.lang.String" />
        <result property="callStatus" column="CALL_STATUS" javaType="java.lang.String" />
        <result property="receiptDate" column="RECEIPT_DATE" javaType="java.lang.String" />
        <result property="inquiryGubun" column="INQUIRY_GUBUN" javaType="java.lang.String" />
        <result property="inquiryGubunNm" column="INQUIRY_GUBUN_NM" javaType="java.lang.String" />
        <result property="inquiry" column="INQUIRY" javaType="java.lang.String" />
        <result property="officeCode" column="OFFICE_CODE" javaType="java.lang.String" />
        <result property="officeCodeNm" column="OFFICE_CODE_NM" javaType="java.lang.String" />
        <result property="officeNm" column="OFFICE_NM" javaType="java.lang.String" />
        <result property="officeCity" column="OFFICE_CITY" javaType="java.lang.String" />
        <result property="officeCityNm" column="OFFICE_CITY_NM" javaType="java.lang.String" />
        <result property="mileage" column="MILEAGE" javaType="java.lang.Long" />
        <result property="warranty" column="WARRANTY" javaType="java.lang.String" />
        <result property="stausCode" column="STATUS_CODE" javaType="java.lang.String" />
        <result property="status" column="STATUS" javaType="java.lang.String" />
        <result property="mainCategory" column="MAIN_CATEGORY" javaType="java.lang.String" />
        <result property="mainCategoryNm" column="MAIN_CATEGORY_NM" javaType="java.lang.String" />
        <result property="smallCategory" column="MAIN_CATEGORY" javaType="java.lang.String" />
        <result property="smallCategoryNm" column="SMALL_CATEGORY_NM" javaType="java.lang.String" />
        <result property="dtc" column="DTC" javaType="java.lang.String" />
        <result property="dtcEtc" column="DTC_ETC" javaType="java.lang.String" />
        <result property="consultingDate" column="CONSULTING_DATE" javaType="java.lang.String" />
        <result property="consultingNm" column="CONSULTING_NM" javaType="java.lang.String" />
        <result property="sdAppoint" column="SD_APPOINT" javaType="java.lang.String" />
        <result property="researchDate" column="RESEARCH_DATE" javaType="java.lang.String" />
        <result property="researchNm" column="RESEARCH_NM" javaType="java.lang.String" />
        <result property="researchType" column="RESEARCH_TYPE" javaType="java.lang.String" />
        <result property="researchCont" column="RESEARCH_CONT"  jdbcType="CLOB"  javaType="java.lang.String" />
        <result property="roNo" column="RO_NO" javaType="java.lang.String" />
        <result property="recallReqDate" column="RECALL_REQ_DATE" javaType="java.lang.String" />
        <result property="gqnetIssueDate" column="GQNET_ISSUE_DATE" javaType="java.lang.String" />
        <result property="gqnetNo" column="GQNET_NO" javaType="java.lang.String" />
        <result property="receiveDate" column="RECEIVE_DATE" javaType="java.lang.String" />
        <result property="enginNo" column="ENGIN_NO" javaType="java.lang.String" />
        <result property="removeNo" column="REMOVE_NO" javaType="java.lang.String" />
        <result property="roConfirmDate" column="RO_CONFIRM_DATE" javaType="java.lang.String" />
        <result property="actionType" column="ACTION_TYPE" javaType="java.lang.String" />
        <result property="matDiv" column="MAT_DIV" javaType="java.lang.String" />
        <result property="replacePartNm" column="REPLACE_PART_NM" javaType="java.lang.String" />
        <result property="replacePartNo" column="REPLACE_PART_NO" javaType="java.lang.String" />
        <result property="replacePartCnt" column="REPLACE_PART_CNT" javaType="java.lang.String" />
        <result property="totalAmt" column="TOTAL_AMT" javaType="java.lang.Long" />
        <result property="csrs" column="CSRS" javaType="java.lang.String" />
        <result property="fieldWorkResult" column="FIELD_WORK_RESULT" javaType="java.lang.String" />
        <result property="finalResearchResult" column="FINAL_RESEARCH_RESULT" javaType="java.lang.String" />
        <result property="qualityProblemNm" column="QUALITY_PROBLEM_NM" javaType="java.lang.String" />
        <result property="totalVal" column="TOTAL_VAL" javaType="java.lang.Long" />
        <result property="roSpecialFeature" column="RO_SPECIAL_FEATURE" jdbcType="CLOB" javaType="java.lang.String" />
        <result property="manageNo" column="MANAGE_NO" javaType="java.lang.String" />
        <result property="saleCountry" column="SALE_COUNTRY" javaType="java.lang.String" />
        <result property="consultingExp" column="CONSULTING_EXP" javaType="java.lang.String" />
        <result property="hmcPartNo" column="HMC_PART_NO" javaType="java.lang.String" />
        <result property="partDiv" column="PART_DIV" javaType="java.lang.String" />
        <result property="groupId" column="GROUP_ID" javaType="java.lang.String" />
        <result property="masterId" column="MASTER_ID" javaType="java.lang.String" />
        <result property="repairDate" column="REPAIR_DATE" javaType="java.lang.String" />
        <result property="warrantState" column="WARRANT_STATE" javaType="java.lang.String" />
        <result property="consultingCont" column="CONSULTING_CONT" javaType="java.lang.String" />
        <result property="receiptNm" column="RECEIPT_NM" javaType="java.lang.String" />

    </resultMap>

    <sql id="select_01">
         <!-- 대상 테이블 INDEX 생성 필요 -->
        SELECT Z.*
        ,	   X.CODE_KO_NM AS MAKER_NM
        ,	   Y.CODE_KO_NM AS EXHAUST_REG_NM
        ,	   Q.CODE_KO_NM AS ENGINE_TYPE_NM
        ,	   W.MAIN_CATEGORY_NM AS MAIN_CATEGORY_NM
        FROM   VW_CLAIM_RESULT Z
        LEFT OUTER JOIN (SELECT CODE_CD, CODE_KO_NM
                    FROM TB_CM_CODE
                    WHERE GRP_CD = 'CAMAK' ) X
        ON Z.MAKER = X.CODE_CD
        LEFT OUTER JOIN (SELECT CODE_CD, CODE_KO_NM
                    FROM TB_CM_CODE
                    WHERE GRP_CD = 'C006' ) Y
        ON Z.EXHAUST_REG = Y.CODE_CD
        LEFT OUTER JOIN (SELECT CODE_CD, CODE_KO_NM
                    FROM TB_CM_CODE
                    WHERE GRP_CD = 'C021' ) Q
        ON Z.ENGINE_TYPE = Q.CODE_CD
        LEFT OUTER JOIN TB_BA_MAIN_CATEGORY W
        ON  Z.MAIN_CATEGORY = W.MAIN_CATEGORY
    </sql>

    <sql id="select_02">
        SELECT Z.*
        FROM   VW_CLAIM_RESULT_TYPE Z
        LEFT OUTER JOIN (SELECT CODE_CD, CODE_KO_NM
                    FROM TB_CM_CODE
                    WHERE GRP_CD = 'CAMAK' ) X
        ON Z.MAKER = X.CODE_CD
        LEFT OUTER JOIN (SELECT CODE_CD, CODE_KO_NM
                    FROM TB_CM_CODE
                    WHERE GRP_CD = 'C006' ) Y
        ON Z.EXHAUST_REG = Y.CODE_CD
        LEFT OUTER JOIN (SELECT CODE_CD, CODE_KO_NM
                    FROM TB_CM_CODE
                    WHERE GRP_CD = 'C021' ) Q
        ON Z.ENGINE_TYPE = Q.CODE_CD
        LEFT OUTER JOIN TB_BA_MAIN_CATEGORY W
        ON  Z.MAIN_CATEGORY = W.MAIN_CATEGORY
    </sql>

    <sql id="select_03">
        SELECT Z.*
        FROM   VW_CLAIM_RESULT_EXCEL Z
    </sql>

    <sql id="where_01">
     <!-- 기준일자 -->
      <if test="criteria.dateSearchOption != null and criteria.dateSearchOption != ''">
            <if test="criteria.dateSearchOption == '01'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND RECEIPT_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND RECEIPT_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
          <if test="criteria.dateSearchOption == '02'">
              <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                  AND SALE_DATE  &gt;=  #{criteria.searchResultDateFr}
              </if>
              <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                  AND SALE_DATE  &lt;=  #{criteria.searchResultDateTo}
              </if>
          </if>
          <if test="criteria.dateSearchOption == '03'">
              <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                  AND PROD_DATE  &gt;=  #{criteria.searchResultDateFr}
              </if>
              <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                  AND PROD_DATE  &lt;=  #{criteria.searchResultDateTo}
              </if>
          </if>
      </if>
        <!-- 차종 -->
        <if test="criteria.model != null and criteria.model != ''">
            AND MODEL LIKE '%'||#{criteria.model}||'%'
        </if>
        <!-- 소재지 -->
        <if test="criteria.officeCity != null and criteria.officeCity != ''">
            AND OFFICE_CITY = #{criteria.officeCity}
        </if>
        <!-- 정비소 -->
        <if test="criteria.officeNm != null and criteria.officeNm != ''">
           AND OFFICE_NM LIKE '%'||#{criteria.officeNm}||'%'
        </if>
        <!-- CS/RS -->
        <if test="criteria.csrsSearchOption != null and criteria.csrsSearchOption != ''">
            AND CSRS = #{criteria.csrsSearchOption}
        </if>
        <!-- 생산거점 -->
        <if test="criteria.partGroup != null and criteria.partGroup != ''">
            AND PART_GROUP = #{criteria.partGroup}
        </if>
        <!-- 메이커 -->
        <if test="criteria.maker != null and criteria.maker != ''">
            AND MAKER = #{criteria.maker}
        </if>
        <!-- 승상용 -->
        <if test="criteria.tireStd != null and criteria.tireStd != ''">
            AND TIRE_STD = #{criteria.tireStd}
        </if>
        <!-- 문의품구분 -->
        <if test="criteria.inquiryGubun != null and criteria.inquiryGubun != ''">
            AND INQUIRY_GUBUN = #{criteria.inquiryGubun}
        </if>
        <!-- 품질문제명 -->
        <if test="criteria.qualityProblemNm != null and criteria.qualityProblemNm != ''">
            AND QUALITY_PROBLEM_NM = #{criteria.qualityProblemNm}
        </if>
        <!-- 접수구분 -->
        <if test="criteria.div != null and criteria.div != ''">
            AND DIV = #{criteria.div}
        </if>
        <!-- 판매국가 -->
        <if test="criteria.saleCountry != null and criteria.saleCountry != ''">
            AND SALE_COUNTRY = #{criteria.saleCountry}
        </if>
        <!-- 엔진형식 -->
        <if test="criteria.engineType != null and criteria.engineType != ''">
            AND ENGINE_TYPE = #{criteria.engineType}
        </if>
        <!-- 배기형식 -->
        <if test="criteria.exhaustReg != null and criteria.exhaustReg != ''">
            AND EXHAUST_REG = #{criteria.exhaustReg}
        </if>
        <!-- 주원인품명 -->
        <if test="criteria.replacePartNo != null and criteria.replacePartNo != ''">
            AND REPLACE_PART_NO LIKE '%'||#{criteria.replacePartNo}||'%'
        </if>
        <!-- 고객품번 -->
        <if test="criteria.hmcPartNo != null and criteria.hmcPartNo != ''">
            AND HMC_PART_NO LIKE '%'||#{criteria.hmcPartNo}||'%'
        </if>
        <!-- VINNO -->
        <if test="criteria.vinno != null and criteria.vinno != ''">
            AND VINNO LIKE '%'||UPPER(#{criteria.vinno})||'%'
        </if>
        <!-- RO등록 -->
        <if test="criteria.roSearchOption != null and criteria.roSearchOption != ''">
             <if test="criteria.roSearchOption == '01'">
                 AND (RO_NO != ' ' AND RO_NO IS NOT NULL)
             </if>
            <if test="criteria.roSearchOption == '02'">
                 AND (RO_NO = ' ' OR RO_NO IS NULL)
            </if>
        </if>
        <!-- GQNET No. -->
        <if test="criteria.gqnetNo != null and criteria.gqnetNo != ''">
            AND GQNET_NO LIKE '%'||UPPER(#{criteria.gqnetNo})||'%'
        </if>
        <!-- R/O NO -->
        <if test="criteria.roNo != null and criteria.roNo != ''">
            AND RO_NO LIKE '%'||UPPER(#{criteria.roNo})||'%'
        </if>
        <!-- 주행거리 -->
        <if test="criteria.mileage != null and criteria.mileage != ''">
            AND MILEAGE = #{criteria.mileage}
        </if>
    </sql>

    <sql id="where_02">
        AND DIV &lt;&gt; '02'
        AND RECEIPT_DATE  &gt;=   TO_CHAR(SYSDATE-10,'YYYYMMDD')
        AND RECEIPT_DATE  &lt;=   TO_CHAR(SYSDATE,'YYYYMMDD')
        <if test='value != null'>
            AND CONSULTING_NM = #{uname} OR SD_APPOINT = #{uname}
        </if>
    </sql>

    <sql id="where_03">
        <!-- 기준일자 -->
        <if test="criteria.dateSearchOption != null and criteria.dateSearchOption != ''">
            <if test="criteria.dateSearchOption == '01'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND RECEIPT_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND RECEIPT_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
            <if test="criteria.dateSearchOption == '02'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND SALE_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND SALE_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
            <if test="criteria.dateSearchOption == '03'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND PROD_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND PROD_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
        </if>
        <!-- 차종 -->
        <if test="criteria.model != null and criteria.model != ''">
            AND MODEL LIKE '%'||#{criteria.model}||'%'
        </if>
        <!-- 소재지 -->
        <if test="criteria.officeCity != null and criteria.officeCity != ''">
            AND OFFICE_CITY = #{criteria.officeCity}
        </if>
        <!-- 정비소 -->
        <if test="criteria.officeNm != null and criteria.officeNm != ''">
            AND OFFICE_NM LIKE '%'||#{criteria.officeNm}||'%'
        </if>
        <!-- CS/RS -->
        <if test="criteria.csrsSearchOption != null and criteria.csrsSearchOption != ''">
            AND CSRS = #{criteria.csrsSearchOption}
        </if>
        <!-- 생산거점 -->
        <if test="criteria.partGroup != null and criteria.partGroup != ''">
            AND PART_GROUP = #{criteria.partGroup}
        </if>
        <!-- 메이커 -->
        <if test="criteria.maker != null and criteria.maker != ''">
            AND MAKER = #{criteria.maker}
        </if>
        <!-- 승상용 -->
        <if test="criteria.tireStd != null and criteria.tireStd != ''">
            AND TIRE_STD = #{criteria.tireStd}
        </if>
        <!-- 문의품구분 -->
        <if test="criteria.inquiryGubun != null and criteria.inquiryGubun != ''">
            AND INQUIRY_GUBUN = #{criteria.inquiryGubun}
        </if>
        <!-- 품질문제명 -->
        <if test="criteria.qualityProblemNm != null and criteria.qualityProblemNm != ''">
            AND QUALITY_PROBLEM_NM = #{criteria.qualityProblemNm}
        </if>
        <!-- 접수구분 -->
        <if test="criteria.div != null and criteria.div != ''">
            AND DIV = #{criteria.div}
        </if>
        <!-- 판매국가 -->
        <if test="criteria.saleCountry != null and criteria.saleCountry != ''">
            AND SALE_COUNTRY = #{criteria.saleCountry}
        </if>
        <!-- 엔진형식 -->
        <if test="criteria.engineType != null and criteria.engineType != ''">
            AND ENGINE_TYPE = #{criteria.engineType}
        </if>
        <!-- 배기형식 -->
        <if test="criteria.exhaustReg != null and criteria.exhaustReg != ''">
            AND EXHAUST_REG = #{criteria.exhaustReg}
        </if>
        <!-- 주원인품명 -->
        <if test="criteria.replacePartNo != null and criteria.replacePartNo != ''">
            AND REPLACE_PART_NO LIKE '%'||#{criteria.replacePartNo}||'%'
        </if>
        <!-- 고객품번 -->
        <if test="criteria.hmcPartNo != null and criteria.hmcPartNo != ''">
            AND HMC_PART_NO LIKE '%'||#{criteria.hmcPartNo}||'%'
        </if>
        <!-- VINNO -->
        <if test="criteria.vinno != null and criteria.vinno != ''">
            AND VINNO LIKE '%'||UPPER(#{criteria.vinno})||'%'
        </if>
        <!-- RO등록 -->
        <if test="criteria.roSearchOption != null and criteria.roSearchOption != ''">
            <if test="criteria.roSearchOption == '01'">
                AND (RO_NO != ' ' AND RO_NO IS NOT NULL)
            </if>
            <if test="criteria.roSearchOption == '02'">
                AND (RO_NO = ' ' OR RO_NO IS NULL)
            </if>
        </if>
        <!-- GQNET No. -->
        <if test="criteria.gqnetNo != null and criteria.gqnetNo != ''">
            AND GQNET_NO LIKE '%'||UPPER(#{criteria.gqnetNo})||'%'
        </if>
        <!-- R/O NO -->
        <if test="criteria.roNo != null and criteria.roNo != ''">
            AND RO_NO LIKE '%'||UPPER(#{criteria.roNo})||'%'
        </if>
        <!-- 주행거리 -->
        <if test="criteria.mileage != null and criteria.mileage != ''">
            AND MILEAGE = #{criteria.mileage}
        </if>

         AND MANAGE_NO IN  (   SELECT  Y.MANAGE_NO
                           FROM    VW_CLAIM_CONDITION Y
                           WHERE   Y.INQUIRY_GUBUN  = #{criteria.mainType}
                           <if test="criteria.statusUsr != null and criteria.statusUsr != ''">
                           AND     Y.RECEIPT_NM = #{criteria.statusUsr}
                           </if> )

    </sql>
    <sql id="where_04">
        <!-- 기준일자 -->
        <if test="criteria.dateSearchOption != null and criteria.dateSearchOption != ''">
            <if test="criteria.dateSearchOption == '01'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND RECEIPT_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND RECEIPT_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
            <if test="criteria.dateSearchOption == '02'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND SALE_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND SALE_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
            <if test="criteria.dateSearchOption == '03'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND PROD_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND PROD_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
        </if>
        <!-- 차종 -->
        <if test="criteria.model != null and criteria.model != ''">
            AND MODEL LIKE '%'||#{criteria.model}||'%'
        </if>
        <!-- 소재지 -->
        <if test="criteria.officeCity != null and criteria.officeCity != ''">
            AND OFFICE_CITY = #{criteria.officeCity}
        </if>
        <!-- 정비소 -->
        <if test="criteria.officeNm != null and criteria.officeNm != ''">
            AND OFFICE_NM LIKE '%'||#{criteria.officeNm}||'%'
        </if>
        <!-- CS/RS -->
        <if test="criteria.csrsSearchOption != null and criteria.csrsSearchOption != ''">
            AND CSRS = #{criteria.csrsSearchOption}
        </if>
        <!-- 생산거점 -->
        <if test="criteria.partGroup != null and criteria.partGroup != ''">
            AND PART_GROUP = #{criteria.partGroup}
        </if>
        <!-- 메이커 -->
        <if test="criteria.maker != null and criteria.maker != ''">
            AND MAKER = #{criteria.maker}
        </if>
        <!-- 승상용 -->
        <if test="criteria.tireStd != null and criteria.tireStd != ''">
            AND TIRE_STD = #{criteria.tireStd}
        </if>
        <!-- 문의품구분 -->
        <if test="criteria.inquiryGubun != null and criteria.inquiryGubun != ''">
            AND INQUIRY_GUBUN = #{criteria.inquiryGubun}
        </if>
        <!-- 품질문제명 -->
        <if test="criteria.qualityProblemNm != null and criteria.qualityProblemNm != ''">
            AND QUALITY_PROBLEM_NM = #{criteria.qualityProblemNm}
        </if>
        <!-- 접수구분 -->
        <if test="criteria.div != null and criteria.div != ''">
            AND DIV = #{criteria.div}
        </if>
        <!-- 판매국가 -->
        <if test="criteria.saleCountry != null and criteria.saleCountry != ''">
            AND SALE_COUNTRY = #{criteria.saleCountry}
        </if>
        <!-- 엔진형식 -->
        <if test="criteria.engineType != null and criteria.engineType != ''">
            AND ENGINE_TYPE = #{criteria.engineType}
        </if>
        <!-- 배기형식 -->
        <if test="criteria.exhaustReg != null and criteria.exhaustReg != ''">
            AND EXHAUST_REG = #{criteria.exhaustReg}
        </if>
        <!-- 주원인품명 -->
        <if test="criteria.replacePartNo != null and criteria.replacePartNo != ''">
            AND REPLACE_PART_NO LIKE '%'||#{criteria.replacePartNo}||'%'
        </if>
        <!-- 고객품번 -->
        <if test="criteria.hmcPartNo != null and criteria.hmcPartNo != ''">
            AND HMC_PART_NO LIKE '%'||#{criteria.hmcPartNo}||'%'
        </if>
        <!-- VINNO -->
        <if test="criteria.vinno != null and criteria.vinno != ''">
            AND VINNO LIKE '%'||UPPER(#{criteria.vinno})||'%'
        </if>
        <!-- RO등록 -->
        <if test="criteria.roSearchOption != null and criteria.roSearchOption != ''">
            <if test="criteria.roSearchOption == '01'">
                AND (RO_NO != ' ' AND RO_NO IS NOT NULL)
            </if>
            <if test="criteria.roSearchOption == '02'">
                AND (RO_NO = ' ' OR RO_NO IS NULL)
            </if>
        </if>
        <!-- GQNET No. -->
        <if test="criteria.gqnetNo != null and criteria.gqnetNo != ''">
            AND GQNET_NO LIKE '%'||UPPER(#{criteria.gqnetNo})||'%'
        </if>
        <!-- R/O NO -->
        <if test="criteria.roNo != null and criteria.roNo != ''">
            AND RO_NO LIKE '%'||UPPER(#{criteria.roNo})||'%'
        </if>
        <!-- 주행거리 -->
        <if test="criteria.mileage != null and criteria.mileage != ''">
            AND MILEAGE = #{criteria.mileage}
        </if>
          AND MANAGE_NO IN  (
                            SELECT  MANAGE_NO
                            FROM    TB_DC_SERVICE_MASTER  A
                            WHERE   A.CONDITION = '02'
                            AND     A.MANAGE_NO IN ( SELECT MANAGE_NO
                                                    FROM   TB_DC_CONSULTING
                                                    WHERE  0 = 0
                                                    <if test="criteria.statusUsr != null and criteria.statusUsr != ''">
                                                        AND CONSULTING_NM = #{criteria.statusUsr}
                                                    </if>  )
                          )
    </sql>
    <sql id="where_05">
        <!-- 기준일자 -->
        <if test="criteria.dateSearchOption != null and criteria.dateSearchOption != ''">
            <if test="criteria.dateSearchOption == '01'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND RECEIPT_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND RECEIPT_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
            <if test="criteria.dateSearchOption == '02'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND SALE_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND SALE_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
            <if test="criteria.dateSearchOption == '03'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND PROD_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND PROD_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
        </if>
        <!-- 차종 -->
        <if test="criteria.model != null and criteria.model != ''">
            AND MODEL LIKE '%'||#{criteria.model}||'%'
        </if>
        <!-- 소재지 -->
        <if test="criteria.officeCity != null and criteria.officeCity != ''">
            AND OFFICE_CITY = #{criteria.officeCity}
        </if>
        <!-- 정비소 -->
        <if test="criteria.officeNm != null and criteria.officeNm != ''">
            AND OFFICE_NM LIKE '%'||#{criteria.officeNm}||'%'
        </if>
        <!-- CS/RS -->
        <if test="criteria.csrsSearchOption != null and criteria.csrsSearchOption != ''">
            AND CSRS = #{criteria.csrsSearchOption}
        </if>
        <!-- 생산거점 -->
        <if test="criteria.partGroup != null and criteria.partGroup != ''">
            AND PART_GROUP = #{criteria.partGroup}
        </if>
        <!-- 메이커 -->
        <if test="criteria.maker != null and criteria.maker != ''">
            AND MAKER = #{criteria.maker}
        </if>
        <!-- 승상용 -->
        <if test="criteria.tireStd != null and criteria.tireStd != ''">
            AND TIRE_STD = #{criteria.tireStd}
        </if>
        <!-- 문의품구분 -->
        <if test="criteria.inquiryGubun != null and criteria.inquiryGubun != ''">
            AND INQUIRY_GUBUN = #{criteria.inquiryGubun}
        </if>
        <!-- 품질문제명 -->
        <if test="criteria.qualityProblemNm != null and criteria.qualityProblemNm != ''">
            AND QUALITY_PROBLEM_NM = #{criteria.qualityProblemNm}
        </if>
        <!-- 접수구분 -->
        <if test="criteria.div != null and criteria.div != ''">
            AND DIV = #{criteria.div}
        </if>
        <!-- 판매국가 -->
        <if test="criteria.saleCountry != null and criteria.saleCountry != ''">
            AND SALE_COUNTRY = #{criteria.saleCountry}
        </if>
        <!-- 엔진형식 -->
        <if test="criteria.engineType != null and criteria.engineType != ''">
            AND ENGINE_TYPE = #{criteria.engineType}
        </if>
        <!-- 배기형식 -->
        <if test="criteria.exhaustReg != null and criteria.exhaustReg != ''">
            AND EXHAUST_REG = #{criteria.exhaustReg}
        </if>
        <!-- 주원인품명 -->
        <if test="criteria.replacePartNo != null and criteria.replacePartNo != ''">
            AND REPLACE_PART_NO LIKE '%'||#{criteria.replacePartNo}||'%'
        </if>
        <!-- 고객품번 -->
        <if test="criteria.hmcPartNo != null and criteria.hmcPartNo != ''">
            AND HMC_PART_NO LIKE '%'||#{criteria.hmcPartNo}||'%'
        </if>
        <!-- VINNO -->
        <if test="criteria.vinno != null and criteria.vinno != ''">
            AND VINNO LIKE '%'||UPPER(#{criteria.vinno})||'%'
        </if>
        <!-- RO등록 -->
        <if test="criteria.roSearchOption != null and criteria.roSearchOption != ''">
            <if test="criteria.roSearchOption == '01'">
                AND (RO_NO != ' ' AND RO_NO IS NOT NULL)
            </if>
            <if test="criteria.roSearchOption == '02'">
                AND (RO_NO = ' ' OR RO_NO IS NULL)
            </if>
        </if>
        <!-- GQNET No. -->
        <if test="criteria.gqnetNo != null and criteria.gqnetNo != ''">
            AND GQNET_NO LIKE '%'||UPPER(#{criteria.gqnetNo})||'%'
        </if>
        <!-- R/O NO -->
        <if test="criteria.roNo != null and criteria.roNo != ''">
            AND RO_NO LIKE '%'||UPPER(#{criteria.roNo})||'%'
        </if>
        <!-- 주행거리 -->
        <if test="criteria.mileage != null and criteria.mileage != ''">
            AND MILEAGE = #{criteria.mileage}
        </if>
        AND MANAGE_NO IN  (
                        SELECT  MANAGE_NO
                        FROM    TB_DC_SERVICE_MASTER  A
                        WHERE   A.CONDITION = '04'
                        AND     A.MANAGE_NO IN ( SELECT MANAGE_NO
                                                FROM    TB_DC_CONSULTING
                                                WHERE  0 = 0
                                                <if test="criteria.statusUsr != null and criteria.statusUsr != ''">
                                                    AND CONSULTING_NM = #{criteria.statusUsr}
                                                </if>  )
        )
    </sql>

    <sql id="where_06">
        <!-- 기준일자 -->
        <if test="criteria.dateSearchOption != null and criteria.dateSearchOption != ''">
            <if test="criteria.dateSearchOption == '01'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND RECEIPT_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND RECEIPT_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
            <if test="criteria.dateSearchOption == '02'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND SALE_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND SALE_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
            <if test="criteria.dateSearchOption == '03'">
                <if test="criteria.searchResultDateFr != null and criteria.searchResultDateFr != ''">
                    AND PROD_DATE  &gt;=  #{criteria.searchResultDateFr}
                </if>
                <if test="criteria.searchResultDateTo != null and criteria.searchResultDateTo != ''">
                    AND PROD_DATE  &lt;=  #{criteria.searchResultDateTo}
                </if>
            </if>
        </if>
        <!-- 차종 -->
        <if test="criteria.model != null and criteria.model != ''">
            AND MODEL LIKE '%'||#{criteria.model}||'%'
        </if>
        <!-- 소재지 -->
        <if test="criteria.officeCity != null and criteria.officeCity != ''">
            AND OFFICE_CITY = #{criteria.officeCity}
        </if>
        <!-- 정비소 -->
        <if test="criteria.officeNm != null and criteria.officeNm != ''">
            AND OFFICE_NM LIKE '%'||#{criteria.officeNm}||'%'
        </if>
        <!-- CS/RS -->
        <if test="criteria.csrsSearchOption != null and criteria.csrsSearchOption != ''">
            AND CSRS = #{criteria.csrsSearchOption}
        </if>
        <!-- 생산거점 -->
        <if test="criteria.partGroup != null and criteria.partGroup != ''">
            AND PART_GROUP = #{criteria.partGroup}
        </if>
        <!-- 메이커 -->
        <if test="criteria.maker != null and criteria.maker != ''">
            AND MAKER = #{criteria.maker}
        </if>
        <!-- 승상용 -->
        <if test="criteria.tireStd != null and criteria.tireStd != ''">
            AND TIRE_STD = #{criteria.tireStd}
        </if>
        <!-- 문의품구분 -->
        <if test="criteria.inquiryGubun != null and criteria.inquiryGubun != ''">
            AND INQUIRY_GUBUN = #{criteria.inquiryGubun}
        </if>
        <!-- 품질문제명 -->
        <if test="criteria.qualityProblemNm != null and criteria.qualityProblemNm != ''">
            AND QUALITY_PROBLEM_NM = #{criteria.qualityProblemNm}
        </if>
        <!-- 접수구분 -->
        <if test="criteria.div != null and criteria.div != ''">
            AND DIV = #{criteria.div}
        </if>
        <!-- 판매국가 -->
        <if test="criteria.saleCountry != null and criteria.saleCountry != ''">
            AND SALE_COUNTRY = #{criteria.saleCountry}
        </if>
        <!-- 엔진형식 -->
        <if test="criteria.engineType != null and criteria.engineType != ''">
            AND ENGINE_TYPE = #{criteria.engineType}
        </if>
        <!-- 배기형식 -->
        <if test="criteria.exhaustReg != null and criteria.exhaustReg != ''">
            AND EXHAUST_REG = #{criteria.exhaustReg}
        </if>
        <!-- 주원인품명 -->
        <if test="criteria.replacePartNo != null and criteria.replacePartNo != ''">
            AND REPLACE_PART_NO LIKE '%'||#{criteria.replacePartNo}||'%'
        </if>
        <!-- 고객품번 -->
        <if test="criteria.hmcPartNo != null and criteria.hmcPartNo != ''">
            AND HMC_PART_NO LIKE '%'||#{criteria.hmcPartNo}||'%'
        </if>
        <!-- VINNO -->
        <if test="criteria.vinno != null and criteria.vinno != ''">
            AND VINNO LIKE '%'||UPPER(#{criteria.vinno})||'%'
        </if>
        <!-- RO등록 -->
        <if test="criteria.roSearchOption != null and criteria.roSearchOption != ''">
            <if test="criteria.roSearchOption == '01'">
                AND (RO_NO != ' ' AND RO_NO IS NOT NULL)
            </if>
            <if test="criteria.roSearchOption == '02'">
                AND (RO_NO = ' ' OR RO_NO IS NULL)
            </if>
        </if>
        <!-- GQNET No. -->
        <if test="criteria.gqnetNo != null and criteria.gqnetNo != ''">
            AND GQNET_NO LIKE '%'||UPPER(#{criteria.gqnetNo})||'%'
        </if>
        <!-- R/O NO -->
        <if test="criteria.roNo != null and criteria.roNo != ''">
            AND RO_NO LIKE '%'||UPPER(#{criteria.roNo})||'%'
        </if>
        <!-- 주행거리 -->
        <if test="criteria.mileage != null and criteria.mileage != ''">
            AND MILEAGE = #{criteria.mileage}
        </if>
        AND VINNO IN  (
        SELECT  VINNO
        FROM    TB_DC_SERVICE_MASTER  A
        WHERE    0 = 0
        <if test="criteria.statusUsr != null and criteria.statusUsr != ''">
            AND A.OFFICE_CODE = #{criteria.statusUsr}
        </if>  )
    </sql>

    <select id="searchByKey" resultMap="rsMap" parameterType="com.globaldenso.dicas.business.domain.ClaimVehicleDomain">
        SELECT *
        FROM (
        <include refid="select_01"/>
        ) AA
        WHERE AA.VINNO = UPPER(#{vinno})
        AND ROWNUM = 1
    </select>

    <select id="searchByCondition" resultMap="rsMap" parameterType="Map">

        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
            <include refid="select_01" />
            <where>
                <include refid="where_01"/>
            </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA

        <if test="pageable != null">
            WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
        </if>
        ORDER BY RN

    </select>

    <select id="searchByPopupCondition" resultMap="rsMap" parameterType="Map">

        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_06"/>
        </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA

        <if test="pageable != null">
            WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
        </if>
        ORDER BY RN

    </select>


    <select id="searchByConditionDownload"  resultMap="rsMap2" parameterType="Map">
        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_03" />
        <where>
            <include refid="where_01"/>
        </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA
        ORDER BY RN
    </select>

    <select id="searchByByMainIngListDownload"  resultMap="rsMap2" parameterType="Map">
        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_03" />
        <where>
            <include refid="where_04"/>
        </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA
        ORDER BY RN
    </select>

    <select id="searchByMainRsListDownLoad"  resultMap="rsMap2" parameterType="Map">
        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_03" />
        <where>
            <include refid="where_05"/>
        </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA
        ORDER BY RN
    </select>

    <select id="searchByTypeDownload"  resultMap="rsMap2" parameterType="Map">
        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_03" />
        <where>
            <include refid="where_03"/>
        </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA
        ORDER BY RN
    </select>

    <select id="searchCount1" resultType="int" parameterType="Map">

        SELECT COUNT(ID) AS CNT
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_01"/>
        </where>
        ) AA

    </select>

    <select id="searchCount2" resultType="int" parameterType="Map">

        SELECT COUNT(ID) AS CNT
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_06"/>
        </where>
        ) AA
        
    </select>

    <select id="searchByMain" resultMap="rsMap">
	WITH TEST1 AS
	(
 		SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
 		UNION ALL
 		SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
 		UNION ALL
 		SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
	)
	SELECT * FROM TEST1
    </select>

    <!-- 사용자별 조건 -->
    <select id="searchByMainUser" resultMap="rsMap">
	WITH TEST1 AS
	(
 		SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
 		UNION ALL
 		SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
 		UNION ALL
 		SELECT '111' RN, '1' ID,'KR_000013153' MANGE_NO, '20210510' RECEIPT_DATE, '20200511' SALE_DATE, '20200504' PROD_DATE, '01' DIV, '01' SALE_COUNTRY, '콜대상' CALL_STATUS, NULL CSRS, 'AK3680' OFFICE_CODE, '동남모터스' OFFICE_NM, '101' OFFICE_CITY, '1940038' CONSULTING_EXP, '238242' VINNO, '02' MAKER, '34' ENGINE_TYPE, '04' EXHAUST_REG, 'SORENTO' MODEL, NULL MAIN_CATEGORY, NULL REPLACE_PART_NO, NULL REPLACE_PART_NM, NULL RECALL_REQ_DATE, '02' STAUS_CODE, '상담' STATUS, 'EGR-V' INQUIRY, '01' TIRE_STD, '03' INQUIRY_GUBUN, NULL QUALITY_PROBLEM_NM, NULL RO_NO, NULL GQNET_NO, '03' PART_DIV, NULL GROUP_ID, '10269' MILEAGE, '20210510000001' MASTER_ID, '1940038' CONSULTING_NM, NULL SD_APPOINT FROM DUAL
	)
	SELECT * FROM TEST1
    </select>

    <!-- 조건절 현업 결정 후 추가 / SD 조건절 추가
         AND TO_CHAR(RECEIPT_DATE,'YYYYMMDD') &gt;= TO_CHAR(ADD_MONTHS(SYSDATE,-1),'YYYYMMDD')
         AND TO_CHAR(RECEIPT_DATE,'YYYYMMDD') &lt;= TO_CHAR(SYSDATE,'YYYYMMDD');  -->

    <select id="searchByMainClaimProcessCnt" resultType="int" parameterType="String">
      WITH TEST1 AS (SELECT 0 CNT FROM DUAL)

		SELECT * FROM TEST1

    </select>

    <!-- 진행 -->
    <select id="searchByMainIngCnt" resultType="int">
        SELECT  NVL(COUNT(*),0) AS CNT
        FROM    TB_DC_SERVICE_MASTER  A
        WHERE   A.CONDITION = '02'
        AND     A.MANAGE_NO IN ( SELECT MANAGE_NO
                                    FROM   TB_DC_CONSULTING
                                    WHERE  0 = 0
                                    <if test='value != null'>
                                        AND CONSULTING_NM = #{uname}
                                    </if>  )

    </select>

    <!-- 결과 -->
    <select id="searchByMaingRsCnt" resultType="int">
        SELECT  NVL(COUNT(*),0) AS CNT
        FROM    TB_DC_SERVICE_MASTER  A
        WHERE   A.CONDITION = '04'
        AND     A.MANAGE_NO IN ( SELECT MANAGE_NO
                                 FROM   TB_DC_CONSULTING
                                 WHERE  0 = 0
                                <if test='value != null'>
                                    AND CONSULTING_NM = #{uname}
                                </if>  )
    </select>

    <select id="searchByMaingPerCnt" resultType="int">
        SELECT CEIL((B.RS_CNT / DECODE(A.TOT_CNT,0,1,A.TOT_CNT)  ) * 100) AS PER_CNT
        FROM (
              SELECT NVL(COUNT(*),0) TOT_CNT
              FROM   TB_DC_CONSULTING
              WHERE  0 = 0
            <if test='value != null'>
                AND CONSULTING_NM = #{uname}
            </if>
          ) A ,
            (SELECT  NVL(COUNT(*),0) AS RS_CNT
             FROM    TB_DC_SERVICE_MASTER  A
             WHERE   A.CONDITION = '04'
             AND     A.MANAGE_NO IN ( SELECT MANAGE_NO
                                    FROM   TB_DC_CONSULTING
                                    WHERE  0 = 0
                                    <if test='value != null'>
                                        AND CONSULTING_NM = #{uname}
                                    </if>
                                    )  ) B
    </select>

    <select id="searchByMainClaimPerCnt" resultType="int">
       WITH TEST1 AS (SELECT 0 PER_CNT FROM DUAL)

		SELECT * FROM TEST1
    </select>

    <!-- 고품회수별 관리자별 검색조건  -->
    <select id="searchByType" resultMap="rsMap" parameterType="Map">
        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
            <include refid="select_01" />
            <where>
                <include refid="where_03"/>
            </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA

        <if test="pageable != null">
            WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
        </if>
        ORDER BY RN
    </select>

    <!-- 고품회수별 관리자별 검색조건 수  -->
    <select id="searchByTypeCount" resultType="int" parameterType="Map">

        SELECT COUNT(*) AS CNT
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_03"/>
        </where>
        ) A
    </select>

    <select id="searchByMainIngList" resultMap="rsMap" parameterType="Map">
        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_04"/>
        </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA

        <if test="pageable != null">
            WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
        </if>
        ORDER BY RN
    </select>

    <select id="searchByMainIngListCount" resultType="int" parameterType="Map">
        SELECT COUNT(*) AS CNT
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_04"/>
        </where>
        ) A
    </select>


    <select id="searchByMainRsList" resultMap="rsMap" parameterType="Map">
        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_05"/>
        </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA

        <if test="pageable != null">
            WHERE RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
        </if>
        ORDER BY RN
    </select>

    <select id="searchByMainRsListCount" resultType="int" parameterType="Map">
        SELECT COUNT(*) AS CNT
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_05"/>
        </where>
        ) A
    </select>

    <select id="searchByConditionRecpDt" resultMap="rsMap" parameterType="Map">
      SELECT
        *
        FROM (
            SELECT
                ROWNUM AS RN
                , A.*
            FROM (
            <include refid="select_01" />
            <where>
                <include refid="where_06"/>
            </where>
            ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA
        WHERE 1=1
          AND RECEIPT_DATE IS NOT NULL

        <if test="pageable != null">
            AND RN BETWEEN ((${pageable.pageNumber} - 1) * ${pageable.pageSize}) + 1 AND ${pageable.offset}
        </if>
        ORDER BY RN
    </select>

    <select id="searchCount3" resultType="int" parameterType="Map">

        SELECT COUNT(ID) AS CNT
        FROM (
        <include refid="select_01" />
        <where>
            <include refid="where_01"/>
        </where>
        ) AA
        WHERE RECEIPT_DATE IS NOT NULL
    </select>

    <select id="searchByConditionDownloadRecpDt"  resultMap="rsMap2" parameterType="Map">
        SELECT *
        FROM (
        SELECT ROWNUM AS RN, A.*
        FROM (
        <include refid="select_03" />
        <where>
            <include refid="where_01"/>
        </where>
        ) A
        ORDER BY A.RECEIPT_DATE DESC
        ) AA
        WHERE 1=1
          AND RECEIPT_DATE IS NOT NULL
        ORDER BY RN
    </select>

</mapper>
