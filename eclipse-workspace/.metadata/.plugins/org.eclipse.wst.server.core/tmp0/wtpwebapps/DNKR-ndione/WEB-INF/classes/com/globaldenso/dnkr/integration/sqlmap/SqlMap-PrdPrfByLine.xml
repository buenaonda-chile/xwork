<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.globaldenso.dnkr.integration.dao.PrdPrfByLineDao">

<!-- 検索結果をMapで受け取る -->
    <resultMap id="PrdPrfByLine" type="PrdPrfByLineDomain">
        <result property="clsCode" column="CLS_CODE" />
        <result property="lineCode" column="LINE_CODE" />
        <result property="lineNm" column="LINE_NM" />        
        <result property="prdtNo" column="PRDT_NO" />  
        <result property="prdtNm" column="PRDT_NM" />         
        <result property="locCode" column="LOC_CODE" /> 

        <result property="cycleTime" column="CYCLE_TIME" />
        <result property="uph" column="UPH" />        
                
        <result property="year" column="YEAR" />         
        <result property="fsHalf" column="FS_HALF" />         
                
        <result property="colNm" column="COL_NM" />
        <result property="totHrMntD01" column="TOT_HR_MNT_D01" />
        <result property="totHrMntD02" column="TOT_HR_MNT_D02" />
        <result property="totHrMntD03" column="TOT_HR_MNT_D03" />
        <result property="totHrMntD04" column="TOT_HR_MNT_D04" />
        <result property="totHrMntD05" column="TOT_HR_MNT_D05" />
        <result property="totHrMntD06" column="TOT_HR_MNT_D06" />
        <result property="totHrMntD07" column="TOT_HR_MNT_D07" />
        <result property="totHrMntD08" column="TOT_HR_MNT_D08" />
        <result property="totHrMntD09" column="TOT_HR_MNT_D09" />
        <result property="totHrMntD10" column="TOT_HR_MNT_D10" />
        <result property="totHrMntD11" column="TOT_HR_MNT_D11" />
        <result property="totHrMntD12" column="TOT_HR_MNT_D12" />
        <result property="totHrMntD13" column="TOT_HR_MNT_D13" />
        <result property="totHrMntD14" column="TOT_HR_MNT_D14" />
        <result property="totHrMntD15" column="TOT_HR_MNT_D15" />
        <result property="totHrMntD16" column="TOT_HR_MNT_D16" />
        <result property="totHrMntD17" column="TOT_HR_MNT_D17" />
        <result property="totHrMntD18" column="TOT_HR_MNT_D18" />
        <result property="totHrMntD19" column="TOT_HR_MNT_D19" />
        <result property="totHrMntD20" column="TOT_HR_MNT_D20" />
        <result property="totHrMntD21" column="TOT_HR_MNT_D21" />
        <result property="totHrMntD22" column="TOT_HR_MNT_D22" />
        <result property="totHrMntD23" column="TOT_HR_MNT_D23" />
        <result property="totHrMntD24" column="TOT_HR_MNT_D24" />
        <result property="totHrMntD25" column="TOT_HR_MNT_D25" />
        <result property="totHrMntD26" column="TOT_HR_MNT_D26" />
        <result property="totHrMntD27" column="TOT_HR_MNT_D27" />
        <result property="totHrMntD28" column="TOT_HR_MNT_D28" />
        <result property="totHrMntD29" column="TOT_HR_MNT_D29" />
        <result property="totHrMntD30" column="TOT_HR_MNT_D30" />
        <result property="totHrMntD31" column="TOT_HR_MNT_D31" />
        
        <result property="hrMntD01" column="HR_MNT_D01" />
        <result property="hrMntD02" column="HR_MNT_D02" />
        <result property="hrMntD03" column="HR_MNT_D03" />
        <result property="hrMntD04" column="HR_MNT_D04" />
        <result property="hrMntD05" column="HR_MNT_D05" />
        <result property="hrMntD06" column="HR_MNT_D06" />
        <result property="hrMntD07" column="HR_MNT_D07" />
        <result property="hrMntD08" column="HR_MNT_D08" />
        <result property="hrMntD09" column="HR_MNT_D09" />
        <result property="hrMntD10" column="HR_MNT_D10" />
        <result property="hrMntD11" column="HR_MNT_D11" />
        <result property="hrMntD12" column="HR_MNT_D12" />
        <result property="hrMntD13" column="HR_MNT_D13" />
        <result property="hrMntD14" column="HR_MNT_D14" />
        <result property="hrMntD15" column="HR_MNT_D15" />
        <result property="hrMntD16" column="HR_MNT_D16" />
        <result property="hrMntD17" column="HR_MNT_D17" />
        <result property="hrMntD18" column="HR_MNT_D18" />
        <result property="hrMntD19" column="HR_MNT_D19" />
        <result property="hrMntD20" column="HR_MNT_D20" />
        <result property="hrMntD21" column="HR_MNT_D21" />
        <result property="hrMntD22" column="HR_MNT_D22" />
        <result property="hrMntD23" column="HR_MNT_D23" />
        <result property="hrMntD24" column="HR_MNT_D24" />
        <result property="hrMntD25" column="HR_MNT_D25" />
        <result property="hrMntD26" column="HR_MNT_D26" />
        <result property="hrMntD27" column="HR_MNT_D27" />
        <result property="hrMntD28" column="HR_MNT_D28" />
        <result property="hrMntD29" column="HR_MNT_D29" />
        <result property="hrMntD30" column="HR_MNT_D30" />
        <result property="hrMntD31" column="HR_MNT_D31" />        
        <result property="seNm" column="SE_NM" />
        <result property="codeNm" column="CODE_NM" />
        <result property="code" column="CODE" />
        <result property="se" column="SE" />       
        <result property="hrMntTot" column="HR_MNT_TOT" />
        <result property="ptmTot" column="PTM_TOT" />
        <result property="hrMntDeTot" column="HR_MNT_DE_TOT" />
        <result property="dCodeSumCnt" column="D_CODE_SUM_CNT" />
        <result property="bCodeSumCnt" column="B_CODE_SUM_CNT" />
        <result property="cCodeSumCnt" column="C_CODE_SUM_CNT" />
        

    </resultMap>

	<!-- 손실제외 왼쪽 항목코드네임리스트 -->
	<select id="searchBylosExcIndNm" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
	SELECT A.CLS_CODE AS CLS_CODE, TRIM(A.SE) AS SE, TRIM(A.CODE) AS CODE, A.CODE_NM AS CODE_NM
            , CASE SE WHEN 'D' THEN '손실시간'
                      WHEN 'B' THEN '제외시간'
                      WHEN 'C' THEN '간접시간'
              ELSE '' END AS SE_NM
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'D' AND CLS_CODE = #{clsCode}) AS D_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'B' AND CLS_CODE = #{clsCode}) AS B_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'C' AND CLS_CODE = #{clsCode}) AS C_CODE_SUM_CNT
    FROM PSZDBLIB.FHP020PF A
    WHERE A.SE  = 'D' 
    AND A.CLS_CODE = #{clsCode}
UNION ALL
SELECT 'D1' AS CLS_CODE, 'D' AS SE, '30.9' AS CODE, '손실시간 소계 (분)' AS CODE_NM
            , '손실시간' AS SE_NM
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'D' AND CLS_CODE = #{clsCode}) AS D_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'B' AND CLS_CODE = #{clsCode}) AS B_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'C' AND CLS_CODE = #{clsCode}) AS C_CODE_SUM_CNT
FROM SYSIBM.SYSDUMMY1
union all
SELECT B.CLS_CODE AS CLS_CODE, TRIM(B.SE) AS SE, TRIM(B.CODE) AS CODE, B.CODE_NM AS CODE_NM
            , CASE SE WHEN 'D' THEN '손실시간'
                      WHEN 'B' THEN '제외시간'
                      WHEN 'C' THEN '간접시간'
              ELSE '' END AS SE_NM
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'D' AND CLS_CODE = #{clsCode}) AS D_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'B' AND CLS_CODE = #{clsCode}) AS B_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'C' AND CLS_CODE = #{clsCode}) AS C_CODE_SUM_CNT
    FROM PSZDBLIB.FHP020PF B
    WHERE B.SE  = 'B' 
    AND B.CLS_CODE = #{clsCode}
union all
SELECT 'B1' AS CLS_CODE, 'B' AS SE, '50.9' AS CODE, '제외시간 소계 (분)' AS CODE_NM
            , '제외시간' AS SE_NM
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'D' AND CLS_CODE = #{clsCode}) AS D_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'B' AND CLS_CODE = #{clsCode}) AS B_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'C' AND CLS_CODE = #{clsCode}) AS C_CODE_SUM_CNT
FROM SYSIBM.SYSDUMMY1
union all
SELECT C.CLS_CODE AS CLS_CODE, TRIM(C.SE) AS SE, TRIM(C.CODE) AS CODE, C.CODE_NM AS CODE_NM
            , CASE SE WHEN 'D' THEN '손실시간'
                      WHEN 'B' THEN '제외시간'
                      WHEN 'C' THEN '간접시간'
              ELSE '' END AS SE_NM
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'D' AND CLS_CODE = #{clsCode}) AS D_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'B' AND CLS_CODE = #{clsCode}) AS B_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'C' AND CLS_CODE = #{clsCode}) AS C_CODE_SUM_CNT
    FROM PSZDBLIB.FHP020PF C
    WHERE C.SE  = 'C'
    AND C.CLS_CODE = #{clsCode}
union all
SELECT 'C1' AS CLS_CODE, 'C' AS SE, '99.9' AS CODE, '간접시간 소계 (분)' AS CODE_NM
            , '간접시간' AS SE_NM
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'D' AND CLS_CODE = #{clsCode}) AS D_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'B' AND CLS_CODE = #{clsCode}) AS B_CODE_SUM_CNT
            , (SELECT COUNT(1) AS SE_NM FROM PSZDBLIB.FHP020PF WHERE SE = 'C' AND CLS_CODE = #{clsCode}) AS C_CODE_SUM_CNT
FROM SYSIBM.SYSDUMMY1
ORDER BY CODE ASC


    </select>
    
    <!-- 총투입시간 및 직접생산시간 -->
    <select id="searchBytotHrMnt1" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
		/*총투입시간(직접시간+제외,간접) ***  직접생산시간(라인내) + 직접생산시간(라인외물류) */
		SELECT MAX(A.LINE_CODE) AS LINE_CODE
		        /*, '총투입시간(직접시간+제외간접)' AS COL_NM*/
		        , '총투입시간(직접시간+제외간접)' AS SE_NM
		        , '총투입시간(직접시간+제외간접)' AS CODE_NM
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D01
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D02
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D03
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D04
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D05
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D06
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D07
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D08
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D09
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D10
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D11
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D12
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D13
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D14
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D15
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D16
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D17
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D18
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D19
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D20
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D21
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D22
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D23
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D24
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D25
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D26
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D27
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28'
		                  THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		              END)
		            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D28
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D29
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D30
		        ,DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31'
		                              THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                   + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                          END)
		                        + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP109PF A
		WHERE 1 = 1
		AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		AND A.CLS_CODE = #{clsCode}
		AND A.LOC_CODE = #{locCode}
		AND A.LINE_CODE = #{lineCode}

UNION ALL

		/*직접생산시간(라인내) 라인인원투입시간 등록(소계)*/
		SELECT  MAX(A.LINE_CODE) AS LINE_CODE
		        /*, '직접생산시간(라인내)' AS COL_NM*/
		        , '직접생산시간(라인내)' AS SE_NM
		        , '직접생산시간(라인내)' AS CODE_NM
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END),0)) AS HR_MNT_SUM_D01
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D02
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D03
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D04
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D05
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D06
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D07
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D08
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D09
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10'
						                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
						                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
						              END), 0)) AS HR_MNT_SUM_D10
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D11
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D12
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13'
						                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
						                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
						              END), 0)) AS HR_MNT_SUM_D13
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D14
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D15
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D16
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D17
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                       + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D18
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D19
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D20
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D21
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D22
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D23
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D24
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D25
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D26
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D27
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D28
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D29
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D30
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31'
		                                   THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                           + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0
		                              END), 0)) AS HR_MNT_SUM_D31
		FROM PSZDBLIB.FHP109PF A
		WHERE 1 = 1
		AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		AND A.CLS_CODE = #{clsCode}
		AND A.LOC_CODE = #{locCode}
		AND A.LINE_CODE = #{lineCode}

    </select>      

	<!-- 총투입시간 및 직접생산시간2 -->
    <select id="searchBytotHrMnt2" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
	    /*직접생산시간(라인외 물류) 물류시간*/
		SELECT MAX(A.LINE_CODE) AS LINE_CODE
		    /*, '직접생산시간(라인외 물류)' AS COL_NM*/
		    , '직접생산시간(라인외 물류)' AS CODE_NM
		    , '직접생산시간(라인외 물류)' AS SE_NM
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D01 /* LGST_TIME_D01 */
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D02
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D03
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D04
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D05
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D06
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D07
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D08
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D09
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D10
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D11
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D12
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D13
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D14
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D15
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D16
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D17
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D18
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D19
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D20
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D21
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D22
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D23
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D24
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D25
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D26
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D27
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D28
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D29
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D30
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.LGST_TIME ELSE 0 END),0)) AS TOT_HR_MNT_D31
		
		FROM PSZDBLIB.FHP109PF A
		WHERE 1 = 1
		AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		AND A.CLS_CODE = #{clsCode}
		AND A.LOC_CODE = #{locCode}
		AND A.LINE_CODE = #{lineCode}

UNION ALL


		/* 직접생산시간(손실포함) ** 총투입시간(직접생산시간 라인내+직접생산시간 라인외물류)-(제외시간소계+간접시간소계) */
		SELECT  MAX(B.LINE_CODE) AS LINE_CODE
		        /*, '직접생산시간(손실포함)' AS COL_NM*/
		        , '직접생산시간(손실포함)' AS SE_NM
		        , '직접생산시간(손실포함)' AS CODE_NM
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D01 /* 직접생산시간(손실포함) */
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D02
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D03
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D04
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D05
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D06
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D07
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D08
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D09
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D10
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D11
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D12
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D13
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D14
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D15
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D16
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D17
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D18
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D19
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D20
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D21
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D22
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D23
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D24
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D25
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D26
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D27
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D28
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D29
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D30
		        , DOUBLE(COALESCE(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31'
		                                   THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                       + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                              END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.LGST_TIME ELSE 0 END)
		                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0),0)) AS HR_MNT_DE_D31
		
		FROM PSZDBLIB.FHP109PF B LEFT OUTER JOIN PSZDBLIB.FHP130PF A
		                                      ON A.CLS_CODE = B.CLS_CODE
		                                     AND A.LOC_CODE = B.LOC_CODE
		                                     AND A.LINE_CODE = B.LINE_CODE
		                                     AND A.OPERT_DE = B.OPERT_DE
		                                     AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
		WHERE 1 = 1
		AND SUBSTR(B.OPERT_DE, 1, 6) = #{repym}
		AND B.CLS_CODE = #{clsCode}
		AND B.LOC_CODE = #{locCode}
		AND B.LINE_CODE = #{lineCode}  

    
    </select>
    
    <!-- 손실 제외 간접 시간 -->
	<select id="searchByHrMnt1" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
		/*손실,제외,간접 (손실제외간접시간에 해당라인에 해당하는 값 취득)*/
		SELECT MAX(A.LINE_CODE) AS LINE_CODE, TRIM(MAX(A.SE)) AS SE, TRIM(A.CODE) AS CODE
		     	, '제외간접' AS SE_NM
				, '제외간접 ' AS CODE_NM
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D01  /* HR_MNT_D01 */
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D02
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D03
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D04
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D05
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D06
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D07
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D08
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D09
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D10
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D11
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D12
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D13
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D14
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D15
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D16
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D17
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D18
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D19
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D20
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D21
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D22
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D23
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D24
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D25
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D26
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D27
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D28
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D29
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D30
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP130PF A
		WHERE 1 = 1
		  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		  AND A.CLS_CODE = #{clsCode}
		  AND A.LOC_CODE = #{locCode}
		  AND A.LINE_CODE = #{lineCode}
		  AND A.SE = 'D'
		GROUP BY A.CODE
		UNION ALL
		SELECT MAX(A.LINE_CODE) AS LINE_CODE, TRIM(MAX(A.SE)) AS SE, '30.9' AS CODE
		     	, '제외간접' AS SE_NM
				, '제외간접 ' AS CODE_NM
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D01  /* HR_MNT_D01 */
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D02
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D03
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D04
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D05
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D06
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D07
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D08
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D09
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D10
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D11
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D12
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D13
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D14
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D15
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D16
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D17
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D18
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D19
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D20
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D21
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D22
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D23
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D24
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D25
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D26
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D27
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D28
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D29
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D30
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP130PF A
		WHERE 1 = 1
		  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		  AND A.CLS_CODE = #{clsCode}
		  AND A.LOC_CODE = #{locCode}
		  AND A.LINE_CODE = #{lineCode}
		  AND A.SE = 'D'
		UNION ALL
		SELECT MAX(A.LINE_CODE) AS LINE_CODE, TRIM(MAX(A.SE)) AS SE, TRIM(A.CODE) AS CODE
		     	, '제외간접' AS SE_NM
				, '제외간접 ' AS CODE_NM
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D01  /* HR_MNT_D01 */
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D02
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D03
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D04
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D05
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D06
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D07
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D08
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D09
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D10
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D11
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D12
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D13
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D14
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D15
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D16
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D17
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D18
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D19
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D20
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D21
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D22
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D23
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D24
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D25
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D26
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D27
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D28
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D29
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D30
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP130PF A
		WHERE 1 = 1
		  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		  AND A.CLS_CODE = #{clsCode}
		  AND A.LOC_CODE = #{locCode}
		  AND A.LINE_CODE = #{lineCode}
		  AND A.SE = 'B'
		GROUP BY A.CODE
		UNION ALL
		SELECT MAX(A.LINE_CODE) AS LINE_CODE, TRIM(MAX(A.SE)) AS SE, '50.9' AS CODE
		     	, '제외간접' AS SE_NM
				, '제외간접 ' AS CODE_NM
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D01  /* HR_MNT_D01 */
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D02
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D03
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D04
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D05
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D06
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D07
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D08
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D09
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D10
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D11
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D12
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D13
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D14
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D15
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D16
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D17
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D18
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D19
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D20
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D21
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D22
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D23
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D24
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D25
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D26
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D27
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D28
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D29
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D30
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP130PF A
		WHERE 1 = 1
		  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		  AND A.CLS_CODE = #{clsCode}
		  AND A.LOC_CODE = #{locCode}
		  AND A.LINE_CODE = #{lineCode}
		  AND A.SE = 'B'
		UNION ALL
		SELECT MAX(A.LINE_CODE) AS LINE_CODE, TRIM(MAX(A.SE)) AS SE, TRIM(A.CODE) AS CODE
		     	, '제외간접' AS SE_NM
				, '제외간접 ' AS CODE_NM
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D01  /* HR_MNT_D01 */
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D02
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D03
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D04
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D05
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D06
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D07
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D08
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D09
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D10
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D11
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D12
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D13
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D14
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D15
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D16
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D17
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D18
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D19
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D20
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D21
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D22
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D23
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D24
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D25
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D26
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D27
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D28
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D29
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D30
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP130PF A
		WHERE 1 = 1
		  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		  AND A.CLS_CODE = #{clsCode}
		  AND A.LOC_CODE = #{locCode}
		  AND A.LINE_CODE = #{lineCode}
		  AND A.SE = 'C'
		GROUP BY A.CODE
		UNION ALL
		SELECT MAX(A.LINE_CODE) AS LINE_CODE, TRIM(MAX(A.SE)) AS SE, '99.9' AS CODE
		     	, '제외간접' AS SE_NM
				, '제외간접 ' AS CODE_NM
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D01  /* HR_MNT_D01 */
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D02
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D03
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D04
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D05
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D06
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D07
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D08
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D09
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D10
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D11
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D12
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D13
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D14
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D15
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D16
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D17
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D18
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D19
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D20
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D21
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D22
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D23
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D24
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D25
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D26
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D27
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D28
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D29
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D30
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP130PF A
		WHERE 1 = 1
		  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		  AND A.CLS_CODE = #{clsCode}
		  AND A.LOC_CODE = #{locCode}
		  AND A.LINE_CODE = #{lineCode}
		  AND A.SE = 'C'

	</select>    
          
    <!-- 제외 간접 부서 대응 시간 (분)%-->
	<select id="searchByHrMnt2" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
		/*제외,간접부서 대응시간(분) (제외시간+간접시간)*/    
		SELECT  MAX(A.LINE_CODE) AS LINE_CODE
				, '제외간접부서 대응시간' AS SE_NM
				, '제외간접부서 대응시간' AS CODE_NM
				, 'HR_MNT_BC' AS SE,'HR_MNT_BC' AS CODE
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D01 /* HR_MNT_BC_D01*/
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D02
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D03
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D04
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D05
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D06
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D07
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D08
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D09
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D10
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D11
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D12
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D13
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D14
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D15
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D16
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D17
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D18
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D19
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D20
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D21
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D22
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D23
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D24
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D25
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D26
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D27
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D28
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D29
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D30
		        , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0)) AS TOT_HR_MNT_D31
		
		FROM PSZDBLIB.FHP130PF A
		WHERE 1 = 1
		  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		  /*AND A.OPERT_DE = '20210302'*/
		  AND A.CLS_CODE = #{clsCode}
		  AND A.LOC_CODE = #{locCode}
		  AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
		  AND A.LINE_CODE = #{lineCode}
	</select>
	
	
	<!-- 제외 간접 부서 지원 시간비율 %-->
	<select id="searchByHrMnt3_1" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">


		/*제외,간접 부서 지원 시간비율 ((제외시간+간접시간)/해당라인값)1 */
		SELECT MAX(B.LINE_CODE) AS  LINE_CODE
		        , '제외간접부서지원 시간비율' AS SE_NM
				, '제외간접부서지원 시간비율' AS CODE_NM
				, 'HR_MNT_BC_RATIO' AS SE
		        , 'HR_MNT_BC_RATIO' AS CODE
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D01 /*HR_MNT_DE_D01*/ 
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D02
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D03
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D04
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D05
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D06
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D07
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D08
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D09
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D10
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D11
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D12
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D13
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D14
		      
		FROM PSZDBLIB.FHP109PF B LEFT OUTER JOIN PSZDBLIB.FHP130PF A
		                                      ON A.CLS_CODE = B.CLS_CODE
		                                     AND A.LOC_CODE = B.LOC_CODE
		                                     AND A.LINE_CODE = B.LINE_CODE
		                                     AND A.OPERT_DE = B.OPERT_DE
		                                     AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
		WHERE 1 = 1
		AND SUBSTR(B.OPERT_DE, 1, 6) = #{repym}
		AND B.CLS_CODE = #{clsCode}
		AND B.LOC_CODE = #{locCode}
		AND B.LINE_CODE = #{lineCode}
        
        
	</select>
	
	<!-- 제외 간접 부서 지원 시간비율 %-->
	<select id="searchByHrMnt3_2" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">


		/*제외,간접 부서 지원 시간비율 ((제외시간+간접시간)/해당라인값)2*/
		SELECT  CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D15
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D16
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D17
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D18
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D19
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D20
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D21
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D22
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D23
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D24
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D25
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D26
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D27
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D28
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D29
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D30
		      , CASE COALESCE(DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                               + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.LGST_TIME ELSE 0 END),15,2),0)
		             WHEN 0 THEN 0
		        ELSE DOUBLE(ROUND(DEC(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0),15,2)
		                        / DEC(MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31'
		                                       THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                                           + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                                  END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.LGST_TIME ELSE 0 END),15,2)
		                    * 100.00, 1)) END AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP109PF B LEFT OUTER JOIN PSZDBLIB.FHP130PF A
		                                      ON A.CLS_CODE = B.CLS_CODE
		                                     AND A.LOC_CODE = B.LOC_CODE
		                                     AND A.LINE_CODE = B.LINE_CODE
		                                     AND A.OPERT_DE = B.OPERT_DE
		                                     AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
		WHERE 1 = 1
		AND SUBSTR(B.OPERT_DE, 1, 6) = #{repym}
		AND B.CLS_CODE = #{clsCode}
		AND B.LOC_CODE = #{locCode}
		AND B.LINE_CODE = #{lineCode}
        
        
	</select>
	
	<!-- 기준시간(분)-->
	<select id="searchBySt1" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
		/*기준시간(분)*/
		SELECT COALESCE(MAX(LINE_CODE),'') AS LINE_CODE
			, '기준시간(분)' AS SE_NM
			, '기준시간(분)' AS CODE_NM
			, 'STD01' AS SE
			, 'STD01' AS CODE
	        , ROUND(DOUBLE(COALESCE(SUM(ST01),0)/60), 2) AS TOT_HR_MNT_D01 /* STD01 */
	        , ROUND(DOUBLE(COALESCE(SUM(ST02),0)/60), 2) AS TOT_HR_MNT_D02
	        , ROUND(DOUBLE(COALESCE(SUM(ST03),0)/60), 2) AS TOT_HR_MNT_D03
	        , ROUND(DOUBLE(COALESCE(SUM(ST04),0)/60), 2) AS TOT_HR_MNT_D04
	        , ROUND(DOUBLE(COALESCE(SUM(ST05),0)/60), 2) AS TOT_HR_MNT_D05
	        , ROUND(DOUBLE(COALESCE(SUM(ST06),0)/60), 2) AS TOT_HR_MNT_D06
	        , ROUND(DOUBLE(COALESCE(SUM(ST07),0)/60), 2) AS TOT_HR_MNT_D07
	        , ROUND(DOUBLE(COALESCE(SUM(ST08),0)/60), 2) AS TOT_HR_MNT_D08
	        , ROUND(DOUBLE(COALESCE(SUM(ST09),0)/60), 2) AS TOT_HR_MNT_D09
	        , ROUND(DOUBLE(COALESCE(SUM(ST10),0)/60), 2) AS TOT_HR_MNT_D10
	        , ROUND(DOUBLE(COALESCE(SUM(ST11),0)/60), 2) AS TOT_HR_MNT_D11
	        , ROUND(DOUBLE(COALESCE(SUM(ST12),0)/60), 2) AS TOT_HR_MNT_D12
	        , ROUND(DOUBLE(COALESCE(SUM(ST13),0)/60), 2) AS TOT_HR_MNT_D13
	        , ROUND(DOUBLE(COALESCE(SUM(ST14),0)/60), 2) AS TOT_HR_MNT_D14
	        , ROUND(DOUBLE(COALESCE(SUM(ST15),0)/60), 2) AS TOT_HR_MNT_D15
	        , ROUND(DOUBLE(COALESCE(SUM(ST16),0)/60), 2) AS TOT_HR_MNT_D16
	        , ROUND(DOUBLE(COALESCE(SUM(ST17),0)/60), 2) AS TOT_HR_MNT_D17
	        , ROUND(DOUBLE(COALESCE(SUM(ST18),0)/60), 2) AS TOT_HR_MNT_D18
	        , ROUND(DOUBLE(COALESCE(SUM(ST19),0)/60), 2) AS TOT_HR_MNT_D19
	        , ROUND(DOUBLE(COALESCE(SUM(ST20),0)/60), 2) AS TOT_HR_MNT_D20
	        , ROUND(DOUBLE(COALESCE(SUM(ST21),0)/60), 2) AS TOT_HR_MNT_D21
	        , ROUND(DOUBLE(COALESCE(SUM(ST22),0)/60), 2) AS TOT_HR_MNT_D22
	        , ROUND(DOUBLE(COALESCE(SUM(ST23),0)/60), 2) AS TOT_HR_MNT_D23
	        , ROUND(DOUBLE(COALESCE(SUM(ST24),0)/60), 2) AS TOT_HR_MNT_D24
	        , ROUND(DOUBLE(COALESCE(SUM(ST25),0)/60), 2) AS TOT_HR_MNT_D25
	        , ROUND(DOUBLE(COALESCE(SUM(ST26),0)/60), 2) AS TOT_HR_MNT_D26
	        , ROUND(DOUBLE(COALESCE(SUM(ST27),0)/60), 2) AS TOT_HR_MNT_D27
	        , ROUND(DOUBLE(COALESCE(SUM(ST28),0)/60), 2) AS TOT_HR_MNT_D28
	        , ROUND(DOUBLE(COALESCE(SUM(ST29),0)/60), 2) AS TOT_HR_MNT_D29
	        , ROUND(DOUBLE(COALESCE(SUM(ST30),0)/60), 2) AS TOT_HR_MNT_D30
	        , ROUND(DOUBLE(COALESCE(SUM(ST31),0)/60), 2) AS TOT_HR_MNT_D31
		FROM (SELECT MAX(A.LINE_CODE) AS LINE_CODE
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST01
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST02
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST03
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST04
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST05
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST06
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST07
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST08
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST09
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST10
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST11
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST12
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST13
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST14
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST15
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST16
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST17
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST18
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST19
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST20
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST21
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST22
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST23
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST24
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST25
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST26
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST27
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST28
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST29
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST30
		            , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST31
		     FROM (
		             SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE, U.LOC_CODE, U.PRODUCT_NO, LINE_CODE AS LINE_CODE, SUM(U.QY) AS QY
		             FROM (
	                      SELECT P.OPERT_DE
	                           , B.CLS_CODE
	                           , B.LOC_CODE
	                           , B.LINE_CODE
	                           , P.PSPNO AS PRODUCT_NO
	                           , P.QY
	                      FROM (
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY01 AS QY, TRNYM || '01' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY02 AS QY, TRNYM || '02' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY03 AS QY, TRNYM || '03' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY04 AS QY, TRNYM || '04' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY05 AS QY, TRNYM || '05' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY06 AS QY, TRNYM || '06' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY07 AS QY, TRNYM || '07' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY08 AS QY, TRNYM || '08' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY09 AS QY, TRNYM || '09' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY10 AS QY, TRNYM || '10' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY11 AS QY, TRNYM || '11' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY12 AS QY, TRNYM || '12' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY13 AS QY, TRNYM || '13' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY14 AS QY, TRNYM || '14' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY15 AS QY, TRNYM || '15' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY16 AS QY, TRNYM || '16' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY17 AS QY, TRNYM || '17' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY18 AS QY, TRNYM || '18' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY19 AS QY, TRNYM || '19' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY20 AS QY, TRNYM || '20' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY21 AS QY, TRNYM || '21' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY22 AS QY, TRNYM || '22' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY23 AS QY, TRNYM || '23' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY24 AS QY, TRNYM || '24' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY25 AS QY, TRNYM || '25' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY26 AS QY, TRNYM || '26' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY27 AS QY, TRNYM || '27' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY28 AS QY, TRNYM || '28' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY29 AS QY, TRNYM || '29' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY30 AS QY, TRNYM || '30' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                               UNION ALL
	                               SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY31 AS QY, TRNYM || '31' AS OPERT_DE
	                               FROM ${lib2}.FGP500PF
	                               WHERE COMPS = #{clsCode}
	                                 AND TRNYM = #{repym}
	                           ) P
	                               INNER JOIN PSZDBLIB.FHP010PF B
	                                          ON P.DEVID = B.IF_CODE
	                                              AND P.COMPS = B.CLS_CODE
	                      WHERE P.COMPS = #{clsCode}
	                        AND P.TRNYM = #{repym}
	                        AND B.LOC_CODE = #{locCode}
	                        AND B.CLS_CODE = #{clsCode}
	                        AND LENGTH(TRIM(B.IF_CODE)) > 0
	                        AND B.IF_TYPE = 'Q'
	                      UNION ALL
	                      SELECT OPERT_DE
	                           , CLS_CODE
	                           , LOC_CODE
	                           , LINE_CODE
	                           , PRODUCT_NO
	                           , QY
	                      FROM PSZDBLIB.FHP100PF
	                      WHERE CLS_CODE = #{clsCode}
	                        AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
	                        AND SUBSTR(OPERT_DE, 1, 6) = #{repym}
	                  ) U
	             GROUP BY OPERT_DE, CLS_CODE, LOC_CODE, LINE_CODE, PRODUCT_NO
		         ) A
		     		
		     		
		     		, PSZDBLIB.FHP030PF B
		    WHERE A.CLS_CODE = #{clsCode}
		      AND A.LOC_CODE = #{locCode}
		      AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		      AND A.LINE_CODE = #{lineCode}
		      AND A.LINE_CODE = B.LINE_CODE
		      AND A.CLS_CODE = B.CLS_CODE
		      AND A.PRODUCT_NO = B.PRDT_NO
		      AND B.YEAR = #{year}
		      AND B.FS_HALF = #{fsHalf} /* F:상반기, S:하반기 */
		    GROUP BY A.PRODUCT_NO, A.LINE_CODE /* 다른 라인이지만 같은 품폭번호가 존재함 */
	    ) C
	</select>    
     
    
	<!--  공수저감지수-->
	<select id="searchBySt6_1" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
	    
	    /* 공수저감지수(직접생산시간/기준시간*100) */
	    select MAX(E.LINE_CODE) AS LINE_CODE
		        , '공수저감지수' AS SE_NM
		        , '공수저감지수' AS CODE_NM
		        , 'PTM_D01' AS SE
		        , 'PTM_D01' AS CODE
		        , CASE MAX(D.STD01) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '01'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '01' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD01) * 100, 0),1)) END  as TOT_HR_MNT_D01 /* PTM_D01 */
		        , CASE MAX(D.STD02) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '02'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '02' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD02) * 100, 0),1)) END  as TOT_HR_MNT_D02
		        , CASE MAX(D.STD03) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '03'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '03' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD03) * 100, 0),1)) END  as TOT_HR_MNT_D03
		        , CASE MAX(D.STD04) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '04'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '04' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD04) * 100, 0),1)) END  as TOT_HR_MNT_D04
		        , CASE MAX(D.STD05) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '05'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '05' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD05) * 100, 0),1)) END  as TOT_HR_MNT_D05
		        , CASE MAX(D.STD06) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '06'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '06' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD06) * 100, 0),1)) END  as TOT_HR_MNT_D06
		        , CASE MAX(D.STD07) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '07'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '07' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD07) * 100, 0),1)) END  as TOT_HR_MNT_D07
		        , CASE MAX(D.STD08) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '08'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '08' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD08) * 100, 0),1)) END  as TOT_HR_MNT_D08
		        , CASE MAX(D.STD09) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '09'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '09' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD09) * 100, 0),1)) END  as TOT_HR_MNT_D09
		        , CASE MAX(D.STD10) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '10'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '10' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD10) * 100, 0),1)) END  as TOT_HR_MNT_D10
		        , CASE MAX(D.STD11) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '11'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '11' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD11) * 100, 0),1)) END  as TOT_HR_MNT_D11
		        , CASE MAX(D.STD12) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '12'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '12' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD12) * 100, 0),1)) END  as TOT_HR_MNT_D12
		        , CASE MAX(D.STD13) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '13'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '13' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD13) * 100, 0),1)) END  as TOT_HR_MNT_D13
		        , CASE MAX(D.STD14) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '14'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '14' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD14) * 100, 0),1)) END  as TOT_HR_MNT_D14
		        
		FROM PSZDBLIB.FHP109PF E LEFT OUTER JOIN PSZDBLIB.FHP130PF A
		                                  ON A.CLS_CODE = E.CLS_CODE
		                                 AND A.LOC_CODE = E.LOC_CODE
		                                 AND A.LINE_CODE = E.LINE_CODE
		                                 AND A.OPERT_DE = E.OPERT_DE
		                                 AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
		    , (
		        SELECT COALESCE(MAX(LINE_CODE),'') AS LINE_CODE
		             , COALESCE(MAX(CLS_CODE),'') AS CLS_CODE
		             , COALESCE(MAX(LOC_CODE),'') AS LOC_CODE
		            , DOUBLE(COALESCE(SUM(ST01),0)/60) AS STD01
		            , DOUBLE(COALESCE(SUM(ST02),0)/60) AS STD02
		            , DOUBLE(COALESCE(SUM(ST03),0)/60) AS STD03
		            , DOUBLE(COALESCE(SUM(ST04),0)/60) AS STD04
		            , DOUBLE(COALESCE(SUM(ST05),0)/60) AS STD05
		            , DOUBLE(COALESCE(SUM(ST06),0)/60) AS STD06
		            , DOUBLE(COALESCE(SUM(ST07),0)/60) AS STD07
		            , DOUBLE(COALESCE(SUM(ST08),0)/60) AS STD08
		            , DOUBLE(COALESCE(SUM(ST09),0)/60) AS STD09
		            , DOUBLE(COALESCE(SUM(ST10),0)/60) AS STD10
		            , DOUBLE(COALESCE(SUM(ST11),0)/60) AS STD11
		            , DOUBLE(COALESCE(SUM(ST12),0)/60) AS STD12
		            , DOUBLE(COALESCE(SUM(ST13),0)/60) AS STD13
		            , DOUBLE(COALESCE(SUM(ST14),0)/60) AS STD14
		            
		        FROM (
		                SELECT MAX(A.LINE_CODE) AS LINE_CODE
		                    , MAX(A.CLS_CODE) AS CLS_CODE
		                    , MAX(A.LOC_CODE) AS LOC_CODE
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST01
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST02
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST03
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST04
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST05
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST06
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST07
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST08
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST09
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST10
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST11
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST12
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST13
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST14
		                    
		                FROM 
		                    (
		                     SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE, U.LOC_CODE, U.PRODUCT_NO, LINE_CODE AS LINE_CODE, SUM(U.QY) AS QY
		                     FROM (
		                              SELECT P.OPERT_DE
		                                   , BB.CLS_CODE
		                                   , BB.LOC_CODE
		                                   , BB.LINE_CODE
		                                   , P.PSPNO AS PRODUCT_NO
		                                   , P.QY
		                              FROM (
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY01 AS QY, TRNYM || '01' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY02 AS QY, TRNYM || '02' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY03 AS QY, TRNYM || '03' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY04 AS QY, TRNYM || '04' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY05 AS QY, TRNYM || '05' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY06 AS QY, TRNYM || '06' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY07 AS QY, TRNYM || '07' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY08 AS QY, TRNYM || '08' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY09 AS QY, TRNYM || '09' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY10 AS QY, TRNYM || '10' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY11 AS QY, TRNYM || '11' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY12 AS QY, TRNYM || '12' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY13 AS QY, TRNYM || '13' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY14 AS QY, TRNYM || '14' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       
		                                   ) P
		                                       INNER JOIN PSZDBLIB.FHP010PF BB
		                                                  ON P.DEVID = BB.IF_CODE
		                                                      AND P.COMPS = BB.CLS_CODE
		                              WHERE P.COMPS = #{clsCode}
		                                AND P.TRNYM = #{repym}
		                                AND BB.LOC_CODE = #{locCode}
		                                AND BB.CLS_CODE = #{clsCode}
		                                AND LENGTH(TRIM(BB.IF_CODE)) > 0
		                                AND BB.IF_TYPE = 'Q'
		                              UNION ALL
		                              SELECT OPERT_DE
		                                   , CLS_CODE
		                                   , LOC_CODE
		                                   , LINE_CODE
		                                   , PRODUCT_NO
		                                   , QY
		                              FROM PSZDBLIB.FHP100PF
		                              WHERE CLS_CODE = #{clsCode}
		                                AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
		                                AND SUBSTR(OPERT_DE, 1, 6) = #{repym}
		                          ) U
		                     GROUP BY OPERT_DE, CLS_CODE, LOC_CODE, LINE_CODE, PRODUCT_NO
		                    ) A
		                    , PSZDBLIB.FHP030PF B
		                WHERE A.CLS_CODE = #{clsCode}
		                  AND A.LOC_CODE = #{locCode}
		                  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		                  --AND A.OPERT_DE = REPLACE(CHAR(DATE('2021-03-26'), ISO), '-', '')
		                  --AND A.OPERT_DE = REPLACE(CHAR(DATE('2021-03-26'), ISO), '-', '')
		                  AND A.LINE_CODE = #{lineCode} 
		                  AND A.LINE_CODE = B.LINE_CODE
		                  AND A.CLS_CODE = B.CLS_CODE
		                  AND A.PRODUCT_NO = B.PRDT_NO
		                  AND B.YEAR = #{year}
		                  AND B.FS_HALF = #{fsHalf} /* F:상반기, S:하반기 */
		                GROUP BY A.PRODUCT_NO, A.LINE_CODE /* 다른 라인이지만 같은 품폭번호가 존재함 */
		                ) C
		        ) D
		WHERE 1 = 1
		AND SUBSTR(E.OPERT_DE, 1, 6) = #{repym}
		AND E.CLS_CODE = #{clsCode}
		AND E.LOC_CODE = #{locCode}
		AND E.LINE_CODE = #{lineCode}  
		AND E.CLS_CODE = D.CLS_CODE
		AND E.LOC_CODE = D.LOC_CODE
		AND E.LINE_CODE = D.LINE_CODE

	</select>   
	
	<select id="searchBySt6_2" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
	    
	    /* 공수저감지수(직접생산시간/기준시간*100) */
	    select  CASE MAX(D.STD15) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '15'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '15' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD15) * 100, 0),1)) END  as TOT_HR_MNT_D15
		        , CASE MAX(D.STD16) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '16'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '16' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD16) * 100, 0),1)) END  as TOT_HR_MNT_D16
		        , CASE MAX(D.STD17) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '17'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '17' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD17) * 100, 0),1)) END  as TOT_HR_MNT_D17
		        , CASE MAX(D.STD18) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '18'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '18' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD18) * 100, 0),1)) END  as TOT_HR_MNT_D18
		        , CASE MAX(D.STD19) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '19'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '19' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD19) * 100, 0),1)) END  as TOT_HR_MNT_D19
		        , CASE MAX(D.STD20) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '20'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '20' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD20) * 100, 0),1)) END  as TOT_HR_MNT_D20
		        , CASE MAX(D.STD21) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '21'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '21' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD21) * 100, 0),1)) END  as TOT_HR_MNT_D21
		        , CASE MAX(D.STD22) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '22'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '22' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD22) * 100, 0),1)) END  as TOT_HR_MNT_D22
		        , CASE MAX(D.STD23) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '23'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '23' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD23) * 100, 0),1)) END  as TOT_HR_MNT_D23
		        , CASE MAX(D.STD24) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '24'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '24' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD24) * 100, 0),1)) END  as TOT_HR_MNT_D24
		        , CASE MAX(D.STD25) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '25'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '25' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD25) * 100, 0),1)) END  as TOT_HR_MNT_D25
		        , CASE MAX(D.STD26) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '26'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '26' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD26) * 100, 0),1)) END  as TOT_HR_MNT_D26
		        , CASE MAX(D.STD27) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '27'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '27' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD27) * 100, 0),1)) END  as TOT_HR_MNT_D27
		        , CASE MAX(D.STD28) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '28'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '28' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD28) * 100, 0),1)) END  as TOT_HR_MNT_D28
		        , CASE MAX(D.STD29) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '29'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '29' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD29) * 100, 0),1)) END  as TOT_HR_MNT_D29
		        , CASE MAX(D.STD30) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '30'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '30' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD30) * 100, 0),1)) END  as TOT_HR_MNT_D30
		        , CASE MAX(D.STD31) WHEN 0 THEN 0 ELSE
		               DOUBLE(ROUND(COALESCE(DEC(MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '31'
		                                                  THEN (E.HR_MNT1*E.PRSNL1 + E.HR_MNT2*E.PRSNL2 + E.HR_MNT3*E.PRSNL3 + E.HR_MNT4*E.PRSNL4
		                                                    + E.HR_MNT5*E.PRSNL5 + E.HR_MNT6*E.PRSNL6 + E.HR_MNT7*E.PRSNL7 + E.HR_MNT8*E.PRSNL8) ELSE 0
		                                             END) + MAX(CASE WHEN SUBSTR(E.OPERT_DE, 7, 8) = '31' THEN E.LGST_TIME ELSE 0 END)
		                                        - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0),15,1)
		                                    / MAX(D.STD31) * 100, 0),1)) END  as TOT_HR_MNT_D31
		
		FROM PSZDBLIB.FHP109PF E LEFT OUTER JOIN PSZDBLIB.FHP130PF A
		                                  ON A.CLS_CODE = E.CLS_CODE
		                                 AND A.LOC_CODE = E.LOC_CODE
		                                 AND A.LINE_CODE = E.LINE_CODE
		                                 AND A.OPERT_DE = E.OPERT_DE
		                                 AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
		    , (
		        SELECT COALESCE(MAX(LINE_CODE),'') AS LINE_CODE
		             , COALESCE(MAX(CLS_CODE),'') AS CLS_CODE
		             , COALESCE(MAX(LOC_CODE),'') AS LOC_CODE
		            , DOUBLE(COALESCE(SUM(ST15),0)/60) AS STD15
		            , DOUBLE(COALESCE(SUM(ST16),0)/60) AS STD16
		            , DOUBLE(COALESCE(SUM(ST17),0)/60) AS STD17
		            , DOUBLE(COALESCE(SUM(ST18),0)/60) AS STD18
		            , DOUBLE(COALESCE(SUM(ST19),0)/60) AS STD19
		            , DOUBLE(COALESCE(SUM(ST20),0)/60) AS STD20
		            , DOUBLE(COALESCE(SUM(ST21),0)/60) AS STD21
		            , DOUBLE(COALESCE(SUM(ST22),0)/60) AS STD22
		            , DOUBLE(COALESCE(SUM(ST23),0)/60) AS STD23
		            , DOUBLE(COALESCE(SUM(ST24),0)/60) AS STD24
		            , DOUBLE(COALESCE(SUM(ST25),0)/60) AS STD25
		            , DOUBLE(COALESCE(SUM(ST26),0)/60) AS STD26
		            , DOUBLE(COALESCE(SUM(ST27),0)/60) AS STD27
		            , DOUBLE(COALESCE(SUM(ST28),0)/60) AS STD28
		            , DOUBLE(COALESCE(SUM(ST29),0)/60) AS STD29
		            , DOUBLE(COALESCE(SUM(ST30),0)/60) AS STD30
		            , DOUBLE(COALESCE(SUM(ST31),0)/60) AS STD31
		        FROM (
		                SELECT MAX(A.LINE_CODE) AS LINE_CODE
		                    , MAX(A.CLS_CODE) AS CLS_CODE
		                    , MAX(A.LOC_CODE) AS LOC_CODE
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST15
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST16
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST17
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST18
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST19
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST20
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST21
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST22
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST23
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST24
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST25
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST26
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST27
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST28
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST29
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST30
		                    , SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.QY ELSE 0 END) * MAX(B.STDR_LABOR) AS ST31
		                FROM 
		                    (
		                     SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE, U.LOC_CODE, U.PRODUCT_NO, LINE_CODE AS LINE_CODE, SUM(U.QY) AS QY
		                     FROM (
		                              SELECT P.OPERT_DE
		                                   , BB.CLS_CODE
		                                   , BB.LOC_CODE
		                                   , BB.LINE_CODE
		                                   , P.PSPNO AS PRODUCT_NO
		                                   , P.QY
		                              FROM (
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY15 AS QY, TRNYM || '15' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY16 AS QY, TRNYM || '16' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY17 AS QY, TRNYM || '17' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY18 AS QY, TRNYM || '18' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY19 AS QY, TRNYM || '19' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY20 AS QY, TRNYM || '20' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY21 AS QY, TRNYM || '21' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY22 AS QY, TRNYM || '22' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY23 AS QY, TRNYM || '23' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY24 AS QY, TRNYM || '24' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY25 AS QY, TRNYM || '25' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY26 AS QY, TRNYM || '26' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY27 AS QY, TRNYM || '27' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY28 AS QY, TRNYM || '28' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY29 AS QY, TRNYM || '29' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY30 AS QY, TRNYM || '30' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                       UNION ALL
		                                       SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY31 AS QY, TRNYM || '31' AS OPERT_DE
		                                       FROM ${lib2}.FGP500PF
		                                       WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                                   ) P
		                                       INNER JOIN PSZDBLIB.FHP010PF BB
		                                                  ON P.DEVID = BB.IF_CODE
		                                                      AND P.COMPS = BB.CLS_CODE
		                              WHERE P.COMPS = #{clsCode}
		                                AND P.TRNYM = #{repym}
		                                AND BB.LOC_CODE = #{locCode}
		                                AND BB.CLS_CODE = #{clsCode}
		                                AND LENGTH(TRIM(BB.IF_CODE)) > 0
		                                AND BB.IF_TYPE = 'Q'
		                              UNION ALL
		                              SELECT OPERT_DE
		                                   , CLS_CODE
		                                   , LOC_CODE
		                                   , LINE_CODE
		                                   , PRODUCT_NO
		                                   , QY
		                              FROM PSZDBLIB.FHP100PF
		                              WHERE CLS_CODE = #{clsCode}
		                                AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
		                                AND SUBSTR(OPERT_DE, 1, 6) = #{repym}
		                          ) U
		                     GROUP BY OPERT_DE, CLS_CODE, LOC_CODE, LINE_CODE, PRODUCT_NO
		                    ) A
		                    , PSZDBLIB.FHP030PF B
		                WHERE A.CLS_CODE = #{clsCode}
		                  AND A.LOC_CODE = #{locCode}
		                  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		                  --AND A.OPERT_DE = REPLACE(CHAR(DATE('2021-03-26'), ISO), '-', '')
		                  --AND A.OPERT_DE = REPLACE(CHAR(DATE('2021-03-26'), ISO), '-', '')
		                  AND A.LINE_CODE = #{lineCode} 
		                  AND A.LINE_CODE = B.LINE_CODE
		                  AND A.CLS_CODE = B.CLS_CODE
		                  AND A.PRODUCT_NO = B.PRDT_NO
		                  AND B.YEAR = #{year}
		                  AND B.FS_HALF = #{fsHalf} /* F:상반기, S:하반기 */
		                GROUP BY A.PRODUCT_NO, A.LINE_CODE /* 다른 라인이지만 같은 품폭번호가 존재함 */
		                ) C
		        ) D
		WHERE 1 = 1
		AND SUBSTR(E.OPERT_DE, 1, 6) = #{repym}
		AND E.CLS_CODE = #{clsCode}
		AND E.LOC_CODE = #{locCode}
		AND E.LINE_CODE = #{lineCode}  
		AND E.CLS_CODE = D.CLS_CODE
		AND E.LOC_CODE = D.LOC_CODE
		AND E.LINE_CODE = D.LINE_CODE

	</select>   

        
    <!-- 설총율 -->
    <select id="searchBySt2" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
	    select '' as LINE_CODE
	    	, '설총율' AS SE_NM
			, '설총율' AS CODE_NM
			, 'PPD01' AS SE
			, 'PPD01' AS CODE
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D01
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D02
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D03
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D04
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D05
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D06
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D07
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D08
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D09
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D10
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D11
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D12
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D13
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D14
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D15
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D16
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D17
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D18
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D19
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D20
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D21
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D22
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D23
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D24
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D25
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D26
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D27
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D28
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D29
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D30
	        , DOUBLE(COALESCE(0,0)) AS TOT_HR_MNT_D31
        from sysibm.sysdummy1
	</select>

<!-- 생산실적수-->
    <select id="searchBySt7" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
		/* 생산 실적수(업무종료기준) (대) */
		SELECT MAX(TRIM(A.LINE_CODE)) AS LINE_CODE
			, '생산실적수' AS SE_NM
			, '생산실적수' AS CODE_NM
			, 'PPD01' AS SE
			, 'PPD01' AS CODE
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D01 /*PPD01*/
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D02
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D03
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D04
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D05
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D06
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D07
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D08
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D09
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D10
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D11
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D12
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D13
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D14
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D15
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D16
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D17
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D18
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D19
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D20
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D21
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D22
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D23
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D24
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D25
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D26
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D27
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D28
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D29
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D30
		    , DOUBLE(COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.QY ELSE 0 END),0)) AS TOT_HR_MNT_D31
		FROM (
			SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE,U.LOC_CODE,U.PRODUCT_NO, LINE_CODE, SUM(U.QY) AS QY
			FROM (
			            SELECT
			                     M.OPERT_DE
			                   , B.CLS_CODE
			                   , B.LOC_CODE
			                   , B.LINE_CODE
			                   , M.PSPNO AS     PRODUCT_NO
			                   , QY
	                   FROM (
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY01 AS QY, TRNYM || '01' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY02 AS QY, TRNYM || '02' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY03 AS QY, TRNYM || '03' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY04 AS QY, TRNYM || '04' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY05 AS QY, TRNYM || '05' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY06 AS QY, TRNYM || '06' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY07 AS QY, TRNYM || '07' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY08 AS QY, TRNYM || '08' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY09 AS QY, TRNYM || '09' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY10 AS QY, TRNYM || '10' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY11 AS QY, TRNYM || '11' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY12 AS QY, TRNYM || '12' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY13 AS QY, TRNYM || '13' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY14 AS QY, TRNYM || '14' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY15 AS QY, TRNYM || '15' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY16 AS QY, TRNYM || '16' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY17 AS QY, TRNYM || '17' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY18 AS QY, TRNYM || '18' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY19 AS QY, TRNYM || '19' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY20 AS QY, TRNYM || '20' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY21 AS QY, TRNYM || '21' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY22 AS QY, TRNYM || '22' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY23 AS QY, TRNYM || '23' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY24 AS QY, TRNYM || '24' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY25 AS QY, TRNYM || '25' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY26 AS QY, TRNYM || '26' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY27 AS QY, TRNYM || '27' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY28 AS QY, TRNYM || '28' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY29 AS QY, TRNYM || '29' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY30 AS QY, TRNYM || '30' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                      UNION ALL
	                      SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY31 AS QY, TRNYM || '31' AS OPERT_DE
	                      FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
	                  ) M
	                      INNER JOIN PSZDBLIB.FHP010PF B
	                      ON M.DEVID = B.IF_CODE
	                      AND M.COMPS = B.CLS_CODE
	                      WHERE M.COMPS = #{clsCode}
	                      AND M.TRNYM = #{repym} 
	                      AND B.LOC_CODE = #{locCode}
	                      AND B.CLS_CODE = #{clsCode}
	                      AND LENGTH(TRIM(B.IF_CODE)) > 0
	                      AND B.IF_TYPE = 'Q'
			      UNION ALL
			         SELECT OPERT_DE
			              ,  CLS_CODE
			              , LOC_CODE
			              , LINE_CODE
			              , PRODUCT_NO
			              , QY
			         FROM PSZDBLIB.FHP100PF
			         WHERE CLS_CODE = #{clsCode}
			           AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
			          AND SUBSTR(OPERT_DE,1,6) = #{repym} 
			) U
			GROUP BY OPERT_DE,CLS_CODE,LOC_CODE,LINE_CODE,PRODUCT_NO
		) A
		WHERE A.CLS_CODE = #{clsCode}
		  AND A.LOC_CODE = #{locCode}
		  AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}  
		  AND A.LINE_CODE = #{lineCode}
  
  
	</select>
	
	<!-- 총대당투입공수-->
    <select id="searchBySt3" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
    
    	/*총대당투입공수(총시간합계x60/생산실적) (초) */
		SELECT MAX(A.LINE_CODE) AS LINE_CODE
				, '총대당투입공수' AS SE_NM
				, '총대당투입공수' AS CODE_NM
				, 'PMH_D01' AS SE
				, 'PMH_D01' AS CODE
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D01 /*PMH_D01*/
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D02
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D03
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D04
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D05
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D06
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D07
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D08
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D09
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D10
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D11
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D12
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D13
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D14
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D15
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D16
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D17
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D18
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D19
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D20
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D21
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D22
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D23
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D24
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D25
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D26
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D27
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D28
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D29
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D30
		        , DOUBLE(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0 ELSE
		          ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31'
		                            THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
		                                + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
		                    + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
		         / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.QY ELSE 0 END),15,2), 1) END) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP109PF A /*라인인원투입시간*/	
			   , (
			         SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE,U.LOC_CODE,U.PRODUCT_NO, LINE_CODE, SUM(U.QY) AS QY
			         FROM (
		                       SELECT
		                                 M.OPERT_DE
		                               , B.CLS_CODE
		                               , B.LOC_CODE
		                               , B.LINE_CODE
		                               , M.PSPNO AS     PRODUCT_NO
		                               , QY
		                       FROM (
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY01 AS QY, TRNYM || '01' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY02 AS QY, TRNYM || '02' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY03 AS QY, TRNYM || '03' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY04 AS QY, TRNYM || '04' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY05 AS QY, TRNYM || '05' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY06 AS QY, TRNYM || '06' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY07 AS QY, TRNYM || '07' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY08 AS QY, TRNYM || '08' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY09 AS QY, TRNYM || '09' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY10 AS QY, TRNYM || '10' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY11 AS QY, TRNYM || '11' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY12 AS QY, TRNYM || '12' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY13 AS QY, TRNYM || '13' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY14 AS QY, TRNYM || '14' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY15 AS QY, TRNYM || '15' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY16 AS QY, TRNYM || '16' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY17 AS QY, TRNYM || '17' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY18 AS QY, TRNYM || '18' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY19 AS QY, TRNYM || '19' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY20 AS QY, TRNYM || '20' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY21 AS QY, TRNYM || '21' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY22 AS QY, TRNYM || '22' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY23 AS QY, TRNYM || '23' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY24 AS QY, TRNYM || '24' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY25 AS QY, TRNYM || '25' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY26 AS QY, TRNYM || '26' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY27 AS QY, TRNYM || '27' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY28 AS QY, TRNYM || '28' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY29 AS QY, TRNYM || '29' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY30 AS QY, TRNYM || '30' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY31 AS QY, TRNYM || '31' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                      ) M
		                          INNER JOIN PSZDBLIB.FHP010PF B
		                          ON M.DEVID = B.IF_CODE
		                          AND M.COMPS = B.CLS_CODE
		                          WHERE M.COMPS = #{clsCode}
		                          AND M.TRNYM = #{repym}
		                          AND B.LOC_CODE = #{locCode}
		                          AND B.CLS_CODE = #{clsCode}
		                          AND LENGTH(TRIM(B.IF_CODE)) > 0
		                          AND B.IF_TYPE = 'Q'
		                  UNION ALL
		                     SELECT OPERT_DE
		                          ,  CLS_CODE
		                          , LOC_CODE
		                          , LINE_CODE
		                          , PRODUCT_NO
		                          , QY
		                     FROM PSZDBLIB.FHP100PF
		                     WHERE CLS_CODE = #{clsCode}
		                       AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
		                      AND SUBSTR(OPERT_DE,1,6) = #{repym}
			         ) U
			         GROUP BY OPERT_DE,CLS_CODE,LOC_CODE,LINE_CODE,PRODUCT_NO
			    ) B
			
		WHERE 1 = 1
		AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		AND A.CLS_CODE = #{clsCode}
		AND A.LOC_CODE = #{locCode}
		AND A.LINE_CODE = #{lineCode}
		AND A.OPERT_DE = B.OPERT_DE
		AND A.CLS_CODE = B.CLS_CODE
		AND A.LOC_CODE = B.LOC_CODE
		AND A.LINE_CODE = B.LINE_CODE
    </select>

	<!--  직접대당투입공수-->
    <select id="searchBySt4_1" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
    
		/*직접대당투입공수(직접생산량*60/생산실적)*/
		SELECT  MAX(B.LINE_CODE) AS LINE_CODE
		        , '직접대당투입공수' AS SE_NM
				, '직접대당투입공수' AS CODE_NM
				, 'DBITD01' AS SE
				, 'DBITD01' AS CODE
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '01' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '01' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D01 /* DBITD01 */
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '02' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '02' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D02
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '03' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '03' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D03
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '04' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '04' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D04
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '05' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '05' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D05
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '06' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '06' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D06
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '07' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '07' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D07
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '08' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '08' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D08
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '09' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '09' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D09
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '10' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '10' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D10
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '11' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '11' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D11
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '12' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '12' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D12
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '13' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '13' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D13
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '14' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '14' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D14
		        
		FROM PSZDBLIB.FHP109PF B LEFT OUTER JOIN PSZDBLIB.FHP130PF A
		                                      ON A.CLS_CODE = B.CLS_CODE
		                                     AND A.LOC_CODE = B.LOC_CODE
		                                     AND A.LINE_CODE = B.LINE_CODE
		                                     AND A.OPERT_DE = B.OPERT_DE
		                                     AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
		          , (
			           SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE,U.LOC_CODE,U.PRODUCT_NO, LINE_CODE, SUM(U.QY) AS QY
			            FROM (
			                    SELECT
			                             M.OPERT_DE
			                           , B.CLS_CODE
			                           , B.LOC_CODE
			                           , B.LINE_CODE
			                           , M.PSPNO AS     PRODUCT_NO
			                           , QY
			                    FROM (
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY01 AS QY, TRNYM || '01' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY02 AS QY, TRNYM || '02' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY03 AS QY, TRNYM || '03' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY04 AS QY, TRNYM || '04' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY05 AS QY, TRNYM || '05' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY06 AS QY, TRNYM || '06' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY07 AS QY, TRNYM || '07' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY08 AS QY, TRNYM || '08' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY09 AS QY, TRNYM || '09' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY10 AS QY, TRNYM || '10' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY11 AS QY, TRNYM || '11' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY12 AS QY, TRNYM || '12' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY13 AS QY, TRNYM || '13' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY14 AS QY, TRNYM || '14' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY15 AS QY, TRNYM || '15' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY16 AS QY, TRNYM || '16' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY17 AS QY, TRNYM || '17' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY18 AS QY, TRNYM || '18' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY19 AS QY, TRNYM || '19' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY20 AS QY, TRNYM || '20' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY21 AS QY, TRNYM || '21' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY22 AS QY, TRNYM || '22' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY23 AS QY, TRNYM || '23' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY24 AS QY, TRNYM || '24' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY25 AS QY, TRNYM || '25' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY26 AS QY, TRNYM || '26' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY27 AS QY, TRNYM || '27' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY28 AS QY, TRNYM || '28' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY29 AS QY, TRNYM || '29' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY30 AS QY, TRNYM || '30' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY31 AS QY, TRNYM || '31' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                          ) M
			                              INNER JOIN PSZDBLIB.FHP010PF B
			                              ON M.DEVID = B.IF_CODE
			                              AND M.COMPS = B.CLS_CODE
			                              WHERE M.COMPS = #{clsCode}
			                              AND M.TRNYM = #{repym}
			                              AND B.LOC_CODE = #{locCode}
			                              AND B.CLS_CODE = #{clsCode}
			                              AND LENGTH(TRIM(B.IF_CODE)) > 0
			                              AND B.IF_TYPE = 'Q'
			                    UNION ALL
			                    SELECT OPERT_DE
			                          ,  CLS_CODE
			                          , LOC_CODE
			                          , LINE_CODE
			                          , PRODUCT_NO
			                          , QY
			                    FROM PSZDBLIB.FHP100PF
			                    WHERE CLS_CODE = #{clsCode}
			                    AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
			                    AND SUBSTR(OPERT_DE,1,6) = #{repym}
			            ) U
			            GROUP BY OPERT_DE,CLS_CODE,LOC_CODE,LINE_CODE,PRODUCT_NO
    			) C /*생산실적*/		    
		WHERE 1 = 1
		AND SUBSTR(B.OPERT_DE, 1, 6) = #{repym}
		AND B.CLS_CODE = #{clsCode}
		AND B.LOC_CODE = #{locCode}
		AND B.LINE_CODE = #{lineCode}
		AND B.OPERT_DE = C.OPERT_DE
		AND B.CLS_CODE = C.CLS_CODE
		AND B.LOC_CODE = C.LOC_CODE
		AND B.LINE_CODE = C.LINE_CODE

    </select>
    
    
    <!--  직접대당투입공수-->
    <select id="searchBySt4_2" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
    
		/*직접대당투입공수(직접생산량*60/생산실적)*/
		SELECT  
		         DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '15' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '15' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D15
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '16' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '16' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D16
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '17' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '17' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D17
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '18' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '18' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D18
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '19' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '19' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D19
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '20' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '20' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D20
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '21' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '21' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D21
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '22' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '22' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D22
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '23' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '23' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D23
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '24' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '24' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D24
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '25' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '25' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D25
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '26' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '26' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D26
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '27' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '27' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D27
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '28' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '28' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D28
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '29' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '29' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D29
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '30' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '30' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D30
		        , DOUBLE(CASE COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '31' THEN C.QY ELSE 0 END),0) WHEN 0 THEN 0 ELSE
		                 (MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31'
		                          THEN (B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
		                             + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) ELSE 0
		                     END) + MAX(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.LGST_TIME ELSE 0 END)
		                    - COALESCE(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.HR_MNT ELSE 0 END),0))*60
		                / COALESCE(SUM(CASE WHEN SUBSTR(C.OPERT_DE, 7, 8) = '31' THEN C.QY ELSE 0 END),0) END) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP109PF B LEFT OUTER JOIN PSZDBLIB.FHP130PF A
		                                      ON A.CLS_CODE = B.CLS_CODE
		                                     AND A.LOC_CODE = B.LOC_CODE
		                                     AND A.LINE_CODE = B.LINE_CODE
		                                     AND A.OPERT_DE = B.OPERT_DE
		                                     AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
		          , (
			           SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE,U.LOC_CODE,U.PRODUCT_NO, LINE_CODE, SUM(U.QY) AS QY
			            FROM (
			                    SELECT
			                             M.OPERT_DE
			                           , B.CLS_CODE
			                           , B.LOC_CODE
			                           , B.LINE_CODE
			                           , M.PSPNO AS     PRODUCT_NO
			                           , QY
			                    FROM (
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY01 AS QY, TRNYM || '01' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY02 AS QY, TRNYM || '02' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY03 AS QY, TRNYM || '03' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY04 AS QY, TRNYM || '04' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY05 AS QY, TRNYM || '05' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY06 AS QY, TRNYM || '06' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY07 AS QY, TRNYM || '07' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY08 AS QY, TRNYM || '08' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY09 AS QY, TRNYM || '09' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY10 AS QY, TRNYM || '10' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY11 AS QY, TRNYM || '11' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY12 AS QY, TRNYM || '12' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY13 AS QY, TRNYM || '13' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY14 AS QY, TRNYM || '14' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY15 AS QY, TRNYM || '15' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY16 AS QY, TRNYM || '16' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY17 AS QY, TRNYM || '17' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY18 AS QY, TRNYM || '18' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY19 AS QY, TRNYM || '19' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY20 AS QY, TRNYM || '20' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY21 AS QY, TRNYM || '21' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY22 AS QY, TRNYM || '22' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY23 AS QY, TRNYM || '23' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY24 AS QY, TRNYM || '24' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY25 AS QY, TRNYM || '25' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY26 AS QY, TRNYM || '26' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY27 AS QY, TRNYM || '27' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY28 AS QY, TRNYM || '28' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY29 AS QY, TRNYM || '29' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY30 AS QY, TRNYM || '30' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                              UNION ALL
			                              SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY31 AS QY, TRNYM || '31' AS OPERT_DE
			                              FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
			                          ) M
			                              INNER JOIN PSZDBLIB.FHP010PF B
			                              ON M.DEVID = B.IF_CODE
			                              AND M.COMPS = B.CLS_CODE
			                              WHERE M.COMPS = #{clsCode}
			                              AND M.TRNYM = #{repym}
			                              AND B.LOC_CODE = #{locCode}
			                              AND B.CLS_CODE = #{clsCode}
			                              AND LENGTH(TRIM(B.IF_CODE)) > 0
			                              AND B.IF_TYPE = 'Q'
			                    UNION ALL
			                    SELECT OPERT_DE
			                          ,  CLS_CODE
			                          , LOC_CODE
			                          , LINE_CODE
			                          , PRODUCT_NO
			                          , QY
			                    FROM PSZDBLIB.FHP100PF
			                    WHERE CLS_CODE = #{clsCode}
			                    AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
			                    AND SUBSTR(OPERT_DE,1,6) = #{repym}
			            ) U
			            GROUP BY OPERT_DE,CLS_CODE,LOC_CODE,LINE_CODE,PRODUCT_NO
    			) C /*생산실적*/		    
		WHERE 1 = 1
		AND SUBSTR(B.OPERT_DE, 1, 6) = #{repym}
		AND B.CLS_CODE = #{clsCode}
		AND B.LOC_CODE = #{locCode}
		AND B.LINE_CODE = #{lineCode}
		AND B.OPERT_DE = C.OPERT_DE
		AND B.CLS_CODE = C.CLS_CODE
		AND B.LOC_CODE = C.LOC_CODE
		AND B.LINE_CODE = C.LINE_CODE

    </select>
    
	<!--UPH-->
    <select id="searchBySt5_1" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
	    SELECT MAX(A.LINE_CODE) AS LINE_CODE
		    , 'UPH' AS SE_NM
			, 'UPH' AS CODE_NM
			, 'UPH_D01' AS SE
			, 'UPH_D01' AS CODE
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '01' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '01' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D01 /*UPH_D01*/
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '02' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '02' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D02
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '03' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '03' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D03
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '04' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '04' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D04
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '05' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '05' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D05
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '06' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '06' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D06
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '07' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '07' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D07
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '08' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '08' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D08
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '09' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '09' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D09
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '10' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '10' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D10
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '11' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '11' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D11
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '12' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '12' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D12
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '13' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '13' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D13
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '14' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '14' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D14	        
		FROM PSZDBLIB.FHP109PF A /*라인인원투입시간*/
		    , (
		        SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE,U.LOC_CODE,U.PRODUCT_NO, LINE_CODE, SUM(U.QY) AS QY
		        FROM (
		                SELECT
		                         M.OPERT_DE
		                       , B.CLS_CODE
		                       , B.LOC_CODE
		                       , B.LINE_CODE
		                       , M.PSPNO AS     PRODUCT_NO
		                       , QY
		                FROM (
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY01 AS QY, TRNYM || '01' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY02 AS QY, TRNYM || '02' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY03 AS QY, TRNYM || '03' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY04 AS QY, TRNYM || '04' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY05 AS QY, TRNYM || '05' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY06 AS QY, TRNYM || '06' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY07 AS QY, TRNYM || '07' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY08 AS QY, TRNYM || '08' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY09 AS QY, TRNYM || '09' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY10 AS QY, TRNYM || '10' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY11 AS QY, TRNYM || '11' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY12 AS QY, TRNYM || '12' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY13 AS QY, TRNYM || '13' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY14 AS QY, TRNYM || '14' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                      ) M
		                          INNER JOIN PSZDBLIB.FHP010PF B
		                          ON M.DEVID = B.IF_CODE
		                          AND M.COMPS = B.CLS_CODE
		                          WHERE M.COMPS = #{clsCode}
		                          AND M.TRNYM = #{repym}
		                          AND B.LOC_CODE = #{locCode}
		                          AND B.CLS_CODE = #{clsCode}
		                          AND LENGTH(TRIM(B.IF_CODE)) > 0
		                          AND B.IF_TYPE = 'Q'
		                UNION ALL
		                SELECT OPERT_DE
		                      ,  CLS_CODE
		                      , LOC_CODE
		                      , LINE_CODE
		                      , PRODUCT_NO
		                      , QY
		                FROM PSZDBLIB.FHP100PF
		                WHERE CLS_CODE = #{clsCode}
		                AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
		                AND SUBSTR(OPERT_DE,1,6) = #{repym}
		        ) U
		        GROUP BY OPERT_DE,CLS_CODE,LOC_CODE,LINE_CODE,PRODUCT_NO
		    ) B	/*생산실적*/			
		WHERE 1 = 1
		AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		AND A.CLS_CODE = #{clsCode}
		AND A.LOC_CODE = #{locCode}
		AND A.LINE_CODE = #{lineCode}
		AND A.OPERT_DE = B.OPERT_DE
		AND A.CLS_CODE = B.CLS_CODE
		AND A.LOC_CODE = B.LOC_CODE
		AND A.LINE_CODE = B.LINE_CODE


    </select>
    
    <!--UPH-->
    <select id="searchBySt5_2" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
		SELECT MAX(A.LINE_CODE) AS LINE_CODE
	       	, 'UPH' AS SE_NM
			, 'UPH' AS CODE_NM
			, 'UPH_D01' AS SE
			, 'UPH_D01' AS CODE
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '15' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '15' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D15
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '16' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '16' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D16
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '17' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '17' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D17
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '18' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '18' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D18
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '19' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '19' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D19
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '20' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '20' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D20
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '21' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '21' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D21
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '22' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '22' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D22
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '23' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '23' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D23
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '24' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '24' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D24
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '25' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '25' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D25
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '26' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '26' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D26
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '27' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '27' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D27
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '28' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '28' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D28
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '29' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '29' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D29
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '30' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '30' THEN B.QY ELSE 0 END),15,2), 1), 0) ,1) END) AS TOT_HR_MNT_D30
	        , DOUBLE(CASE ROUND(CASE COALESCE(DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.QY ELSE 0 END),15,2),0) WHEN 0 THEN 0
	                           ELSE DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31'
	                                             THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                  + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                  + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                  / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.QY ELSE 0 END),15,2)
	                           END, 1) WHEN 0 THEN 0
	                ELSE ROUND(3600 / COALESCE(ROUND(DEC(SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31'
	                                                     THEN (A.HR_MNT1*A.PRSNL1 + A.HR_MNT2*A.PRSNL2 + A.HR_MNT3*A.PRSNL3 + A.HR_MNT4*A.PRSNL4
	                                                          + A.HR_MNT5*A.PRSNL5 + A.HR_MNT6*A.PRSNL6 + A.HR_MNT7*A.PRSNL7 + A.HR_MNT8*A.PRSNL8) ELSE 0 END)
	                                            + SUM(CASE WHEN SUBSTR(A.OPERT_DE, 7, 8) = '31' THEN A.LGST_TIME ELSE 0 END),15,2) * 60
	                                        / DEC(SUM(CASE WHEN SUBSTR(B.OPERT_DE, 7, 8) = '31' THEN B.QY ELSE 0 END),15,2), 1),0) ,1) END) AS TOT_HR_MNT_D31
		FROM PSZDBLIB.FHP109PF A /*라인인원투입시간*/
		    , (
		        SELECT U.OPERT_DE AS OPERT_DE, U.CLS_CODE,U.LOC_CODE,U.PRODUCT_NO, LINE_CODE, SUM(U.QY) AS QY
		        FROM (
		                SELECT
		                         M.OPERT_DE
		                       , B.CLS_CODE
		                       , B.LOC_CODE
		                       , B.LINE_CODE
		                       , M.PSPNO AS     PRODUCT_NO
		                       , QY
		                FROM (
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY15 AS QY, TRNYM || '15' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY16 AS QY, TRNYM || '16' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY17 AS QY, TRNYM || '17' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY18 AS QY, TRNYM || '18' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY19 AS QY, TRNYM || '19' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY20 AS QY, TRNYM || '20' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY21 AS QY, TRNYM || '21' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY22 AS QY, TRNYM || '22' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY23 AS QY, TRNYM || '23' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY24 AS QY, TRNYM || '24' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY25 AS QY, TRNYM || '25' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY26 AS QY, TRNYM || '26' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY27 AS QY, TRNYM || '27' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY28 AS QY, TRNYM || '28' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY29 AS QY, TRNYM || '29' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY30 AS QY, TRNYM || '30' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                          UNION ALL
		                          SELECT COMPS, TRNYM, DEVID, PSPNO, ITDSC, PTQY31 AS QY, TRNYM || '31' AS OPERT_DE
		                          FROM ${lib2}.FGP500PF  WHERE COMPS = #{clsCode} AND TRNYM = #{repym}
		                      ) M
		                          INNER JOIN PSZDBLIB.FHP010PF B
		                          ON M.DEVID = B.IF_CODE
		                          AND M.COMPS = B.CLS_CODE
		                          WHERE M.COMPS = #{clsCode}
		                          AND M.TRNYM = #{repym}
		                          AND B.LOC_CODE = #{locCode}
		                          AND B.CLS_CODE = #{clsCode}
		                          AND LENGTH(TRIM(B.IF_CODE)) > 0
		                          AND B.IF_TYPE = 'Q'
		                UNION ALL
		                SELECT OPERT_DE
		                      ,  CLS_CODE
		                      , LOC_CODE
		                      , LINE_CODE
		                      , PRODUCT_NO
		                      , QY
		                FROM PSZDBLIB.FHP100PF
		                WHERE CLS_CODE = #{clsCode}
		                AND LOC_CODE = #{locCode} AND INT_TYPE IN ( 'M', 'I')
		                AND SUBSTR(OPERT_DE,1,6) = #{repym}
		        ) U
		        GROUP BY OPERT_DE,CLS_CODE,LOC_CODE,LINE_CODE,PRODUCT_NO
		    ) B	/*생산실적*/		
		WHERE 1 = 1
		AND SUBSTR(A.OPERT_DE, 1, 6) = #{repym}
		AND A.CLS_CODE = #{clsCode}
		AND A.LOC_CODE = #{locCode}
		AND A.LINE_CODE = #{lineCode}
		AND A.OPERT_DE = B.OPERT_DE
		AND A.CLS_CODE = B.CLS_CODE
		AND A.LOC_CODE = B.LOC_CODE
		AND A.LINE_CODE = B.LINE_CODE
    </select>
    
    <!-- 기준시간(분) 총계 -->
    <select id="searchbyStTot" resultType="java.lang.Integer" parameterType="PrdPrfByLineDomain">
    select DOUBLE(COALESCE(sum(C.ST),0)) as ST_TOT
from (
     select max(A.PRODUCT_NO),
            sum(A.QY) * max(B.STDR_LABOR) AS ST
     FROM PSZDBLIB.FHP100PF A,
          PSZDBLIB.FHP030PF B
     WHERE A.CLS_CODE = #{clsCode}
       AND A.LOC_CODE = #{locCode}
       and substr(A.opert_de, 1, 6) = #{repym}
       AND A.INT_TYPE in ('M', 'I')
       and A.line_code = #{lineCode}
       and A.line_code = B.line_code
       and A.CLS_CODE = B.CLS_CODE
       and A.PRODUCT_NO = B.PRDT_NO
       and B.YEAR = #{year}
       and B.FS_HALF = #{fsHalf} /* F:상반기 S:하반기 */
     group by A.PRODUCT_NO, A.line_code /* 다른 라인이지만 같은 품폭번호가 존재함 */
     union all
        SELECT MAX(A.PSPNO), SUM(A.PTQY01+A.PTQY02+A.PTQY03+A.PTQY04+A.PTQY05+A.PTQY06+A.PTQY07+A.PTQY08+A.PTQY09+A.PTQY10+A.PTQY11
                    +A.PTQY12+A.PTQY13+A.PTQY14+A.PTQY15+A.PTQY16+A.PTQY17+A.PTQY18+A.PTQY19+A.PTQY20+A.PTQY21+A.PTQY22+A.PTQY23
                    +A.PTQY24+A.PTQY25+A.PTQY26+A.PTQY27+A.PTQY28+A.PTQY29+A.PTQY30+A.PTQY31) * MAX(C.STDR_LABOR) AS ST
        FROM ${lib2}.FGP500PF A, PSZDBLIB.FHP010PF B, PSZDBLIB.FHP030PF C
        WHERE A.COMPS = B.CLS_CODE
        AND A.TRNYM = #{repym}
        AND B.CLS_CODE = #{clsCode}
        AND B.LOC_CODE = #{locCode}
        AND B.LINE_CODE = #{lineCode}
        AND A.DEVID = B.IF_CODE
        AND A.COMPS = B.CLS_CODE
        AND LENGTH(TRIM(B.IF_CODE)) > 0
        AND B.LINE_CODE = C.LINE_CODE
        AND A.COMPS = C.CLS_CODE
        AND A.PSPNO = C.PRDT_NO
        AND C.YEAR = #{year}
        AND C.FS_HALF = #{fsHalf}
        GROUP BY A.PSPNO, A.DEVID
 ) C    
     </select>
    
    <!-- 직접생산시간(분) 총계 -->
    <select id="searchbyHrMntTot" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
	    select   DOUBLE(COALESCE(sum(B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
	            + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) + sum(B.LGST_TIME)
	            + coalesce(sum(A.HR_MNT),0),0)) AS  HR_MNT_TOT
		FROM PSZDBLIB.FHP109PF B left outer join PSZDBLIB.FHP130PF A
		                                      on A.cls_code = B.cls_code
		                                     and A.loc_code = B.loc_code
		                                     and A.line_code = B.line_code
		                                     and A.opert_de = B.opert_de
		                                     AND A.SE in( 'B', 'C') /*제외(B), 간접(C)*/
		WHERE 1 = 1
		and substr(B.opert_de, 1, 6) = #{repym}
		AND B.CLS_CODE = #{clsCode}
		AND B.LOC_CODE = #{locCode}
		and B.line_code = #{lineCode}
	</select>

	<!-- 공수저감지수 총계 -->
    <select id="searchbyPtmTot" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
select DOUBLE(COALESCE(CASE dec((
						
								SELECT SUM(U.QY) AS QY
								FROM (
								         SELECT B.CLS_CODE
								              , B.LOC_CODE
								              , B.LINE_CODE
								              , A.PSPNO AS PRODUCT_NO
								              , (A.PTQY01 + A.PTQY02 + A.PTQY03 + A.PTQY04 + A.PTQY05 + A.PTQY06 + A.PTQY07 + A.PTQY08 +
								                 A.PTQY09 + A.PTQY10
								             + A.PTQY11 + A.PTQY12 + A.PTQY13 + A.PTQY14 + A.PTQY15 + A.PTQY16 + A.PTQY17 + A.PTQY18 +
								                 A.PTQY19 + A.PTQY20
								             + A.PTQY21 + A.PTQY22 + A.PTQY23 + A.PTQY24 + A.PTQY25 + A.PTQY26 + A.PTQY27 + A.PTQY28 +
								                 A.PTQY29 + A.PTQY30 + A.PTQY31
								             )             AS QY
								         FROM ${lib2}.FGP500PF A
								                  INNER JOIN PSZDBLIB.FHP010PF B
								                             ON A.DEVID = B.IF_CODE
								                                 AND A.COMPS = B.CLS_CODE
								         WHERE A.COMPS = #{clsCode}
								           AND A.TRNYM = #{repym}
								           AND B.LOC_CODE = #{locCode}
								           AND B.CLS_CODE = #{clsCode}
								           AND LENGTH(TRIM(B.IF_CODE)) > 0
								           AND B.IF_TYPE = 'Q'
								           and B.line_code = #{lineCode}
								
								         UNION ALL
								
								         SELECT CLS_CODE
								              , LOC_CODE
								              , LINE_CODE
								              , PRODUCT_NO
								              , SUM(QY)  AS QY
								         FROM (
								                  SELECT SUBSTR(OPERT_DE, 1, 6) AS OPERT_DE
								                       , CLS_CODE
								                       , LOC_CODE
								                       , LINE_CODE
								                       , PRODUCT_NO
								                       , QY
								                  FROM PSZDBLIB.FHP100PF
								                  WHERE CLS_CODE = #{clsCode}
								                    and line_code = #{lineCode}
								                    AND LOC_CODE = #{locCode} AND INT_TYPE in ( 'M', 'I')
								                    AND SUBSTR(OPERT_DE, 1, 6) = #{repym}
								              ) A
								         GROUP BY A.CLS_CODE, A.LOC_CODE, A.LINE_CODE, A.PRODUCT_NO
								     ) U
								GROUP BY U.CLS_CODE, U.LOC_CODE, U.LINE_CODE
                                      
                               ),15,2) WHEN 0 THEN 0
                        ELSE
                               round(dec((
                                       select sum(B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
                                                + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8) + sum(B.LGST_TIME)
                                                + coalesce(sum(A.HR_MNT), 0) AS HR_MNT_TOT
                                       FROM PSZDBLIB.FHP109PF B
                                       left outer join PSZDBLIB.FHP130PF A
                                       on A.cls_code = B.cls_code
                                           and A.loc_code = B.loc_code
                                           and A.line_code = B.line_code
                                           and A.opert_de = B.opert_de
                                           AND A.SE in ('B', 'C') /*제외(B), 간접(C)*/
                                       WHERE 1 = 1
                                           and substr(B.opert_de, 1, 6) = #{repym}
                                           AND B.CLS_CODE = #{clsCode}
                                           AND B.LOC_CODE = #{locCode}
                                           and B.line_code = #{lineCode}
                                   ),15,2) / dec((                                   
                                   
				                                   SELECT SUM(U.QY) AS QY
													FROM (
													         SELECT B.CLS_CODE
													              , B.LOC_CODE
													              , B.LINE_CODE
													              , A.PSPNO AS PRODUCT_NO
													              , (A.PTQY01 + A.PTQY02 + A.PTQY03 + A.PTQY04 + A.PTQY05 + A.PTQY06 + A.PTQY07 + A.PTQY08 +
													                 A.PTQY09 + A.PTQY10
													             + A.PTQY11 + A.PTQY12 + A.PTQY13 + A.PTQY14 + A.PTQY15 + A.PTQY16 + A.PTQY17 + A.PTQY18 +
													                 A.PTQY19 + A.PTQY20
													             + A.PTQY21 + A.PTQY22 + A.PTQY23 + A.PTQY24 + A.PTQY25 + A.PTQY26 + A.PTQY27 + A.PTQY28 +
													                 A.PTQY29 + A.PTQY30 + A.PTQY31
													             )             AS QY
													         FROM ${lib2}.FGP500PF A
													                  INNER JOIN PSZDBLIB.FHP010PF B
													                             ON A.DEVID = B.IF_CODE
													                                 AND A.COMPS = B.CLS_CODE
													         WHERE A.COMPS = #{clsCode}
													           AND A.TRNYM = #{repym}
													           AND B.LOC_CODE = #{locCode}
													           AND B.CLS_CODE = #{clsCode}
													           AND LENGTH(TRIM(B.IF_CODE)) > 0
													           AND B.IF_TYPE = 'Q'
													           and B.line_code = #{lineCode}
													
													         UNION ALL
													
													         SELECT CLS_CODE
													              , LOC_CODE
													              , LINE_CODE
													              , PRODUCT_NO
													              , SUM(QY)  AS QY
													         FROM (
													                  SELECT SUBSTR(OPERT_DE, 1, 6) AS OPERT_DE
													                       , CLS_CODE
													                       , LOC_CODE
													                       , LINE_CODE
													                       , PRODUCT_NO
													                       , QY
													                  FROM PSZDBLIB.FHP100PF
													                  WHERE CLS_CODE = #{clsCode}
													                    and line_code = #{lineCode}
													                    AND LOC_CODE = #{locCode} AND INT_TYPE in ( 'M', 'I')
													                    AND SUBSTR(OPERT_DE, 1, 6) = #{repym}
													              ) A
													         GROUP BY A.CLS_CODE, A.LOC_CODE, A.LINE_CODE, A.PRODUCT_NO
													     ) U
													GROUP BY U.CLS_CODE, U.LOC_CODE, U.LINE_CODE               
													                                                       
                               ),15,2) * 100,1) END, 0)) AS PTM_TOT
from sysibm.sysdummy1

	</select>

	<!-- 제외간접부서비윻 총계 -->
    <select id="searchbyHrMntDeTot" resultMap="PrdPrfByLine" parameterType="PrdPrfByLineDomain">
SELECT CASE DEC(SUM(C.HR_MNT_TOT),15,2) WHEN 0 THEN 0
       ELSE DOUBLE(COALESCE(ROUND(DEC(SUM(C.HR_MNT),15,2)/DEC(SUM(C.HR_MNT_TOT),15,2)*100,1),0)) END AS HR_MNT_DE_TOT
FROM (
    SELECT DEC(COALESCE(SUM( A.HR_MNT ),0),15,2) AS HR_MNT
            , DEC(MAX(B.HR_MNT1*B.PRSNL1 + B.HR_MNT2*B.PRSNL2 + B.HR_MNT3*B.PRSNL3 + B.HR_MNT4*B.PRSNL4
                                        + B.HR_MNT5*B.PRSNL5 + B.HR_MNT6*B.PRSNL6 + B.HR_MNT7*B.PRSNL7 + B.HR_MNT8*B.PRSNL8)+ MAX(B.LGST_TIME),15,2) AS HR_MNT_TOT
    FROM PSZDBLIB.FHP109PF B LEFT OUTER JOIN PSZDBLIB.FHP130PF A
                                          ON A.CLS_CODE = B.CLS_CODE
                                         AND A.LOC_CODE = B.LOC_CODE
                                         AND A.LINE_CODE = B.LINE_CODE
                                         AND A.OPERT_DE = B.OPERT_DE
                                         AND A.SE IN( 'B', 'C') /*제외(B), 간접(C)*/
    WHERE 1 = 1
    AND SUBSTR(B.OPERT_DE, 1, 6) = #{repym}
    AND B.CLS_CODE = #{clsCode}
    AND B.LOC_CODE = #{locCode}
    AND B.LINE_CODE = #{lineCode}
    GROUP BY B.OPERT_DE
    ) C
    </select>
    
        

</mapper>