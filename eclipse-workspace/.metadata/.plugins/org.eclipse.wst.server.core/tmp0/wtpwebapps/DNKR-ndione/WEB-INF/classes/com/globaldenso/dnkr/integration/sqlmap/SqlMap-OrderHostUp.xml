<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.globaldenso.dnkr.integration.dao.OrderHostUpDao">

    <resultMap id="OrderHostUp" type="OrderHostUpDomain">
		<result property="psvnd" column="PSVND" />
		<result property="pscom" column="PSCOM" />
		<result property="pyvnd" column="PYVND" />
		<result property="vndcd" column="VNDCD" />
		<result property="faccd" column="FACCD" />
		
		<result property="comps" column="COMPS" />
		<result property="mcrcd" column="MCRCD" />
		<result property="msecd" column="MSECD" />
		<result property="mcrc1" column="MCRC1" />
		<result property="msec1" column="MSEC1" />
		
		<result property="pspno" column="PSPNO" />
		<result property="seqcd" column="SEQCD" />
		<result property="seqno" column="SEQNO" />
		<result property="efffr" column="EFFFR" />
		<result property="effto" column="EFFTO" />

		<result property="dmkcr" column="DMKCR" />
		<result property="dsecd" column="DSECD" />
		<result property="dseno" column="DSENO" />
		<result property="dfacd" column="DFACD" />
		<result property="deffr" column="DEFFR" />
		<result property="defto" column="DEFTO" />
		<result property="dumcb" column="DUMCB" />
		<result property="trimd" column="TRIMD" />
		<result property="pbsqy" column="PBSQY" />
		<result property="patqy" column="PATQY" />
		<result property="wbsqy" column="WBSQY" />

		<result property="d0t01" column="D0T01" />
		<result property="d0t02" column="D0T02" />
		<result property="d0t03" column="D0T03" />
		<result property="d0t04" column="D0T04" />
		<result property="d0t05" column="D0T05" />
		<result property="d0t06" column="D0T06" />
		<result property="d0t07" column="D0T07" />
		<result property="d0t08" column="D0T08" />
		<result property="d0t09" column="D0T09" />
		<result property="d0t10" column="D0T10" />
		<result property="d0tqy" column="D0TQY" />
		
		<result property="d1t01" column="D1T01" />
		<result property="d1t02" column="D1T02" />
		<result property="d1t03" column="D1T03" />
		<result property="d1t04" column="D1T04" />
		<result property="d1t05" column="D1T05" />
		<result property="d1t06" column="D1T06" />
		<result property="d1t07" column="D1T07" />
		<result property="d1t08" column="D1T08" />
		<result property="d1t09" column="D1T09" />
		<result property="d1t10" column="D1T10" />
		<result property="d1tqy" column="D1TQY" />
		
		<result property="d2t01" column="D2T01" />
		<result property="d2t02" column="D2T02" />
		<result property="d2t03" column="D2T03" />
		<result property="d2t04" column="D2T04" />
		<result property="d2t05" column="D2T05" />
		<result property="d2t06" column="D2T06" />
		<result property="d2t07" column="D2T07" />
		<result property="d2t08" column="D2T08" />
		<result property="d2t09" column="D2T09" />
		<result property="d2t10" column="D2T10" />
		<result property="d2tqy" column="D2TQY" />
		
		<result property="d3t01" column="D3T01" />
		<result property="d3t02" column="D3T02" />
		<result property="d3t03" column="D3T03" />
		<result property="d3t04" column="D3T04" />
		<result property="d3t05" column="D3T05" />
		<result property="d3t06" column="D3T06" />
		<result property="d3t07" column="D3T07" />
		<result property="d3t08" column="D3T08" />
		<result property="d3t09" column="D3T09" />
		<result property="d3t10" column="D3T10" />
		<result property="d3tqy" column="D3TQY" />
		
		<result property="d4t01" column="D4T01" />
		<result property="d4t02" column="D4T02" />
		<result property="d4t03" column="D4T03" />
		<result property="d4t04" column="D4T04" />
		<result property="d4t05" column="D4T05" />
		<result property="d4t06" column="D4T06" />
		<result property="d4t07" column="D4T07" />
		<result property="d4t08" column="D4T08" />
		<result property="d4t09" column="D4T09" />
		<result property="d4t10" column="D4T10" />
		<result property="d4tqy" column="D4TQY" />
		
		<result property="dat00" column="DAT00" />
		<result property="dat01" column="DAT01" />
		<result property="dat02" column="DAT02" />
		<result property="dat03" column="DAT03" />
		<result property="dat04" column="DAT04" />
		<result property="dat05" column="DAT05" />
		<result property="dat06" column="DAT06" />
		<result property="dat07" column="DAT07" />
		<result property="dat08" column="DAT08" />
		<result property="dat09" column="DAT09" />
		<result property="dat10" column="DAT10" />
		<result property="dat11" column="DAT11" />
		<result property="dat12" column="DAT12" />		

		<result property="remqy" column="REMQY" />
		<result property="grtot" column="GRTOT" />
		<result property="okqty" column="OKQTY" />
		<result property="mitqy" column="MITQY" />
		<result property="prseq" column="PRSEQ" />
		<result property="miqqy" column="MIQQY" />
		<result property="mioqy" column="MIOQY" />
		<result property="molcd" column="MOLCD" />
						
        <result property="lib1" column="lib1" />
        <result property="lib2" column="lib2" />
        <result property="lib3" column="lib3" />     
    </resultMap>

    <select id="selectSVM020PF" resultMap="OrderHostUp" parameterType="OrderHostUpDomain">
		SELECT PSVND, PSCOM
		FROM 
		     <if test='comps.equals("E1")'>
			 PSZDBLIB.SVM020PF
			 </if>
		     <if test='!comps.equals("E1")'>
			 PSZDBLIB.SVM030PF
			 </if>
		WHERE 
		      'SqlMap-OrderHostUp.selectSVM020PF' = 'SqlMap-OrderHostUp.selectSVM020PF'
		<if test="vndcd != null and vndcd !='' ">
		  AND VNDCD = #{vndcd}
		</if>	
		<if test="faccd != null and faccd !='' ">
		    <if test='comps.equals("E1")'>
			AND FACCD = #{faccd}
			</if>
		    <if test='!comps.equals("E1")'>
			AND SEQNO = #{seqno}
			</if>				  
		</if>
    </select>

    <select id="selectSVZ080PF" resultMap="OrderHostUp" parameterType="OrderHostUpDomain">
		SELECT MCRCD, MSECD
		FROM 
			PSZDBLIB.SVZ080PF 
		WHERE 
		      'SqlMap-OrderHostUp.selectSVZ080PF' = 'SqlMap-OrderHostUp.selectSVZ080PF'
		<if test="comps != null and comps !='' ">
		  AND COMPS = #{comps}
		</if>
		<if test="pyvnd != null and pyvnd !='' ">
		  AND PYVND = #{pyvnd}
		</if>
		<if test="mcrcd != null and mcrcd !='' ">
		  AND MCRCD = #{mcrcd}
		</if>
		<if test="msecd != null and msecd !='' ">
		  AND MSECD = #{msecd}
		</if>
		<if test="mcrc1 != null and mcrc1 !='' ">
		  AND MCRC1 = #{mcrc1}
		</if>
		<if test="msec1 != null and msec1 !='' ">
		  AND MSEC1 = #{msec1}
		</if>
    </select>
    
    <select id="selectSVM100PF" resultMap="OrderHostUp" parameterType="OrderHostUpDomain">
		SELECT PSPNO, EFFFR, EFFTO
		FROM 
			PSZDBLIB.SVM100PF 
		WHERE 
		      'SqlMap-OrderHostUp.selectSVM100PF' = 'SqlMap-OrderHostUp.selectSVM100PF'
		<if test="comps != null and comps !='' ">
		  AND COMPS = #{comps}
		</if>
		<if test="pyvnd != null and pyvnd !='' ">
		  AND PYVND = #{pyvnd}
		</if>
		<if test="pspno != null and pspno !='' ">
		  AND PSPNO = #{pspno}
		</if>		
		<if test="mcrcd != null and mcrcd !='' ">
		  AND MCRCD = #{mcrcd}
		</if>
		<if test="seqcd != null and seqcd !='' ">
		  AND SEQCD = #{seqcd}
		</if>
		<if test="seqno != null and seqno !='' ">
		  AND SEQNO = #{seqno}
		</if>
    </select>
    
    <!-- 테스트시 오류 발생하여 GROUP BY 처리 : 동일한 데이터가 2건 존재하였음. -->
    <select id="selectSVM300PF" resultMap="OrderHostUp" parameterType="OrderHostUpDomain">
		SELECT COMPS 
		FROM 
			PSZDBLIB.SVM300PF 
		WHERE 
		      'SqlMap-OrderHostUp.selectSVM300PF' = 'SqlMap-OrderHostUp.selectSVM300PF'
		<if test="comps != null and comps !='' ">
		  AND COMPS = #{comps}
		</if>
		<if test="pyvnd != null and pyvnd !='' ">
		  AND PYVND = #{pyvnd}
		</if>	
		<if test="mcrcd != null and mcrcd !='' ">
		  AND MKCAR = #{mcrcd}
		</if>
		<if test="seqcd != null and seqcd !='' ">
		  AND SEYCD = #{seqcd}
		</if>
		<if test="seqno != null and seqno !='' ">
		  AND SEYNO = #{seqno}
		</if>
		GROUP BY COMPS
    </select>


    <select id="countSVH310PF_Temp" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT
		FROM
			PSZDBLIB.SVH315PF
		WHERE
		      'SqlMap-OrderHostUp.countSVH310PF_Temp' = 'SqlMap-OrderHostUp.countSVH310PF_Temp'
		<if test="pyvnd != null and pyvnd !='' ">
		  AND PYVND = #{pyvnd}
		</if>	
		<if test="pspno != null and pspno !='' ">
		  AND PSPNO = #{pspno}
		</if>
    </select>
    
    <delete id="deleteSVH310PF_Temp" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SVH315PF 
		WHERE 
			  'SqlMap-OrderHostUp.deleteSVH310PF_Temp' = 'SqlMap-OrderHostUp.deleteSVH310PF_Temp'
    </delete>
    
    <insert id="createSVH310PF_Temp" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderHostUp.createSVH310PF_Temp */
		INSERT INTO 
			PSZDBLIB.SVH315PF
       (
           COMPS, PYVND, PSPNO, DMKCR, DSECD, DSENO, DFACD, DEFFR, DEFTO, DUMCB,
           TRIMD, PBSQY, PATQY, WBSQY,	
           D0T01, D0T02, D0T03, D0T04, D0T05, D0T06, D0T07, D0T08, D0T09, D0T10, D0TQY,	
           D1T01, D1T02, D1T03, D1T04, D1T05, D1T06, D1T07, D1T08, D1T09, D1T10, D1TQY,	
           D2T01, D2T02, D2T03, D2T04, D2T05, D2T06, D2T07, D2T08, D2T09, D2T10, D2TQY,	
           D3T01, D3T02, D3T03, D3T04, D3T05, D3T06, D3T07, D3T08, D3T09, D3T10, D3TQY,	
           D4T01, D4T02, D4T03, D4T04, D4T05, D4T06, D4T07, D4T08, D4T09, D4T10, D4TQY,	
           REMQY, GRTOT, 
           HOSTD, 
           HOSTT	
        )
		VALUES
			(
			#{comps},#{pyvnd},#{pspno},#{dmkcr},#{dsecd},#{dseno},#{dfacd},#{deffr},#{defto},#{dumcb},
			#{trimd},#{pbsqy},#{patqy},#{wbsqy},
			#{d0t01},#{d0t02},#{d0t03},#{d0t04},#{d0t05},#{d0t06},#{d0t07},#{d0t08},#{d0t09},#{d0t10},#{d0tqy},
			#{d1t01},#{d1t02},#{d1t03},#{d1t04},#{d1t05},#{d1t06},#{d1t07},#{d1t08},#{d1t09},#{d1t10},#{d1tqy},
			#{d2t01},#{d2t02},#{d2t03},#{d2t04},#{d2t05},#{d2t06},#{d2t07},#{d2t08},#{d2t09},#{d2t10},#{d2tqy},
			#{d3t01},#{d3t02},#{d3t03},#{d3t04},#{d3t05},#{d3t06},#{d3t07},#{d3t08},#{d3t09},#{d3t10},#{d3tqy},
			#{d4t01},#{d4t02},#{d4t03},#{d4t04},#{d4t05},#{d4t06},#{d4t07},#{d4t08},#{d4t09},#{d4t10},#{d4tqy},
			#{remqy},#{grtot},
			substr(trim(char(date(current date), ISO)),1,4) || substr(trim(char(date(current date), ISO)),6,2) || substr(trim(char(date(current date), ISO)),9,2),
			substr(trim(char(time(current time), ISO)),1,2) || substr(trim(char(time(current time), ISO)),4,2) || substr(trim(char(time(current time), ISO)),7,2) 
			)
    </insert> 
    
    <select id="selectSVH310PF_Temp" resultMap="OrderHostUp" parameterType="OrderHostUpDomain">
		SELECT									
			COMPS, PYVND, PSPNO, DMKCR, DSECD, DSENO, DFACD, DEFFR, DEFTO, DUMCB,
			TRIMD, PBSQY, PATQY, WBSQY,
			D0T01, D0T02, D0T03, D0T04, D0T05, 
			D0T06, D0T07, D0T08, D0T09, D0T10, D0TQY,
			D1T01, D1T02, D1T03, D1T04, D1T05, 
			D1T06, D1T07, D1T08, D1T09, D1T10, D1TQY,
			D2T01, D2T02, D2T03, D2T04, D2T05, 
			D2T06, D2T07, D2T08, D2T09, D2T10, D2TQY,
			D3T01, D3T02, D3T03, D3T04, D3T05, 
			D3T06, D3T07, D3T08, D3T09, D3T10, D3TQY,
			D4T01, D4T02, D4T03, D4T04, D4T05, 
			D4T06, D4T07, D4T08, D4T09, D4T10, D4TQY,
			REMQY, GRTOT			
		FROM									
			PSZDBLIB.SVH315PF												
		WHERE
		      'SqlMap-OrderHostUp.selectSVH310PF_Temp' = 'SqlMap-OrderHostUp.selectSVH310PF_Temp'							
		ORDER BY									
			COMPS,PYVND,PSPNO
    </select>
    
    <select id="selectSVH310PF_TempSum" resultMap="OrderHostUp" parameterType="OrderHostUpDomain">
		SELECT
			SUM(TRIMD) AS TRIMD, SUM(PBSQY) AS PBSQY, SUM(PATQY) AS PATQY, SUM(WBSQY) AS WBSQY,
			SUM(D0T01) AS D0T01, SUM(D0T02) AS D0T02, SUM(D0T03) AS D0T03, SUM(D0T04) AS D0T04, SUM(D0T05) AS D0T05, 
			SUM(D0T06) AS D0T06, SUM(D0T07) AS D0T07, SUM(D0T08) AS D0T08, SUM(D0T09) AS D0T09, SUM(D0T10) AS D0T10, SUM(D0TQY) AS D0TQY,
			SUM(D1T01) AS D1T01, SUM(D1T02) AS D1T02, SUM(D1T03) AS D1T03, SUM(D1T04) AS D1T04, SUM(D1T05) AS D1T05, 
			SUM(D1T06) AS D1T06, SUM(D1T07) AS D1T07, SUM(D1T08) AS D1T08, SUM(D1T09) AS D1T09, SUM(D1T10) AS D1T10, SUM(D1TQY) AS D1TQY,
			SUM(D2T01) AS D2T01, SUM(D2T02) AS D2T02, SUM(D2T03) AS D2T03, SUM(D2T04) AS D2T04, SUM(D2T05) AS D2T05, 
			SUM(D2T06) AS D2T06, SUM(D2T07) AS D2T07, SUM(D2T08) AS D2T08, SUM(D2T09) AS D2T09, SUM(D2T10) AS D2T10, SUM(D2TQY) AS D2TQY,
			SUM(D3T01) AS D3T01, SUM(D3T02) AS D3T02, SUM(D3T03) AS D3T03, SUM(D3T04) AS D3T04, SUM(D3T05) AS D3T05, 
			SUM(D3T06) AS D3T06, SUM(D3T07) AS D3T07, SUM(D3T08) AS D3T08, SUM(D3T09) AS D3T09, SUM(D3T10) AS D3T10, SUM(D3TQY) AS D3TQY,
			SUM(D4T01) AS D4T01, SUM(D4T02) AS D4T02, SUM(D4T03) AS D4T03, SUM(D4T04) AS D4T04, SUM(D4T05) AS D4T05, 
			SUM(D4T06) AS D4T06, SUM(D4T07) AS D4T07, SUM(D4T08) AS D4T08, SUM(D4T09) AS D4T09, SUM(D4T10) AS D4T10, SUM(D4TQY) AS D4TQY,
			SUM(REMQY) AS REMQY, SUM(GRTOT) AS GRTOT							
		FROM									
			PSZDBLIB.SVH315PF												
		WHERE
		      'SqlMap-OrderHostUp.selectSVH310PF_Temp' = 'SqlMap-OrderHostUp.selectSVH310PF_Temp'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}
		  AND PSPNO = #{pspno}
    </select>
    
    <select id="countSVH310PF1" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT
		FROM
			PSZDBLIB.SVH310PF
		WHERE
		      'SqlMap-OrderHostUp.countSVH310PF1' = 'SqlMap-OrderHostUp.countSVH310PF1'
		  AND DFACD IN (SELECT DFACD FROM PSZDBLIB.SVH315PF GROUP BY DFACD)
    </select>
    
    <!-- AND DFACD = #{dfacd} -->
    <delete id="deleteSVH310PF" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SVH310PF 
		WHERE 
			  'SqlMap-OrderHostUp.deleteSVH310PF' = 'SqlMap-OrderHostUp.deleteSVH310PF'
		  AND DFACD IN (SELECT DFACD FROM PSZDBLIB.SVH315PF GROUP BY DFACD)
    </delete>
    
    <select id="countSVH310PF2" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT
		FROM
			PSZDBLIB.SVH310PF
		WHERE
		      'SqlMap-OrderHostUp.countSVH310PF2' = 'SqlMap-OrderHostUp.countSVH310PF2'		  
		  AND PYVND = #{pyvnd}
		  AND PSPNO = #{pspno}
    </select>

    <insert id="createSVH310PF" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderHostUp.createSVH310PF */
		INSERT INTO 
			PSZDBLIB.SVH310PF
       (
           COMPS, PYVND, PSPNO, DMKCR, DSECD, DSENO, DFACD, DEFFR, DEFTO, DUMCB,
           TRIMD, PBSQY, PATQY, WBSQY,
           D0T01, D0T02, D0T03, D0T04, D0T05, D0T06, D0T07, D0T08, D0T09, D0T10, D0TQY,	
           D1T01, D1T02, D1T03, D1T04, D1T05, D1T06, D1T07, D1T08, D1T09, D1T10, D1TQY,	
           D2T01, D2T02, D2T03, D2T04, D2T05, D2T06, D2T07, D2T08, D2T09, D2T10, D2TQY,	
           D3T01, D3T02, D3T03, D3T04, D3T05, D3T06, D3T07, D3T08, D3T09, D3T10, D3TQY,	
           D4T01, D4T02, D4T03, D4T04, D4T05, D4T06, D4T07, D4T08, D4T09, D4T10, D4TQY,	
           REMQY, GRTOT,
           HOSTD,	
           HOSTT
        )
		VALUES
			(
			#{comps},#{pyvnd},#{pspno},#{dmkcr},#{dsecd},#{dseno},#{dfacd},#{deffr},#{defto},#{dumcb},
			#{trimd},#{pbsqy},#{patqy},#{wbsqy},
			#{d0t01},#{d0t02},#{d0t03},#{d0t04},#{d0t05},#{d0t06},#{d0t07},#{d0t08},#{d0t09},#{d0t10},#{d0tqy},
			#{d1t01},#{d1t02},#{d1t03},#{d1t04},#{d1t05},#{d1t06},#{d1t07},#{d1t08},#{d1t09},#{d1t10},#{d1tqy},
			#{d2t01},#{d2t02},#{d2t03},#{d2t04},#{d2t05},#{d2t06},#{d2t07},#{d2t08},#{d2t09},#{d2t10},#{d2tqy},
			#{d3t01},#{d3t02},#{d3t03},#{d3t04},#{d3t05},#{d3t06},#{d3t07},#{d3t08},#{d3t09},#{d3t10},#{d3tqy},
			#{d4t01},#{d4t02},#{d4t03},#{d4t04},#{d4t05},#{d4t06},#{d4t07},#{d4t08},#{d4t09},#{d4t10},#{d4tqy},
			#{remqy},#{grtot},
			substr(trim(char(date(current date), ISO)),1,4) || substr(trim(char(date(current date), ISO)),6,2) || substr(trim(char(date(current date), ISO)),9,2),
			substr(trim(char(time(current time), ISO)),1,2) || substr(trim(char(time(current time), ISO)),4,2) || substr(trim(char(time(current time), ISO)),7,2) 
			)
    </insert> 
    
    <insert id="createSVH310PF_ADD" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderHostUp.createSVH310PF_ADD */
		INSERT INTO 
			PSZDBLIB.SVH310PF
       (
           COMPS, PYVND, PSPNO, 
           DMKCR, DSECD, DSENO, DFACD, DEFFR, DEFTO, DUMCB,
           TRIMD, PBSQY, PATQY, WBSQY	
           D0T01, D0T02, D0T03, D0T04, D0T05, D0T06, D0T07, D0T08, D0T09, D0T10, D0TQY,	
           D1T01, D1T02, D1T03, D1T04, D1T05, D1T06, D1T07, D1T08, D1T09, D1T10, D1TQY,	
           D2T01, D2T02, D2T03, D2T04, D2T05, D2T06, D2T07, D2T08, D2T09, D2T10, D2TQY,	
           D3T01, D3T02, D3T03, D3T04, D3T05, D3T06, D3T07, D3T08, D3T09, D3T10, D3TQY,	
           D4T01, D4T02, D4T03, D4T04, D4T05, D4T06, D4T07, D4T08, D4T09, D4T10, D4TQY,	
           REMQY, GRTOT,
           HOSTD,	
           HOSTT
        )
		(select
			X.COMPS,X.PYVND,X.CINBR,
			MAX(X.DMKCR),MAX(X.DSECD),MAX(X.DSENO),MAX(X.DFACD),MAX(X.DEFFR),MAX(X.DEFTO),MAX(X.DUMCB),
			MAX(X.TRIMD),MAX(X.PBSQY),MAX(X.PATQY),MAX(X.WBSQY),
			SUM(X.Z01),SUM(X.Z02),SUM(X.Z03),SUM(X.Z04),SUM(X.Z05),SUM(X.Z06),SUM(X.Z07),SUM(X.Z08),SUM(X.Z09),SUM(X.Z10),
			SUM(X.Z11),SUM(X.Z12),SUM(X.Z13),SUM(X.Z14),SUM(X.Z15),SUM(X.Z16),SUM(X.Z17),SUM(X.Z18),SUM(X.Z19),SUM(X.Z20),
			SUM(X.Z21),SUM(X.Z22),SUM(X.Z23),SUM(X.Z24),SUM(X.Z25),SUM(X.Z26),SUM(X.Z27),SUM(X.Z28),SUM(X.Z29),SUM(X.Z30),
			SUM(X.Z31),SUM(X.Z32),SUM(X.Z33),SUM(X.Z34),SUM(X.Z35),SUM(X.Z36),SUM(X.Z37),SUM(X.Z38),SUM(X.Z39),SUM(X.Z40),
			SUM(X.Z41),SUM(X.Z42),SUM(X.Z43),SUM(X.Z44),SUM(X.Z45),SUM(X.Z46),SUM(X.Z47),SUM(X.Z48),SUM(X.Z49),SUM(X.Z50),
			SUM(X.Z51),SUM(X.Z52),SUM(X.Z53),SUM(X.Z54),SUM(X.Z55),SUM(X.Z56),SUM(X.Z57),
			substr(trim(char(date(current date), ISO)),1,4) || substr(trim(char(date(current date), ISO)),6,2) || substr(trim(char(date(current date), ISO)),9,2),
			substr(trim(char(time(current time), ISO)),1,2) || substr(trim(char(time(current time), ISO)),4,2) || substr(trim(char(time(current time), ISO)),7,2) 
		from
			(select 	
				A.COMPS,A.PYVND,B.CINBR,
				A.DMKCR,A.DSECD,A.DSENO,A.DFACD,A.DEFFR,A.DEFTO,A.DUMCB,
				A.TRIMD,A.PBSQY,A.PATQY,A.WBSQY,
				A.D0T01*B.QTYPR Z01,A.D0T02*B.QTYPR Z02,A.D0T03*B.QTYPR Z03,A.D0T04*B.QTYPR Z04,A.D0T05*B.QTYPR Z05,
				A.D0T06*B.QTYPR Z06,A.D0T07*B.QTYPR Z07,A.D0T08*B.QTYPR Z08,A.D0T09*B.QTYPR Z09,A.D0T10*B.QTYPR Z10,
				A.D0TQY*B.QTYPR Z11,A.D1T01*B.QTYPR Z12,A.D1T02*B.QTYPR Z13,A.D1T03*B.QTYPR Z14,A.D1T04*B.QTYPR Z15,
				A.D1T05*B.QTYPR Z16,A.D1T06*B.QTYPR Z17,A.D1T07*B.QTYPR Z18,A.D1T08*B.QTYPR Z19,A.D1T09*B.QTYPR Z20,
				A.D1T10*B.QTYPR Z21,A.D1TQY*B.QTYPR Z22,A.D2T01*B.QTYPR Z23,A.D2T02*B.QTYPR Z24,A.D2T03*B.QTYPR Z25,
				A.D2T04*B.QTYPR Z26,A.D2T05*B.QTYPR Z27,A.D2T06*B.QTYPR Z28,A.D2T07*B.QTYPR Z29,A.D2T08*B.QTYPR Z30,
				A.D2T09*B.QTYPR Z31,A.D2T10*B.QTYPR Z32,A.D2TQY*B.QTYPR Z33,A.D3T01*B.QTYPR Z34,A.D3T02*B.QTYPR Z35,
				A.D3T03*B.QTYPR Z36,A.D3T04*B.QTYPR Z37,A.D3T05*B.QTYPR Z38,A.D3T06*B.QTYPR Z39,A.D3T07*B.QTYPR Z40,
				A.D3T08*B.QTYPR Z41,A.D3T09*B.QTYPR Z42,A.D3T10*B.QTYPR Z43,A.D3TQY*B.QTYPR Z44,A.D4T01*B.QTYPR Z45,
				A.D4T02*B.QTYPR Z46,A.D4T03*B.QTYPR Z47,A.D4T04*B.QTYPR Z48,A.D4T05*B.QTYPR Z49,A.D4T06*B.QTYPR Z50,
				A.D4T07*B.QTYPR Z51,A.D4T08*B.QTYPR Z52,A.D4T09*B.QTYPR Z53,A.D4T10*B.QTYPR Z54,A.D4TQY*B.QTYPR Z55,
				A.REMQY*B.QTYPR Z56,A.GRTOT*B.QTYPR Z57,
				A.HOSTD,A.HOSTT 
			from 
				PSZDBLIB.svh310pf a, 
				(select * from PSZDBLIB.svz050pf where pspno != cinbr) b 
			where
				a.comps=b.comps and a.pspno=b.pspno
			) x left outer join PSZDBLIB.svh310pf y on not(x.comps = y.comps and x.pyvnd=y.pyvnd and x.cinbr = y.pspno)
	<!--WHERE
		 y.pspno is null -->
		 
		<!-- 중복오류 임시해결 -->
		WHERE X.COMPS || X.PYVND || X.CINBR NOT IN (SELECT Z.COMPS || Z.PYVND || Z.PSPNO FROM PSZDBLIB.SVH310PF Z)
				 
		GROUP BY
			X.COMPS,X.PYVND,X.CINBR
		)
    </insert>   
    
    
    <select id="countSVH320PF_Temp" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT 
		FROM 
			PSZDBLIB.SVH325PF
		WHERE 
			  'SqlMap-OrderHostUp.countSVH320PF_Temp' = 'SqlMap-OrderHostUp.countSVH320PF_Temp'
		<if test="pyvnd != null and pyvnd !='' ">
		  AND PYVND = #{pyvnd}
		</if>	
		<if test="pspno != null and pspno !='' ">
		  AND PSPNO = #{pspno}
		</if>
    </select>
        
    <delete id="deleteSVH320PF_Temp" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SVH325PF
		WHERE 
			  'SqlMap-OrderHostUp.deleteSVH320PF_Temp' = 'SqlMap-OrderHostUp.deleteSVH320PF_Temp'
    </delete>
        
    <insert id="createSVH320PF_Temp" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderHostUp.createSVH320PF_Temp */
		INSERT INTO 
			PSZDBLIB.SVH325PF
       (
            COMPS, PYVND, PSPNO, DMKCR, DSECD, DSENO, DFACD, DEFFR, DEFTO, DUMCB,
			TRIMD, PBSQY, PATQY, WBSQY,
			DAT00, DAT01, DAT02, DAT03, DAT04, DAT05, DAT06, DAT07, DAT08, DAT09, DAT10, DAT11, DAT12,
			REMQY, OKQTY, MITQY, PRSEQ, MIQQY, MIOQY, GRTOT, MOLCD, SPACE,	
            HOSTD,
            HOSTT
        )
		VALUES
			(
			#{comps},#{pyvnd},#{pspno},#{dmkcr},#{dsecd},#{dseno},#{dfacd},#{deffr},#{defto},#{dumcb},
			#{trimd},#{pbsqy},#{patqy},#{wbsqy},
			#{dat00},#{dat01},#{dat02},#{dat03},#{dat04},#{dat05},#{dat06},#{dat07},#{dat08},#{dat09},#{dat10},#{dat11},#{dat12},
			#{remqy},#{okqty},#{mitqy},#{prseq},#{miqqy},#{mioqy},#{grtot},#{molcd},'',
			substr(trim(char(date(current date), ISO)),1,4) || substr(trim(char(date(current date), ISO)),6,2) || substr(trim(char(date(current date), ISO)),9,2),
			substr(trim(char(time(current time), ISO)),1,2) || substr(trim(char(time(current time), ISO)),4,2) || substr(trim(char(time(current time), ISO)),7,2) 
			)
    </insert> 
        
    <select id="selectSVH320PF_Temp" resultMap="OrderHostUp" parameterType="OrderHostUpDomain">
		SELECT									
			COMPS, PYVND, PSPNO, DMKCR, DSECD, DSENO, DFACD, DEFFR, DEFTO, DUMCB,
			TRIMD, PBSQY, PATQY, WBSQY,
			DAT00, DAT01, DAT02, DAT03, DAT04, DAT05, 
			DAT06, DAT07, DAT08, DAT09, DAT10, DAT11, DAT12,
			REMQY, OKQTY, MITQY, PRSEQ, MIQQY, MIOQY, GRTOT, MOLCD	
		FROM									
			PSZDBLIB.SVH325PF												
		WHERE
		      'SqlMap-OrderHostUp.selectSVH320PF_Temp' = 'SqlMap-OrderHostUp.selectSVH320PF_Temp'
		ORDER BY									
			COMPS,PYVND,PSPNO
    </select>
    
    <select id="selectSVH320PF_TempSum" resultMap="OrderHostUp" parameterType="OrderHostUpDomain">
		SELECT			
		    SUM(TRIMD) AS TRIMD, SUM(PBSQY) AS PBSQY, SUM(PATQY) AS PATQY, SUM(WBSQY) AS WBSQY,						
			SUM(DAT00) AS DAT00, SUM(DAT01) AS DAT01, SUM(DAT02) AS DAT02, SUM(DAT03) AS DAT03, SUM(DAT04) AS DAT04, SUM(DAT05) AS DAT05, 
			SUM(DAT06) AS DAT06, SUM(DAT07) AS DAT07, SUM(DAT08) AS DAT08, SUM(DAT09) AS DAT09, SUM(DAT10) AS DAT10, SUM(DAT11) AS DAT11, SUM(DAT12) AS DAT12,
			SUM(REMQY) AS REMQY, SUM(OKQTY) AS OKQTY, SUM(MITQY) AS MITQY, SUM(PRSEQ) AS PRSEQ, SUM(MIQQY) AS MIQQY, SUM(MIOQY) AS MIOQY, SUM(GRTOT) AS GRTOT
		FROM									
			PSZDBLIB.SVH325PF												
		WHERE
		      'SqlMap-OrderHostUp.selectSVH320PF_Temp' = 'SqlMap-OrderHostUp.selectSVH320PF_Temp'
		  AND COMPS = #{comps}
		  AND PYVND = #{pyvnd}
		  AND PSPNO = #{pspno}
    </select>
    
    <select id="countSVH320PF1" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT 
		FROM 
			PSZDBLIB.SVH320PF 
		WHERE 
			  'SqlMap-OrderHostUp.countSVH320PF1' = 'SqlMap-OrderHostUp.countSVH320PF1'
	      AND DFACD IN (SELECT DFACD FROM PSZDBLIB.SVH325PF GROUP BY DFACD)
    </select>
    
    <!-- AND DFACD = #{dfacd} -->
    <delete id="deleteSVH320PF" parameterType="OrderHostUpDomain">
		DELETE FROM 
			PSZDBLIB.SVH320PF 
		WHERE 
			  'SqlMap-OrderHostUp.deleteSVH320PF' = 'SqlMap-OrderHostUp.deleteSVH320PF'
		  AND DFACD IN (SELECT DFACD FROM PSZDBLIB.SVH325PF GROUP BY DFACD)
    </delete>
    
    <select id="countSVH320PF2" resultType="java.lang.Integer" parameterType="OrderHostUpDomain">
		SELECT
			COUNT(*) CNT
		FROM
			PSZDBLIB.SVH320PF
		WHERE
		      'SqlMap-OrderHostUp.countSVH320PF2' = 'SqlMap-OrderHostUp.countSVH320PF2'		  
		  AND PYVND = #{pyvnd}
		  AND PSPNO = #{pspno}
    </select>
  
    <insert id="createSVH320PF" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderHostUp.createSVH320PF */
		INSERT INTO 
			PSZDBLIB.SVH320PF
       (
            COMPS, PYVND, PSPNO, DMKCR, DSECD, DSENO, DFACD, DEFFR, DEFTO, DUMCB,
            TRIMD, PBSQY, PATQY, WBSQY,	
            DAT00, DAT01, DAT02, DAT03, DAT04, DAT05, DAT06, DAT07, DAT08, DAT09, DAT10, DAT11, DAT12,	
            REMQY, OKQTY, MITQY, PRSEQ, MIQQY, MIOQY, GRTOT, MOLCD, SPACE,
            HOSTD,
            HOSTT
        )
		VALUES
			(
			#{comps},#{pyvnd},#{pspno},#{dmkcr},#{dsecd},#{dseno},#{dfacd},#{deffr},#{defto},#{dumcb},
			#{trimd},#{pbsqy},#{patqy},#{wbsqy},
			#{dat00},#{dat01},#{dat02},#{dat03},#{dat04},#{dat05},#{dat06},#{dat07},#{dat08},#{dat09},#{dat10},#{dat11},#{dat12},
			#{remqy},#{okqty},#{mitqy},#{prseq},#{miqqy},#{mioqy},#{grtot},#{molcd},'',
			substr(trim(char(date(current date), ISO)),1,4) || substr(trim(char(date(current date), ISO)),6,2) || substr(trim(char(date(current date), ISO)),9,2),
			substr(trim(char(time(current time), ISO)),1,2) || substr(trim(char(time(current time), ISO)),4,2) || substr(trim(char(time(current time), ISO)),7,2) 
			)
    </insert> 
    
    <insert id="createSVH320PF_ADD" parameterType ="OrderHostUpDomain">
    	/* SqlMap-OrderHostUp.createSVH320PF_ADD */
		INSERT INTO 
			PSZDBLIB.SVH320PF
       (
            COMPS, PYVND, PSPNO, DMKCR, DSECD, DSENO, DFACD, DEFFR, DEFTO, DUMCB,
            TRIMD, PBSQY, PATQY, WBSQY,	
            DAT00, DAT01, DAT02, DAT03, DAT04, DAT05, DAT06, DAT07, DAT08, DAT09, DAT10, DAT11, DAT12,	
            REMQY, OKQTY, MITQY, PRSEQ, MIQQY, MIOQY, GRTOT, MOLCD, SPACE,
            HOSTD,
            HOSTT
        )
		(SELECT
			X.COMPS,X.PYVND,X.CINBR,
			MAX(X.DMKCR),MAX(X.DSECD),MAX(X.DSENO),MAX(X.DFACD),MAX(X.DEFFR),MAX(X.DEFTO),MAX(X.DUMCB),
			SUM(X.Z01),SUM(X.Z02),SUM(X.Z03),SUM(X.Z04),SUM(X.Z05),SUM(X.Z06),SUM(X.Z07),SUM(X.Z08),SUM(X.Z09),SUM(X.Z10),
			SUM(X.Z11),SUM(X.Z12),SUM(X.Z13),SUM(X.Z14),SUM(X.Z15),SUM(X.Z16),SUM(X.Z17),SUM(X.Z18),SUM(X.Z19),SUM(X.Z20),
			SUM(X.Z21),SUM(X.Z22),SUM(X.Z23),SUM(X.Z24),
			MAX(X.MOLCD),MAX(X.SPACE),
			substr(trim(char(date(current date), ISO)),1,4) || substr(trim(char(date(current date), ISO)),6,2) || substr(trim(char(date(current date), ISO)),9,2),
			substr(trim(char(time(current time), ISO)),1,2) || substr(trim(char(time(current time), ISO)),4,2) || substr(trim(char(time(current time), ISO)),7,2) 
		FROM
			(select 	
				A.COMPS,A.PYVND,B.CINBR,A.DMKCR,A.DSECD,A.DSENO,A.DFACD,A.DEFFR,A.DEFTO,A.DUMCB,
				A.TRIMD*B.QTYPR Z01,A.PBSQY*B.QTYPR Z02,A.PATQY*B.QTYPR Z03,A.WBSQY*B.QTYPR Z04,A.DAT00*B.QTYPR Z05,
				A.DAT01*B.QTYPR Z06,A.DAT02*B.QTYPR Z07,A.DAT03*B.QTYPR Z08,A.DAT04*B.QTYPR Z09,A.DAT05*B.QTYPR Z10,
				A.DAT06*B.QTYPR Z11,A.DAT07*B.QTYPR Z12,A.DAT08*B.QTYPR Z13,A.DAT09*B.QTYPR Z14,A.DAT10*B.QTYPR Z15,
				A.DAT11*B.QTYPR Z16,A.DAT12*B.QTYPR Z17,A.REMQY*B.QTYPR Z18,A.OKQTY*B.QTYPR Z19,A.MITQY*B.QTYPR Z20,
				A.PRSEQ*B.QTYPR Z21,A.MIQQY*B.QTYPR Z22,A.MIOQY*B.QTYPR Z23,A.GRTOT*B.QTYPR Z24,
				A.MOLCD,A.SPACE,A.HOSTD,A.HOSTT
			from 
				PSZDBLIB.svh320pf a, 
				(select * from PSZDBLIB.svz050pf where pspno != cinbr) b 
			where
				a.comps=b.comps and a.pspno=b.pspno
			) x left outer join PSZDBLIB.svh320pf y on not(x.comps = y.comps and x.pyvnd=y.pyvnd and x.cinbr = y.pspno)
	<!--WHERE
		 y.pspno is null -->
		 
		<!-- 중복오류 임시해결 -->
		WHERE X.COMPS || X.PYVND || X.CINBR NOT IN (SELECT Z.COMPS || Z.PYVND || Z.PSPNO FROM PSZDBLIB.SVH320PF Z)
					
		GROUP BY
			X.COMPS,X.PYVND,X.CINBR
		)
    </insert>
    
</mapper>